# GCP - 存储未认证枚举

{{#include ../../../../banners/hacktricks-training.md}}

## 存储

有关存储的更多信息，请查看：

{{#ref}}
../../gcp-services/gcp-storage-enum.md
{{#endref}}

### 公共桶暴力破解

访问桶的**URL格式**是**`https://storage.googleapis.com/<bucket-name>`。**

可以使用以下工具生成给定名称的变体，并搜索配置错误的桶：

- [https://github.com/RhinoSecurityLabs/GCPBucketBrute](https://github.com/RhinoSecurityLabs/GCPBucketBrute)

**此外，提到的工具**在：

{{#ref}}
../
{{#endref}}

如果您发现可以**访问一个桶**，您可能能够**进一步提升权限**，请查看：

{{#ref}}
gcp-public-buckets-privilege-escalation.md
{{#endref}}

### 在当前账户中搜索开放桶

使用以下脚本 [从这里收集](https://gitlab.com/gitlab-com/gl-security/security-operations/gl-redteam/gcp_misc/-/blob/master/find_open_buckets.sh) 您可以找到所有开放的桶：
```bash
#!/bin/bash

############################
# Run this tool to find buckets that are open to the public anywhere
# in your GCP organization.
#
# Enjoy!
############################

for proj in $(gcloud projects list --format="get(projectId)"); do
echo "[*] scraping project $proj"
for bucket in $(gsutil ls -p $proj); do
echo "    $bucket"
ACL="$(gsutil iam get $bucket)"

all_users="$(echo $ACL | grep allUsers)"
all_auth="$(echo $ACL | grep allAuthenticatedUsers)"

if [ -z "$all_users" ]
then
:
else
echo "[!] Open to all users: $bucket"
fi

if [ -z "$all_auth" ]
then
:
else
echo "[!] Open to all authenticated users: $bucket"
fi
done
done
```
{{#include ../../../../banners/hacktricks-training.md}}
