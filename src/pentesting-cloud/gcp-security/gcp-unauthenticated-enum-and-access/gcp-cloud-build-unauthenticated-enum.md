# GCP - Cloud Build Unauthenticated Enum

{{#include ../../../banners/hacktricks-training.md}}

## Cloud Build

Для отримання додаткової інформації про Cloud Build перегляньте:

{{#ref}}
../gcp-services/gcp-cloud-build-enum.md
{{#endref}}

### cloudbuild.yml

Якщо ви отримали доступ до запису на репозиторій, що містить файл з назвою **`cloudbuild.yml`**, ви могли б **встановити бекдор** у цей файл, який вказує на **команди, що будуть виконані** всередині Cloud Build, і ексфільтрувати секрети, скомпрометувати те, що робиться, а також скомпрометувати **обліковий запис служби Cloud Build.**

> [!NOTE]
> Зверніть увагу, що GCP має можливість дозволити адміністраторам контролювати виконання системи збірки з зовнішніх PR через "Контроль коментарів". Контроль коментарів - це функція, де співпрацівники/власники проекту **повинні прокоментувати “/gcbrun”, щоб запустити збірку** проти PR, і використання цієї функції в принципі запобігає будь-кому в Інтернеті від запуску ваших систем збірки.

Для деякої пов'язаної інформації ви можете переглянути сторінку про те, як атакувати Github Actions (схоже на це):

{{#ref}}
../../../pentesting-ci-cd/github-security/abusing-github-actions/
{{#endref}}

### PR Approvals

Коли тригером є PR, оскільки **будь-хто може виконувати PR до публічних репозиторіїв**, було б дуже небезпечно просто **дозволити виконання тригера з будь-яким PR**. Тому за замовчуванням виконання буде **автоматичним лише для власників і співпрацівників**, і для виконання тригера з PR інших користувачів власник або співпрацівник повинен прокоментувати `/gcbrun`.

<figure><img src="../../../images/image (339).png" alt="" width="563"><figcaption></figcaption></figure>

> [!CAUTION]
> Тому, якщо це встановлено на **`Не обов'язково`**, зловмисник може виконати **PR до гілки**, що викличе виконання, додавши виконання шкідливого коду до файлу **`cloudbuild.yml`** і скомпрометувати виконання cloudbuild (зверніть увагу, що cloudbuild завантажить код З PR, тому він виконає шкідливий **`cloudbuild.yml`**).

Більше того, легко побачити, чи потрібно виконати деяке виконання cloudbuild, коли ви надсилаєте PR, оскільки це з'являється в Github:

<figure><img src="../../../images/image (340).png" alt=""><figcaption></figcaption></figure>

> [!WARNING]
> Тоді, навіть якщо cloudbuild не виконується, зловмисник зможе побачити **назву проекту GCP**, що належить компанії.

{{#include ../../../banners/hacktricks-training.md}}
