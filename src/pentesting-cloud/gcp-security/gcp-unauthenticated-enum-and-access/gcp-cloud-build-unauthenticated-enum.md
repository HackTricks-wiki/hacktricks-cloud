# GCP - Cloud Build Unauthenticated Enum

{{#include ../../../banners/hacktricks-training.md}}

## Cloud Build

Für weitere Informationen über Cloud Build siehe:

{{#ref}}
../gcp-services/gcp-cloud-build-enum.md
{{#endref}}

### cloudbuild.yml

Wenn du Schreibzugriff auf ein Repository mit einer Datei namens **`cloudbuild.yml`** erlangst, könntest du diese Datei **hintertüren**, die die **Befehle angibt, die innerhalb eines Cloud Builds ausgeführt werden sollen** und die Geheimnisse exfiltrieren, was durchgeführt wird, kompromittieren und auch das **Cloud Build-Dienstkonto** gefährden.

> [!NOTE]
> Beachte, dass GCP die Option hat, Administratoren die Kontrolle über die Ausführung von Build-Systemen aus externen PRs über "Comment Control" zu ermöglichen. Comment Control ist eine Funktion, bei der Mitarbeiter/Projektinhaber **kommentieren müssen “/gcbrun”, um den Build** gegen den PR auszulösen, und die Verwendung dieser Funktion verhindert grundsätzlich, dass jemand im Internet deine Build-Systeme auslösen kann.

Für einige verwandte Informationen kannst du die Seite über den Angriff auf Github Actions (ähnlich wie dies) überprüfen:

{{#ref}}
../../../pentesting-ci-cd/github-security/abusing-github-actions/
{{#endref}}

### PR Genehmigungen

Wenn der Trigger PR ist, weil **jeder PRs zu öffentlichen Repositories durchführen kann**, wäre es sehr gefährlich, einfach **die Ausführung des Triggers mit jedem PR zuzulassen**. Daher wird die Ausführung standardmäßig nur **automatisch für Eigentümer und Mitarbeiter** sein, und um den Trigger mit PRs anderer Benutzer auszuführen, muss ein Eigentümer oder Mitarbeiter kommentieren `/gcbrun`.

<figure><img src="../../../images/image (339).png" alt="" width="563"><figcaption></figcaption></figure>

> [!CAUTION]
> Daher, wenn dies auf **`Not required`** gesetzt ist, könnte ein Angreifer einen **PR zum Branch** durchführen, der die Ausführung auslöst, indem er die bösartige Codeausführung zur **`cloudbuild.yml`**-Datei hinzufügt und die cloudbuild-Ausführung gefährdet (beachte, dass cloudbuild den Code VON dem PR herunterladen wird, sodass es die bösartige **`cloudbuild.yml`** ausführen wird).

Darüber hinaus ist es einfach zu sehen, ob eine cloudbuild-Ausführung durchgeführt werden muss, wenn du einen PR sendest, da sie in Github erscheint:

<figure><img src="../../../images/image (340).png" alt=""><figcaption></figcaption></figure>

> [!WARNING]
> Dann, selbst wenn der cloudbuild nicht ausgeführt wird, wird der Angreifer in der Lage sein, den **Projektnamen eines GCP-Projekts** zu sehen, das zur Firma gehört.

{{#include ../../../banners/hacktricks-training.md}}
