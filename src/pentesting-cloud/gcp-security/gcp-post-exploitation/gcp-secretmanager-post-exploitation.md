# GCP - Secretmanager Post Exploitation

{{#include ../../../banners/hacktricks-training.md}}

## Secretmanager

有关 Secret Manager 的更多信息，请查看：

{{#ref}}
../gcp-services/gcp-secrets-manager-enum.md
{{#endref}}

### `secretmanager.versions.access`

这允许你从 Secret Manager 读取 secrets，并且可能有助于提升权限（取决于 secret 中存储的信息）：

<details>

<summary>访问 secret 版本</summary>
```bash
# Get clear-text of version 1 of secret: "<secret name>"
gcloud secrets versions access 1 --secret="<secret_name>"
```
</details>

### `secretmanager.versions.destroy`
`secretmanager.versions.destroy` 权限允许某个主体永久销毁（标记为不可恢复地删除）Secret Manager 中某个 secret 的特定版本，这可能使关键凭证被移除，并可能导致 denial of service 或阻止敏感数据的恢复。
```bash
gcloud secrets versions destroy <VERSION> --secret="<SECRET_NAME>" --project=<PROJECTID>
```
### `secretmanager.versions.disable`
该 `secretmanager.versions.disable` 权限允许某个主体在 Secret Manager 中禁用活动的 secret 版本，暂时阻止依赖它们的应用程序或服务使用这些版本。
```bash
gcloud secrets versions disable <VERSION> --secret="<SECRET_NAME>" --project=<PROJECTID>
```
### `secretmanager.secrets.delete`
`secretmanager.secrets.delete` 权限集允许某个身份在 Secret Manager 中完全删除一个 secret 及其所有已存储的版本。
```bash
gcloud secrets delete <SECRET_NAME> --project=<PROJECT_ID>
```
### `secretmanager.secrets.update`
权限 `secretmanager.secrets.update` 允许某个主体修改 Secret 的元数据和配置（例如：轮换设置、版本策略、标签以及某些 Secret 属性）。
```bash
gcloud secrets update SECRET_NAME \
--project=PROJECT_ID \
--clear-labels \
--rotation-period=DURATION
```
{{#include ../../../banners/hacktricks-training.md}}
