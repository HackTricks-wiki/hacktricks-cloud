# GCP - Secretmanager Post Exploitation

{{#include ../../../banners/hacktricks-training.md}}

## Secretmanager

Für weitere Informationen zum Secret Manager siehe:

{{#ref}}
../gcp-services/gcp-secrets-manager-enum.md
{{#endref}}

### `secretmanager.versions.access`

Dies gibt dir Zugriff, die secrets aus dem secret manager zu lesen und könnte dabei helfen, Privilegien zu eskalieren (abhängig davon, welche Informationen im Secret gespeichert sind):

<details>

<summary>Zugriff auf Secret-Version</summary>
```bash
# Get clear-text of version 1 of secret: "<secret name>"
gcloud secrets versions access 1 --secret="<secret_name>"
```
### `secretmanager.versions.destroy`
Die `secretmanager.versions.destroy`-Berechtigung erlaubt einer Identität, eine bestimmte Version eines Secrets in Secret Manager dauerhaft zu zerstören (als unwiderruflich gelöscht zu markieren), was die Entfernung kritischer Anmeldeinformationen ermöglichen und potenziell zu einem denial of service führen oder die Wiederherstellung sensibler Daten verhindern könnte.
```bash
gcloud secrets versions destroy <VERSION> --secret="<SECRET_NAME>" --project=<PROJECTID>
```
### `secretmanager.versions.disable`
Die Berechtigung `secretmanager.versions.disable` erlaubt einer Identität, aktive Secret-Versionen in Secret Manager zu deaktivieren, wodurch deren Nutzung durch Anwendungen oder Dienste, die von ihnen abhängen, vorübergehend blockiert wird.
```bash
gcloud secrets versions disable <VERSION> --secret="<SECRET_NAME>" --project=<PROJECTID>
```
### `secretmanager.secrets.delete`
Die Berechtigung `secretmanager.secrets.delete` erlaubt einer Identität, ein secret und alle seine gespeicherten Versionen in Secret Manager vollständig zu löschen.
```bash
gcloud secrets delete <SECRET_NAME> --project=<PROJECT_ID>
```
### `secretmanager.secrets.update`
Die Berechtigung `secretmanager.secrets.update` erlaubt einer Identität, die Metadaten und die Konfiguration eines Secrets zu ändern (zum Beispiel Rotationseinstellungen, Versionsrichtlinie, Labels und bestimmte Eigenschaften des Secrets).
```bash
gcloud secrets update SECRET_NAME \
--project=PROJECT_ID \
--clear-labels \
--rotation-period=DURATION
```
{{#include ../../../banners/hacktricks-training.md}}
