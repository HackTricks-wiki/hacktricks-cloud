# GCP - Secretmanager Post Exploitation

{{#include ../../../banners/hacktricks-training.md}}

## Secretmanager

Para más información sobre Secret Manager consulta:

{{#ref}}
../gcp-services/gcp-secrets-manager-enum.md
{{#endref}}

### `secretmanager.versions.access`

Esto te da acceso para leer los secrets del secret manager y quizá esto pueda ayudar a escalar privilegios (dependiendo de qué información esté almacenada dentro del secret):

<details>

<summary>Acceder a la versión del secret</summary>
```bash
# Get clear-text of version 1 of secret: "<secret name>"
gcloud secrets versions access 1 --secret="<secret_name>"
```
</details>

### `secretmanager.versions.destroy`
El permiso `secretmanager.versions.destroy` permite a una identidad destruir permanentemente (marcar como eliminada de forma irreversible) una versión específica de un secret en Secret Manager, lo que podría permitir la eliminación de credenciales críticas y potencialmente causar denial of service o impedir la recuperación de datos sensibles.
```bash
gcloud secrets versions destroy <VERSION> --secret="<SECRET_NAME>" --project=<PROJECTID>
```
### `secretmanager.versions.disable`
El permiso `secretmanager.versions.disable` permite a una identidad deshabilitar versiones activas de secretos en Secret Manager, bloqueando temporalmente su uso por parte de aplicaciones o servicios que dependan de ellas.
```bash
gcloud secrets versions disable <VERSION> --secret="<SECRET_NAME>" --project=<PROJECTID>
```
### `secretmanager.secrets.delete`
El conjunto de permisos `secretmanager.secrets.delete` permite a una identidad eliminar por completo un secreto y todas sus versiones almacenadas en Secret Manager.
```bash
gcloud secrets delete <SECRET_NAME> --project=<PROJECT_ID>
```
### `secretmanager.secrets.update`
El permiso `secretmanager.secrets.update` permite a una identidad modificar los metadatos y la configuración de un secreto (por ejemplo, ajustes de rotación, política de versiones, etiquetas y ciertas propiedades del secreto).
```bash
gcloud secrets update SECRET_NAME \
--project=PROJECT_ID \
--clear-labels \
--rotation-period=DURATION
```
{{#include ../../../banners/hacktricks-training.md}}
