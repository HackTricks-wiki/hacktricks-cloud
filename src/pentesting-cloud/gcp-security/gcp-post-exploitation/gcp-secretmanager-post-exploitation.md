# GCP - Secretmanager Post Exploitation

{{#include ../../../banners/hacktricks-training.md}}

## Secretmanager

Pour plus d'informations sur Secret Manager, consultez :

{{#ref}}
../gcp-services/gcp-secrets-manager-enum.md
{{#endref}}

### `secretmanager.versions.access`

Cela vous permet de lire les secrets depuis le Secret Manager et peut éventuellement aider à escalader des privilèges (selon les informations stockées dans le secret) :

<details>

<summary>Accéder à la version du secret</summary>
```bash
# Get clear-text of version 1 of secret: "<secret name>"
gcloud secrets versions access 1 --secret="<secret_name>"
```
</details>

### `secretmanager.versions.destroy`
La permission `secretmanager.versions.destroy` permet à une identité de détruire définitivement (marquer comme irrémédiablement supprimée) une version spécifique d'un secret dans Secret Manager, ce qui peut permettre la suppression d'identifiants critiques et potentiellement provoquer un denial of service ou empêcher la récupération de données sensibles.
```bash
gcloud secrets versions destroy <VERSION> --secret="<SECRET_NAME>" --project=<PROJECTID>
```
### `secretmanager.versions.disable`
La permission `secretmanager.versions.disable` permet à une identité de désactiver des versions de secret actives dans Secret Manager, bloquant temporairement leur utilisation par des applications ou services qui en dépendent.
```bash
gcloud secrets versions disable <VERSION> --secret="<SECRET_NAME>" --project=<PROJECTID>
```
### `secretmanager.secrets.delete`
Le jeu d'autorisations `secretmanager.secrets.delete` permet à une identité de supprimer complètement un secret et toutes ses versions stockées dans Secret Manager.
```bash
gcloud secrets delete <SECRET_NAME> --project=<PROJECT_ID>
```
### `secretmanager.secrets.update`
La permission `secretmanager.secrets.update` permet à une identité de modifier les métadonnées et la configuration d'un secret (par exemple, les paramètres de rotation, la politique de versions, les labels et certaines propriétés du secret).
```bash
gcloud secrets update SECRET_NAME \
--project=PROJECT_ID \
--clear-labels \
--rotation-period=DURATION
```
{{#include ../../../banners/hacktricks-training.md}}
