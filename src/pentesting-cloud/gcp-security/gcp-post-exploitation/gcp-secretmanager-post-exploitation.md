# GCP - Secretmanager Post Exploitation

{{#include ../../../banners/hacktricks-training.md}}

## Secretmanager

Для додаткової інформації про Secret Manager див.:

{{#ref}}
../gcp-services/gcp-secrets-manager-enum.md
{{#endref}}

### `secretmanager.versions.access`

Це дає можливість читати секрети з secret manager і може допомогти в ескалації привілеїв (залежно від того, яка інформація зберігається всередині секрету):

<details>

<summary>Доступ до версії секрету</summary>
```bash
# Get clear-text of version 1 of secret: "<secret name>"
gcloud secrets versions access 1 --secret="<secret_name>"
```
</details>

### `secretmanager.versions.destroy`
Дозвіл `secretmanager.versions.destroy` дає змогу ідентичності постійно знищити (позначити як безповоротно видалену) конкретну версію секрету в Secret Manager, що може дозволити видалення критичних облікових даних та потенційно спричинити відмову в обслуговуванні або перешкодити відновленню чутливих даних.
```bash
gcloud secrets versions destroy <VERSION> --secret="<SECRET_NAME>" --project=<PROJECTID>
```
### `secretmanager.versions.disable`
Дозвіл `secretmanager.versions.disable` дозволяє ідентичності відключати активні версії секретів у Secret Manager, тимчасово блокуючи їх використання додатками або сервісами, які від них залежать.
```bash
gcloud secrets versions disable <VERSION> --secret="<SECRET_NAME>" --project=<PROJECTID>
```
### `secretmanager.secrets.delete`
Набір дозволів `secretmanager.secrets.delete` дозволяє ідентичності повністю видалити секрет і всі його збережені версії у Secret Manager.
```bash
gcloud secrets delete <SECRET_NAME> --project=<PROJECT_ID>
```
### `secretmanager.secrets.update`
Дозвіл `secretmanager.secrets.update` дозволяє сутності змінювати метадані та конфігурацію секрету (наприклад, налаштування ротації, політику версій, мітки та певні властивості секрету).
```bash
gcloud secrets update SECRET_NAME \
--project=PROJECT_ID \
--clear-labels \
--rotation-period=DURATION
```
{{#include ../../../banners/hacktricks-training.md}}
