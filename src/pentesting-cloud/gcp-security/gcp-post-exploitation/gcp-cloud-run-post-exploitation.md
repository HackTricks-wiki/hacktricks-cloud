# GCP - Cloud Run Post Exploitation

{{#include ../../../banners/hacktricks-training.md}}

## Cloud Run

Cloud Run の詳細については、次を参照してください：

{{#ref}}
../gcp-services/gcp-cloud-run-enum.md
{{#endref}}

### CloudRun Job の削除
`run.services.delete` と `run.services.get` の権限、および `run.jobs.delete` は、アイデンティティが Cloud Run のサービスやジョブ（構成や履歴を含む）を完全に削除できるようにします。攻撃者の手に渡ると、これはアプリケーションや重要なワークフローに即時の障害を引き起こし、サービスロジックや必須のスケジュールされたタスクに依存するユーザーやシステムに対してサービス拒否（DoS）をもたらす可能性があります。

ジョブを削除するには、次の操作を実行できます。
```bash
gcloud run jobs delete <JOB_NAME> --region=<REGION> --quiet
```
サービスを削除するには、次の操作を実行します。
```bash
gcloud run services delete <SERVICE_NAME> --region=<REGION> --quiet
```
### 画像にアクセスする

コンテナイメージにアクセスできる場合は、コードに脆弱性やハードコードされた機密情報がないか確認してください。env variables に含まれる機密情報も確認します。

イメージが Artifact Registry サービス内のリポジトリに保存されており、ユーザーがそれらのリポジトリに対して読み取りアクセスを持っている場合、そのユーザーはこのサービスからイメージをダウンロードすることもできます。

### イメージを修正して再デプロイする

実行されるイメージを改変して情報を盗み、新しいバージョンを再デプロイします（同じタグで新しい docker container を単にアップロードしても実行されません）。例えば、ログインページを公開している場合は、ユーザーが送信する認証情報を盗むようにします。

{{#include ../../../banners/hacktricks-training.md}}
