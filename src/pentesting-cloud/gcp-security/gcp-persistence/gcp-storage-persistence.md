# GCP - Storage 永続化

{{#include ../../../banners/hacktricks-training.md}}

## Storage

Cloud Storageについての詳細は次を参照してください:

{{#ref}}
../gcp-services/gcp-storage-enum.md
{{#endref}}

### `storage.hmacKeys.create`

bucketに対する永続性を維持するためにHMACを作成できます。 この手法の詳細については[**こちらを参照**](../gcp-privilege-escalation/gcp-storage-privesc.md#storage.hmackeys.create)。

<details>

<summary>Storageアクセス用のHMACキーの作成と利用</summary>
```bash
# Create key
gsutil hmac create <sa-email>

# Configure gsutil to use it
gsutil config -a

# Use it
gsutil ls gs://[BUCKET_NAME]
```
</details>

この手法の別のエクスプロイトスクリプトは [here](https://github.com/RhinoSecurityLabs/GCP-IAM-Privilege-Escalation/blob/master/ExploitScripts/storage.hmacKeys.create.py) で確認できます。

### パブリックアクセスを付与

**bucket を公開アクセス可能にすること** は、bucket へのアクセスを維持するもう一つの方法です。方法は以下を参照してください:

{{#ref}}
../gcp-post-exploitation/gcp-storage-post-exploitation.md
{{#endref}}

{{#include ../../../banners/hacktricks-training.md}}
