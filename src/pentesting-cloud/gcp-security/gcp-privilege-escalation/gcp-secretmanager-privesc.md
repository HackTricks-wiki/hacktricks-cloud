# GCP - Secretmanager Privesc

{{#include ../../../banners/hacktricks-training.md}}

## secretmanager

Για περισσότερες πληροφορίες σχετικά με το secretmanager:

{{#ref}}
../gcp-services/gcp-secrets-manager-enum.md
{{#endref}}

### `secretmanager.versions.access`

Αυτό σας δίνει πρόσβαση για να διαβάσετε τα secrets από το secret manager και ίσως αυτό να βοηθήσει να escalate privielegs (ανάλογα με τις πληροφορίες που είναι αποθηκευμένες μέσα στο secret):

<details><summary>Λήψη clear-text secret version</summary>
```bash
# Get clear-text of version 1 of secret: "<secret name>"
gcloud secrets versions access 1 --secret="<secret_name>"
```
</details>

Καθώς πρόκειται επίσης για τεχνική post exploitation, μπορεί να βρεθεί στο:

{{#ref}}
../gcp-post-exploitation/gcp-secretmanager-post-exploitation.md
{{#endref}}

### `secretmanager.secrets.setIamPolicy`

Αυτό σας επιτρέπει να διαβάσετε τα secrets από τον secret manager, για παράδειγμα χρησιμοποιώντας:

<details><summary>Προσθήκη IAM policy binding σε secret</summary>
```bash
gcloud secrets add-iam-policy-binding <scret-name> \
--member="serviceAccount:<sa-name>@$PROJECT_ID.iam.gserviceaccount.com" \
--role="roles/secretmanager.secretAccessor"
```
Ή ανακαλέστε πολιτικές με:
```bash
gcloud secrets remove-iam-policy-binding <secret-name> \
--member="serviceAccount:<sa-name>@<PROJECT_ID>.iam.gserviceaccount.com" \
--role="roles/secretmanager.secretAccessor"
```
</details>

{{#include ../../../banners/hacktricks-training.md}}
