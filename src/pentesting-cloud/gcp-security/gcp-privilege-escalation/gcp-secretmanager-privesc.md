# GCP - Secretmanager Privesc

{{#include ../../../banners/hacktricks-training.md}}

## secretmanager

secretmanager에 대한 자세한 정보:

{{#ref}}
../gcp-services/gcp-secrets-manager-enum.md
{{#endref}}

### `secretmanager.versions.access`

이 권한은 secret manager에서 secrets를 읽을 수 있는 접근을 제공합니다. 저장된 정보에 따라 이는 escalate privielegs에 도움이 될 수 있습니다:

<details><summary>평문 secret 버전 가져오기</summary>
```bash
# Get clear-text of version 1 of secret: "<secret name>"
gcloud secrets versions access 1 --secret="<secret_name>"
```
</details>

이는 또한 post exploitation technique이므로 다음에서 확인할 수 있습니다:

{{#ref}}
../gcp-post-exploitation/gcp-secretmanager-post-exploitation.md
{{#endref}}

### `secretmanager.secrets.setIamPolicy`

이를 통해 secret manager에서 secrets를 읽을 수 있는 접근 권한을 부여할 수 있습니다. 예:

<details><summary>secret에 IAM 정책 바인딩 추가</summary>
```bash
gcloud secrets add-iam-policy-binding <scret-name> \
--member="serviceAccount:<sa-name>@$PROJECT_ID.iam.gserviceaccount.com" \
--role="roles/secretmanager.secretAccessor"
```
또는 정책을 철회하려면:
```bash
gcloud secrets remove-iam-policy-binding <secret-name> \
--member="serviceAccount:<sa-name>@<PROJECT_ID>.iam.gserviceaccount.com" \
--role="roles/secretmanager.secretAccessor"
```
</details>

{{#include ../../../banners/hacktricks-training.md}}
