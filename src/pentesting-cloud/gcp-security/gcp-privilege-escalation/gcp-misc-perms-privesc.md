# GCP - Permissions génériques Privesc

{{#include ../../../banners/hacktricks-training.md}}

## Permissions génériques intéressantes

### \*.setIamPolicy

Si un utilisateur que vous contrôlez possède la permission **`setIamPolicy`** sur une ressource, vous pouvez **escalader les privilèges sur cette ressource** car vous pourrez modifier la politique IAM de cette ressource et vous accorder davantage de privilèges.\
Cette permission peut aussi permettre d'**escalader vers d'autres entités (principals)** si la ressource permet d'exécuter du code et que `iam.ServiceAccounts.actAs` n'est pas nécessaire.

- _cloudfunctions.functions.setIamPolicy_
- Modifier la politique d'une Cloud Function pour vous permettre de l'invoquer.

Il existe des dizaines de types de ressources avec ce genre de permission ; vous pouvez tous les trouver sur [https://cloud.google.com/iam/docs/permissions-reference](https://cloud.google.com/iam/docs/permissions-reference) en recherchant setIamPolicy.

### \*.create, \*.update

Ces permissions peuvent être très utiles pour tenter d'escalader des privilèges sur des ressources en **créant une nouvelle ressource ou en mettant à jour une ressource existante**. Ce type de permissions est particulièrement utile si vous avez aussi la permission **iam.serviceAccounts.actAs** sur un Service Account et que la ressource sur laquelle vous avez .create/.update peut attacher un Service Account.

### \*ServiceAccount\*

Cette permission vous permettra généralement de **accéder ou modifier un Service Account dans une ressource** (par ex. : compute.instances.setServiceAccount). Cela **pourrait conduire à un vecteur d'escalade de privilèges**, mais cela dépendra de chaque cas.

### iam.ServiceAccounts.actAs

Cette permission vous permettra d'attacher un Service Account à une ressource qui le prend en charge (par ex. : Compute Engine VM, Cloud Function, Cloud Run, etc).\
Si vous pouvez attacher un Service Account qui a plus de privilèges que votre utilisateur à une ressource capable d'exécuter du code, vous pourrez escalader vos privilèges en exécutant du code avec ce Service Account.

Cherchez dans Cloud Hacktricks `iam.ServiceAccounts.actAs` pour trouver plusieurs exemples d'escalade de privilèges avec cette permission.

{{#include ../../../banners/hacktricks-training.md}}
