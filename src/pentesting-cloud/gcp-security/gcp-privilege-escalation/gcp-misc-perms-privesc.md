# GCP - Generic Permissions Privesc

{{#include ../../../banners/hacktricks-training.md}}

## Загальні цікаві дозволи

### \*.setIamPolicy

Якщо у вас є користувач, який має дозвіл **`setIamPolicy`** на ресурсі, ви можете **підвищити привілеї в цьому ресурсі**, оскільки зможете змінити IAM-політику ресурсу та надати собі більше привілеїв щодо нього.\
Цей дозвіл також може дозволити **ескалювати до інших принципалів**, якщо ресурс дозволяє виконувати код і `iam.ServiceAccounts.actAs` не потрібен.

- _cloudfunctions.functions.setIamPolicy_
- Змінити політику Cloud Function, щоб дозволити собі викликати її.

Існує десятки типів ресурсів з таким дозволом; ви можете знайти їх усі на [https://cloud.google.com/iam/docs/permissions-reference](https://cloud.google.com/iam/docs/permissions-reference), шукаючи setIamPolicy.

### \*.create, \*.update

Ці дозволи можуть бути дуже корисними для спроб підвищення привілеїв у ресурсах шляхом **створення нового ресурсу або оновлення існуючого**. Ці типи дозволів особливо корисні, якщо у вас також є дозвіл **iam.serviceAccounts.actAs** щодо Service Account і ресурс, над яким у вас є .create/.update, може прикріпити Service Account.

### \*ServiceAccount\*

Цей дозвіл зазвичай дозволяє вам **доступатися або змінювати Service Account у певному ресурсі** (наприклад: compute.instances.setServiceAccount). Це **може призвести до вектора підвищення привілеїв**, але все залежатиме від конкретного випадку.

### iam.ServiceAccounts.actAs

Цей дозвіл дозволяє прикріплювати Service Account до ресурсу, який це підтримує (наприклад: Compute Engine VM, Cloud Function, Cloud Run тощо).\
Якщо ви можете прикріпити Service Account, який має більше привілеїв, ніж ваш користувач, до ресурсу, що може виконувати код, ви зможете підвищити свої привілеї, виконуючи код від імені цього Service Account.

Пошукайте в Cloud Hacktricks `iam.ServiceAccounts.actAs`, щоб знайти кілька прикладів, як ескалювати привілеї з цим дозволом.

{{#include ../../../banners/hacktricks-training.md}}
