# GCP - Generic Permissions Privesc

{{#include ../../../banners/hacktricks-training.md}}

## Allgemein interessante Berechtigungen

### \*.setIamPolicy

Wenn du einen Nutzer besitzt, der die **`setIamPolicy`**-Berechtigung für eine Ressource hat, kannst du **escalate privileges in that resource**, weil du die IAM-Richtlinie dieser Ressource ändern und dir dadurch mehr Rechte verschaffen kannst.\
Diese Berechtigung kann auch erlauben, **escalate to other principals**, wenn die Ressource das Ausführen von Code erlaubt und `iam.ServiceAccounts.actAs` nicht notwendig ist.

- _cloudfunctions.functions.setIamPolicy_
- Ändere die Richtlinie einer Cloud Function, um dir selbst das Aufrufen zu erlauben.

Es gibt Dutzende von Ressourcentypen mit dieser Art von Berechtigung; du kannst alle in [https://cloud.google.com/iam/docs/permissions-reference](https://cloud.google.com/iam/docs/permissions-reference) finden, indem du nach setIamPolicy suchst.

### \*.create, \*.update

Diese Berechtigungen können sehr nützlich sein, um zu versuchen, in Ressourcen Privilegien zu eskalieren, indem du eine neue Ressource erstellst oder eine bestehende aktualisierst. Diese Arten von Berechtigungen sind besonders nützlich, wenn du außerdem die Berechtigung **iam.serviceAccounts.actAs** für ein Service Account hast und die Ressource, über die du .create/.update-Rechte besitzt, ein Service Account anhängen kann.

### \*ServiceAccount\*

Diese Berechtigung erlaubt dir in der Regel, auf ein Service Account in einer Ressource zuzugreifen oder es zu ändern (z. B.: compute.instances.setServiceAccount). Dies **could lead to a privilege escalation**, hängt aber vom Einzelfall ab.

### iam.ServiceAccounts.actAs

Diese Berechtigung erlaubt es dir, ein Service Account an eine Ressource anzuhängen, die dies unterstützt (z. B.: Compute Engine VM, Cloud Function, Cloud Run, etc).\
Wenn du ein Service Account anhängen kannst, das mehr Rechte hat als dein Nutzer, an eine Ressource, die Code ausführen kann, wirst du in der Lage sein, escalate your privileges, indem du Code mit diesem Service Account ausführst.

Suche in Cloud Hacktricks nach `iam.ServiceAccounts.actAs`, um mehrere Beispiele zu finden, wie man mit dieser Berechtigung escalate privileges erreicht.

{{#include ../../../banners/hacktricks-training.md}}
