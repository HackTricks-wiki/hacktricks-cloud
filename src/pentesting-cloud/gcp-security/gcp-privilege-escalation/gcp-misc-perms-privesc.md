# GCP - Generic Permissions Privesc

{{#include ../../../banners/hacktricks-training.md}}

## Permisos genéricos interesantes

### \*.setIamPolicy

Si controlas un usuario que tiene el permiso **`setIamPolicy`** en un recurso, puedes **escalar privilegios en ese recurso** porque podrás cambiar la política IAM de ese recurso y otorgarte más privilegios sobre él.\
Este permiso también puede permitir **escalar a otros principals** si el recurso permite ejecutar código y no es necesario `iam.ServiceAccounts.actAs`.

- _cloudfunctions.functions.setIamPolicy_
- Modify the policy of a Cloud Function to allow yourself to invoke it.

Hay decenas de tipos de recursos con este tipo de permiso; puedes encontrarlos todos en [https://cloud.google.com/iam/docs/permissions-reference](https://cloud.google.com/iam/docs/permissions-reference) buscando setIamPolicy.

### \*.create, \*.update

Estos permisos pueden ser muy útiles para intentar escalar privilegios en recursos creando uno nuevo o actualizando uno existente. Este tipo de permisos es especialmente útil si además tienes el permiso **iam.serviceAccounts.actAs** sobre una Service Account y el recurso sobre el que tienes .create/.update puede adjuntar una service account.

### \*ServiceAccount\*

Este permiso generalmente te permitirá **acceder o modificar una Service Account en algún recurso** (por ejemplo: compute.instances.setServiceAccount). Esto **podría conducir a un vector de escalada de privilegios**, pero dependerá de cada caso.

### iam.ServiceAccounts.actAs

Este permiso te permitirá adjuntar una Service Account a un recurso que lo soporte (por ejemplo: Compute Engine VM, Cloud Function, Cloud Run, etc).\
Si puedes adjuntar una Service Account que tenga más privilegios que tu usuario a un recurso que pueda ejecutar código, podrás escalar tus privilegios ejecutando código con esa Service Account.

Search in Cloud Hacktricks for `iam.ServiceAccounts.actAs` to find several examples of how to escalate privileges with this permission.

{{#include ../../../banners/hacktricks-training.md}}
