# GCP - Deploymentmaneger Privesc

{{#include ../../../banners/hacktricks-training.md}}

## deploymentmanager

### `deploymentmanager.deployments.create`

Cette seule permission vous permet de **lancer de nouveaux déploiements** de ressources dans GCP avec des comptes de service arbitraires. Vous pourriez par exemple lancer une instance de calcul avec un SA pour y accéder.

Vous pourriez en fait **lancer n'importe quelle ressource** listée dans `gcloud deployment-manager types list`

Dans la [**recherche originale**](https://rhinosecuritylabs.com/gcp/privilege-escalation-google-cloud-platform-part-1/), le [**script**](https://github.com/RhinoSecurityLabs/GCP-IAM-Privilege-Escalation/blob/master/ExploitScripts/deploymentmanager.deployments.create.py) suivant est utilisé pour déployer une instance de calcul, cependant ce script ne fonctionnera pas. Consultez un script pour automatiser la [**création, l'exploitation et le nettoyage d'un environnement vulnérable ici**](https://github.com/carlospolop/gcp_privesc_scripts/blob/main/tests/1-deploymentmanager.deployments.create.sh)**.**

### `deploymentmanager.deployments.update`

C'est comme l'abus précédent mais au lieu de créer un nouveau déploiement, vous modifiez un déjà existant (donc soyez prudent)

Consultez un script pour automatiser la [**création, l'exploitation et le nettoyage d'un environnement vulnérable ici**](https://github.com/carlospolop/gcp_privesc_scripts/blob/main/tests/e-deploymentmanager.deployments.update.sh)**.**

### `deploymentmanager.deployments.setIamPolicy`

C'est comme l'abus précédent mais au lieu de créer directement un nouveau déploiement, vous vous donnez d'abord cet accès et ensuite abusez de la permission comme expliqué dans la section précédente _deploymentmanager.deployments.create_.

## References

- [https://rhinosecuritylabs.com/gcp/privilege-escalation-google-cloud-platform-part-1/](https://rhinosecuritylabs.com/gcp/privilege-escalation-google-cloud-platform-part-1/)

{{#include ../../../banners/hacktricks-training.md}}
