# GCP - Deploymentmaneger Privesc

{{#include ../../../banners/hacktricks-training.md}}

## deploymentmanager

### `deploymentmanager.deployments.create`

この単一の権限により、任意のサービスアカウントを使用してGCPに**新しいリソースのデプロイメントを開始**できます。たとえば、SAを使用してコンピュートインスタンスを起動し、それに昇格することができます。

実際には、`gcloud deployment-manager types list`にリストされている**任意のリソースを起動**できます。

[**元の研究**](https://rhinosecuritylabs.com/gcp/privilege-escalation-google-cloud-platform-part-1/)では、[**スクリプト**](https://github.com/RhinoSecurityLabs/GCP-IAM-Privilege-Escalation/blob/master/ExploitScripts/deploymentmanager.deployments.create.py)がコンピュートインスタンスをデプロイするために使用されていますが、そのスクリプトは機能しません。ここで、[**脆弱な環境の作成、悪用、クリーンアップを自動化するスクリプト**](https://github.com/carlospolop/gcp_privesc_scripts/blob/main/tests/1-deploymentmanager.deployments.create.sh)**を確認してください。**

### `deploymentmanager.deployments.update`

これは前の悪用と似ていますが、新しいデプロイメントを作成するのではなく、既存のデプロイメントを変更します（注意してください）。

ここで、[**脆弱な環境の作成、悪用、クリーンアップを自動化するスクリプト**](https://github.com/carlospolop/gcp_privesc_scripts/blob/main/tests/e-deploymentmanager.deployments.update.sh)**を確認してください。**

### `deploymentmanager.deployments.setIamPolicy`

これは前の悪用と似ていますが、新しいデプロイメントを直接作成するのではなく、最初にそのアクセスを付与し、その後、前の_deploymentmanager.deployments.create_セクションで説明したように権限を悪用します。

## References

- [https://rhinosecuritylabs.com/gcp/privilege-escalation-google-cloud-platform-part-1/](https://rhinosecuritylabs.com/gcp/privilege-escalation-google-cloud-platform-part-1/)

{{#include ../../../banners/hacktricks-training.md}}
