# GCP - Deploymentmaneger Privesc

{{#include ../../../banners/hacktricks-training.md}}

## deploymentmanager

### `deploymentmanager.deployments.create`

这个单一权限允许你**在 GCP 中启动新的资源部署**，使用任意服务账户。例如，你可以启动一个计算实例并通过它进行权限提升。

你实际上可以**启动任何资源**，该资源在 `gcloud deployment-manager types list` 中列出。

在[**原始研究**](https://rhinosecuritylabs.com/gcp/privilege-escalation-google-cloud-platform-part-1/)中，使用了以下[**脚本**](https://github.com/RhinoSecurityLabs/GCP-IAM-Privilege-Escalation/blob/master/ExploitScripts/deploymentmanager.deployments.create.py)来部署计算实例，但该脚本无法工作。查看一个脚本以自动化[**创建、利用和清理漏洞环境**](https://github.com/carlospolop/gcp_privesc_scripts/blob/main/tests/1-deploymentmanager.deployments.create.sh)**。**

### `deploymentmanager.deployments.update`

这类似于之前的滥用，但不是创建新的部署，而是修改一个已经存在的（所以要小心）。

查看一个脚本以自动化[**创建、利用和清理漏洞环境**](https://github.com/carlospolop/gcp_privesc_scripts/blob/main/tests/e-deploymentmanager.deployments.update.sh)**。**

### `deploymentmanager.deployments.setIamPolicy`

这类似于之前的滥用，但不是直接创建新的部署，而是首先授予你该访问权限，然后如前面 _deploymentmanager.deployments.create_ 部分所述滥用该权限。

## References

- [https://rhinosecuritylabs.com/gcp/privilege-escalation-google-cloud-platform-part-1/](https://rhinosecuritylabs.com/gcp/privilege-escalation-google-cloud-platform-part-1/)

{{#include ../../../banners/hacktricks-training.md}}
