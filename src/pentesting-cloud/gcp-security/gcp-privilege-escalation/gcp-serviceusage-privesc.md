# GCP - Serviceusage Privesc

{{#include ../../../banners/hacktricks-training.md}}

## serviceusage

–ù–∞—Å—Ç—É–ø–Ω—ñ –¥–æ–∑–≤–æ–ª–∏ –∫–æ—Ä–∏—Å–Ω—ñ –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ –∫—Ä–∞–¥—ñ–∂–∫–∏ API keys, –∑–∞—É–≤–∞–∂—Ç–µ –≤–∏—Ç—è–≥ –∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó: _API key ‚Äî —Ü–µ –ø—Ä–æ—Å—Ç–∏–π –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π —Ä—è–¥–æ–∫, —è–∫–∏–π **—ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É—î –¥–æ–¥–∞—Ç–æ–∫ –±–µ–∑ –±—É–¥—å-—è–∫–æ–≥–æ principal**. –í–æ–Ω–∏ –∫–æ—Ä–∏—Å–Ω—ñ –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ **public data anonymously**, —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è **associate** API-–∑–∞–ø–∏—Ç—ñ–≤ –∑ –≤–∞—à–∏–º –ø—Ä–æ–µ–∫—Ç–æ–º –¥–ª—è quota —Ç–∞ **billing**._

–û—Ç–∂–µ, –∑ API key –≤–∏ –º–æ–∂–µ—Ç–µ –∑–º—É—Å–∏—Ç–∏ —Ü—é –∫–æ–º–ø–∞–Ω—ñ—é –æ–ø–ª–∞—Ç–∏—Ç–∏ –≤–∞—à–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è API, –∞–ª–µ –≤–∏ –Ω–µ –∑–º–æ–∂–µ—Ç–µ escalate privileges.

–©–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è –ø—Ä–æ —ñ–Ω—à—ñ –¥–æ–∑–≤–æ–ª–∏ —Ç–∞ —Å–ø–æ—Å–æ–±–∏ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó API keys, –¥–∏–≤.:

{{#ref}}
gcp-apikeys-privesc.md
{{#endref}}

### `serviceusage.apiKeys.create`

–ë—É–ª–æ –∑–Ω–∞–π–¥–µ–Ω–æ –Ω–µ–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤–∞–Ω–µ API, —è–∫–µ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –¥–ª—è **—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è API keys:**

<details><summary>–°—Ç–≤–æ—Ä–∏—Ç–∏ API key –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –Ω–µ–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤–∞–Ω–æ–≥–æ API</summary>
```bash
curl -XPOST "https://apikeys.clients6.google.com/v1/projects/<project-uniq-name>/apiKeys?access_token=$(gcloud auth print-access-token)"
```
</details>

### `serviceusage.apiKeys.list`

–ë—É–ª–æ –≤–∏—è–≤–ª–µ–Ω–æ —â–µ –æ–¥–∏–Ω –Ω–µ–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤–∞–Ω–∏–π API –¥–ª—è –ø–µ—Ä–µ–ª—ñ–∫—É API keys, —è–∫—ñ –≤–∂–µ —Å—Ç–≤–æ—Ä–µ–Ω–æ (API keys –ø—Ä–∏—Å—É—Ç–Ω—ñ —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ):

<details><summary>–ü–µ—Ä–µ–ª—ñ–∫ API keys –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –Ω–µ–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤–∞–Ω–æ–≥–æ API</summary>
```bash
curl "https://apikeys.clients6.google.com/v1/projects/<project-uniq-name>/apiKeys?access_token=$(gcloud auth print-access-token)"
```
</details>

### **`serviceusage.services.enable`** , **`serviceusage.services.use`**

–ó —Ü–∏–º–∏ –¥–æ–∑–≤–æ–ª–∞–º–∏ attacker –º–æ–∂–µ –≤–≤—ñ–º–∫–Ω—É—Ç–∏ —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –Ω–æ–≤—ñ —Å–µ—Ä–≤—ñ—Å–∏ –≤ –ø—Ä–æ—î–∫—Ç—ñ. –¶–µ –º–æ–∂–µ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ **attacker —É–≤—ñ–º–∫–Ω—É—Ç–∏ —Å–µ—Ä–≤—ñ—Å–∏ –Ω–∞ –∫—à—Ç–∞–ª—Ç admin –∞–±–æ cloudidentity**, —â–æ–± —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó Workspace –∞–±–æ —á–µ—Ä–µ–∑ —ñ–Ω—à—ñ —Å–µ—Ä–≤—ñ—Å–∏ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ü—ñ–∫–∞–≤–∏—Ö –¥–∞–Ω–∏—Ö.

## **References**

- [https://rhinosecuritylabs.com/cloud-security/privilege-escalation-google-cloud-platform-part-2/](https://rhinosecuritylabs.com/cloud-security/privilege-escalation-google-cloud-platform-part-2/)

<details>

<summary><strong>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks —Ç–∞ –æ—Ç—Ä–∏–º–∞–π—Ç–µ –ø–µ—Ä–µ–≤–∞–≥–∏!</strong></summary>

–í–∏ –ø—Ä–∞—Ü—é—î—Ç–µ –≤ **cybersecurity company**? –•–æ—á–µ—Ç–µ, —â–æ–± –≤–∞—à–∞ **company advertised in HackTricks**? –ê–±–æ –±–∞–∂–∞—î—Ç–µ –º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ **latest version of the PEASS or download HackTricks in PDF**? –ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!

–î—ñ–∑–Ω–∞–π—Ç–µ—Å—å –ø—Ä–æ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFTs**](https://opensea.io/collection/the-peass-family)

–ü—Ä–∏–¥–±–∞–π—Ç–µ [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)

**–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** [**üí¨**](https://emojipedia.org/speech-balloon/) [**Discord group**](https://discord.gg/hRep4RUj7f) –∞–±–æ –¥–æ [**telegram group**](https://t.me/peass) –∞–±–æ **–ø—ñ–¥–ø–∏—Å—É–π—Ç–µ—Å—å** –Ω–∞ –º–µ–Ω–µ –≤ **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/carlospolopm)**.**

**Share your hacking tricks submitting PRs to the** [**hacktricks github repo**](https://github.com/carlospolop/hacktricks)\*\*\*\*

**.**

</details>



{{#include ../../../banners/hacktricks-training.md}}
