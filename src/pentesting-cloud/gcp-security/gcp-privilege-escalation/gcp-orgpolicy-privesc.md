# GCP - Orgpolicy Privesc

{{#include ../../../banners/hacktricks-training.md}}

## orgpolicy

### `orgpolicy.policy.set`

Ein Angreifer, der **orgpolicy.policy.set** ausnutzt, kann organisatorische Richtlinien manipulieren, was ihm ermöglicht, bestimmte Einschränkungen zu entfernen, die spezifische Operationen behindern. Zum Beispiel blockiert die Einschränkung **appengine.disableCodeDownload** normalerweise das Herunterladen des App Engine Quellcodes. Durch die Verwendung von **orgpolicy.policy.set** kann ein Angreifer jedoch diese Einschränkung deaktivieren und somit Zugriff auf den Quellcode erhalten, obwohl dieser ursprünglich geschützt war.
```bash
# Get info
gcloud resource-manager org-policies describe <org-policy> [--folder <id> | --organization <id> | --project <id>]

# Disable
gcloud resource-manager org-policies disable-enforce <org-policy> [--folder <id> | --organization <id> | --project <id>]
```
Ein Python-Skript für diese Methode kann [hier](https://github.com/RhinoSecurityLabs/GCP-IAM-Privilege-Escalation/blob/master/ExploitScripts/orgpolicy.policy.set.py) gefunden werden.

## Referenzen

- [https://rhinosecuritylabs.com/cloud-security/privilege-escalation-google-cloud-platform-part-2/](https://rhinosecuritylabs.com/cloud-security/privilege-escalation-google-cloud-platform-part-2/)

{{#include ../../../banners/hacktricks-training.md}}
