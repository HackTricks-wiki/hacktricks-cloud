# GCP - Artifact Registry Enum

{{#include ../../../banners/hacktricks-training.md}}

## Basic Information

Google Cloud Artifact Registry एक पूरी तरह से प्रबंधित सेवा है जो आपको **अपने सॉफ़्टवेयर आर्टिफैक्ट्स का प्रबंधन, भंडारण और सुरक्षा** करने की अनुमति देती है। यह मूल रूप से **बिल्ड निर्भरताओं** के लिए एक भंडार है, जैसे कि **Docker** छवियाँ, **Maven**, npm पैकेज, और अन्य प्रकार के आर्टिफैक्ट्स। इसका **सामान्यत: CI/CD पाइपलाइनों में उपयोग किया जाता है** जो सॉफ़्टवेयर विकास प्रक्रिया के दौरान उत्पन्न आर्टिफैक्ट्स को स्टोर और संस्करणित करता है।

Artifact Registry की प्रमुख विशेषताएँ शामिल हैं:

1. **Unified Repository**: यह **कई प्रकार के आर्टिफैक्ट्स** का समर्थन करता है, जिससे आप Docker छवियों, भाषा पैकेज (जैसे Java का Maven, Node.js का npm), और अन्य प्रकार के आर्टिफैक्ट्स के लिए एकल भंडार रख सकते हैं, जिससे सभी आर्टिफैक्ट्स के लिए सुसंगत पहुँच नियंत्रण और एकीकृत दृश्य सक्षम होता है।
2. **Fully Managed**: एक प्रबंधित सेवा के रूप में, यह अंतर्निहित बुनियादी ढाँचे, स्केलिंग, और सुरक्षा का ध्यान रखता है, जिससे उपयोगकर्ताओं के लिए रखरखाव का बोझ कम होता है।
3. **Fine-grained Access Control**: यह Google Cloud के पहचान और पहुँच प्रबंधन (IAM) के साथ एकीकृत होता है, जिससे आप यह परिभाषित कर सकते हैं कि कौन आपके भंडार में आर्टिफैक्ट्स तक पहुँच, अपलोड, या डाउनलोड कर सकता है।
4. **Geo-replication**: यह कई क्षेत्रों में आर्टिफैक्ट्स की प्रतिकृति का समर्थन करता है, डाउनलोड की गति में सुधार करता है और उपलब्धता सुनिश्चित करता है।
5. **Integration with Google Cloud Services**: यह **अन्य GCP सेवाओं जैसे Cloud Build, Kubernetes Engine, और Compute Engine** के साथ निर्बाध रूप से काम करता है, जिससे यह उन टीमों के लिए एक सुविधाजनक विकल्प बनता है जो पहले से Google Cloud पारिस्थितिकी तंत्र में काम कर रही हैं।
6. **Security**: **कमजोरियों की स्कैनिंग और कंटेनर विश्लेषण** जैसी सुविधाएँ प्रदान करता है ताकि यह सुनिश्चित किया जा सके कि संग्रहीत आर्टिफैक्ट्स सुरक्षित हैं और ज्ञात सुरक्षा समस्याओं से मुक्त हैं।

### Formats and Modes

जब एक नया भंडार बनाया जाता है, तो **भंडार के प्रारूप/प्रकार** को कई में से **चुनना संभव है** जैसे Docker, Maven, npm, Python... और मोड जो आमतौर पर इनमें से एक हो सकता है:

- **Standard Repository**: **अपने स्वयं के आर्टिफैक्ट्स** (जैसे Docker छवियाँ, Maven पैकेज) को सीधे GCP में स्टोर करने के लिए डिफ़ॉल्ट मोड। यह सुरक्षित, स्केलेबल है, और Google Cloud पारिस्थितिकी तंत्र के भीतर अच्छी तरह से एकीकृत होता है।
- **Remote Repository** (यदि उपलब्ध हो): **बाहरी**, सार्वजनिक भंडारों से आर्टिफैक्ट्स को कैश करने के लिए एक प्रॉक्सी के रूप में कार्य करता है। यह निर्भरताओं के ऊपर बदलने से समस्याओं को रोकने में मदद करता है और अक्सर एक्सेस किए जाने वाले आर्टिफैक्ट्स को कैश करके विलंबता को कम करता है।
- **Virtual Repository** (यदि उपलब्ध हो): **एकल एंडपॉइंट के माध्यम से कई (मानक या दूरस्थ) भंडारों तक पहुँचने के लिए एकीकृत इंटरफ़ेस प्रदान करता है**, विभिन्न भंडारों में फैले आर्टिफैक्ट्स के लिए क्लाइंट-साइड कॉन्फ़िगरेशन और पहुँच प्रबंधन को सरल बनाता है।
- एक वर्चुअल भंडार के लिए आपको **भंडारों का चयन करना होगा और उन्हें प्राथमिकता देना होगा** (जिस भंडार की प्राथमिकता सबसे बड़ी होगी, उसका उपयोग किया जाएगा)।
- आप **वर्चुअल** में **दूरस्थ और मानक** भंडारों को **मिश्रित** कर सकते हैं, यदि **दूरस्थ** की **प्राथमिकता** **मानक** से **बड़ी** है, तो **दूरस्थ से पैकेज (उदाहरण के लिए PyPi) का उपयोग किया जाएगा**। इससे **Dependency Confusion** हो सकता है।

ध्यान दें कि **Docker के दूरस्थ संस्करण** में Docker Hub तक पहुँचने के लिए एक उपयोगकर्ता नाम और टोकन देना संभव है। **टोकन फिर Secret Manager में संग्रहीत किया जाता है**।

### Encryption

जैसा कि अपेक्षित है, डिफ़ॉल्ट रूप से एक Google-प्रबंधित कुंजी का उपयोग किया जाता है लेकिन एक ग्राहक-प्रबंधित कुंजी को इंगित किया जा सकता है (CMEK)।

### Cleanup Policies

- **Delete artifacts:** आर्टिफैक्ट्स को **साफ़ करने की नीति** मानदंडों के अनुसार **हटाया जाएगा**।
- **Dry run:** (डिफ़ॉल्ट) आर्टिफैक्ट्स **हटाए नहीं जाएंगे**। साफ़ करने की नीतियों का मूल्यांकन किया जाएगा, और क्लाउड ऑडिट लॉगिंग के लिए परीक्षण हटाने की घटनाएँ भेजी जाएँगी।

### Vulnerability Scanning

यह संभव है कि **कमजोरियों के स्कैनर** को सक्षम किया जाए जो **कंटेनर छवियों** के अंदर कमजोरियों की जाँच करेगा।

### Enumeration
```bash
# Get repositories
gcloud artifacts repositories list
gcloud artifacts repositories describe --location <location> <repo-name>
gcloud artifacts versions list --repository=<repo-name> -location <location> --package <package-name>

# Get settings of a repository (example using python but could be other)
gcloud artifacts print-settings python --repository <repo-name> --location <location>

# Get docker images
gcloud artifacts docker images list us-central1-docker.pkg.dev/<proj-name>/<repo-name>

# Get packages (like python and others...)
gcloud artifacts packages list --repository <repo-name> --location <location>

# Get SBOMB artifacts
gcloud artifacts sbom list

# Get vulnerabilities (docker images)
gcloud artifacts vulnerabilities list us-east1-docker.pkg.dev/project123/repository123/someimage@sha256:49765698074d6d7baa82f
gcloud artifacts docker images list-vulnerabilities projects/<proj-name>/locations/<location>/scans/<scan-uuid>
```
### विशेषाधिकार वृद्धि

{{#ref}}
../gcp-privilege-escalation/gcp-artifact-registry-privesc.md
{{#endref}}

### बिना प्रमाणीकरण के पहुंच

{{#ref}}
../gcp-unauthenticated-enum-and-access/gcp-artifact-registry-unauthenticated-enum.md
{{#endref}}

### पोस्ट-शोषण

{{#ref}}
../gcp-post-exploitation/gcp-artifact-registry-post-exploitation.md
{{#endref}}

### स्थिरता

{{#ref}}
../gcp-persistence/gcp-artifact-registry-persistence.md
{{#endref}}

{{#include ../../../banners/hacktricks-training.md}}
