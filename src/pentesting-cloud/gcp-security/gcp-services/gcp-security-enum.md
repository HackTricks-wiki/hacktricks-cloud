# GCP - Security Enum

{{#include ../../../banners/hacktricks-training.md}}

## 基本情報

Google Cloud Platform (GCP) セキュリティは、Google Cloud 環境内のリソースとデータの**セキュリティ**を確保するために設計された**包括的なツール**と実践のスイートを含み、主に4つのセクションに分かれています: **セキュリティコマンドセンター、検出と制御、データ保護、ゼロトラスト。**

## **セキュリティコマンドセンター**

Google Cloud Platform (GCP) セキュリティコマンドセンター (SCC) は、GCPリソースのための**セキュリティとリスク管理ツール**であり、組織がクラウド資産を可視化し、制御することを可能にします。これは、包括的なセキュリティ分析を提供し、**脅威を検出し対応する**のを助け、**誤設定を特定し**、セキュリティ基準への**準拠を確保し**、自動化された脅威検出と対応のために他のセキュリティツールと**統合します**。

- **概要**: セキュリティコマンドセンターのすべての結果の**概要を可視化する**パネル。
- 脅威: \[プレミアム必要] すべての**検出された脅威を可視化する**パネル。以下の脅威についての詳細を確認してください。
- **脆弱性**: GCPアカウント内の**誤設定を可視化する**パネル。
- **コンプライアンス**: \[プレミアム必要] このセクションでは、組織全体の**GCP環境をいくつかのコンプライアンスチェックに対してテストする**ことができます（PCI-DSS、NIST 800-53、CISベンチマークなど）。
- **資産**: このセクションは、**使用されているすべての資産を表示**し、システム管理者（おそらく攻撃者）にとって、単一のページで何が稼働しているかを確認するのに非常に便利です。
- **発見**: これは、GCPセキュリティの異なるセクション（コマンドセンターだけでなく）の**発見をテーブルに集約**し、重要な発見を簡単に可視化できるようにします。
- **ソース**: GCPセキュリティのさまざまなセクションの**発見の概要を表示**します。
- **姿勢**: \[プレミアム必要] セキュリティ姿勢は、**GCP環境のセキュリティを定義、評価、監視する**ことを可能にします。これは、GCP内のリソースを制御/監視する制約や制限を定義するポリシーを作成することによって機能します。 [https://cloud.google.com/security-command-center/docs/security-posture-overview?authuser=2#predefined-policy](https://cloud.google.com/security-command-center/docs/security-posture-overview?authuser=2#predefined-policy) で見つけることができるいくつかの事前定義された姿勢テンプレートがあります。

### **脅威**

攻撃者の視点から見ると、これはおそらく**攻撃者を検出できる最も興味深い機能**です。ただし、この機能は**プレミアム**を必要とするため（つまり、会社は追加料金を支払う必要があります）、**有効になっていない可能性もあります**。

脅威検出メカニズムには3つのタイプがあります：

- **イベント脅威**: Googleによって内部で作成された**ルール**に基づいて、**Cloud Logging**からのイベントを照合することによって生成された発見。**Google Workspaceログ**をスキャンすることもできます。
- すべての[**検出ルールの説明はドキュメントにあります**](https://cloud.google.com/security-command-center/docs/concepts-event-threat-detection-overview?authuser=2#how_works)
- **コンテナ脅威**: コンテナのカーネルの低レベルの動作を分析した後に生成された発見。
- **カスタム脅威**: 会社によって作成されたルール。

両方のタイプの検出された脅威に対する推奨される対応は、[https://cloud.google.com/security-command-center/docs/how-to-investigate-threats?authuser=2#event_response](https://cloud.google.com/security-command-center/docs/how-to-investigate-threats?authuser=2#event_response) で見つけることができます。

### 列挙
```bash
# Get a source
gcloud scc sources describe <org-number> --source=5678
## If the response is that the service is disabled or that the source is not found, then, it isn't enabled

# Get notifications
gcloud scc notifications list <org-number>

# Get findings (if not premium these are just vulnerabilities)
gcloud scc findings list <org-number>
```
### Post Exploitation

{{#ref}}
../gcp-post-exploitation/gcp-security-post-exploitation.md
{{#endref}}

## Detections and Controls

- **Chronicle SecOps**: セキュリティオペレーションの速度と影響を高めるために設計された高度なセキュリティオペレーションスイートで、脅威の検出、調査、対応を含みます。
- **reCAPTCHA Enterprise**: 人間のユーザーとボットを区別することによって、スクレイピング、資格情報の詰め込み、自動攻撃などの不正行為からウェブサイトを保護するサービスです。
- **Web Security Scanner**: Google Cloudまたは他のウェブサービスにホストされているウェブアプリケーションの脆弱性や一般的なセキュリティ問題を検出する自動セキュリティスキャンツールです。
- **Risk Manager**: 組織がGoogle Cloudのリスク姿勢を評価、文書化、理解するのを助けるガバナンス、リスク、コンプライアンス（GRC）ツールです。
- **Binary Authorization**: エンタープライズによって設定されたポリシーに従って、信頼されたコンテナイメージのみがKubernetes Engineクラスターにデプロイされることを保証するコンテナ用のセキュリティ制御です。
- **Advisory Notifications**: 潜在的なセキュリティ問題、脆弱性、およびリソースを安全に保つための推奨アクションに関するアラートとアドバイザリーを提供するサービスです。
- **Access Approval**: Googleの従業員がデータや設定にアクセスする前に明示的な承認を要求することを可能にする機能で、追加の制御と監査可能性を提供します。
- **Managed Microsoft AD**: ユーザーがGoogle Cloud上で既存のMicrosoft AD依存のアプリケーションやワークロードを使用できるようにする、管理されたMicrosoft Active Directory（AD）を提供するサービスです。

## Data Protection

- **Sensitive Data Protection**: 個人情報や知的財産などの機密データを不正アクセスや露出から保護することを目的としたツールと実践です。
- **Data Loss Prevention (DLP)**: 使用中、移動中、静止中のデータを特定、監視、保護するために使用されるツールとプロセスのセットで、深いコンテンツ検査と包括的なデータ保護ルールの適用によって行われます。
- **Certificate Authority Service**: 内部および外部サービスのSSL/TLS証明書の管理、デプロイ、および更新を簡素化し、自動化するスケーラブルで安全なサービスです。
- **Key Management**: アプリケーションの暗号鍵を管理するためのクラウドベースのサービスで、暗号化鍵の作成、インポート、ローテーション、使用、破棄を含みます。詳細は以下を参照してください：

{{#ref}}
gcp-kms-enum.md
{{#endref}}

- **Certificate Manager**: SSL/TLS証明書を管理およびデプロイし、ウェブサービスやアプリケーションへの安全で暗号化された接続を確保するサービスです。
- **Secret Manager**: APIキー、パスワード、証明書、その他の機密データのための安全で便利なストレージシステムで、これらの秘密の簡単で安全なアクセスと管理をアプリケーションで可能にします。詳細は以下を参照してください：

{{#ref}}
gcp-secrets-manager-enum.md
{{#endref}}

## Zero Trust

- **BeyondCorp Enterprise**: 従来のVPNを必要とせず、ユーザーとデバイスの信頼性の検証に基づいて内部アプリケーションへの安全なアクセスを可能にするゼロトラストセキュリティプラットフォームです。
- **Policy Troubleshooter**: 管理者が組織内のアクセス問題を理解し解決するのを助けるために設計されたツールで、ユーザーが特定のリソースにアクセスできる理由やアクセスが拒否された理由を特定し、ゼロトラストポリシーの施行を支援します。
- **Identity-Aware Proxy (IAP)**: Google Cloud、オンプレミス、または他のクラウド上で実行されているクラウドアプリケーションやVMへのアクセスを、リクエストの発信元のネットワークではなく、ユーザーのアイデンティティとリクエストのコンテキストに基づいて制御するサービスです。
- **VPC Service Controls**: Google Cloudの仮想プライベートクラウド（VPC）にホストされているリソースやサービスに追加の保護層を提供し、データの流出を防ぎ、詳細なアクセス制御を提供するセキュリティ境界です。
- **Access Context Manager**: Google CloudのBeyondCorp Enterpriseの一部であり、ユーザーのアイデンティティとリクエストのコンテキスト（デバイスのセキュリティステータス、IPアドレスなど）に基づいて、詳細なアクセス制御ポリシーを定義し施行するのを助けるツールです。

{{#include ../../../banners/hacktricks-training.md}}
