# GCP - Firebase Enum

{{#include ../../../banners/hacktricks-training.md}}

## [Firebase](https://cloud.google.com/sdk/gcloud/reference/firebase/)

Die Firebase Realtime-Datenbank ist eine cloudbasierte NoSQL-Datenbank, die es Ihnen ermöglicht, Daten in Echtzeit zwischen Ihren Benutzern zu speichern und zu synchronisieren. [Erfahren Sie mehr](https://firebase.google.com/products/realtime-database/).

### Unauthenticated Enum

Einige **Firebase-Endpunkte** könnten in **mobilen Anwendungen** gefunden werden. Es ist möglich, dass der verwendete Firebase-Endpunkt **schlecht konfiguriert ist und jedem Berechtigungen zum Lesen (und Schreiben)** gewährt.

Dies ist die gängige Methodik, um schlecht konfigurierte Firebase-Datenbanken zu suchen und auszunutzen:

1. **Holen Sie sich die APK** der App, Sie können eines der Tools verwenden, um die APK von dem Gerät für diesen POC zu erhalten.\
Sie können „APK Extractor“ verwenden [https://play.google.com/store/apps/details?id=com.ext.ui\&hl=e](https://hackerone.com/redirect?signature=3774f35d1b5ea8a4fd209d80084daa9f5887b105&url=https%3A%2F%2Fplay.google.com%2Fstore%2Fapps%2Fdetails%3Fid%3Dcom.ext.ui%26hl%3Den)
2. **Decompilieren** Sie die APK mit **apktool**, folgen Sie dem untenstehenden Befehl, um den Quellcode aus der APK zu extrahieren.
3. Gehen Sie zu _**res/values/strings.xml**_ und suchen Sie nach diesem und **suchen** Sie nach dem Schlüsselwort „**firebase**“
4. Sie könnten etwas wie diese URL finden „_**https://xyz.firebaseio.com/**_“
5. Gehen Sie als Nächstes zum Browser und **navigieren Sie zur gefundenen URL**: _https://xyz.firebaseio.com/.json_
6. Es können 2 Arten von Antworten erscheinen:
   1. „**Zugriff verweigert**“: Das bedeutet, dass Sie nicht darauf zugreifen können, also ist es gut konfiguriert.
   2. „**null**“-Antwort oder eine Menge von **JSON-Daten**: Das bedeutet, dass die Datenbank öffentlich ist und Sie zumindest Lesezugriff haben.
      1. In diesem Fall könnten Sie **nach Schreibberechtigungen suchen**, ein Exploit zum Testen der Schreibberechtigungen kann hier gefunden werden: [https://github.com/MuhammadKhizerJaved/Insecure-Firebase-Exploit](https://github.com/MuhammadKhizerJaved/Insecure-Firebase-Exploit)

**Interessante Anmerkung**: Wenn Sie eine mobile Anwendung mit **MobSF** analysieren, wird überprüft, ob eine Firebase-Datenbank **öffentlich verfügbar** ist, und es wird eine Benachrichtigung ausgegeben.

Alternativ können Sie [Firebase Scanner](https://github.com/shivsahni/FireBaseScanner) verwenden, ein Python-Skript, das die oben genannte Aufgabe automatisiert, wie unten gezeigt:
```bash
python FirebaseScanner.py -f <commaSeperatedFirebaseProjectNames>
```
### Authenticated Enum

Wenn Sie Anmeldeinformationen haben, um auf die Firebase-Datenbank zuzugreifen, können Sie ein Tool wie [**Baserunner**](https://github.com/iosiro/baserunner) verwenden, um einfacher auf die gespeicherten Informationen zuzugreifen. Oder ein Skript wie das folgende:
```python
#Taken from https://blog.assetnote.io/bug-bounty/2020/02/01/expanding-attack-surface-react-native/
#Install pyrebase: pip install pyrebase4
import pyrebase

config = {
"apiKey": "FIREBASE_API_KEY",
"authDomain": "FIREBASE_AUTH_DOMAIN_ID.firebaseapp.com",
"databaseURL": "https://FIREBASE_AUTH_DOMAIN_ID.firebaseio.com",
"storageBucket": "FIREBASE_AUTH_DOMAIN_ID.appspot.com",
}

firebase = pyrebase.initialize_app(config)

db = firebase.database()

print(db.get())
```
Um andere Aktionen in der Datenbank zu testen, wie das Schreiben in die Datenbank, siehe die Pyrebase4-Dokumentation, die [hier](https://github.com/nhorvath/Pyrebase4) zu finden ist.

### Zugriff auf Informationen mit APPID und API-Schlüssel <a href="#access-info-with-appid-and-api-key" id="access-info-with-appid-and-api-key"></a>

Wenn Sie die iOS-Anwendung dekompilieren und die Datei `GoogleService-Info.plist` öffnen und den API-Schlüssel und die APP-ID finden:

- API-SCHLÜSSEL **AIzaSyAs1\[...]**
- APP-ID **1:612345678909:ios:c212345678909876**

Möglicherweise können Sie auf einige interessante Informationen zugreifen.

**Anfrage**

`curl -v -X POST "https://firebaseremoteconfig.googleapis.com/v1/projects/612345678909/namespaces/firebase:fetch?key=AIzaSyAs1[...]" -H "Content-Type: application/json" --data '{"appId": "1:612345678909:ios:c212345678909876", "appInstanceId": "PROD"}'`

## Referenzen <a href="#references" id="references"></a>

- ​[https://blog.securitybreached.org/2020/02/04/exploiting-insecure-firebase-database-bugbounty/](https://blog.securitybreached.org/2020/02/04/exploiting-insecure-firebase-database-bugbounty/)​
- ​[https://medium.com/@danangtriatmaja/firebase-database-takover-b7929bbb62e1](https://medium.com/@danangtriatmaja/firebase-database-takover-b7929bbb62e1)​

{{#include ../../../banners/hacktricks-training.md}}
