# GCP - Bigtable Enum

{{#include ../../../banners/hacktricks-training.md}}

## Bigtable

Google Cloud Bigtable est une base de données NoSQL entièrement gérée et évolutive, conçue pour des applications nécessitant un débit extrêmement élevé et une très faible latence. Elle est conçue pour gérer des volumes massifs de données — des pétaoctets répartis sur des milliers de nœuds — tout en offrant des performances rapides en lecture et en écriture. Bigtable est idéale pour des charges de travail telles que les séries temporelles, la télémétrie IoT, l'analytique financière, les moteurs de personnalisation et les bases de données opérationnelles à grande échelle. Elle utilise une map triée multidimensionnelle, sparse et distribuée comme modèle de stockage sous-jacent, ce qui la rend efficace pour stocker des tables larges où de nombreuses colonnes peuvent être vides. [Learn more](https://cloud.google.com/bigtable).

### Hiérarchie

1. **Bigtable Instance**

Une Bigtable instance est la ressource de niveau supérieur que vous créez.
Elle ne stocke pas les données en elle-même — pensez-y comme un conteneur logique qui regroupe vos clusters et vos tables.

Il existe deux types d'instances :

- instance de développement (nœud unique, peu coûteuse, pas pour la production)
- instance de production (peut avoir plusieurs clusters)

2. **Clusters**

Un cluster contient les ressources réelles de calcul et de stockage utilisées pour servir les données Bigtable.

- Chaque cluster réside dans une seule région.
- Il est composé de nœuds, qui fournissent CPU, RAM et capacité réseau.
- Vous pouvez créer des instances multi-clusters pour la haute disponibilité ou des lectures/écritures globales.
- Les données sont automatiquement répliquées entre les clusters d'une même instance.

Important :
- Les tables appartiennent à l'instance, pas à un cluster spécifique.
- Les clusters fournissent simplement les ressources pour servir les données.

3. **Tables**

Une table dans Bigtable est similaire à une table dans les bases de données NoSQL :

- Les données sont stockées en lignes, identifiées par une clé de ligne.
- Chaque ligne contient des column families, qui contiennent des colonnes.
- Elles sont sparse : les cellules vides ne consomment pas d'espace.
- Bigtable stocke les données triées lexicographiquement par la clé de ligne.

Les tables sont servies par tous les clusters de l'instance.

4. **Tablets (and Hot Tablets)**

Bigtable divise chaque table en partitions horizontales appelées tablets. Une tablet est :

- Une plage contiguë de clés de ligne.
- Stockée sur un seul nœud à un moment donné.
- Les tablets sont automatiquement scindées, fusionnées et déplacées par Bigtable.

Un **hot tablet** survient lorsque :

- Trop de lectures ou d'écritures ciblent la même plage de clés de ligne (même tablet).
- Ce tablet/nœud spécifique devient surchargé.
- Cela entraîne des hotspots (goulots d'étranglement de performance).

5. **Authorized Views**

Les authorized views permettent de créer un sous-ensemble des données d'une table pouvant être partagé avec des utilisateurs ou des applications spécifiques sans leur donner accès à la table entière. Cela est utile pour :

- Limiter l'accès aux données sensibles.
- Fournir un accès en lecture seule à des colonnes ou des lignes spécifiques.

6. **App Profiles**

Un app profile Bigtable est une configuration qui définit comment une application ou un client spécifique doit interagir avec une instance Bigtable, en particulier dans des environnements multi-clusters. Il contrôle le comportement de routage — si les requêtes doivent être dirigées vers un seul cluster ou réparties entre plusieurs clusters pour la haute disponibilité — et gouverne la façon dont les écritures sont répliquées, en choisissant entre des modes synchrones (consistance plus forte) ou asynchrones (latence plus faible).
```bash
# Cloud Bigtable
gcloud bigtable instances list
gcloud bigtable instances describe <instance>
gcloud bigtable instances get-iam-policy <instance>

## Clusters
gcloud bigtable clusters list
gcloud bigtable clusters describe <cluster>

## Tables
gcloud bigtable tables list --instance <INSTANCE>
gcloud bigtable tables describe --instance <INSTANCE> <TABLE>
gcloud bigtable tables get-iam-policy --instance <INSTANCE> <TABLE>

## Backups
gcloud bigtable backups list --instance <INSTANCE>
gcloud bigtable backups describe --instance <INSTANCE> <backupname>
gcloud bigtable backups get-iam-policy --instance <INSTANCE> <backupname>

## Hot Tables
gcloud bigtable hot-tablets list

## App Profiles
gcloud bigtable app-profiles list --instance <INSTANCE>
gcloud bigtable app-profiles describe --instance <INSTANCE> <app-prof>

## Authorized Views
gcloud bigtable authorized-views list --instance <INSTANCE> --table <TABLE>
gcloud bigtable authorized-views describe --instance <INSTANCE> --table <TABLE> <VIEW>
```
## Escalade de privilèges

{{#ref}}
../gcp-privilege-escalation/gcp-bigtable-privesc.md
{{#endref}}

## Post-exploitation

{{#ref}}
../gcp-post-exploitation/gcp-bigtable-post-exploitation.md
{{#endref}}

## Persistance

{{#ref}}
../gcp-persistence/gcp-bigtable-persistence.md
{{#endref}}

{{#include ../../../banners/hacktricks-training.md}}
