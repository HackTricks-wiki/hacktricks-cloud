# GCP - Secrets Manager Enum

{{#include ../../../banners/hacktricks-training.md}}

## Secret Manager

Google [**Secret Manager**](https://cloud.google.com/solutions/secrets-management/) şifreler, API anahtarları, sertifikalar, dosyalar (maks 64KB) ve diğer hassas verileri depolamak için bir kasa benzeri çözümdür.

Bir gizli anahtarın **farklı verileri depolayan farklı sürümleri** olabilir.

Gizli anahtarlar **varsayılan olarak** **Google tarafından yönetilen bir anahtar ile şifrelenir**, ancak gizli anahtarı şifrelemek için **KMS'den bir anahtar seçmek mümkündür**.

**Döngü** ile ilgili olarak, **her belirli gün sayısında pub-sub'a gönderilecek mesajlar** yapılandırmak mümkündür, bu mesajları dinleyen kod **gizli anahtarı döndürebilir**.

**Otomatik silme** için bir gün yapılandırmak mümkündür, belirtilen gün **ulaşıldığında**, **gizli anahtar otomatik olarak silinecektir**.

### Enumeration
```bash
# First, list the entries
gcloud secrets list
gcloud secrets get-iam-policy <secret_name>

# Then, pull the clear-text of any version of any secret
gcloud secrets versions list <secret_name>
gcloud secrets versions access 1 --secret="<secret_name>"
```
### Yetki Yükseltme

Aşağıdaki sayfada **secretmanager izinlerini kötüye kullanarak yetki yükseltmeyi** kontrol edebilirsiniz.

{{#ref}}
../gcp-privilege-escalation/gcp-secretmanager-privesc.md
{{#endref}}

### Sonrası İstismar

{{#ref}}
../gcp-post-exploitation/gcp-secretmanager-post-exploitation.md
{{#endref}}

### Süreklilik

{{#ref}}
../gcp-persistence/gcp-secret-manager-persistence.md
{{#endref}}

### Dönüşüm Kötüye Kullanımı

Bir saldırgan, sırrı **dönüşümleri durdurmak için** güncelleyebilir (böylece değiştirilmez), veya **dönüşümleri çok daha az sıklıkta yapmak için** (böylece sır değiştirilmez) ya da **dönüşüm mesajını farklı bir pub/sub'a yayınlamak için**, ya da yürütülen dönüşüm kodunu değiştirmek için (bu farklı bir hizmette gerçekleşir, muhtemelen bir Cloud Function'da, bu nedenle saldırganın Cloud Function veya başka bir hizmet üzerinde ayrıcalıklı erişime ihtiyacı olacaktır)

{{#include ../../../banners/hacktricks-training.md}}
