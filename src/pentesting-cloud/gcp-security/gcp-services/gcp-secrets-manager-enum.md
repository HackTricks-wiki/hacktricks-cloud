# GCP - Secrets Manager Enum

{{#include ../../../banners/hacktricks-training.md}}

## Secret Manager

Google [**Secret Manager**](https://cloud.google.com/solutions/secrets-management/) - це рішення, схоже на сховище, для зберігання паролів, API ключів, сертифікатів, файлів (макс 64KB) та інших чутливих даних.

Секрет може мати **різні версії, що зберігають різні дані**.

Секрети за **замовчуванням** **шифруються за допомогою ключа, керованого Google**, але **можливо вибрати ключ з KMS** для використання для шифрування секрету.

Щодо **ротації**, можливо налаштувати **повідомлення, які будуть надсилатися до pub-sub кожну кількість днів**, код, що слухає ці повідомлення, може **ротаціювати секрет**.

Можливо налаштувати день для **автоматичного видалення**, коли вказаний день буде **досягнуто**, **секрет буде автоматично видалено**.

### Enumeration
```bash
# First, list the entries
gcloud secrets list
gcloud secrets get-iam-policy <secret_name>

# Then, pull the clear-text of any version of any secret
gcloud secrets versions list <secret_name>
gcloud secrets versions access 1 --secret="<secret_name>"
```
### Підвищення Привілеїв

На наступній сторінці ви можете перевірити, як **зловживати дозволами secretmanager для підвищення привілеїв.**

{{#ref}}
../gcp-privilege-escalation/gcp-secretmanager-privesc.md
{{#endref}}

### Після Експлуатації

{{#ref}}
../gcp-post-exploitation/gcp-secretmanager-post-exploitation.md
{{#endref}}

### Постійність

{{#ref}}
../gcp-persistence/gcp-secret-manager-persistence.md
{{#endref}}

### Зловживання Ротацією

Зловмисник може оновити секрет, щоб **зупинити ротації** (щоб його не змінювали), або **зробити ротації набагато рідшими** (щоб секрет не змінювався) або **опублікувати повідомлення про ротацію в іншому pub/sub**, або змінити код ротації, що виконується (це відбувається в іншій службі, ймовірно, в Cloud Function, тому зловмиснику знадобиться привілейований доступ до Cloud Function або будь-якої іншої служби)

{{#include ../../../banners/hacktricks-training.md}}
