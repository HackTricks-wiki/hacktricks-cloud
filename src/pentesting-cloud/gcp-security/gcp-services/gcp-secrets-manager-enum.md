# GCP - Secrets Manager Enum

{{#include ../../../banners/hacktricks-training.md}}

## Secret Manager

Google [**Secret Manager**](https://cloud.google.com/solutions/secrets-management/) is 'n kluisagtige oplossing vir die stoor van wagwoorde, API sleutels, sertifikate, lêers (maks 64KB) en ander sensitiewe data.

'n Geheim kan **verskillende weergawes hê wat verskillende data stoor**.

Geheime is **per standaard** **versleuteld met 'n Google bestuurde sleutel**, maar dit is **moontlik om 'n sleutel van KMS te kies** om te gebruik om die geheim te versleutel.

Ten opsigte van **rotasie**, is dit moontlik om **boodskappe te konfigureer wat elke aantal dae na pub-sub gestuur word**, die kode wat na daardie boodskappe luister kan **die geheim roteer**.

Dit is moontlik om 'n dag vir **outomatiese verwydering** te konfigureer, wanneer die aangeduide dag **bereik word**, sal die **geheim outomaties verwyder word**.

### Enumeration
```bash
# First, list the entries
gcloud secrets list
gcloud secrets get-iam-policy <secret_name>

# Then, pull the clear-text of any version of any secret
gcloud secrets versions list <secret_name>
gcloud secrets versions access 1 --secret="<secret_name>"
```
### Privilege Escalation

In die volgende bladsy kan jy kyk hoe om **geheimbestuurder toestemmings te misbruik om voorregte te verhoog.**

{{#ref}}
../gcp-privilege-escalation/gcp-secretmanager-privesc.md
{{#endref}}

### Post Exploitation

{{#ref}}
../gcp-post-exploitation/gcp-secretmanager-post-exploitation.md
{{#endref}}

### Persistence

{{#ref}}
../gcp-persistence/gcp-secret-manager-persistence.md
{{#endref}}

### Rotation misuse

'n Aanvaller kan die geheim opdateer om **rotasies te stop** (sodat dit nie gewysig sal word nie), of **rotasies baie minder gereeld te maak** (sodat die geheim nie gewysig sal word nie) of om **die rotasieboodskap na 'n ander pub/sub te publiseer**, of die rotasiekode wat uitgevoer word te wysig (dit gebeur in 'n ander diens, waarskynlik in 'n Cloud Function, so die aanvaller sal bevoorregte toegang tot die Cloud Function of enige ander diens benodig)

{{#include ../../../banners/hacktricks-training.md}}
