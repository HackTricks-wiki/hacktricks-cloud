# GCP - Secrets Manager Enum

{{#include ../../../banners/hacktricks-training.md}}

## Secret Manager

Google [**Secret Manager**](https://cloud.google.com/solutions/secrets-management/) एक वॉल्ट-जैसी समाधान है जो पासवर्ड, API कुंजी, प्रमाणपत्र, फ़ाइलें (अधिकतम 64KB) और अन्य संवेदनशील डेटा संग्रहीत करने के लिए है।

एक रहस्य में **विभिन्न संस्करण हो सकते हैं जो विभिन्न डेटा संग्रहीत करते हैं**।

रहस्य **डिफ़ॉल्ट रूप से** **Google प्रबंधित कुंजी का उपयोग करके एन्क्रिप्ट किए जाते हैं**, लेकिन **रहस्य को एन्क्रिप्ट करने के लिए KMS से एक कुंजी का चयन करना संभव है**।

**रोटेशन** के संबंध में, **हर कुछ दिनों में pub-sub पर भेजे जाने वाले संदेशों को कॉन्फ़िगर करना संभव है**, उन संदेशों को सुनने वाला कोड **रहस्य को घुमा सकता है**।

**स्वचालित विलोपन** के लिए एक दिन कॉन्फ़िगर करना संभव है, जब निर्दिष्ट दिन **पहुंचा जाता है**, तो **रहस्य स्वचालित रूप से हटा दिया जाएगा**।

### Enumeration
```bash
# First, list the entries
gcloud secrets list
gcloud secrets get-iam-policy <secret_name>

# Then, pull the clear-text of any version of any secret
gcloud secrets versions list <secret_name>
gcloud secrets versions access 1 --secret="<secret_name>"
```
### Privilege Escalation

In the following page you can check how to **secretmanager अनुमतियों का दुरुपयोग करके विशेषाधिकार बढ़ाएं।**

{{#ref}}
../gcp-privilege-escalation/gcp-secretmanager-privesc.md
{{#endref}}

### Post Exploitation

{{#ref}}
../gcp-post-exploitation/gcp-secretmanager-post-exploitation.md
{{#endref}}

### Persistence

{{#ref}}
../gcp-persistence/gcp-secret-manager-persistence.md
{{#endref}}

### Rotation misuse

An attacker could update the secret to **रोटेशन को रोकें** (so it won't be modified), or **रोटेशन को बहुत कम बार करें** (so the secret won't be modified) or to **रोटेशन संदेश को एक अलग pub/sub पर प्रकाशित करें**, or modifying the rotation code being executed (this happens in a different service, probably in a Clound Function, so the attacker will need privileged access over the Cloud Function or any other service)

{{#include ../../../banners/hacktricks-training.md}}
