# GCP - Source Repositories Enum

{{#include ../../../banners/hacktricks-training.md}}

## Basic Information <a href="#reviewing-cloud-git-repositories" id="reviewing-cloud-git-repositories"></a>

Google Cloud Source Repositories is 'n volledig funksionele, skaalbare, **private Git repository diens**. Dit is ontwerp om **jou bronkode in 'n volledig bestuurde omgewing te huisves**, wat naatloos integreer met ander GCP gereedskap en dienste. Dit bied 'n samewerkende en veilige plek vir spanne om hul kode te stoor, bestuur en op te spoor.

Belangrike kenmerke van Cloud Source Repositories sluit in:

1. **Volledig Bestuurde Git Hosting**: Bied die bekende funksionaliteit van Git, wat beteken jy kan gereelde Git-opdragte en werkvloei gebruik.
2. **Integrasie met GCP Dienste**: Integreer met ander GCP dienste soos Cloud Build, Pub/Sub, en App Engine vir end-to-end opspoorbaarheid van kode tot implementering.
3. **Private Repositories**: Verseker dat jou kode veilig en privaat gestoor word. Jy kan toegang beheer met behulp van Cloud Identity and Access Management (IAM) rolle.
4. **Bronkode Analise**: Werk saam met ander GCP gereedskap om geoutomatiseerde analise van jou bronkode te bied, wat potensiële probleme soos foute, kwesbaarhede, of slegte kodering praktyke identifiseer.
5. **Samewerking Gereedskap**: Ondersteun samewerkende kodering met gereedskap soos samesmeltingsversoeke, kommentaar, en hersienings.
6. **Spieëlondersteuning**: Laat jou toe om Cloud Source Repositories met repositories wat op GitHub of Bitbucket gehos is, te verbind, wat outomatiese sinkronisasie moontlik maak en 'n verenigde weergawe van al jou repositories bied.

### OffSec information <a href="#reviewing-cloud-git-repositories" id="reviewing-cloud-git-repositories"></a>

- Die bronrepositories konfigurasie binne 'n projek sal 'n **Diensrekening** hê wat gebruik word om Cloud Pub/Sub boodskappe te publiseer. Die standaard een wat gebruik word is die **Compute SA**. egter, **ek dink nie dit is moontlik om sy token te steel** van Source Repositories aangesien dit in die agtergrond uitgevoer word.
- Om die kode binne die GCP Cloud Source Repositories webkonsol te sien ([https://source.cloud.google.com/](https://source.cloud.google.com/)), moet die kode **binne die meester tak wees per standaard**.
- Jy kan ook **'n spieël Cloud Repository** skep wat na 'n repo van **Github** of **Bitbucket** wys (toegang aan daardie platforms gee).
- Dit is moontlik om **kode & debugg te doen van binne GCP**.
- Per standaard, **verhoed Source Repositories dat private sleutels in verbintenisse gepush word**, maar dit kan gedeaktiveer word.

### Open In Cloud Shell

Dit is moontlik om die repository in Cloud Shell te open, 'n prompt soos hierdie sal verskyn:

<figure><img src="../../../images/image (325).png" alt=""><figcaption></figcaption></figure>

Dit sal jou toelaat om te kodeer en te debugg in Cloud Shell (wat cloudshell gecompromitteer kan maak).

### Enumeration
```bash
# Repos enumeration
gcloud source repos list #Get names and URLs
gcloud source repos describe <repo_name>
gcloud source repos get-iam-policy <repo_name>

# gcloud repo clone
gcloud source repos clone <REPO NAME>
gcloud source repos get-iam-policy <REPO NAME>
... git add & git commit -m ...
git push --set-upstream origin master
git push -u origin master

# Access via git
## To add a SSH key go to https://source.cloud.google.com/user/ssh_keys (no gcloud command)
git clone ssh://username@domain.com@source.developers.google.com:2022/p/<proj-name>/r/<repo-name>
git add, commit, push...
```
### Privilege Escalation & Post Exploitation

{{#ref}}
../gcp-privilege-escalation/gcp-sourcerepos-privesc.md
{{#endref}}

### Ongeauthentiseerde Enum

{{#ref}}
../gcp-unauthenticated-enum-and-access/gcp-source-repositories-unauthenticated-enum.md
{{#endref}}

{{#include ../../../banners/hacktricks-training.md}}
