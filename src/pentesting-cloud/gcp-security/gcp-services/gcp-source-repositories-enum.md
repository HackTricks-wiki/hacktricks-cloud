# GCP - Source Repositories Enum

{{#include ../../../banners/hacktricks-training.md}}

## Temel Bilgiler <a href="#reviewing-cloud-git-repositories" id="reviewing-cloud-git-repositories"></a>

Google Cloud Source Repositories, tam özellikli, ölçeklenebilir, **özel Git depo hizmeti**dir. **Kaynak kodunuzu tamamen yönetilen bir ortamda barındırmak** için tasarlanmıştır ve diğer GCP araçları ve hizmetleriyle sorunsuz bir şekilde entegre olur. Takımların kodlarını depolamak, yönetmek ve izlemek için işbirlikçi ve güvenli bir yer sunar.

Cloud Source Repositories'in ana özellikleri şunlardır:

1. **Tam Yönetilen Git Barındırma**: Git'in tanıdık işlevselliğini sunar, yani normal Git komutlarını ve iş akışlarını kullanabilirsiniz.
2. **GCP Hizmetleri ile Entegrasyon**: Koddan dağıtıma kadar uçtan uca izlenebilirlik için Cloud Build, Pub/Sub ve App Engine gibi diğer GCP hizmetleriyle entegre olur.
3. **Özel Depolar**: Kodunuzun güvenli ve özel bir şekilde depolandığından emin olur. Erişimi Cloud Identity and Access Management (IAM) rolleriyle kontrol edebilirsiniz.
4. **Kaynak Kodu Analizi**: Diğer GCP araçlarıyla çalışarak kaynak kodunuzun otomatik analizini sağlar, potansiyel sorunları, hataları, güvenlik açıklarını veya kötü kodlama uygulamalarını tanımlar.
5. **İşbirliği Araçları**: Birleştirme talepleri, yorumlar ve incelemeler gibi araçlarla işbirlikçi kodlamayı destekler.
6. **Aynalama Desteği**: Cloud Source Repositories'i GitHub veya Bitbucket'ta barındırılan depolarla bağlamanıza olanak tanır, otomatik senkronizasyon sağlar ve tüm depolarınızın birleşik bir görünümünü sunar.

### OffSec bilgileri <a href="#reviewing-cloud-git-repositories" id="reviewing-cloud-git-repositories"></a>

- Bir projedeki kaynak depo yapılandırması, Cloud Pub/Sub mesajlarını yayınlamak için kullanılan bir **Hizmet Hesabı** içerecektir. Kullanılan varsayılan **Compute SA**'dır. Ancak, **kaynak depolarından token'ını çalmanın mümkün olduğunu düşünmüyorum** çünkü arka planda çalıştırılmaktadır.
- GCP Cloud Source Repositories web konsolundaki kodu görmek için, kodun **varsayılan olarak ana dalda olması gerekir**.
- Ayrıca, **Github** veya **Bitbucket**'taki bir depoya işaret eden bir **ayna Cloud Repository** oluşturabilirsiniz (bu platformlara erişim vererek).
- **GCP içinden kod yazmak ve hata ayıklamak** mümkündür.
- Varsayılan olarak, Source Repositories **özel anahtarların taahhütlerde itilmesini engeller**, ancak bu devre dışı bırakılabilir.

### Cloud Shell'de Aç

Depoyu Cloud Shell'de açmak mümkündür, bu gibi bir istemci görünecektir:

<figure><img src="../../../images/image (325).png" alt=""><figcaption></figcaption></figure>

Bu, Cloud Shell'de kod yazmanıza ve hata ayıklamanıza olanak tanır (bu, cloudshell'in tehlikeye girmesine neden olabilir).

### Sayım
```bash
# Repos enumeration
gcloud source repos list #Get names and URLs
gcloud source repos describe <repo_name>
gcloud source repos get-iam-policy <repo_name>

# gcloud repo clone
gcloud source repos clone <REPO NAME>
gcloud source repos get-iam-policy <REPO NAME>
... git add & git commit -m ...
git push --set-upstream origin master
git push -u origin master

# Access via git
## To add a SSH key go to https://source.cloud.google.com/user/ssh_keys (no gcloud command)
git clone ssh://username@domain.com@source.developers.google.com:2022/p/<proj-name>/r/<repo-name>
git add, commit, push...
```
### Yetki Yükseltme & Saldırı Sonrası

{{#ref}}
../gcp-privilege-escalation/gcp-sourcerepos-privesc.md
{{#endref}}

### Kimlik Doğrulaması Olmadan Enum

{{#ref}}
../gcp-unauthenticated-enum-and-access/gcp-source-repositories-unauthenticated-enum.md
{{#endref}}

{{#include ../../../banners/hacktricks-training.md}}
