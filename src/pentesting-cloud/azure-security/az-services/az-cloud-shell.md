# Az - Cloud Shell

{% hint style="success" %}
AWSハッキングを学び、実践する：<img src="../../../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">\
GCPハッキングを学び、実践する：<img src="../../../.gitbook/assets/image (2) (1).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2) (1).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksをサポートする</summary>

* [**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)を確認してください！
* **💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**Telegramグループ**](https://t.me/peass)に参加するか、**Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**をフォローしてください。**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks)および[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のGitHubリポジトリにPRを送信してハッキングトリックを共有してください。**

</details>
{% endhint %}

## Azure Cloud Shell

**Azure Cloud Shell**は、Azureリソースを管理するために設計されたインタラクティブで認証されたブラウザアクセス可能なターミナルで、BashまたはPowerShellのいずれかで作業する柔軟性を提供します。これは、20分の非アクティブ状態の後にタイムアウトする一時的なセッションホスト上で実行され、$HOMEロケーションに5GBのファイル共有を使用してファイルを保持します。Cloud Shellは、Azureポータル、shell.azure.com、Azure CLIおよびPowerShellドキュメント、Azureモバイルアプリ、Visual Studio Code Azureアカウント拡張機能など、複数のポイントからアクセスできます。

このサービスには権限が割り当てられていないため、特権昇格技術はありません。また、何らかの列挙もありません。

### 主な機能

**環境**: Azure Cloud Shellは、クラウドインフラストラクチャ用に設計されたMicrosoft独自のLinuxディストリビューションであるAzure Linux上で実行されることにより、安全な環境を提供します。Azure Linuxリポジトリに含まれるすべてのパッケージは、サプライチェーン攻撃から守るためにMicrosoftによって内部的にコンパイルされています。  
**プリインストールツール**: Cloud Shellには、Azure CLI、Azure PowerShell、Terraform、Docker CLI、Ansible、Git、vim、nano、emacsなどのテキストエディタなど、包括的なプリインストールツールセットが含まれています。これらのツールはすぐに使用できます。インストールされたパッケージとモジュールをリストするには、「Get-Module -ListAvailable」、「tdnf list」、「pip3 list」を使用できます。  
**$HOMEの永続性**: Azure Cloud Shellを初めて起動するとき、ストレージアカウントを添付するかしないかを選択できます。ストレージを添付しないことを選択すると、セッションが終了するとファイルが削除される一時的なセッションが作成されます。セッション間でファイルを保持するには、ストレージアカウントをマウントし、これが自動的に**$HOME\clouddrive**として添付され、**$HOME**ディレクトリはAzure File Shareに**.img**ファイルとして保存されます。ただし、$HOME外のファイルとマシンの状態は保持されません。SSHキーなどの秘密を安全に保存するには、Azure Key Vaultを使用してください。  
**Azureドライブ (Azure:)**: Azure Cloud ShellのPowerShellにはAzureドライブ (Azure:)が含まれており、ファイルシステムのようなコマンドを使用してCompute、Network、StorageなどのAzureリソースを簡単にナビゲートできます。cd Azure:でAzureドライブに切り替え、cd ~でホームディレクトリに戻ります。どのドライブからでもAzure PowerShellコマンドレットを使用してリソースを管理できます。  
**カスタムツールのインストール**: ストレージアカウントでCloud Shellを構成したユーザーは、ルート権限を必要としない追加のツールをインストールできます。この機能により、Cloud Shell環境のさらなるカスタマイズが可能になり、ユーザーは特定のニーズに合わせてセットアップを調整できます。

## 参考文献

* [https://learn.microsoft.com/en-us/azure/cloud-shell/overview](https://learn.microsoft.com/en-us/azure/cloud-shell/overview)
* [https://learn.microsoft.com/en-us/azure/cloud-shell/features](https://learn.microsoft.com/en-us/azure/cloud-shell/features)
* [https://learn.microsoft.com/en-us/azure/cloud-shell/using-the-shell-window](https://learn.microsoft.com/en-us/azure/cloud-shell/using-the-shell-window)


## 永続性

{% content-ref url="../az-privilege-escalation/az-cloud-shell-persistence.md" %}
[az-cloud-shell-persistence.md](../az-privilege-escalation/az-cloud-shell-persistence.md)
{% endcontent-ref %}

{% hint style="success" %}
AWSハッキングを学び、実践する：<img src="../../../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">\
GCPハッキングを学び、実践する：<img src="../../../.gitbook/assets/image (2) (1).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2) (1).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksをサポートする</summary>

* [**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)を確認してください！
* **💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**Telegramグループ**](https://t.me/peass)に参加するか、**Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**をフォローしてください。**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks)および[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のGitHubリポジトリにPRを送信してハッキングトリックを共有してください。**

</details>
{% endhint %}
