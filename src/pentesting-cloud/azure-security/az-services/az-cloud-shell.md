# Az - Cloud Shell

{{#include ../../../banners/hacktricks-training.md}}

## Azure Cloud Shell

**Azure Cloud Shell**는 Azure 리소스를 관리하기 위해 설계된 대화형 인증 브라우저 접근 터미널로, Bash 또는 PowerShell 중 하나로 작업할 수 있는 유연성을 제공합니다. 이 터미널은 비활성 상태가 20분이 지나면 타임아웃되는 임시 세션 호스트에서 실행되며, $HOME 위치에 5-GB 파일 공유를 사용하여 파일을 유지합니다. Cloud Shell은 Azure 포털, shell.azure.com, Azure CLI 및 PowerShell 문서, Azure 모바일 앱, Visual Studio Code Azure 계정 확장 등 여러 지점을 통해 접근할 수 있습니다.

이 서비스에는 권한이 할당되지 않으므로 권한 상승 기술이 없습니다. 또한 어떤 종류의 열거도 없습니다.

### 주요 기능

**환경**: Azure Cloud Shell은 클라우드 인프라를 위해 설계된 Microsoft의 자체 Linux 배포판인 Azure Linux에서 실행되어 안전한 환경을 제공합니다. Azure Linux 리포지토리에 포함된 모든 패키지는 공급망 공격을 방지하기 위해 Microsoft에 의해 내부적으로 컴파일됩니다.  
**사전 설치된 도구**: Cloud Shell에는 Azure CLI, Azure PowerShell, Terraform, Docker CLI, Ansible, Git 및 vim, nano, emacs와 같은 텍스트 편집기와 같은 포괄적인 사전 설치 도구 세트가 포함되어 있습니다. 이러한 도구는 즉시 사용할 수 있습니다. 설치된 패키지 및 모듈을 나열하려면 "Get-Module -ListAvailable", "tdnf list" 및 "pip3 list"를 사용할 수 있습니다.  
**$HOME 지속성**: Azure Cloud Shell을 처음 시작할 때, 연결된 스토리지 계정이 있거나 없거나 사용할 수 있습니다. 스토리지를 연결하지 않으면 세션이 종료될 때 파일이 삭제되는 일시적인 세션이 생성됩니다. 세션 간에 파일을 유지하려면 스토리지 계정을 마운트해야 하며, 이는 자동으로 **$HOME\clouddrive**로 연결되며, **$HOME** 디렉토리는 Azure File Share에 **.img** 파일로 저장됩니다. 그러나 $HOME 외부의 파일과 머신 상태는 유지되지 않습니다. SSH 키와 같은 비밀을 안전하게 저장하려면 Azure Key Vault를 사용하십시오.  
**Azure 드라이브 (Azure:)**: Azure Cloud Shell의 PowerShell에는 Azure 리소스(Compute, Network, Storage 등)를 파일 시스템과 유사한 명령을 사용하여 쉽게 탐색할 수 있는 Azure 드라이브(Azure:)가 포함되어 있습니다. cd Azure:로 Azure 드라이브로 전환하고 cd ~로 홈 디렉토리로 돌아갈 수 있습니다. 여전히 Azure PowerShell cmdlet을 사용하여 모든 드라이브에서 리소스를 관리할 수 있습니다.  
**사용자 정의 도구 설치**: 스토리지 계정으로 Cloud Shell을 구성한 사용자는 루트 권한이 필요하지 않은 추가 도구를 설치할 수 있습니다. 이 기능은 Cloud Shell 환경을 추가로 사용자 정의할 수 있게 하여 사용자가 특정 요구에 맞게 설정을 조정할 수 있도록 합니다.

## References

- [https://learn.microsoft.com/en-us/azure/cloud-shell/overview](https://learn.microsoft.com/en-us/azure/cloud-shell/overview)
- [https://learn.microsoft.com/en-us/azure/cloud-shell/features](https://learn.microsoft.com/en-us/azure/cloud-shell/features)
- [https://learn.microsoft.com/en-us/azure/cloud-shell/using-the-shell-window](https://learn.microsoft.com/en-us/azure/cloud-shell/using-the-shell-window)

## Persistence

{{#ref}}
../az-persistence/az-cloud-shell-persistence.md
{{#endref}}

{{#include ../../../banners/hacktricks-training.md}}
