# Az - Defender

{{#include ../../../banners/hacktricks-training.md}}

## Microsoft Sentinel

Το Microsoft Sentinel είναι μια cloud-native **SIEM** (Διαχείριση Πληροφοριών και Συμβάντων Ασφαλείας) και **SOAR** (Αυτοματοποίηση, Ορχήστρωση και Αντίκτυπος Ασφαλείας) λύση στο Azure​.

Συγκεντρώνει δεδομένα ασφαλείας από όλη την οργάνωση (on-premises και cloud) σε μια ενιαία πλατφόρμα και χρησιμοποιεί **ενσωματωμένη ανάλυση και πληροφορίες απειλών** για να εντοπίσει πιθανές απειλές​.
Το Sentinel αξιοποιεί υπηρεσίες Azure όπως το Log Analytics (για μαζική αποθήκευση και ερώτηση καταγραφών) και τα Logic Apps (για αυτοματοποιημένες ροές εργασίας) – αυτό σημαίνει ότι μπορεί να κλιμακώνεται κατά παραγγελία και να ενσωματώνεται με τις δυνατότητες AI και αυτοματοποίησης του Azure​.

Στην ουσία, το Sentinel συλλέγει και αναλύει καταγραφές από διάφορες πηγές, **εντοπίζει ανωμαλίες ή κακόβουλες δραστηριότητες**, και επιτρέπει στις ομάδες ασφαλείας να ερευνούν και να ανταποκρίνονται γρήγορα σε απειλές, όλα μέσω της πύλης Azure χωρίς να χρειάζεται υποδομή SIEM on-premises​.


### Ρύθμιση Microsoft Sentinel

Ξεκινάτε ενεργοποιώντας το Sentinel σε ένα Azure Log Analytics workspace (το workspace είναι όπου θα αποθηκευτούν και θα αναλυθούν οι καταγραφές). Παρακάτω είναι τα βασικά βήματα για να ξεκινήσετε:

1. **Ενεργοποιήστε το Microsoft Sentinel σε ένα Workspace**: Στην πύλη Azure, δημιουργήστε ή χρησιμοποιήστε ένα υπάρχον Log Analytics workspace και προσθέστε το Microsoft Sentinel σε αυτό. Αυτό αναπτύσσει τις δυνατότητες του Sentinel στο workspace σας.
2. **Συνδέστε Πηγές Δεδομένων (Data Connectors)**: Μόλις ενεργοποιηθεί το Sentinel, συνδέστε τις πηγές δεδομένων σας χρησιμοποιώντας ενσωματωμένους συνδέσμους δεδομένων. Είτε πρόκειται για καταγραφές Entra ID, Office 365, ή ακόμα και καταγραφές τείχους προστασίας, το Sentinel αρχίζει να εισάγει καταγραφές και ειδοποιήσεις αυτόματα. Αυτό γίνεται συνήθως δημιουργώντας διαγνωστικές ρυθμίσεις για να στέλνετε καταγραφές στο workspace καταγραφών που χρησιμοποιείται.
3. **Εφαρμόστε Κανόνες Ανάλυσης και Περιεχόμενο**: Με τα δεδομένα να ρέουν, ενεργοποιήστε τους ενσωματωμένους κανόνες ανάλυσης ή δημιουργήστε προσαρμοσμένους για να ανιχνεύσετε απειλές. Χρησιμοποιήστε το Content Hub για προ-πακεταρισμένα πρότυπα κανόνων και βιβλία εργασίας που θα επιταχύνουν τις δυνατότητές σας στην ανίχνευση.
4. **(Προαιρετικά) Ρυθμίστε Αυτοματοποίηση**: Ρυθμίστε αυτοματοποίηση με playbooks για να ανταποκριθείτε αυτόματα σε περιστατικά—όπως η αποστολή ειδοποιήσεων ή η απομόνωση συμβιβασμένων λογαριασμών—ενισχύοντας τη συνολική σας ανταπόκριση.


## Κύριες Δυνατότητες

- **Καταγραφές**: Η καρτέλα Καταγραφές ανοίγει τη διεπαφή ερωτήσεων Log Analytics, όπου μπορείτε να εμβαθύνετε **στα δεδομένα σας χρησιμοποιώντας τη Γλώσσα Ερωτήσεων Kusto (KQL)**. Αυτή η περιοχή είναι κρίσιμη για την αποσφαλμάτωση, την εγκληματολογική ανάλυση και την προσαρμοσμένη αναφορά. Μπορείτε να γράψετε και να εκτελέσετε ερωτήσεις για να φιλτράρετε γεγονότα καταγραφών, να συσχετίσετε δεδομένα από διαφορετικές πηγές και ακόμη και να δημιουργήσετε προσαρμοσμένα πίνακες ή ειδοποιήσεις με βάση τα ευρήματά σας. Είναι το κέντρο εξερεύνησης ακατέργαστων δεδομένων του Sentinel.
- **Αναζήτηση**: Το εργαλείο Αναζήτησης προσφέρει μια ενιαία διεπαφή για **γρήγορη εντοπισμό γεγονότων ασφαλείας, περιστατικών και ακόμη και συγκεκριμένων καταγραφών**. Αντί να πλοηγείστε χειροκίνητα μέσω πολλών καρτελών, μπορείτε να πληκτρολογήσετε λέξεις-κλειδιά, διευθύνσεις IP ή ονόματα χρηστών για να εμφανίσετε αμέσως όλα τα σχετικά γεγονότα. Αυτή η δυνατότητα είναι ιδιαίτερα χρήσιμη κατά τη διάρκεια μιας έρευνας όταν χρειάζεται να συνδέσετε γρήγορα διαφορετικά κομμάτια πληροφοριών.
- **Περιστατικά**: Η ενότητα Περιστατικά κεντρικοποιεί όλες τις **ομαδοποιημένες ειδοποιήσεις σε διαχειρίσιμες περιπτώσεις**. Το Sentinel συγκεντρώνει σχετικές ειδοποιήσεις σε ένα μόνο περιστατικό, παρέχοντας συμφραζόμενα όπως σοβαρότητα, χρονοδιάγραμμα και επηρεαζόμενους πόρους. Μέσα σε ένα περιστατικό, μπορείτε να δείτε ένα λεπτομερές γράφημα έρευνας που απεικονίζει τη σχέση μεταξύ των ειδοποιήσεων, διευκολύνοντας την κατανόηση της έκτασης και του αντίκτυπου μιας πιθανής απειλής. Η διαχείριση περιστατικών περιλαμβάνει επίσης επιλογές για την ανάθεση εργασιών, την ενημέρωση καταστάσεων και την ενσωμάτωση με ροές εργασίας αντίκτυπου.
- **Βιβλία Εργασίας**: Τα Βιβλία Εργασίας είναι προσαρμόσιμες πίνακες και αναφορές που σας βοηθούν να **οπτικοποιήσετε και να αναλύσετε τα δεδομένα ασφαλείας σας**. Συνδυάζουν διάφορα γραφήματα, πίνακες και ερωτήσεις για να προσφέρουν μια συνολική εικόνα των τάσεων και των προτύπων. Για παράδειγμα, μπορεί να χρησιμοποιήσετε ένα βιβλίο εργασίας για να εμφανίσετε μια χρονογραμμή δραστηριοτήτων σύνδεσης, γεωγραφική χαρτογράφηση διευθύνσεων IP ή τη συχνότητα συγκεκριμένων ειδοποιήσεων με την πάροδο του χρόνου. Τα Βιβλία Εργασίας είναι τόσο προ-κατασκευασμένα όσο και πλήρως προσαρμόσιμα για να ταιριάζουν στις συγκεκριμένες ανάγκες παρακολούθησης της οργάνωσής σας.
- **Κυνήγι**: Η δυνατότητα Κυνήγι παρέχει μια προληπτική προσέγγιση για **να βρείτε απειλές που μπορεί να μην έχουν ενεργοποιήσει τυπικές ειδοποιήσεις**. Έρχεται με προ-κατασκευασμένες ερωτήσεις κυνήγι που ευθυγραμμίζονται με πλαίσια όπως το MITRE ATT&CK αλλά σας επιτρέπει επίσης να γράφετε προσαρμοσμένες ερωτήσεις. Αυτό το εργαλείο είναι ιδανικό για **προχωρημένους αναλυτές που επιθυμούν να ανακαλύψουν κρυφές ή αναδυόμενες απειλές** εξερευνώντας ιστορικά και δεδομένα σε πραγματικό χρόνο, όπως ασυνήθιστους δικτυακούς προτύπους ή ανωμαλίες στη συμπεριφορά χρηστών.
- **Σημειωματάρια**: Με την ενσωμάτωση Σημειωματάριων, το Sentinel αξιοποιεί **Jupyter Notebooks για προχωρημένη ανάλυση δεδομένων και αυτοματοποιημένες έρευνες**. Αυτή η δυνατότητα σας επιτρέπει να εκτελείτε κώδικα Python απευθείας στα δεδομένα του Sentinel, καθιστώντας δυνατή την εκτέλεση αναλύσεων μηχανικής μάθησης, τη δημιουργία προσαρμοσμένων οπτικοποιήσεων ή την αυτοματοποίηση σύνθετων ερευνητικών εργασιών. Είναι ιδιαίτερα χρήσιμο για επιστήμονες δεδομένων ή αναλυτές ασφαλείας που χρειάζονται να διεξάγουν σε βάθος αναλύσεις πέρα από τις τυπικές ερωτήσεις.
- **Συμπεριφορά Οντοτήτων**: Η σελίδα Συμπεριφορά Οντοτήτων χρησιμοποιεί **Αναλύσεις Συμπεριφοράς Χρηστών και Οντοτήτων (UEBA)** για να καθορίσει τις βάσεις για κανονική δραστηριότητα στο περιβάλλον σας. Εμφανίζει λεπτομερή προφίλ για χρήστες, συσκευές και διευθύνσεις IP, **τονίζοντας τις αποκλίσεις από τη συνήθη συμπεριφορά**. Για παράδειγμα, αν ένας λογαριασμός με κανονικά χαμηλή δραστηριότητα ξαφνικά εμφανίζει υψηλούς όγκους μεταφορών δεδομένων, αυτή η απόκλιση θα σημειωθεί. Αυτό το εργαλείο είναι κρίσιμο για την αναγνώριση εσωτερικών απειλών ή συμβιβασμένων διαπιστευτηρίων με βάση ανωμαλίες συμπεριφοράς.
- **Πληροφορίες Απειλών**: Η ενότητα Πληροφορίες Απειλών σας επιτρέπει να **διαχειρίζεστε και να συσχετίζετε εξωτερικούς δείκτες απειλών**—όπως κακόβουλες διευθύνσεις IP, URLs ή κατακερματισμούς αρχείων—με τα εσωτερικά σας δεδομένα. Με την ενσωμάτωση με εξωτερικές ροές πληροφοριών, το Sentinel μπορεί αυτόματα να σημειώνει γεγονότα που ταιριάζουν με γνωστές απειλές. Αυτό σας βοηθά να ανιχνεύετε και να ανταποκρίνεστε γρήγορα σε επιθέσεις που είναι μέρος ευρύτερων, γνωστών εκστρατειών, προσθέτοντας ένα ακόμη επίπεδο συμφραζομένων στις ειδοποιήσεις ασφαλείας σας.
- **MITRE ATT&CK**: Στην καρτέλα MITRE ATT&CK, το Sentinel **χαρτογραφεί τα δεδομένα ασφαλείας σας και τους κανόνες ανίχνευσης στο ευρέως αναγνωρισμένο πλαίσιο MITRE ATT&CK**. Αυτή η προβολή σας βοηθά να κατανοήσετε ποιες τακτικές και τεχνικές παρατηρούνται στο περιβάλλον σας, να εντοπίσετε πιθανά κενά κάλυψης και να ευθυγραμμίσετε τη στρατηγική ανίχνευσής σας με αναγνωρισμένα πρότυπα επιθέσεων. Παρέχει έναν δομημένο τρόπο ανάλυσης του πώς οι αντίπαλοι μπορεί να επιτίθενται στο περιβάλλον σας και βοηθά στην προτεραιοποίηση αμυντικών ενεργειών.
- **Content Hub**: Το Content Hub είναι μια κεντρική αποθήκη **προ-πακεταρισμένων λύσεων, συμπεριλαμβανομένων συνδέσμων δεδομένων, κανόνων ανάλυσης, βιβλίων εργασίας και playbooks**. Αυτές οι λύσεις έχουν σχεδιαστεί για να επιταχύνουν την ανάπτυξή σας και να βελτιώσουν τη θέση ασφαλείας σας παρέχοντας βέλτιστες ρυθμίσεις για κοινές υπηρεσίες (όπως το Office 365, Entra ID κ.λπ.). Μπορείτε να περιηγηθείτε, να εγκαταστήσετε και να ενημερώσετε αυτά τα πακέτα περιεχομένου, διευκολύνοντας την ενσωμάτωση νέων τεχνολογιών στο Sentinel χωρίς εκτενή χειροκίνητη ρύθμιση.
- **Αποθετήρια**: Η δυνατότητα Αποθετηρίων (προς το παρόν σε προεπισκόπηση) επιτρέπει τον έλεγχο εκδόσεων για το περιεχόμενο του Sentinel σας. Ενσωματώνεται με συστήματα ελέγχου πηγών όπως το GitHub ή το Azure DevOps, επιτρέποντάς σας να **διαχειρίζεστε τους κανόνες ανάλυσης, τα βιβλία εργασίας, τα playbooks και άλλες ρυθμίσεις ως κώδικα**. Αυτή η προσέγγιση όχι μόνο βελτιώνει τη διαχείριση αλλαγών και τη συνεργασία αλλά διευκολύνει επίσης την επιστροφή σε προηγούμενες εκδόσεις αν χρειαστεί.
- **Διαχείριση Workspace**: Ο διαχειριστής Workspace του Microsoft Sentinel επιτρέπει στους χρήστες να **διαχειρίζονται κεντρικά πολλαπλά workspaces Microsoft Sentinel** εντός ενός ή περισσότερων ενοικιαστών Azure. Ο Κεντρικός χώρος εργασίας (με ενεργοποιημένο τον διαχειριστή Workspace) μπορεί να συγκεντρώσει στοιχεία περιεχομένου για δημοσίευση σε κλίμακα σε μέλη workspaces.
- **Συνδέσμοι Δεδομένων**: Η σελίδα Συνδέσμων Δεδομένων απαριθμεί όλους τους διαθέσιμους συνδέσμους που φέρνουν δεδομένα στο Sentinel. Κάθε σύνδεσμος είναι **προ-ρυθμισμένος για συγκεκριμένες πηγές δεδομένων** (τόσο Microsoft όσο και τρίτων) και δείχνει την κατάσταση σύνδεσής του. Η ρύθμιση ενός συνδέσμου δεδομένων συνήθως περιλαμβάνει μερικά κλικ, μετά τα οποία το Sentinel αρχίζει να εισάγει και να αναλύει καταγραφές από αυτή την πηγή. Αυτή η περιοχή είναι ζωτικής σημασίας επειδή η ποιότητα και η έκταση της παρακολούθησης ασφαλείας σας εξαρτώνται από την ποικιλία και τη ρύθμιση των συνδεδεμένων πηγών δεδομένων σας.
- **Ανάλυση**: Στην καρτέλα Ανάλυσης, **δημιουργείτε και διαχειρίζεστε τους κανόνες ανίχνευσης που τροφοδοτούν τις ειδοποιήσεις του Sentinel**. Αυτοί οι κανόνες είναι ουσιαστικά ερωτήσεις που εκτελούνται σε προγραμματισμένο χρόνο (ή σχεδόν σε πραγματικό χρόνο) για να εντοπίσουν ύποπτα πρότυπα ή παραβιάσεις ορίων στα δεδομένα καταγραφών σας. Μπορείτε να επιλέξετε από προ-κατασκευασμένα πρότυπα που παρέχονται από τη Microsoft ή να δημιουργήσετε τους δικούς σας προσαρμοσμένους κανόνες χρησιμοποιώντας KQL. Οι κανόνες ανάλυσης καθορίζουν πώς και πότε παράγονται οι ειδοποιήσεις, επηρεάζοντας άμεσα το πώς σχηματίζονται και προτεραιοποιούνται τα περιστατικά.
- **Λίστα Παρακολούθησης**: Η λίστα παρακολούθησης του Microsoft Sentinel επιτρέπει τη **συλλογή δεδομένων από εξωτερικές πηγές δεδομένων για συσχέτιση με τα γεγονότα** στο περιβάλλον Microsoft Sentinel σας. Μόλις δημιουργηθεί, αξιοποιήστε τις λίστες παρακολούθησης στην αναζήτησή σας, στους κανόνες ανίχνευσης, στο κυνήγι απειλών, στα βιβλία εργασίας και στα playbooks αντίκτυπου.
- **Αυτοματοποίηση**: Οι κανόνες αυτοματοποίησης σας επιτρέπουν να **διαχειρίζεστε κεντρικά όλη την αυτοματοποίηση της διαχείρισης περιστατικών**. Οι κανόνες αυτοματοποίησης απλοποιούν τη χρήση αυτοματοποίησης στο Microsoft Sentinel και σας επιτρέπουν να απλοποιήσετε σύνθετες ροές εργασίας για τις διαδικασίες ορχήστρωσης περιστατικών σας.


{{#include ../../../banners/hacktricks-training.md}}
