# Az - Application Proxy

{{#include ../../../banners/hacktricks-training.md}}

## Basiese Inligting

[Uit die dokumentasie:](https://learn.microsoft.com/en-us/entra/identity/app-proxy/application-proxy)

Azure Active Directory se Application Proxy bied **veilige afstandstoegang tot plaaslike webtoepassings**. Na 'n **enkele aanmelding by Azure AD** kan gebruikers toegang verkry tot beide **cloud** en **plaaslike toepassings** deur 'n **eksterne URL** of 'n interne toepassingsportaal.

Dit werk soos volg:

<figure><img src="../../../images/image (186).png" alt=""><figcaption></figcaption></figure>

1. Nadat die gebruiker toegang tot die toepassing verkry het deur 'n eindpunt, word die gebruiker na die **Azure AD aanmeldbladsy** gelei.
2. Na 'n **suksesvolle aanmelding** stuur Azure AD 'n **token** na die gebruiker se kliënttoestel.
3. Die kliënt stuur die token na die **Application Proxy diens**, wat die gebruiker se hoofnaam (UPN) en sekuriteitshoofnaam (SPN) uit die token onttrek. **Application Proxy stuur dan die versoek na die Application Proxy connector**.
4. As jy enkel aanmelding gekonfigureer het, voer die connector enige **addisionele verifikasie** uit wat benodig word namens die gebruiker.
5. Die connector stuur die versoek na die **plaaslike toepassing**.
6. Die **antwoord** word deur die connector en Application Proxy diens **na die gebruiker** gestuur.

## Enumerasie
```bash
# Enumerate applications with application proxy configured
Get-AzureADApplication | %{try{Get-AzureADApplicationProxyApplication -ObjectId $_.ObjectID;$_.DisplayName;$_.ObjectID}catch{}}

# Get applications service principal
Get-AzureADServicePrincipal -All $true | ?{$_.DisplayName -eq "Name"}

# Use the following ps1 script from https://learn.microsoft.com/en-us/azure/active-directory/app-proxy/scripts/powershell-display-users-group-of-app
# to find users and groups assigned to the application. Pass the ObjectID of the Service Principal to it
Get-ApplicationProxyAssignedUsersAndGroups -ObjectId <object-id>
```
## Verwysings

- [https://learn.microsoft.com/en-us/azure/active-directory/app-proxy/application-proxy](https://learn.microsoft.com/en-us/azure/active-directory/app-proxy/application-proxy)

{{#include ../../../banners/hacktricks-training.md}}
