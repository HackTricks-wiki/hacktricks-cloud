# Az AD Connect - Hybrid Identity

{{#include ../../../../banners/hacktricks-training.md}}

## Basic Information

Integration between **On-premises Active Directory (AD)** and **Azure AD** is facilitated by **Azure AD Connect**, offering various methods that support **Single Sign-on (SSO)**. Each method, while useful, presents potential security vulnerabilities that could be exploited to compromise cloud or on-premises environments:

- **Pass-Through Authentication (PTA)**:
- Uwezekano wa kuathiriwa kwa wakala kwenye AD ya ndani, kuruhusu uthibitishaji wa nywila za watumiaji kwa ajili ya muunganisho wa Azure (kutoka ndani hadi Cloud).
- Uwezekano wa kujiandikisha wakala mpya ili kuthibitisha uthibitisho katika eneo jipya (Cloud hadi ndani).

{{#ref}}
pta-pass-through-authentication.md
{{#endref}}

- **Password Hash Sync (PHS)**:
- Uwezekano wa kutoa nywila za wazi za watumiaji wenye mamlaka kutoka AD, ikiwa ni pamoja na akauti za mtumiaji wa AzureAD zenye mamlaka ya juu, zilizoundwa kiotomatiki.

{{#ref}}
phs-password-hash-sync.md
{{#endref}}

- **Federation**:
- Wizi wa funguo binafsi zinazotumika kwa ajili ya saini ya SAML, kuruhusu uigaji wa vitambulisho vya ndani na vya wingu.

{{#ref}}
federation.md
{{#endref}}

- **Seamless SSO:**
- Wizi wa nywila ya mtumiaji `AZUREADSSOACC`, inayotumika kwa ajili ya kusaini tiketi za Kerberos za fedha, kuruhusu uigaji wa mtumiaji yeyote wa wingu.

{{#ref}}
seamless-sso.md
{{#endref}}

- **Cloud Kerberos Trust**:
- Uwezekano wa kupandisha cheo kutoka kwa Global Admin hadi kwa Domain Admin wa ndani kwa kubadilisha majina ya watumiaji wa AzureAD na SIDs na kuomba TGTs kutoka AzureAD.

{{#ref}}
az-cloud-kerberos-trust.md
{{#endref}}

- **Default Applications**:
- Kuathiri akaunti ya Msimamizi wa Programu au Akaunti ya Sync ya ndani kunaruhusu mabadiliko ya mipangilio ya directory, uanachama wa vikundi, akaunti za watumiaji, tovuti za SharePoint, na faili za OneDrive.

{{#ref}}
az-default-applications.md
{{#endref}}

For each integration method, user synchronization is conducted, and an `MSOL_<installationidentifier>` account is created in the on-prem AD. Notably, both **PHS** and **PTA** methods facilitate **Seamless SSO**, enabling automatic sign-in for Azure AD computers joined to the on-prem domain.

To verify the installation of **Azure AD Connect**, the following PowerShell command, utilizing the **AzureADConnectHealthSync** module (installed by default with Azure AD Connect), can be used:
```powershell
Get-ADSyncConnector
```
{{#include ../../../../banners/hacktricks-training.md}}
