# Az AD Connect - Hybrid Identity

{{#include ../../../../banners/hacktricks-training.md}}

## Basic Information

**On-premises Active Directory (AD)** और **Azure AD** के बीच एकीकरण **Azure AD Connect** द्वारा किया जाता है, जो **Single Sign-on (SSO)** का समर्थन करने वाले विभिन्न तरीकों की पेशकश करता है। प्रत्येक विधि, जबकि उपयोगी है, संभावित सुरक्षा कमजोरियों को प्रस्तुत करती है जिन्हें क्लाउड या ऑन-प्रिमाइसेस वातावरण को समझौता करने के लिए उपयोग किया जा सकता है:

- **Pass-Through Authentication (PTA)**:
- ऑन-प्रिम AD पर एजेंट का संभावित समझौता, Azure कनेक्शनों (ऑन-प्रिम से क्लाउड) के लिए उपयोगकर्ता पासवर्डों की मान्यता की अनुमति देता है।
- एक नए स्थान (क्लाउड से ऑन-प्रिम) में प्रमाणीकरण मान्य करने के लिए एक नए एजेंट को पंजीकृत करने की संभावना।

{{#ref}}
pta-pass-through-authentication.md
{{#endref}}

- **Password Hash Sync (PHS)**:
- AD से विशेषाधिकार प्राप्त उपयोगकर्ताओं के स्पष्ट-पाठ पासवर्डों का संभावित निष्कर्षण, जिसमें एक उच्च-विशेषाधिकार प्राप्त, स्व-निर्मित AzureAD उपयोगकर्ता के क्रेडेंशियल शामिल हैं।

{{#ref}}
phs-password-hash-sync.md
{{#endref}}

- **Federation**:
- SAML साइनिंग के लिए उपयोग की जाने वाली निजी कुंजी की चोरी, ऑन-प्रिम और क्लाउड पहचान की नकल करने की अनुमति देती है।

{{#ref}}
federation.md
{{#endref}}

- **Seamless SSO:**
- `AZUREADSSOACC` उपयोगकर्ता का पासवर्ड चुराना, जिसका उपयोग Kerberos सिल्वर टिकटों पर हस्ताक्षर करने के लिए किया जाता है, किसी भी क्लाउड उपयोगकर्ता की नकल करने की अनुमति देता है।

{{#ref}}
seamless-sso.md
{{#endref}}

- **Cloud Kerberos Trust**:
- AzureAD उपयोगकर्ता नाम और SIDs में हेरफेर करके और AzureAD से TGTs का अनुरोध करके Global Admin से ऑन-प्रिम डोमेन Admin में बढ़ने की संभावना।

{{#ref}}
az-cloud-kerberos-trust.md
{{#endref}}

- **Default Applications**:
- एक एप्लिकेशन प्रशासक खाते या ऑन-प्रिमिस सिंक खाते का समझौता करने से निर्देशिका सेटिंग्स, समूह सदस्यता, उपयोगकर्ता खाते, SharePoint साइटों और OneDrive फ़ाइलों में संशोधन की अनुमति मिलती है।

{{#ref}}
az-default-applications.md
{{#endref}}

प्रत्येक एकीकरण विधि के लिए, उपयोगकर्ता समन्वय किया जाता है, और ऑन-प्रिम AD में एक `MSOL_<installationidentifier>` खाता बनाया जाता है। विशेष रूप से, दोनों **PHS** और **PTA** विधियाँ **Seamless SSO** की सुविधा प्रदान करती हैं, जो ऑन-प्रिम डोमेन से जुड़े Azure AD कंप्यूटरों के लिए स्वचालित साइन-इन सक्षम करती हैं।

**Azure AD Connect** की स्थापना की पुष्टि करने के लिए, निम्नलिखित PowerShell कमांड का उपयोग किया जा सकता है, जो **AzureADConnectHealthSync** मॉड्यूल का उपयोग करता है (जो Azure AD Connect के साथ डिफ़ॉल्ट रूप से स्थापित होता है):
```bash
Get-ADSyncConnector
```
{{#include ../../../../banners/hacktricks-training.md}}
