# Az - Credenciales de Nube Local

{{#include ../../../banners/hacktricks-training.md}}

## Almacenamiento Local de Tokens y Consideraciones de Seguridad

### Azure CLI (Interfaz de Línea de Comandos)

Los tokens y datos sensibles se almacenan localmente por Azure CLI, lo que plantea preocupaciones de seguridad:

1. **Tokens de Acceso**: Almacenados en texto plano dentro de `accessTokens.json` ubicado en `C:\Users\<username>\.Azure`.
2. **Información de Suscripción**: `azureProfile.json`, en el mismo directorio, contiene detalles de la suscripción.
3. **Archivos de Registro**: La carpeta `ErrorRecords` dentro de `.azure` podría contener registros con credenciales expuestas, tales como:
- Comandos ejecutados con credenciales incrustadas.
- URLs accedidas usando tokens, que podrían revelar información sensible.

### Azure PowerShell

Azure PowerShell también almacena tokens y datos sensibles, que pueden ser accedidos localmente:

1. **Tokens de Acceso**: `TokenCache.dat`, ubicado en `C:\Users\<username>\.Azure`, almacena tokens de acceso en texto plano.
2. **Secretos de Principal de Servicio**: Estos se almacenan sin cifrar en `AzureRmContext.json`.
3. **Función de Guardado de Tokens**: Los usuarios tienen la capacidad de persistir tokens usando el comando `Save-AzContext`, que debe usarse con precaución para prevenir accesos no autorizados.

## Herramientas Automáticas para encontrarlos

- [**Winpeas**](https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS/winPEASexe)
- [**Get-AzurePasswords.ps1**](https://github.com/NetSPI/MicroBurst/blob/master/AzureRM/Get-AzurePasswords.ps1)

## Recomendaciones de Seguridad

Considerando el almacenamiento de datos sensibles en texto plano, es crucial asegurar estos archivos y directorios mediante:

- Limitación de derechos de acceso a estos archivos.
- Monitoreo y auditoría regular de estos directorios para detectar accesos no autorizados o cambios inesperados.
- Empleo de cifrado para archivos sensibles donde sea posible.
- Educación a los usuarios sobre los riesgos y las mejores prácticas para manejar dicha información sensible.

{{#include ../../../banners/hacktricks-training.md}}
