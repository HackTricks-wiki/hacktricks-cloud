# Az - Storage Unauth

{{#include ../../../banners/hacktricks-training.md}}

## Storage Unauth

ストレージに関する詳細情報は、以下を確認してください：

{{#ref}}
../az-services/az-storage.md
{{#endref}}

### Open Storage

[**InvokeEnumerateAzureBlobs.ps1**](https://github.com/NetSPI/MicroBurst/blob/master/Misc/Invoke-EnumerateAzureBlobs.ps1)のようなツールを使用して、オープンストレージを発見することができます。このツールは、**`Microburst/Misc/permutations.txt`**ファイルを使用して、オープンストレージアカウントを**見つける**ための非常にシンプルな順列を生成します。
```bash
Import-Module .\MicroBurst\MicroBurst.psm1
Invoke-EnumerateAzureBlobs -Base corp
[...]
https://corpcommon.blob.core.windows.net/secrets?restype=container&comp=list
[...]

# Access https://corpcommon.blob.core.windows.net/secrets?restype=container&comp=list
# Check: <Name>ssh_info.json</Name>
# Access then https://corpcommon.blob.core.windows.net/secrets/ssh_info.json
```
この目的のために、[**MicroBust**](https://github.com/NetSPI/MicroBurst) のメソッドを使用することもできます。この関数は、いくつかの **azure domains**（ストレージドメインを含む）でベースドメイン名（およびいくつかの変種）を検索します：
```bash
Import-Module .\MicroBurst\MicroBurst.psm1 -Verbose
Invoke-EnumerateAzureSubDomains -Base corp -Verbose
```
### SAS URLs

_**共有アクセス署名**_ (SAS) URLは、特定のストレージアカウントの一部（完全なコンテナやファイルなど）へのアクセスを**提供する**URLであり、リソースに対する特定の権限（読み取り、書き込みなど）を持っています。漏洩した場合、機密情報にアクセスできる可能性があります。これらは次のようになります（これはコンテナにアクセスするためのもので、ファイルへのアクセスを許可するだけの場合、URLのパスにもそのファイルが含まれます）：

`https://<storage_account_name>.blob.core.windows.net/newcontainer?sp=r&st=2021-09-26T18:15:21Z&se=2021-10-27T02:14:21Z&spr=https&sv=2021-07-08&sr=c&sig=7S%2BZySOgy4aA3Dk0V1cJyTSIf1cW%2Fu3WFkhHV32%2B4PE%3D`

[**Storage Explorer**](https://azure.microsoft.com/en-us/features/storage-explorer/)を使用してデータにアクセスします


{{#include ../../../banners/hacktricks-training.md}}
