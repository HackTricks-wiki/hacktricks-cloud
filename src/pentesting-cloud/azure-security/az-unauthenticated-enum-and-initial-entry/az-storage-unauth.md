# Az - Storage Unauth

{{#include ../../../banners/hacktricks-training.md}}

## Storage Unauth

Per ulteriori informazioni sullo storage, controlla:

{{#ref}}
../az-services/az-storage.md
{{#endref}}

### Open Storage

Puoi scoprire storage aperti con uno strumento come [**InvokeEnumerateAzureBlobs.ps1**](https://github.com/NetSPI/MicroBurst/blob/master/Misc/Invoke-EnumerateAzureBlobs.ps1) che utilizzerà il file **`Microburst/Misc/permutations.txt`** per generare permutazioni (molto semplici) per cercare di **trovare account di storage aperti**.
```bash
Import-Module .\MicroBurst\MicroBurst.psm1
Invoke-EnumerateAzureBlobs -Base corp
[...]
https://corpcommon.blob.core.windows.net/secrets?restype=container&comp=list
[...]

# Access https://corpcommon.blob.core.windows.net/secrets?restype=container&comp=list
# Check: <Name>ssh_info.json</Name>
# Access then https://corpcommon.blob.core.windows.net/secrets/ssh_info.json
```
Puoi anche utilizzare un metodo da [**MicroBust**](https://github.com/NetSPI/MicroBurst) per tale scopo. Questa funzione cercherà il nome di dominio di base (e alcune permutazioni) in diversi **azure domains** (inclusi i domini di archiviazione):
```bash
Import-Module .\MicroBurst\MicroBurst.psm1 -Verbose
Invoke-EnumerateAzureSubDomains -Base corp -Verbose
```
### SAS URLs

Un _**shared access signature**_ (SAS) URL è un URL che **fornisce accesso** a una certa parte di un account di Storage (può essere un intero contenitore, un file...) con alcune specifiche autorizzazioni (lettura, scrittura...) sulle risorse. Se ne trovi uno leaked potresti essere in grado di accedere a informazioni sensibili, appaiono così (questo è per accedere a un contenitore, se stesse solo concedendo accesso a un file, il percorso dell'URL conterrà anche quel file):

`https://<storage_account_name>.blob.core.windows.net/newcontainer?sp=r&st=2021-09-26T18:15:21Z&se=2021-10-27T02:14:21Z&spr=https&sv=2021-07-08&sr=c&sig=7S%2BZySOgy4aA3Dk0V1cJyTSIf1cW%2Fu3WFkhHV32%2B4PE%3D`

Usa [**Storage Explorer**](https://azure.microsoft.com/en-us/features/storage-explorer/) per accedere ai dati


{{#include ../../../banners/hacktricks-training.md}}
