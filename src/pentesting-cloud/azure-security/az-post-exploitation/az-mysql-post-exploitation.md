# Az - MySQL Post Exploitation

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="../../../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="../../../.gitbook/assets/image (2) (1).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2) (1).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**ë””ìŠ¤ì½”ë“œ ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}

## MySQL ë°ì´í„°ë² ì´ìŠ¤ í¬ìŠ¤íŠ¸ ìµìŠ¤í”Œë¡œì´í…Œì´ì…˜
MySQL ë°ì´í„°ë² ì´ìŠ¤ì— ëŒ€í•œ ìì„¸í•œ ì •ë³´ëŠ” ë‹¤ìŒì„ í™•ì¸í•˜ì„¸ìš”:

{% content-ref url="../az-services/az-mysql.md" %}
[az-mysql.md](../az-services/az-mysql.md)
{% endcontent-ref %}

### "Microsoft.DBforMySQL/flexibleServers/databases/write" && "Microsoft.DBforMySQL/flexibleServers/databases/read"

ì´ ê¶Œí•œì„ ì‚¬ìš©í•˜ë©´ Azureì˜ MySQL Flexible Server ì¸ìŠ¤í„´ìŠ¤ ë‚´ì—ì„œ ìƒˆë¡œìš´ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì‘ì—… ìì²´ëŠ” ê¸°ì¡´ ë¦¬ì†ŒìŠ¤ë¥¼ ìˆ˜ì •í•˜ì§€ ì•Šì§€ë§Œ, ê³¼ë„í•˜ê±°ë‚˜ ë¬´ë‹¨ìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ìƒì„±í•˜ë©´ ë¦¬ì†ŒìŠ¤ ì†Œë¹„ ë˜ëŠ” ì„œë²„ì˜ ì ì¬ì  ì˜¤ìš©ìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% code overflow="wrap" %}
```bash
az mysql flexible-server db create \
--server-name <server_name> \
--resource-group <resource_group_name> \
--database-name <database_name>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/backups/write"

ì´ ê¶Œí•œì„ ì‚¬ìš©í•˜ë©´ Azureì—ì„œ MySQL Flexible Server ì¸ìŠ¤í„´ìŠ¤ì˜ ë°±ì—… ìƒì„±ì„ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ì‚¬ìš©ìëŠ” íŠ¹ì • ì‹œì ì— ë°ì´í„°ë¥¼ ë³´ì¡´í•˜ëŠ” ë° ìœ ìš©í•œ ì˜¨ë””ë§¨ë“œ ë°±ì—…ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% code overflow="wrap" %}
```bash
az mysql flexible-server backup create \
--name <server_name> \
--resource-group <resource_group_name>
--backup-name <backup_name>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/advancedThreatProtectionSettings/write"

ì´ ê¶Œí•œì„ ì‚¬ìš©í•˜ë©´ Azureì˜ MySQL Flexible Server ì¸ìŠ¤í„´ìŠ¤ì— ëŒ€í•œ Advanced Threat Protection (ATP) ì„¤ì •ì„ êµ¬ì„±í•˜ê±°ë‚˜ ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ë¹„ì •ìƒì ì¸ í™œë™ ë° ì ì¬ì  ìœ„í˜‘ì„ ê°ì§€í•˜ê³  ëŒ€ì‘í•˜ê¸° ìœ„í•´ ì„¤ê³„ëœ ë³´ì•ˆ ê¸°ëŠ¥ì„ í™œì„±í™”í•˜ê±°ë‚˜ ë¹„í™œì„±í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% code overflow="wrap" %}
```bash
az mysql flexible-server threat-protection-policy update \
--name <server_name> \
--resource-group <resource_group_name> \
--state <Enabled|Disabled>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/firewallRules/write"

ì´ ê¶Œí•œì„ ì‚¬ìš©í•˜ë©´ Azureì˜ MySQL Flexible Server ì¸ìŠ¤í„´ìŠ¤ì— ëŒ€í•œ ë°©í™”ë²½ ê·œì¹™ì„ ìƒì„±í•˜ê±°ë‚˜ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ì–´ë–¤ IP ì£¼ì†Œ ë˜ëŠ” ë²”ìœ„ê°€ ì„œë²„ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ”ì§€ë¥¼ ì œì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ê¶Œí•œì˜ ë¬´ë‹¨ ë˜ëŠ” ë¶€ì ì ˆí•œ ì‚¬ìš©ì€ ì„œë²„ë¥¼ ì›ì¹˜ ì•Šê±°ë‚˜ ì•…ì˜ì ì¸ ì ‘ê·¼ì— ë…¸ì¶œì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% code overflow="wrap" %}
```bash
# Create Rule
az mysql flexible-server firewall-rule create \
--name <server_name> \
--resource-group <resource_group_name> \
--rule-name <rule_name> \
--start-ip-address <start_ip> \
--end-ip-address <end_ip>

# Update Rule
az mysql flexible-server firewall-rule update \
--name <server_name> \
--resource-group <resource_group_name> \
--rule-name <rule_name> \
--start-ip-address <start_ip> \
--end-ip-address <end_ip>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/resetGtid/action"

ì´ ê¶Œí•œì„ ì‚¬ìš©í•˜ë©´ Azureì˜ MySQL Flexible Server ì¸ìŠ¤í„´ìŠ¤ì— ëŒ€í•œ GTID(ì „ì—­ íŠ¸ëœì­ì…˜ ì‹ë³„ì)ë¥¼ ì¬ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. GTIDë¥¼ ì¬ì„¤ì •í•˜ë©´ ì¬ì„¤ì • ì‘ì—… ì´ì „ì— ìˆ˜í–‰ëœ ëª¨ë“  ìë™í™”ëœ ì˜¨ë””ë§¨ë“œ ë°±ì—… ë° ì§€ë¦¬ì  ë°±ì—…ì´ ë¬´íš¨í™”ë©ë‹ˆë‹¤. GTID ì¬ì„¤ì • í›„, ì„ íƒí•œ ë³µì› ì‹œê°„ì´ GTID ì¬ì„¤ì • ì‹œê°„ ì´ì „ì¸ ê²½ìš° ê°€ì¥ ë¹ ë¥¸ ë³µì› ì§€ì ì´ë‚˜ ì‚¬ìš©ì ì§€ì • ë³µì› ì§€ì ì„ ì‚¬ìš©í•˜ì—¬ PITR(ì‹œì  ë³µì›)ë¥¼ ìˆ˜í–‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ì„±ê³µì ì¸ ì§€ë¦¬ì  ë³µì›ì€ 5ì¼ í›„ì—ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.

{% code overflow="wrap" %}
```bash
az mysql flexible-server reset-gtid \
--name  \
--resource-group <resource_group_name> \
--gtid-set <gtid>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/updateConfigurations/action"

ì´ ê¶Œí•œì„ ì‚¬ìš©í•˜ë©´ Azureì—ì„œ MySQL Flexible Server ì¸ìŠ¤í„´ìŠ¤ì˜ êµ¬ì„± ì„¤ì •ì„ ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ì„±ëŠ¥ ì¡°ì •, ë³´ì•ˆ êµ¬ì„± ë˜ëŠ” ìš´ì˜ ì„¤ì •ê³¼ ê°™ì€ ì„œë²„ ë§¤ê°œë³€ìˆ˜ë¥¼ ì‚¬ìš©ì ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ë§¤ê°œë³€ìˆ˜ë¥¼ í•¨ê»˜ ë°°ì¹˜ë¡œ ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: audit_log_enabled, audit_log_events, binlog_expire_logs_seconds, binlog_row_image, character_set_server, collation_server, connect_timeout, enforce_gtid_consistency, gtid_mode, init_connect, innodb_buffer_pool_size, innodb_io_capacity, innodb_io_capacity_max, innodb_purge_threads, innodb_read_io_threads, innodb_thread_concurrency, innodb_write_io_threads, long_query_time, max_connect_errors, ë° max_connections.

{% code overflow="wrap" %}
```bash
az mysql flexible-server parameter set-batch \
--resource-group <resource_group_name> \
--server-name <server_name> \
--args max_connections=<value>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/read", "Microsoft.DBforMySQL/flexibleServers/write" && "Microsoft.ManagedIdentity/userAssignedIdentities/assign/action"

ì´ ê¶Œí•œì„ ì‚¬ìš©í•˜ë©´ MySQL ìœ ì—° ì„œë²„ì— ì‚¬ìš©ì ì§€ì • ê´€ë¦¬ IDë¥¼ í• ë‹¹í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% code overflow="wrap" %}
```bash
az mysql flexible-server identity assign \
--resource-group <ResourceGroupName> \
--server-name <ServerName> \
--identity <IdentityName>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/stop/action"

ì´ ê¶Œí•œì„ ì‚¬ìš©í•˜ë©´ Azureì—ì„œ PostgreSQL Flexible Server ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì¤‘ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì„œë²„ë¥¼ ì¤‘ì§€í•˜ë©´ ë°ì´í„°ë² ì´ìŠ¤ì— ì˜ì¡´í•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ì‚¬ìš©ìì—ê²Œ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ì¼ì‹œì ì¸ ì„œë¹„ìŠ¤ ì¤‘ë‹¨ì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% code overflow="wrap" %}
```bash
az mysql flexible-server stop \
--name <server_name> \
--resource-group <resource_group_name>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/start/action"
With this permission, you can start a stopped PostgreSQL Flexible Server instance on Azure. Starting a server restores its availability, enabling applications and users to reconnect and access the database.

{% code overflow="wrap" %}
```bash
az mysql flexible-server start \
--name <server_name> \
--resource-group <resource_group_name>
```
{% endcode %}

### "*/delete"

With this permissions you can delete resources related to mysql server in Azure such as server, firewalls, managed identities or configurations

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2) (1).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2) (1).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
