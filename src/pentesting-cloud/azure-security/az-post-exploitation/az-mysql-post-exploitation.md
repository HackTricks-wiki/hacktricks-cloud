# Az - MySQL åæœŸåˆ©ç”¨

{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="../../../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="../../../.gitbook/assets/image (2) (1).png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="../../../.gitbook/assets/image (2) (1).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}

## MySQL æ•°æ®åº“åæœŸåˆ©ç”¨
æœ‰å…³ MySQL æ•°æ®åº“çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ï¼š

{% content-ref url="../az-services/az-mysql.md" %}
[az-mysql.md](../az-services/az-mysql.md)
{% endcontent-ref %}

### "Microsoft.DBforMySQL/flexibleServers/databases/write" && "Microsoft.DBforMySQL/flexibleServers/databases/read"

æ‹¥æœ‰æ­¤æƒé™åï¼Œæ‚¨å¯ä»¥åœ¨ Azure çš„ MySQL Flexible Server å®ä¾‹ä¸­åˆ›å»ºæ–°æ•°æ®åº“ã€‚è™½ç„¶æ­¤æ“ä½œæœ¬èº«ä¸ä¼šä¿®æ”¹ç°æœ‰èµ„æºï¼Œä½†è¿‡åº¦æˆ–æœªç»æˆæƒçš„æ•°æ®åº“åˆ›å»ºå¯èƒ½å¯¼è‡´èµ„æºæ¶ˆè€—æˆ–æœåŠ¡å™¨çš„æ½œåœ¨æ»¥ç”¨ã€‚

{% code overflow="wrap" %}
```bash
az mysql flexible-server db create \
--server-name <server_name> \
--resource-group <resource_group_name> \
--database-name <database_name>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/backups/write"

é€šè¿‡æ­¤æƒé™ï¼Œæ‚¨å¯ä»¥åœ¨ Azure ä¸Šä¸º MySQL Flexible Server å®ä¾‹å¯åŠ¨å¤‡ä»½çš„åˆ›å»ºã€‚è¿™ä½¿ç”¨æˆ·èƒ½å¤Ÿç”ŸæˆæŒ‰éœ€å¤‡ä»½ï¼Œè¿™å¯¹äºåœ¨ç‰¹å®šæ—¶é—´ç‚¹ä¿ç•™æ•°æ®éå¸¸æœ‰ç”¨ã€‚

{% code overflow="wrap" %}
```bash
az mysql flexible-server backup create \
--name <server_name> \
--resource-group <resource_group_name>
--backup-name <backup_name>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/advancedThreatProtectionSettings/write"

é€šè¿‡æ­¤æƒé™ï¼Œæ‚¨å¯ä»¥é…ç½®æˆ–æ›´æ–° Azure ä¸Š MySQL Flexible Server å®ä¾‹çš„é«˜çº§å¨èƒä¿æŠ¤ (ATP) è®¾ç½®ã€‚è¿™å…è®¸å¯ç”¨æˆ–ç¦ç”¨æ—¨åœ¨æ£€æµ‹å’Œå“åº”å¼‚å¸¸æ´»åŠ¨åŠæ½œåœ¨å¨èƒçš„å®‰å…¨åŠŸèƒ½ã€‚

{% code overflow="wrap" %}
```bash
az mysql flexible-server threat-protection-policy update \
--name <server_name> \
--resource-group <resource_group_name> \
--state <Enabled|Disabled>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/firewallRules/write"

é€šè¿‡æ­¤æƒé™ï¼Œæ‚¨å¯ä»¥ä¸º Azure ä¸Šçš„ MySQL Flexible Server å®ä¾‹åˆ›å»ºæˆ–ä¿®æ”¹é˜²ç«å¢™è§„åˆ™ã€‚è¿™å…è®¸æ§åˆ¶å“ªäº› IP åœ°å€æˆ–èŒƒå›´å¯ä»¥è®¿é—®æœåŠ¡å™¨ã€‚æœªç»æˆæƒæˆ–ä¸å½“ä½¿ç”¨æ­¤æƒé™å¯èƒ½ä¼šä½¿æœåŠ¡å™¨æš´éœ²äºä¸å¿…è¦æˆ–æ¶æ„çš„è®¿é—®ã€‚

{% code overflow="wrap" %}
```bash
# Create Rule
az mysql flexible-server firewall-rule create \
--name <server_name> \
--resource-group <resource_group_name> \
--rule-name <rule_name> \
--start-ip-address <start_ip> \
--end-ip-address <end_ip>

# Update Rule
az mysql flexible-server firewall-rule update \
--name <server_name> \
--resource-group <resource_group_name> \
--rule-name <rule_name> \
--start-ip-address <start_ip> \
--end-ip-address <end_ip>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/resetGtid/action"

æ‹¥æœ‰æ­¤æƒé™ï¼Œæ‚¨å¯ä»¥é‡ç½® Azure ä¸Š MySQL Flexible Server å®ä¾‹çš„ GTIDï¼ˆå…¨å±€äº‹åŠ¡æ ‡è¯†ç¬¦ï¼‰ã€‚é‡ç½® GTID å°†ä½¿æ‰€æœ‰åœ¨é‡ç½®æ“ä½œä¹‹å‰è¿›è¡Œçš„è‡ªåŠ¨ã€æŒ‰éœ€å¤‡ä»½å’Œåœ°ç†å¤‡ä»½å¤±æ•ˆã€‚é‡ç½® GTID åï¼Œå¦‚æœæ‰€é€‰æ¢å¤æ—¶é—´åœ¨ GTID é‡ç½®æ—¶é—´ä¹‹å‰ï¼Œæ‚¨å°†æ— æ³•ä½¿ç”¨æœ€å¿«æ¢å¤ç‚¹æˆ–è‡ªå®šä¹‰æ¢å¤ç‚¹æ‰§è¡Œ PITRï¼ˆæ—¶é—´ç‚¹æ¢å¤ï¼‰ã€‚æˆåŠŸçš„åœ°ç†æ¢å¤ä»…åœ¨ 5 å¤©åæ‰å¯èƒ½è¿›è¡Œã€‚

{% code overflow="wrap" %}
```bash
az mysql flexible-server reset-gtid \
--name  \
--resource-group <resource_group_name> \
--gtid-set <gtid>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/updateConfigurations/action"

é€šè¿‡æ­¤æƒé™ï¼Œæ‚¨å¯ä»¥æ›´æ–° Azure ä¸Š MySQL Flexible Server å®ä¾‹çš„é…ç½®è®¾ç½®ã€‚è¿™å…è®¸è‡ªå®šä¹‰æœåŠ¡å™¨å‚æ•°ï¼Œä¾‹å¦‚æ€§èƒ½è°ƒä¼˜ã€å®‰å…¨é…ç½®æˆ–æ“ä½œè®¾ç½®ã€‚æ‚¨å¯ä»¥æ‰¹é‡æ›´æ–°ä»¥ä¸‹å‚æ•°ï¼šaudit_log_enabled, audit_log_events, binlog_expire_logs_seconds, binlog_row_image, character_set_server, collation_server, connect_timeout, enforce_gtid_consistency, gtid_mode, init_connect, innodb_buffer_pool_size, innodb_io_capacity, innodb_io_capacity_max, innodb_purge_threads, innodb_read_io_threads, innodb_thread_concurrency, innodb_write_io_threads, long_query_time, max_connect_errors å’Œ max_connectionsã€‚

{% code overflow="wrap" %}
```bash
az mysql flexible-server parameter set-batch \
--resource-group <resource_group_name> \
--server-name <server_name> \
--args max_connections=<value>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/read", "Microsoft.DBforMySQL/flexibleServers/write" && "Microsoft.ManagedIdentity/userAssignedIdentities/assign/action"

é€šè¿‡æ­¤æƒé™ï¼Œæ‚¨å¯ä»¥å°†ç”¨æˆ·åˆ†é…çš„æ‰˜ç®¡èº«ä»½åˆ†é…ç»™ MySQL çµæ´»æœåŠ¡å™¨ã€‚

{% code overflow="wrap" %}
```bash
az mysql flexible-server identity assign \
--resource-group <ResourceGroupName> \
--server-name <ServerName> \
--identity <IdentityName>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/stop/action"

æ‹¥æœ‰æ­¤æƒé™ï¼Œæ‚¨å¯ä»¥åœæ­¢ Azure ä¸Šçš„ PostgreSQL Flexible Server å®ä¾‹ã€‚åœæ­¢æœåŠ¡å™¨å¯èƒ½ä¼šå¯¼è‡´ä¸´æ—¶æœåŠ¡ä¸­æ–­ï¼Œå½±å“ä¾èµ–äºæ•°æ®åº“çš„åº”ç”¨ç¨‹åºå’Œç”¨æˆ·ã€‚

{% code overflow="wrap" %}
```bash
az mysql flexible-server stop \
--name <server_name> \
--resource-group <resource_group_name>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/start/action"
With this permission, you can start a stopped PostgreSQL Flexible Server instance on Azure. Starting a server restores its availability, enabling applications and users to reconnect and access the database.

{% code overflow="wrap" %}
```bash
az mysql flexible-server start \
--name <server_name> \
--resource-group <resource_group_name>
```
{% endcode %}

### "*/delete"

With this permissions you can delete resources related to mysql server in Azure such as server, firewalls, managed identities or configurations

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2) (1).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2) (1).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
