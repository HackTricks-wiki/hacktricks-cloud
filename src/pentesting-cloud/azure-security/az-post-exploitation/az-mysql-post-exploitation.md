# Az - MySQL Post Exploitation

{{#include ../../../banners/hacktricks-training.md}}

## MySQL Database Post Exploitation
Aby uzyskać więcej informacji na temat bazy danych MySQL, sprawdź:

{{#ref}}
../az-services/az-mysql.md
{{#endref}}

### `Microsoft.DBforMySQL/flexibleServers/databases/write` && `Microsoft.DBforMySQL/flexibleServers/databases/read`

Dzięki temu uprawnieniu możesz tworzyć nowe bazy danych w instancji MySQL Flexible Server na Azure. Chociaż ta akcja sama w sobie nie modyfikuje istniejących zasobów, nadmierne lub nieautoryzowane tworzenie baz danych może prowadzić do zużycia zasobów lub potencjalnego nadużycia serwera.
```bash
az mysql flexible-server db create \
--server-name <server_name> \
--resource-group <resource_group_name> \
--database-name <database_name>
```
### `Microsoft.DBforMySQL/flexibleServers/backups/write`

Dzięki temu uprawnieniu możesz zainicjować tworzenie kopii zapasowych dla instancji MySQL Flexible Server na Azure. Umożliwia to użytkownikom generowanie kopii zapasowych na żądanie, co może być przydatne do zachowania danych w określonych momentach czasowych.
```bash
az mysql flexible-server backup create \
--name <server_name> \
--resource-group <resource_group_name>
--backup-name <backup_name>
```
### `Microsoft.DBforMySQL/flexibleServers/advancedThreatProtectionSettings/write`

Dzięki temu uprawnieniu możesz skonfigurować lub zaktualizować ustawienia Advanced Threat Protection (ATP) dla instancji MySQL Flexible Server na Azure. Umożliwia to włączenie lub wyłączenie funkcji zabezpieczeń zaprojektowanych w celu wykrywania i reagowania na anomalne działania oraz potencjalne zagrożenia.
```bash
az mysql flexible-server threat-protection-policy update \
--name <server_name> \
--resource-group <resource_group_name> \
--state <Enabled|Disabled>
```
### `Microsoft.DBforMySQL/flexibleServers/firewallRules/write`

Dzięki temu uprawnieniu możesz tworzyć lub modyfikować reguły zapory dla instancji MySQL Flexible Server na Azure. Umożliwia to kontrolowanie, które adresy IP lub zakresy mogą uzyskiwać dostęp do serwera. Nieautoryzowane lub niewłaściwe użycie tego uprawnienia może narazić serwer na niepożądany lub złośliwy dostęp.
```bash
# Create Rule
az mysql flexible-server firewall-rule create \
--name <server_name> \
--resource-group <resource_group_name> \
--rule-name <rule_name> \
--start-ip-address <start_ip> \
--end-ip-address <end_ip>

# Update Rule
az mysql flexible-server firewall-rule update \
--name <server_name> \
--resource-group <resource_group_name> \
--rule-name <rule_name> \
--start-ip-address <start_ip> \
--end-ip-address <end_ip>
```
### `Microsoft.DBforMySQL/flexibleServers/resetGtid/action`

Dzięki temu uprawnieniu możesz zresetować GTID (Global Transaction Identifier) dla instancji MySQL Flexible Server na Azure. Resetowanie GTID unieważni wszystkie automatyczne, na żądanie kopie zapasowe oraz geo-kopie zapasowe, które zostały wykonane przed akcją resetu. Po resecie GTID nie będziesz mógł przeprowadzić PITR (przywracania do punktu w czasie) za pomocą najszybszego punktu przywracania lub przez niestandardowy punkt przywracania, jeśli wybrany czas przywracania jest przed czasem resetu GTID. A udane geo-przywracanie będzie możliwe dopiero po 5 dniach.
```bash
az mysql flexible-server reset-gtid \
--name  \
--resource-group <resource_group_name> \
--gtid-set <gtid>
```
### `Microsoft.DBforMySQL/flexibleServers/updateConfigurations/action`

Dzięki temu uprawnieniu możesz zaktualizować ustawienia konfiguracyjne instancji MySQL Flexible Server na Azure. Umożliwia to dostosowanie parametrów serwera, takich jak optymalizacja wydajności, konfiguracje bezpieczeństwa lub ustawienia operacyjne. Możesz zaktualizować następujące parametry razem w partii: audit_log_enabled, audit_log_events, binlog_expire_logs_seconds, binlog_row_image, character_set_server, collation_server, connect_timeout, enforce_gtid_consistency, gtid_mode, init_connect, innodb_buffer_pool_size, innodb_io_capacity, innodb_io_capacity_max, innodb_purge_threads, innodb_read_io_threads, innodb_thread_concurrency, innodb_write_io_threads, long_query_time, max_connect_errors oraz max_connections.
```bash
az mysql flexible-server parameter set-batch \
--resource-group <resource_group_name> \
--server-name <server_name> \
--args max_connections=<value>
```
### `Microsoft.DBforMySQL/flexibleServers/read`, `Microsoft.DBforMySQL/flexibleServers/write` && `Microsoft.ManagedIdentity/userAssignedIdentities/assign/action`

Dzięki temu uprawnieniu możesz przypisać zarządzaną tożsamość przypisaną do użytkownika do elastycznych serwerów MySQL.
```bash
az mysql flexible-server identity assign \
--resource-group <ResourceGroupName> \
--server-name <ServerName> \
--identity <IdentityName>
```
### `Microsoft.DBforMySQL/flexibleServers/stop/action`

Dzięki temu uprawnieniu możesz zatrzymać instancję PostgreSQL Flexible Server na Azure. Zatrzymanie serwera może prowadzić do tymczasowych zakłóceń w działaniu usługi, wpływając na aplikacje i użytkowników zależnych od bazy danych.
```bash
az mysql flexible-server stop \
--name <server_name> \
--resource-group <resource_group_name>
```

### `Microsoft.DBforMySQL/flexibleServers/start/action`
With this permission, you can start a stopped PostgreSQL Flexible Server instance on Azure. Starting a server restores its availability, enabling applications and users to reconnect and access the database.

```bash
az mysql flexible-server start \
--name <server_name> \
--resource-group <resource_group_name>
```

### `*/delete`

With this permissions you can delete resources related to mysql server in Azure such as server, firewalls, managed identities or configurations

{{#include ../../../banners/hacktricks-training.md}}
