# Az - MySQL Post Exploitation

{{#include ../../../banners/hacktricks-training.md}}

## MySQL 데이터베이스 포스트 익스플로이테이션
MySQL 데이터베이스에 대한 자세한 정보는 다음을 확인하세요:

{% content-ref url="../az-services/az-mysql.md" %}
[az-mysql.md](../az-services/az-mysql.md)
{% endcontent-ref %}

### "Microsoft.DBforMySQL/flexibleServers/databases/write" && "Microsoft.DBforMySQL/flexibleServers/databases/read"

이 권한을 사용하면 Azure의 MySQL Flexible Server 인스턴스 내에서 새로운 데이터베이스를 생성할 수 있습니다. 이 작업 자체는 기존 리소스를 수정하지 않지만, 과도하거나 무단으로 데이터베이스를 생성하면 리소스 소비 또는 서버의 잠재적 오용으로 이어질 수 있습니다.

{% code overflow="wrap" %}
```bash
az mysql flexible-server db create \
--server-name <server_name> \
--resource-group <resource_group_name> \
--database-name <database_name>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/backups/write"

이 권한을 사용하면 Azure에서 MySQL Flexible Server 인스턴스의 백업 생성을 시작할 수 있습니다. 이를 통해 사용자는 특정 시점에 데이터를 보존하는 데 유용한 온디맨드 백업을 생성할 수 있습니다.

{% code overflow="wrap" %}
```bash
az mysql flexible-server backup create \
--name <server_name> \
--resource-group <resource_group_name>
--backup-name <backup_name>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/advancedThreatProtectionSettings/write"

이 권한을 사용하면 Azure의 MySQL Flexible Server 인스턴스에 대한 Advanced Threat Protection (ATP) 설정을 구성하거나 업데이트할 수 있습니다. 이를 통해 비정상적인 활동 및 잠재적 위협을 감지하고 대응하기 위해 설계된 보안 기능을 활성화하거나 비활성화할 수 있습니다.

{% code overflow="wrap" %}
```bash
az mysql flexible-server threat-protection-policy update \
--name <server_name> \
--resource-group <resource_group_name> \
--state <Enabled|Disabled>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/firewallRules/write"

이 권한을 사용하면 Azure의 MySQL Flexible Server 인스턴스에 대한 방화벽 규칙을 생성하거나 수정할 수 있습니다. 이를 통해 어떤 IP 주소 또는 범위가 서버에 접근할 수 있는지를 제어할 수 있습니다. 이 권한의 무단 또는 부적절한 사용은 서버를 원치 않거나 악의적인 접근에 노출시킬 수 있습니다.

{% code overflow="wrap" %}
```bash
# Create Rule
az mysql flexible-server firewall-rule create \
--name <server_name> \
--resource-group <resource_group_name> \
--rule-name <rule_name> \
--start-ip-address <start_ip> \
--end-ip-address <end_ip>

# Update Rule
az mysql flexible-server firewall-rule update \
--name <server_name> \
--resource-group <resource_group_name> \
--rule-name <rule_name> \
--start-ip-address <start_ip> \
--end-ip-address <end_ip>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/resetGtid/action"

이 권한을 사용하면 Azure의 MySQL Flexible Server 인스턴스에 대한 GTID(전역 트랜잭션 식별자)를 재설정할 수 있습니다. GTID를 재설정하면 재설정 작업 이전에 수행된 모든 자동화된 온디맨드 백업 및 지리적 백업이 무효화됩니다. GTID 재설정 후, 선택한 복원 시간이 GTID 재설정 시간 이전인 경우 가장 빠른 복원 지점이나 사용자 지정 복원 지점을 사용하여 PITR(시점 복원)를 수행할 수 없습니다. 성공적인 지리적 복원은 5일 후에만 가능합니다.

{% code overflow="wrap" %}
```bash
az mysql flexible-server reset-gtid \
--name  \
--resource-group <resource_group_name> \
--gtid-set <gtid>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/updateConfigurations/action"

이 권한을 사용하면 Azure에서 MySQL Flexible Server 인스턴스의 구성 설정을 업데이트할 수 있습니다. 이를 통해 성능 조정, 보안 구성 또는 운영 설정과 같은 서버 매개변수를 사용자 정의할 수 있습니다. 다음 매개변수를 함께 배치로 업데이트할 수 있습니다: audit_log_enabled, audit_log_events, binlog_expire_logs_seconds, binlog_row_image, character_set_server, collation_server, connect_timeout, enforce_gtid_consistency, gtid_mode, init_connect, innodb_buffer_pool_size, innodb_io_capacity, innodb_io_capacity_max, innodb_purge_threads, innodb_read_io_threads, innodb_thread_concurrency, innodb_write_io_threads, long_query_time, max_connect_errors, 및 max_connections.

{% code overflow="wrap" %}
```bash
az mysql flexible-server parameter set-batch \
--resource-group <resource_group_name> \
--server-name <server_name> \
--args max_connections=<value>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/read", "Microsoft.DBforMySQL/flexibleServers/write" && "Microsoft.ManagedIdentity/userAssignedIdentities/assign/action"

이 권한을 사용하면 MySQL 유연 서버에 사용자 지정 관리 ID를 할당할 수 있습니다.

{% code overflow="wrap" %}
```bash
az mysql flexible-server identity assign \
--resource-group <ResourceGroupName> \
--server-name <ServerName> \
--identity <IdentityName>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/stop/action"

이 권한을 사용하면 Azure에서 PostgreSQL Flexible Server 인스턴스를 중지할 수 있습니다. 서버를 중지하면 데이터베이스에 의존하는 애플리케이션과 사용자에게 영향을 미치는 일시적인 서비스 중단이 발생할 수 있습니다.

{% code overflow="wrap" %}
```bash
az mysql flexible-server stop \
--name <server_name> \
--resource-group <resource_group_name>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/start/action"
With this permission, you can start a stopped PostgreSQL Flexible Server instance on Azure. Starting a server restores its availability, enabling applications and users to reconnect and access the database.

{% code overflow="wrap" %}
```bash
az mysql flexible-server start \
--name <server_name> \
--resource-group <resource_group_name>
```
{% endcode %}

### "*/delete"

With this permissions you can delete resources related to mysql server in Azure such as server, firewalls, managed identities or configurations

{{#include ../../../banners/hacktricks-training.md}}
