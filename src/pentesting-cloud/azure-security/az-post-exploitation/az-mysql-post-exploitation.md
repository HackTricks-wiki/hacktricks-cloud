# Az - MySQL Post Exploitation

{% hint style="success" %}
Ucz siÄ™ i Ä‡wicz Hacking AWS:<img src="../../../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">\
Ucz siÄ™ i Ä‡wicz Hacking GCP: <img src="../../../.gitbook/assets/image (2) (1).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2) (1).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie HackTricks</summary>

* SprawdÅº [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegram**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ trikami hackingowymi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriÃ³w github.

</details>
{% endhint %}

## MySQL Database Post Exploitation
Aby uzyskaÄ‡ wiÄ™cej informacji o bazie danych MySQL, sprawdÅº:

{% content-ref url="../az-services/az-mysql.md" %}
[az-mysql.md](../az-services/az-mysql.md)
{% endcontent-ref %}

### "Microsoft.DBforMySQL/flexibleServers/databases/write" && "Microsoft.DBforMySQL/flexibleServers/databases/read"

DziÄ™ki temu uprawnieniu moÅ¼esz tworzyÄ‡ nowe bazy danych w instancji MySQL Flexible Server na Azure. ChociaÅ¼ sama ta akcja nie modyfikuje istniejÄ…cych zasobÃ³w, nadmierne lub nieautoryzowane tworzenie baz danych moÅ¼e prowadziÄ‡ do zuÅ¼ycia zasobÃ³w lub potencjalnego naduÅ¼ycia serwera.

{% code overflow="wrap" %}
```bash
az mysql flexible-server db create \
--server-name <server_name> \
--resource-group <resource_group_name> \
--database-name <database_name>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/backups/write"

DziÄ™ki temu uprawnieniu moÅ¼esz zainicjowaÄ‡ tworzenie kopii zapasowych dla instancji MySQL Flexible Server na Azure. UmoÅ¼liwia to uÅ¼ytkownikom generowanie kopii zapasowych na Å¼Ä…danie, co moÅ¼e byÄ‡ przydatne do zachowania danych w okreÅ›lonych momentach w czasie.

{% code overflow="wrap" %}
```bash
az mysql flexible-server backup create \
--name <server_name> \
--resource-group <resource_group_name>
--backup-name <backup_name>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/advancedThreatProtectionSettings/write"

DziÄ™ki temu uprawnieniu moÅ¼esz skonfigurowaÄ‡ lub zaktualizowaÄ‡ ustawienia Advanced Threat Protection (ATP) dla instancji MySQL Flexible Server na Azure. UmoÅ¼liwia to wÅ‚Ä…czenie lub wyÅ‚Ä…czenie funkcji zabezpieczeÅ„ zaprojektowanych w celu wykrywania i reagowania na anomalne dziaÅ‚ania oraz potencjalne zagroÅ¼enia.

{% code overflow="wrap" %}
```bash
az mysql flexible-server threat-protection-policy update \
--name <server_name> \
--resource-group <resource_group_name> \
--state <Enabled|Disabled>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/firewallRules/write"

DziÄ™ki temu uprawnieniu moÅ¼esz tworzyÄ‡ lub modyfikowaÄ‡ reguÅ‚y zapory dla instancji MySQL Flexible Server na Azure. UmoÅ¼liwia to kontrolowanie, ktÃ³re adresy IP lub zakresy mogÄ… uzyskiwaÄ‡ dostÄ™p do serwera. Nieautoryzowane lub niewÅ‚aÅ›ciwe uÅ¼ycie tego uprawnienia moÅ¼e naraziÄ‡ serwer na niepoÅ¼Ä…dany lub zÅ‚oÅ›liwy dostÄ™p.

{% code overflow="wrap" %}
```bash
# Create Rule
az mysql flexible-server firewall-rule create \
--name <server_name> \
--resource-group <resource_group_name> \
--rule-name <rule_name> \
--start-ip-address <start_ip> \
--end-ip-address <end_ip>

# Update Rule
az mysql flexible-server firewall-rule update \
--name <server_name> \
--resource-group <resource_group_name> \
--rule-name <rule_name> \
--start-ip-address <start_ip> \
--end-ip-address <end_ip>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/resetGtid/action"

DziÄ™ki temu uprawnieniu moÅ¼esz zresetowaÄ‡ GTID (Global Transaction Identifier) dla instancji MySQL Flexible Server na Azure. Resetowanie GTID uniewaÅ¼ni wszystkie automatyczne, na Å¼Ä…danie kopie zapasowe oraz geo-kopie zapasowe, ktÃ³re zostaÅ‚y wykonane przed akcjÄ… resetu. Po resecie GTID nie bÄ™dziesz mÃ³gÅ‚ przeprowadziÄ‡ PITR (przywracania do punktu w czasie) za pomocÄ… najszybszego punktu przywracania lub przez niestandardowy punkt przywracania, jeÅ›li wybrany czas przywracania jest przed czasem resetu GTID. A udane geo-przywracanie bÄ™dzie moÅ¼liwe dopiero po 5 dniach.

{% code overflow="wrap" %}
```bash
az mysql flexible-server reset-gtid \
--name  \
--resource-group <resource_group_name> \
--gtid-set <gtid>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/updateConfigurations/action"

DziÄ™ki temu uprawnieniu moÅ¼esz zaktualizowaÄ‡ ustawienia konfiguracyjne instancji MySQL Flexible Server na Azure. UmoÅ¼liwia to dostosowanie parametrÃ³w serwera, takich jak optymalizacja wydajnoÅ›ci, konfiguracje bezpieczeÅ„stwa lub ustawienia operacyjne. MoÅ¼esz zaktualizowaÄ‡ nastÄ™pujÄ…ce parametry razem w partii: audit_log_enabled, audit_log_events, binlog_expire_logs_seconds, binlog_row_image, character_set_server, collation_server, connect_timeout, enforce_gtid_consistency, gtid_mode, init_connect, innodb_buffer_pool_size, innodb_io_capacity, innodb_io_capacity_max, innodb_purge_threads, innodb_read_io_threads, innodb_thread_concurrency, innodb_write_io_threads, long_query_time, max_connect_errors oraz max_connections.

{% code overflow="wrap" %}
```bash
az mysql flexible-server parameter set-batch \
--resource-group <resource_group_name> \
--server-name <server_name> \
--args max_connections=<value>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/read", "Microsoft.DBforMySQL/flexibleServers/write" && "Microsoft.ManagedIdentity/userAssignedIdentities/assign/action"

DziÄ™ki temu uprawnieniu moÅ¼esz przypisaÄ‡ zarzÄ…dzanÄ… toÅ¼samoÅ›Ä‡ przypisanÄ… do uÅ¼ytkownika do elastycznych serwerÃ³w MySQL.

{% code overflow="wrap" %}
```bash
az mysql flexible-server identity assign \
--resource-group <ResourceGroupName> \
--server-name <ServerName> \
--identity <IdentityName>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/stop/action"

DziÄ™ki temu uprawnieniu moÅ¼esz zatrzymaÄ‡ instancjÄ™ PostgreSQL Flexible Server na Azure. Zatrzymanie serwera moÅ¼e prowadziÄ‡ do tymczasowych zakÅ‚Ã³ceÅ„ w dziaÅ‚aniu usÅ‚ug, wpÅ‚ywajÄ…c na aplikacje i uÅ¼ytkownikÃ³w zaleÅ¼nych od bazy danych.

{% code overflow="wrap" %}
```bash
az mysql flexible-server stop \
--name <server_name> \
--resource-group <resource_group_name>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/start/action"
With this permission, you can start a stopped PostgreSQL Flexible Server instance on Azure. Starting a server restores its availability, enabling applications and users to reconnect and access the database.

{% code overflow="wrap" %}
```bash
az mysql flexible-server start \
--name <server_name> \
--resource-group <resource_group_name>
```
{% endcode %}

### "*/delete"

With this permissions you can delete resources related to mysql server in Azure such as server, firewalls, managed identities or configurations

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2) (1).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2) (1).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
