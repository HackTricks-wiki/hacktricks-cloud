# Az - MySQL Post Exploitation

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="../../../.gitbook/assets/image (2) (1).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2) (1).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>
{% endhint %}

## MySQL Database Post Exploitation
–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ MySQL Database –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ:

{% content-ref url="../az-services/az-mysql.md" %}
[az-mysql.md](../az-services/az-mysql.md)
{% endcontent-ref %}

### "Microsoft.DBforMySQL/flexibleServers/databases/write" && "Microsoft.DBforMySQL/flexibleServers/databases/read"

–ó —Ü–∏–º –¥–æ–∑–≤–æ–ª–æ–º –≤–∏ –º–æ–∂–µ—Ç–µ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –Ω–æ–≤—ñ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö —É MySQL Flexible Server –Ω–∞ Azure. –•–æ—á–∞ —Ü—è –¥—ñ—è —Å–∞–º–∞ –ø–æ —Å–æ–±—ñ –Ω–µ –∑–º—ñ–Ω—é—î —ñ—Å–Ω—É—é—á—ñ —Ä–µ—Å—É—Ä—Å–∏, –Ω–∞–¥–º—ñ—Ä–Ω–µ –∞–±–æ –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–µ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –±–∞–∑ –¥–∞–Ω–∏—Ö –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤ –∞–±–æ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ–≥–æ –∑–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è —Å–µ—Ä–≤–µ—Ä–æ–º.

{% code overflow="wrap" %}
```bash
az mysql flexible-server db create \
--server-name <server_name> \
--resource-group <resource_group_name> \
--database-name <database_name>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/backups/write"

–ó —Ü—ñ—î—é –¥–æ–∑–≤–æ–ª–æ–º –≤–∏ –º–æ–∂–µ—Ç–µ —ñ–Ω—ñ—Ü—ñ—é–≤–∞—Ç–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ä–µ–∑–µ—Ä–≤–Ω–∏—Ö –∫–æ–ø—ñ–π –¥–ª—è –µ–∫–∑–µ–º–ø–ª—è—Ä–∞ MySQL Flexible Server –Ω–∞ Azure. –¶–µ –¥–æ–∑–≤–æ–ª—è—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º –≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Ä–µ–∑–µ—Ä–≤–Ω—ñ –∫–æ–ø—ñ—ó –∑–∞ –∑–∞–ø–∏—Ç–æ–º, —â–æ –º–æ–∂–µ –±—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–∏–º –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —É –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ –º–æ–º–µ–Ω—Ç–∏ —á–∞—Å—É.

{% code overflow="wrap" %}
```bash
az mysql flexible-server backup create \
--name <server_name> \
--resource-group <resource_group_name>
--backup-name <backup_name>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/advancedThreatProtectionSettings/write"

–ó —Ü—ñ—î—é –¥–æ–∑–≤–æ–ª–æ–º –≤–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –∞–±–æ –æ–Ω–æ–≤–∏—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ Advanced Threat Protection (ATP) –¥–ª—è –µ–∫–∑–µ–º–ø–ª—è—Ä–∞ MySQL Flexible Server –Ω–∞ Azure. –¶–µ –¥–æ–∑–≤–æ–ª—è—î —É–≤—ñ–º–∫–Ω—É—Ç–∏ –∞–±–æ –≤–∏–º–∫–Ω—É—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—ó –±–µ–∑–ø–µ–∫–∏, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—ñ –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è —Ç–∞ —Ä–µ–∞–≥—É–≤–∞–Ω–Ω—è –Ω–∞ –∞–Ω–æ–º–∞–ª—å–Ω—ñ –¥—ñ—ó —Ç–∞ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ –∑–∞–≥—Ä–æ–∑–∏.

{% code overflow="wrap" %}
```bash
az mysql flexible-server threat-protection-policy update \
--name <server_name> \
--resource-group <resource_group_name> \
--state <Enabled|Disabled>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/firewallRules/write"

–ó —Ü—ñ—î—é –¥–æ–∑–≤–æ–ª–æ–º –≤–∏ –º–æ–∂–µ—Ç–µ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –∞–±–æ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª–∞ –±—Ä–∞–Ω–¥–º–∞—É–µ—Ä–∞ –¥–ª—è –µ–∫–∑–µ–º–ø–ª—è—Ä–∞ MySQL Flexible Server –Ω–∞ Azure. –¶–µ –¥–æ–∑–≤–æ–ª—è—î –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏, —è–∫—ñ IP-–∞–¥—Ä–µ—Å–∏ –∞–±–æ –¥—ñ–∞–ø–∞–∑–æ–Ω–∏ –º–æ–∂—É—Ç—å –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Å–µ—Ä–≤–µ—Ä–∞. –ù–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–µ –∞–±–æ –Ω–µ–Ω–∞–ª–µ–∂–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ü—å–æ–≥–æ –¥–æ–∑–≤–æ–ª—É –º–æ–∂–µ –ø—ñ–¥–¥–∞—Ç–∏ —Å–µ—Ä–≤–µ—Ä –Ω–µ–±–∞–∂–∞–Ω–æ–º—É –∞–±–æ —à–∫—ñ–¥–ª–∏–≤–æ–º—É –¥–æ—Å—Ç—É–ø—É.

{% code overflow="wrap" %}
```bash
# Create Rule
az mysql flexible-server firewall-rule create \
--name <server_name> \
--resource-group <resource_group_name> \
--rule-name <rule_name> \
--start-ip-address <start_ip> \
--end-ip-address <end_ip>

# Update Rule
az mysql flexible-server firewall-rule update \
--name <server_name> \
--resource-group <resource_group_name> \
--rule-name <rule_name> \
--start-ip-address <start_ip> \
--end-ip-address <end_ip>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/resetGtid/action"

–ó —Ü—ñ—î—é –¥–æ–∑–≤–æ–ª–æ–º –≤–∏ –º–æ–∂–µ—Ç–µ —Å–∫–∏–Ω—É—Ç–∏ GTID (–ì–ª–æ–±–∞–ª—å–Ω–∏–π –Ü–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó) –¥–ª—è –µ–∫–∑–µ–º–ø–ª—è—Ä–∞ MySQL Flexible Server –Ω–∞ Azure. –°–∫–∏–¥–∞–Ω–Ω—è GTID –∑—Ä–æ–±–∏—Ç—å –Ω–µ–¥—ñ–π—Å–Ω–∏–º–∏ –≤—Å—ñ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω—ñ, –∑–∞ –∑–∞–ø–∏—Ç–æ–º —Ä–µ–∑–µ—Ä–≤–Ω—ñ –∫–æ–ø—ñ—ó —Ç–∞ –≥–µ–æ-—Ä–µ–∑–µ—Ä–≤–Ω—ñ –∫–æ–ø—ñ—ó, —è–∫—ñ –±—É–ª–∏ –∑—Ä–æ–±–ª–µ–Ω—ñ –¥–æ –¥—ñ—ó —Å–∫–∏–¥–∞–Ω–Ω—è. –ü—ñ—Å–ª—è —Å–∫–∏–¥–∞–Ω–Ω—è GTID –≤–∏ –Ω–µ –∑–º–æ–∂–µ—Ç–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ PITR (–≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –≤ —Ç–æ—á—Ü—ñ —á–∞—Å—É) –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –Ω–∞–π—à–≤–∏–¥—à–æ—ó —Ç–æ—á–∫–∏ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –∞–±–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–æ—ó —Ç–æ—á–∫–∏ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è, —è–∫—â–æ –≤–∏–±—Ä–∞–Ω–∏–π —á–∞—Å –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è —î –¥–æ —á–∞—Å—É —Å–∫–∏–¥–∞–Ω–Ω—è GTID. –Ü —É—Å–ø—ñ—à–Ω–µ –≥–µ–æ-–≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –±—É–¥–µ –º–æ–∂–ª–∏–≤–∏–º –ª–∏—à–µ —á–µ—Ä–µ–∑ 5 –¥–Ω—ñ–≤.

{% code overflow="wrap" %}
```bash
az mysql flexible-server reset-gtid \
--name  \
--resource-group <resource_group_name> \
--gtid-set <gtid>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/updateConfigurations/action"

–ó —Ü—ñ—î—é –¥–æ–∑–≤–æ–ª–æ–º –≤–∏ –º–æ–∂–µ—Ç–µ –æ–Ω–æ–≤–∏—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –µ–∫–∑–µ–º–ø–ª—è—Ä–∞ MySQL Flexible Server –Ω–∞ Azure. –¶–µ –¥–æ–∑–≤–æ–ª—è—î –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —Å–µ—Ä–≤–µ—Ä–∞, —Ç–∞–∫–∏—Ö —è–∫ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ, –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –±–µ–∑–ø–µ–∫–∏ –∞–±–æ –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è. –í–∏ –º–æ–∂–µ—Ç–µ –æ–Ω–æ–≤–∏—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ —Ä–∞–∑–æ–º —É –ø–∞–∫–µ—Ç–Ω–æ–º—É —Ä–µ–∂–∏–º—ñ: audit_log_enabled, audit_log_events, binlog_expire_logs_seconds, binlog_row_image, character_set_server, collation_server, connect_timeout, enforce_gtid_consistency, gtid_mode, init_connect, innodb_buffer_pool_size, innodb_io_capacity, innodb_io_capacity_max, innodb_purge_threads, innodb_read_io_threads, innodb_thread_concurrency, innodb_write_io_threads, long_query_time, max_connect_errors, —ñ max_connections.

{% code overflow="wrap" %}
```bash
az mysql flexible-server parameter set-batch \
--resource-group <resource_group_name> \
--server-name <server_name> \
--args max_connections=<value>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/read", "Microsoft.DBforMySQL/flexibleServers/write" && "Microsoft.ManagedIdentity/userAssignedIdentities/assign/action"

–ó —Ü—ñ—î—é –¥–æ–∑–≤–æ–ª–æ–º –≤–∏ –º–æ–∂–µ—Ç–µ –ø—Ä–∏–∑–Ω–∞—á–∏—Ç–∏ –∫–µ—Ä–æ–≤–∞–Ω—É —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º, –¥–ª—è –≥–Ω—É—á–∫–∏—Ö —Å–µ—Ä–≤–µ—Ä—ñ–≤ MySQL.

{% code overflow="wrap" %}
```bash
az mysql flexible-server identity assign \
--resource-group <ResourceGroupName> \
--server-name <ServerName> \
--identity <IdentityName>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/stop/action"

–ó —Ü—ñ—î—é –¥–æ–∑–≤–æ–ª–æ–º –≤–∏ –º–æ–∂–µ—Ç–µ –∑—É–ø–∏–Ω–∏—Ç–∏ –µ–∫–∑–µ–º–ø–ª—è—Ä PostgreSQL Flexible Server –Ω–∞ Azure. –ó—É–ø–∏–Ω–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ —Ç–∏–º—á–∞—Å–æ–≤–æ–≥–æ –ø–µ—Ä–µ—Ä–∏–≤–∞–Ω–Ω—è –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—è, —â–æ –≤–ø–ª–∏–Ω–µ –Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–∏ —Ç–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, —è–∫—ñ –∑–∞–ª–µ–∂–∞—Ç—å –≤—ñ–¥ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö.

{% code overflow="wrap" %}
```bash
az mysql flexible-server stop \
--name <server_name> \
--resource-group <resource_group_name>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/start/action"
With this permission, you can start a stopped PostgreSQL Flexible Server instance on Azure. Starting a server restores its availability, enabling applications and users to reconnect and access the database.

{% code overflow="wrap" %}
```bash
az mysql flexible-server start \
--name <server_name> \
--resource-group <resource_group_name>
```
{% endcode %}

### "*/delete"

With this permissions you can delete resources related to mysql server in Azure such as server, firewalls, managed identities or configurations

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2) (1).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2) (1).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
