# Az - MySQL Post Exploitation

{{#include ../../../banners/hacktricks-training.md}}

## MySQL Database Post Exploitation
Για περισσότερες πληροφορίες σχετικά με τη βάση δεδομένων MySQL, ελέγξτε:

{% content-ref url="../az-services/az-mysql.md" %}
[az-mysql.md](../az-services/az-mysql.md)
{% endcontent-ref %}

### "Microsoft.DBforMySQL/flexibleServers/databases/write" && "Microsoft.DBforMySQL/flexibleServers/databases/read"

Με αυτή την άδεια, μπορείτε να δημιουργήσετε νέες βάσεις δεδομένων εντός μιας MySQL Flexible Server instance στο Azure. Ενώ αυτή η ενέργεια από μόνη της δεν τροποποιεί υπάρχοντες πόρους, η υπερβολική ή μη εξουσιοδοτημένη δημιουργία βάσεων δεδομένων θα μπορούσε να οδηγήσει σε κατανάλωση πόρων ή πιθανή κακή χρήση του διακομιστή.

{% code overflow="wrap" %}
```bash
az mysql flexible-server db create \
--server-name <server_name> \
--resource-group <resource_group_name> \
--database-name <database_name>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/backups/write"

Με αυτή την άδεια, μπορείτε να ξεκινήσετε τη δημιουργία αντιγράφων ασφαλείας για μια MySQL Flexible Server instance στο Azure. Αυτό επιτρέπει στους χρήστες να δημιουργούν αντίγραφα ασφαλείας κατ' απαίτηση, τα οποία μπορεί να είναι χρήσιμα για τη διατήρηση δεδομένων σε συγκεκριμένες χρονικές στιγμές.

{% code overflow="wrap" %}
```bash
az mysql flexible-server backup create \
--name <server_name> \
--resource-group <resource_group_name>
--backup-name <backup_name>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/advancedThreatProtectionSettings/write"

Με αυτή την άδεια, μπορείτε να ρυθμίσετε ή να ενημερώσετε τις ρυθμίσεις Προηγμένης Προστασίας από Απειλές (ATP) για μια MySQL Flexible Server instance στο Azure. Αυτό επιτρέπει την ενεργοποίηση ή απενεργοποίηση χαρακτηριστικών ασφαλείας που έχουν σχεδιαστεί για να ανιχνεύουν και να ανταποκρίνονται σε ανώμαλες δραστηριότητες και πιθανές απειλές.

{% code overflow="wrap" %}
```bash
az mysql flexible-server threat-protection-policy update \
--name <server_name> \
--resource-group <resource_group_name> \
--state <Enabled|Disabled>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/firewallRules/write"

Με αυτή την άδεια, μπορείτε να δημιουργήσετε ή να τροποποιήσετε κανόνες τείχους προστασίας για μια MySQL Flexible Server instance στο Azure. Αυτό επιτρέπει τον έλεγχο ποιοι διευθύνσεις IP ή εύρη μπορούν να έχουν πρόσβαση στον διακομιστή. Η μη εξουσιοδοτημένη ή ακατάλληλη χρήση αυτής της άδειας θα μπορούσε να εκθέσει τον διακομιστή σε ανεπιθύμητη ή κακόβουλη πρόσβαση.

{% code overflow="wrap" %}
```bash
# Create Rule
az mysql flexible-server firewall-rule create \
--name <server_name> \
--resource-group <resource_group_name> \
--rule-name <rule_name> \
--start-ip-address <start_ip> \
--end-ip-address <end_ip>

# Update Rule
az mysql flexible-server firewall-rule update \
--name <server_name> \
--resource-group <resource_group_name> \
--rule-name <rule_name> \
--start-ip-address <start_ip> \
--end-ip-address <end_ip>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/resetGtid/action"

Με αυτή την άδεια, μπορείτε να επαναφέρετε το GTID (Global Transaction Identifier) για μια MySQL Flexible Server instance στο Azure. Η επαναφορά του GTID θα ακυρώσει όλα τα αυτοματοποιημένα, κατά παραγγελία αντίγραφα ασφαλείας και γεωγραφικά αντίγραφα ασφαλείας που ελήφθησαν πριν από την ενέργεια επαναφοράς. Μετά την επαναφορά του GTID, δεν θα μπορείτε να εκτελέσετε PITR (point-in-time-restore) χρησιμοποιώντας το ταχύτερο σημείο αποκατάστασης ή μέσω προσαρμοσμένου σημείου αποκατάστασης αν ο επιλεγμένος χρόνος αποκατάστασης είναι πριν από την ώρα επαναφοράς του GTID. Και η επιτυχής γεωγραφική αποκατάσταση θα είναι δυνατή μόνο μετά από 5 ημέρες.

{% code overflow="wrap" %}
```bash
az mysql flexible-server reset-gtid \
--name  \
--resource-group <resource_group_name> \
--gtid-set <gtid>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/updateConfigurations/action"

Με αυτή την άδεια, μπορείτε να ενημερώσετε τις ρυθμίσεις διαμόρφωσης μιας MySQL Flexible Server instance στο Azure. Αυτό επιτρέπει την προσαρμογή παραμέτρων του διακομιστή όπως η βελτιστοποίηση απόδοσης, οι ρυθμίσεις ασφαλείας ή οι λειτουργικές ρυθμίσεις. Μπορείτε να ενημερώσετε τις παρακάτω παραμέτρους μαζί σε μια παρτίδα: audit_log_enabled, audit_log_events, binlog_expire_logs_seconds, binlog_row_image, character_set_server, collation_server, connect_timeout, enforce_gtid_consistency, gtid_mode, init_connect, innodb_buffer_pool_size, innodb_io_capacity, innodb_io_capacity_max, innodb_purge_threads, innodb_read_io_threads, innodb_thread_concurrency, innodb_write_io_threads, long_query_time, max_connect_errors, και max_connections.

{% code overflow="wrap" %}
```bash
az mysql flexible-server parameter set-batch \
--resource-group <resource_group_name> \
--server-name <server_name> \
--args max_connections=<value>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/read", "Microsoft.DBforMySQL/flexibleServers/write" && "Microsoft.ManagedIdentity/userAssignedIdentities/assign/action"

Με αυτή την άδεια, μπορείτε να αναθέσετε μια διαχειριζόμενη ταυτότητα που έχει ανατεθεί από τον χρήστη στους ευέλικτους διακομιστές MySQL.

{% code overflow="wrap" %}
```bash
az mysql flexible-server identity assign \
--resource-group <ResourceGroupName> \
--server-name <ServerName> \
--identity <IdentityName>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/stop/action"

Με αυτή την άδεια, μπορείτε να σταματήσετε μια PostgreSQL Flexible Server instance στο Azure. Η διακοπή ενός διακομιστή μπορεί να οδηγήσει σε προσωρινή διακοπή υπηρεσίας, επηρεάζοντας τις εφαρμογές και τους χρήστες που εξαρτώνται από τη βάση δεδομένων.

{% code overflow="wrap" %}
```bash
az mysql flexible-server stop \
--name <server_name> \
--resource-group <resource_group_name>
```
{% endcode %}

### "Microsoft.DBforMySQL/flexibleServers/start/action"
With this permission, you can start a stopped PostgreSQL Flexible Server instance on Azure. Starting a server restores its availability, enabling applications and users to reconnect and access the database.

{% code overflow="wrap" %}
```bash
az mysql flexible-server start \
--name <server_name> \
--resource-group <resource_group_name>
```
{% endcode %}

### "*/delete"

With this permissions you can delete resources related to mysql server in Azure such as server, firewalls, managed identities or configurations

{{#include ../../../banners/hacktricks-training.md}}
