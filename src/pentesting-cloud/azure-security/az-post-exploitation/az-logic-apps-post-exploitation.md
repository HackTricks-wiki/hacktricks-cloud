# Az - Logic Apps Post Exploitation

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="../../../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="../../../.gitbook/assets/image (2) (1).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2) (1).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}

## Logic Apps ë°ì´í„°ë² ì´ìŠ¤ í¬ìŠ¤íŠ¸ ìµìŠ¤í”Œë¡œì´í…Œì´ì…˜
Logic Appsì— ëŒ€í•œ ìì„¸í•œ ì •ë³´ëŠ” ë‹¤ìŒì„ í™•ì¸í•˜ì„¸ìš”:

{% content-ref url="../az-services/az-logic-apps.md" %}
[az-logic-apps.md](../az-services/az-logic-apps.md)
{% endcontent-ref %}

### "Microsoft.Logic/workflows/read", "Microsoft.Logic/workflows/write" && "Microsoft.ManagedIdentity/userAssignedIdentities/assign/action"
ì´ ê¶Œí•œì„ ì‚¬ìš©í•˜ë©´ Logic App ì›Œí¬í”Œë¡œë¥¼ ìˆ˜ì •í•˜ê³  í•´ë‹¹ IDë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. êµ¬ì²´ì ìœ¼ë¡œ, ì‹œìŠ¤í…œ í• ë‹¹ ë° ì‚¬ìš©ì í• ë‹¹ ê´€ë¦¬ IDë¥¼ ì›Œí¬í”Œë¡œì— í• ë‹¹í•˜ê±°ë‚˜ ì œê±°í•  ìˆ˜ ìˆìœ¼ë©°, ì´ë¥¼ í†µí•´ Logic Appì´ ëª…ì‹œì ì¸ ìê²© ì¦ëª… ì—†ì´ ë‹¤ë¥¸ Azure ë¦¬ì†ŒìŠ¤ì— ì¸ì¦í•˜ê³  ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% code overflow="wrap" %}
```bash
az logic workflow identity remove/assign \
--name <workflow_name> \
--resource-group <resource_group_name> \
--system-assigned true \
--user-assigned "/subscriptions/<subscription_id>/resourceGroups/<resource_group>/providers/Microsoft.ManagedIdentity/userAssignedIdentities/<identity_name>"
```
{% endcode %}

### "Microsoft.Web/sites/read", "Microsoft.Web/sites/write"
ì´ ê¶Œí•œì„ ì‚¬ìš©í•˜ë©´ App Service Planì— í˜¸ìŠ¤íŒ…ëœ Logic Appsë¥¼ ìƒì„±í•˜ê±°ë‚˜ ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì—ëŠ” HTTPS ê°•ì œ ì ìš©ì„ í™œì„±í™”í•˜ê±°ë‚˜ ë¹„í™œì„±í™”í•˜ëŠ” ê²ƒê³¼ ê°™ì€ ì„¤ì •ì„ ìˆ˜ì •í•˜ëŠ” ê²ƒì´ í¬í•¨ë©ë‹ˆë‹¤.

{% code overflow="wrap" %}
```bash
az logicapp update \
--resource-group <resource_group_name> \
--name <logic_app_name> \
--set httpsOnly=false
```
{% endcode %}

### "Microsoft.Web/sites/stop/action", "Microsoft.Web/sites/start/action" || "Microsoft.Web/sites/restart/action"
ì´ ê¶Œí•œì„ ì‚¬ìš©í•˜ë©´ App Service Planì— í˜¸ìŠ¤íŒ…ëœ Logic Appsë¥¼ í¬í•¨í•˜ì—¬ ì›¹ ì•±ì„ ì‹œì‘/ì¤‘ì§€/ì¬ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì‘ì—…ì€ ì´ì „ì— ì¤‘ì§€ëœ ì•±ì´ ì˜¨ë¼ì¸ìœ¼ë¡œ ì „í™˜ë˜ê³  ê¸°ëŠ¥ì„ ì¬ê°œí•˜ë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤. ì´ëŠ” ì›Œí¬í”Œë¡œë¥¼ ë°©í•´í•˜ê±°ë‚˜ ì˜ë„í•˜ì§€ ì•Šì€ ì‘ì—…ì„ ìœ ë°œí•˜ê±°ë‚˜ Logic Appsë¥¼ ì˜ˆê¸°ì¹˜ ì•Šê²Œ ì‹œì‘, ì¤‘ì§€ ë˜ëŠ” ì¬ì‹œì‘í•˜ì—¬ ë‹¤ìš´íƒ€ì„ì„ ì´ˆë˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% code overflow="wrap" %}
```bash
az webapp start/stop/restart \
--name <logic_app_name> \
--resource-group <resource_group_name>
```
{% endcode %}


### "Microsoft.Web/sites/config/list/action", "Microsoft.Web/sites/read" && "Microsoft.Web/sites/config/write"

ì´ ê¶Œí•œì„ ì‚¬ìš©í•˜ë©´ App Service Planì— í˜¸ìŠ¤íŒ…ëœ Logic Appsë¥¼ í¬í•¨í•œ ì›¹ ì•±ì˜ ì„¤ì •ì„ êµ¬ì„±í•˜ê±°ë‚˜ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ì•± ì„¤ì •, ì—°ê²° ë¬¸ìì—´, ì¸ì¦ êµ¬ì„± ë“±ì„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% code overflow="wrap" %}
```bash
az logicapp config appsettings set \
--name <logic_app_name> \
--resource-group <resource_group_name> \
--settings "<key>=<value>"
```
{% endcode %}

### "Microsoft.Logic/integrationAccounts/write"
ì´ ê¶Œí•œì„ ì‚¬ìš©í•˜ë©´ Azure Logic Apps í†µí•© ê³„ì •ì„ ìƒì„±, ì—…ë°ì´íŠ¸ ë˜ëŠ” ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì—ëŠ” ë§µ, ìŠ¤í‚¤ë§ˆ, íŒŒíŠ¸ë„ˆ, ê³„ì•½ ë“±ê³¼ ê°™ì€ í†µí•© ê³„ì • ìˆ˜ì¤€ì˜ êµ¬ì„±ì„ ê´€ë¦¬í•˜ëŠ” ê²ƒì´ í¬í•¨ë©ë‹ˆë‹¤.

{% code overflow="wrap" %}
```bash
az logic integration-account create \
--resource-group <resource_group_name> \
--name <integration_account_name> \
--location <location> \
--sku <Standard|Free> \
--state Enabled
```
{% endcode %}

### "Microsoft.Resources/subscriptions/resourcegroups/read" && "Microsoft.Logic/integrationAccounts/batchConfigurations/write"

ì´ ê¶Œí•œì„ ì‚¬ìš©í•˜ë©´ Azure Logic Apps í†µí•© ê³„ì • ë‚´ì—ì„œ ë°°ì¹˜ êµ¬ì„±ì„ ìƒì„±í•˜ê±°ë‚˜ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë°°ì¹˜ êµ¬ì„±ì€ Logic Appsê°€ ë°°ì¹˜ ì²˜ë¦¬ë¥¼ ìœ„í•´ ìˆ˜ì‹  ë©”ì‹œì§€ë¥¼ ì²˜ë¦¬í•˜ê³  ê·¸ë£¹í™”í•˜ëŠ” ë°©ë²•ì„ ì •ì˜í•©ë‹ˆë‹¤.

{% code overflow="wrap" %}
```bash
az logic integration-account batch-configuration create \
--resource-group <resource_group_name> \
--integration-account-name <integration_account_name> \
--name <batch_configuration_name> \
--release-criteria '{
"messageCount": 100,
"batchSize": 1048576,
}'
```
{% endcode %}

### "Microsoft.Resources/subscriptions/resourcegroups/read" && "Microsoft.Logic/integrationAccounts/maps/write"
ì´ ê¶Œí•œì„ ì‚¬ìš©í•˜ë©´ Azure Logic Apps í†µí•© ê³„ì • ë‚´ì—ì„œ ë§µì„ ìƒì„±í•˜ê±°ë‚˜ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë§µì€ ë°ì´í„°ë¥¼ í•œ í˜•ì‹ì—ì„œ ë‹¤ë¥¸ í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ë° ì‚¬ìš©ë˜ë©°, ì„œë¡œ ë‹¤ë¥¸ ì‹œìŠ¤í…œê³¼ ì• í”Œë¦¬ì¼€ì´ì…˜ ê°„ì˜ ì›í™œí•œ í†µí•©ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.

{% code overflow="wrap" %}
```bash
az logic integration-account map create \
--resource-group <resource_group_name> \
--integration-account-name <integration_account_name> \
--name <map_name> \
--map-type <Xslt|Xslt20|Xslt30> \
--content-type application/xml \
--map-content map-content.xslt
```
{% endcode %}

### "Microsoft.Resources/subscriptions/resourcegroups/read" && "Microsoft.Logic/integrationAccounts/partners/write"
ì´ ê¶Œí•œì„ ì‚¬ìš©í•˜ë©´ Azure Logic Apps í†µí•© ê³„ì •ì—ì„œ íŒŒíŠ¸ë„ˆë¥¼ ìƒì„±í•˜ê±°ë‚˜ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. íŒŒíŠ¸ë„ˆëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ê°„(B2B) ì›Œí¬í”Œë¡œì— ì°¸ì—¬í•˜ëŠ” ì—”í„°í‹° ë˜ëŠ” ì‹œìŠ¤í…œì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.

{% code overflow="wrap" %}
```bash
az logic integration-account partner create \
--resource-group <resource_group_name> \
--integration-account-name <integration_account_name> \
--name <partner_name> \
--partner-type <partner-type> \
--content '{
"b2b": {
"businessIdentities": [
{
"qualifier": "ZZ",
"value": "TradingPartner1"
}
]
}
}'
```
{% endcode %}

### "Microsoft.Resources/subscriptions/resourcegroups/read" && "Microsoft.Logic/integrationAccounts/sessions/write"
ì´ ê¶Œí•œì„ ì‚¬ìš©í•˜ë©´ Azure Logic Apps í†µí•© ê³„ì • ë‚´ì—ì„œ ì„¸ì…˜ì„ ìƒì„±í•˜ê±°ë‚˜ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì„¸ì…˜ì€ B2B ì›Œí¬í”Œë¡œìš°ì—ì„œ ë©”ì‹œì§€ë¥¼ ê·¸ë£¹í™”í•˜ê³  ì •ì˜ëœ ê¸°ê°„ ë™ì•ˆ ê´€ë ¨ ê±°ë˜ë¥¼ ì¶”ì í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.

{% code overflow="wrap" %}
```bash
az logic integration-account session create \
--resource-group <resource_group_name> \
--integration-account-name <integration_account_name> \
--name <session_name> \
--content '{
"properties": {
"sessionId": "session123",
"data": {
"key1": "value1",
"key2": "value2"
}
}
}'
```
{% endcode %}

### "*/delete"
ì´ ê¶Œí•œìœ¼ë¡œ Azure Logic Appsì™€ ê´€ë ¨ëœ ë¦¬ì†ŒìŠ¤ë¥¼ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="../../../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="../../../.gitbook/assets/image (2) (1).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2) (1).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}
