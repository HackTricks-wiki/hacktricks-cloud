# DO - Droplets

{{#include ../../../banners/hacktricks-training.md}}

## 기본 정보

DigitalOcean에서 "droplet"은 웹사이트와 애플리케이션을 호스팅하는 데 사용할 수 있는 v**irtual private server (VPS)**입니다. Droplet은 특정량의 CPU, 메모리 및 저장소를 포함하는 **사전 구성된 컴퓨팅 리소스 패키지**로, DigitalOcean의 클라우드 인프라에서 빠르고 쉽게 배포할 수 있습니다.

**일반 OS**에서 **이미 실행 중인 애플리케이션**(예: WordPress, cPanel, Laravel...)을 선택하거나 **자신의 이미지**를 업로드하여 사용할 수 있습니다.

Droplets는 **사용자 데이터 스크립트**를 지원합니다.

<details>

<summary>스냅샷과 백업의 차이</summary>

DigitalOcean에서 스냅샷은 Droplet의 디스크에 대한 시점 복사본입니다. 스냅샷이 찍힌 시점의 Droplet 디스크 상태를 캡처하며, 운영 체제, 설치된 애플리케이션 및 디스크의 모든 파일과 데이터를 포함합니다.

스냅샷은 원래 Droplet과 동일한 구성으로 새로운 Droplet을 생성하거나, 스냅샷이 찍힌 시점의 상태로 Droplet을 복원하는 데 사용할 수 있습니다. 스냅샷은 DigitalOcean의 객체 저장 서비스에 저장되며, 증분 방식으로 저장되므로 마지막 스냅샷 이후의 변경 사항만 저장됩니다. 이는 사용 효율성과 비용 효율성을 높입니다.

반면, 백업은 운영 체제, 설치된 애플리케이션, 파일 및 데이터, Droplet의 설정 및 메타데이터를 포함한 Droplet의 전체 복사본입니다. 백업은 일반적으로 정기적으로 수행되며, 특정 시점의 Droplet의 전체 상태를 캡처합니다.

스냅샷과 달리 백업은 압축되고 암호화된 형식으로 저장되며, DigitalOcean의 인프라에서 원격 위치로 안전하게 전송됩니다. 이는 백업이 재해 복구에 이상적이며, 데이터 손실이나 기타 재앙적 사건 발생 시 복원할 수 있는 Droplet의 전체 복사본을 제공합니다.

요약하자면, 스냅샷은 Droplet의 디스크에 대한 시점 복사본인 반면, 백업은 설정 및 메타데이터를 포함한 Droplet의 전체 복사본입니다. 스냅샷은 DigitalOcean의 객체 저장 서비스에 저장되며, 백업은 DigitalOcean의 인프라에서 원격 위치로 전송됩니다. 스냅샷과 백업 모두 Droplet을 복원하는 데 사용할 수 있지만, 스냅샷은 사용 및 저장이 더 효율적이며, 백업은 재해 복구를 위한 보다 포괄적인 백업 솔루션을 제공합니다.

</details>

### 인증

인증을 위해 **SSH**를 사용자 이름과 **비밀번호**(droplet 생성 시 정의된 비밀번호)를 통해 **활성화**할 수 있습니다. 또는 **업로드된 SSH 키 중 하나 이상을 선택**할 수 있습니다.

### 방화벽

> [!CAUTION]
> 기본적으로 **droplets는 방화벽 없이 생성됩니다**(AWS나 GCP와 같은 다른 클라우드와는 다르게). 따라서 Droplet(VM)의 포트를 보호하려면 **방화벽을 생성하고 연결해야** 합니다.

자세한 정보는:

{{#ref}}
do-networking.md
{{#endref}}

### 열거
```bash
# VMs
doctl compute droplet list # IPs will appear here
doctl compute droplet backups <droplet-id>
doctl compute droplet snapshots <droplet-id>
doctl compute droplet neighbors <droplet-id> # Get network neighbors
doctl compute droplet actions <droplet-id> # Get droplet actions

# VM interesting actions
doctl compute droplet-action password-reset <droplet-id> # New password is emailed to the user
doctl compute droplet-action enable-ipv6 <droplet-id>
doctl compute droplet-action power-on <droplet-id>
doctl compute droplet-action disable-backups <droplet-id>

# SSH
doctl compute ssh <droplet-id> # This will just run SSH
doctl compute ssh-key list
doctl compute ssh-key import <key-name> --public-key-file /path/to/key.pub

# Certificates
doctl compute certificate list

# Snapshots
doctl compute snapshot list
```
> [!CAUTION]
> **Droplets는 메타데이터 엔드포인트를 가지고 있지만**, DO에는 **IAM**이나 AWS의 역할, GCP의 서비스 계정과 같은 것이 **없습니다**.

### RCE

콘솔에 접근하면 **드롭렛 내부에서 셸을 얻을 수 있습니다**. URL에 접근하여: **`https://cloud.digitalocean.com/droplets/<droplet-id>/terminal/ui/`**

호스트 내부에서 명령을 실행하기 위해 **복구 콘솔**을 시작할 수도 있습니다. **`https://cloud.digitalocean.com/droplets/<droplet-id>/console`**에 접근하여 복구 콘솔을 사용하세요(하지만 이 경우 루트 비밀번호를 알아야 합니다).

{{#include ../../../banners/hacktricks-training.md}}
