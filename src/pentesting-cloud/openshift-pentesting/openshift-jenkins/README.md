# OpenShift - Jenkins

**该页面的原作者是** [**Fares**](https://www.linkedin.com/in/fares-siala/)

本页面提供了一些关于如何攻击在OpenShift（或Kubernetes）集群中运行的Jenkins实例的指引。

## 免责声明

Jenkins实例可以部署在OpenShift或Kubernetes集群中。根据您的上下文，您可能需要调整任何显示的有效负载、yaml或技术。有关攻击Jenkins的更多信息，您可以查看[此页面](../../../pentesting-ci-cd/jenkins-security/)。

## 先决条件

1a. 在Jenkins实例中的用户访问权限 或 1b. 对一个SCM仓库的写入权限，该仓库在推送/合并后触发自动构建。

## 工作原理

从根本上讲，幕后几乎所有的工作方式与在VM中运行的常规Jenkins实例相同。主要区别在于整体架构以及如何在OpenShift（或Kubernetes）集群中管理构建。

### 构建

当构建被触发时，首先由Jenkins主节点管理/协调，然后委派给代理/从属/工作节点。在这种情况下，主节点只是一个在命名空间中运行的常规pod（可能与工作节点运行的命名空间不同）。从属/工作节点也是如此，但它们在构建完成后会被销毁，而主节点始终保持运行。您的构建通常在一个pod内运行，使用Jenkins管理员定义的默认pod模板。

### 触发构建

您有多种主要方式来触发构建，例如：

1. 您可以访问Jenkins的UI

一种非常简单方便的方法是使用现有构建的重放功能。它允许您重放先前执行的构建，同时允许您更新groovy脚本。这需要对Jenkins文件夹和预定义管道的权限。如果您需要保持隐蔽，您可以在拥有足够权限的情况下删除您触发的构建。

2. 您对SCM有写入访问权限，并且通过webhook配置了自动构建

您可以直接编辑构建脚本（例如Jenkinsfile），提交并推送（如果构建仅在PR合并时触发，则最终创建一个PR）。请记住，这条路径非常嘈杂，需要提升权限来清理您的痕迹。

## Jenkins构建Pod YAML覆盖

{{#ref}}
openshift-jenkins-build-overrides.md
{{#endref}}
