# AWS - Cognito Persistence

{{#include ../../../banners/hacktricks-training.md}}

## Cognito

Για περισσότερες πληροφορίες, επισκεφθείτε:

{{#ref}}
../aws-services/aws-cognito-enum/
{{#endref}}

### User persistence

Το Cognito είναι μια υπηρεσία που επιτρέπει την εκχώρηση ρόλων σε μη αυθεντικοποιημένους και αυθεντικοποιημένους χρήστες και τον έλεγχο ενός καταλόγου χρηστών. Πολλές διαφορετικές ρυθμίσεις μπορούν να τροποποιηθούν για να διατηρηθεί κάποια επιμονή, όπως:

- **Προσθήκη ενός User Pool** που ελέγχεται από τον χρήστη σε ένα Identity Pool
- Δώστε έναν **ρόλο IAM σε ένα μη αυθεντικοποιημένο Identity Pool και επιτρέψτε τη ροή βασικής αυθεντικοποίησης**
- Ή σε ένα **αυθεντικοποιημένο Identity Pool** αν ο επιτιθέμενος μπορεί να συνδεθεί
- Ή **βελτίωση των δικαιωμάτων** των δοθέντων ρόλων
- **Δημιουργία, επαλήθευση & privesc** μέσω χρηστών που ελέγχονται από χαρακτηριστικά ή νέων χρηστών σε ένα **User Pool**
- **Επιτρέποντας εξωτερικούς Παρόχους Ταυτότητας** να συνδεθούν σε ένα User Pool ή σε ένα Identity Pool

Δείτε πώς να εκτελέσετε αυτές τις ενέργειες στο

{{#ref}}
../aws-privilege-escalation/aws-cognito-privesc.md
{{#endref}}

### `cognito-idp:SetRiskConfiguration`

Ένας επιτιθέμενος με αυτό το προνόμιο θα μπορούσε να τροποποιήσει τη ρύθμιση κινδύνου ώστε να μπορεί να συνδεθεί ως χρήστης Cognito **χωρίς να ενεργοποιούνται συναγερμοί**. [**Δείτε το cli**](https://docs.aws.amazon.com/cli/latest/reference/cognito-idp/set-risk-configuration.html) για να ελέγξετε όλες τις επιλογές:
```bash
aws cognito-idp set-risk-configuration --user-pool-id <pool-id> --compromised-credentials-risk-configuration EventFilter=SIGN_UP,Actions={EventAction=NO_ACTION}
```
Από προεπιλογή, αυτό είναι απενεργοποιημένο:

<figure><img src="https://lh6.googleusercontent.com/EOiM0EVuEgZDfW3rOJHLQjd09-KmvraCMssjZYpY9sVha6NcxwUjStrLbZxAT3D3j9y08kd5oobvW8a2fLUVROyhkHaB1OPhd7X6gJW3AEQtlZM62q41uYJjTY1EJ0iQg6Orr1O7yZ798EpIJ87og4Tbzw=s2048" alt=""><figcaption></figcaption></figure>

{{#include ../../../banners/hacktricks-training.md}}
