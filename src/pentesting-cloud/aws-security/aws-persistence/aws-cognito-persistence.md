# AWS - Cognito 持久性

{{#include ../../../banners/hacktricks-training.md}}

## Cognito

有关更多信息，请访问：

{{#ref}}
../aws-services/aws-cognito-enum/
{{#endref}}

### 用户持久性

Cognito 是一个允许为未认证和已认证用户分配角色并控制用户目录的服务。可以更改几种不同的配置以保持某种持久性，例如：

- **将用户池**添加到由用户控制的身份池
- 为未认证身份池提供一个**IAM角色并允许基本身份验证流程**
- 或者为**已认证身份池**提供角色，如果攻击者可以登录
- 或者**提高给定角色的权限**
- **通过受控属性创建、验证和权限提升**用户或新用户在**用户池**中
- **允许外部身份提供者**在用户池或身份池中登录

查看如何执行这些操作

{{#ref}}
../aws-privilege-escalation/aws-cognito-privesc.md
{{#endref}}

### `cognito-idp:SetRiskConfiguration`

具有此权限的攻击者可以修改风险配置，以便能够作为 Cognito 用户登录**而不会触发警报**。[**查看 cli**](https://docs.aws.amazon.com/cli/latest/reference/cognito-idp/set-risk-configuration.html)以查看所有选项：
```bash
aws cognito-idp set-risk-configuration --user-pool-id <pool-id> --compromised-credentials-risk-configuration EventFilter=SIGN_UP,Actions={EventAction=NO_ACTION}
```
默认情况下，这是禁用的：

<figure><img src="https://lh6.googleusercontent.com/EOiM0EVuEgZDfW3rOJHLQjd09-KmvraCMssjZYpY9sVha6NcxwUjStrLbZxAT3D3j9y08kd5oobvW8a2fLUVROyhkHaB1OPhd7X6gJW3AEQtlZM62q41uYJjTY1EJ0iQg6Orr1O7yZ798EpIJ87og4Tbzw=s2048" alt=""><figcaption></figcaption></figure>

{{#include ../../../banners/hacktricks-training.md}}
