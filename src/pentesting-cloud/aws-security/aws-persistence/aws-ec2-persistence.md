# AWS - EC2 Sürekliliği

{{#include ../../../banners/hacktricks-training.md}}

## EC2

Daha fazla bilgi için kontrol edin:

{{#ref}}
../aws-services/aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum/
{{#endref}}

### Güvenlik Grubu Bağlantı İzleme Sürekliliği

Eğer bir savunucu **EC2 örneğinin ele geçirildiğini** fark ederse, muhtemelen makinenin **ağını izole etmeye** çalışacaktır. Bunu açık bir **Deny NACL** ile yapabilir (ancak NACL'ler tüm alt ağa etki eder), ya da **herhangi bir türde gelen veya giden** trafiğe izin vermeyen **güvenlik grubunu değiştirebilir**.

Eğer saldırganın makineden kaynaklanan bir **ters kabuk** varsa, SG gelen veya giden trafiğe izin vermeyecek şekilde değiştirilse bile, **bağlantı** [**Güvenlik Grubu Bağlantı İzleme**](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-connection-tracking.html)** nedeniyle kesilmeyecektir.**

### EC2 Yaşam Döngüsü Yöneticisi

Bu hizmet, **AMI'lerin ve anlık görüntülerin oluşturulmasını** **planlamaya** ve hatta **başka hesaplarla paylaşmaya** olanak tanır.\
Bir saldırgan, **her hafta** tüm görüntülerin veya tüm hacimlerin **AMI'lerini veya anlık görüntülerini oluşturmak için** yapılandırma yapabilir ve **kendi hesabıyla paylaşabilir**.

### Planlı Örnekler

Örneklerin günlük, haftalık veya hatta aylık olarak çalıştırılması mümkündür. Bir saldırgan, erişebileceği yüksek ayrıcalıklara sahip bir makine çalıştırabilir.

### Spot Filosu Talebi

Spot örnekleri, normal örneklerden **daha ucuzdur**. Bir saldırgan, **otomatik IP** ataması ve saldırgana **spot örneği başladığında** ve **IP adresi** ile ilgili bilgi gönderen bir **kullanıcı verisi** ile **5 yıl için küçük bir spot filosu talebi** başlatabilir (örneğin).

### Arka Kapı Örnekleri

Bir saldırgan, örneklere erişebilir ve bunları arka kapı ile ele geçirebilir:

- Örneğin geleneksel bir **rootkit** kullanarak
- Yeni bir **genel SSH anahtarı** ekleyerek (bakınız [EC2 ayrıcalık yükseltme seçenekleri](../aws-privilege-escalation/aws-ec2-privesc.md))
- **Kullanıcı Verisini** arka kapı ile ele geçirerek

### **Arka Kapı Başlatma Yapılandırması**

- Kullanılan AMI'yi arka kapı ile ele geçirmek
- Kullanıcı Verisini arka kapı ile ele geçirmek
- Anahtar Çifti'ni arka kapı ile ele geçirmek

### VPN

Saldırganın VPC'ye doğrudan bağlanabilmesi için bir VPN oluşturun.

### VPC Peering

Kurban VPC ile saldırgan VPC arasında bir peering bağlantısı oluşturun, böylece kurban VPC'ye erişebilir.

{{#include ../../../banners/hacktricks-training.md}}
