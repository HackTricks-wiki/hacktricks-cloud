# AWS - Persistência do Cloudformation

{{#include ../../../banners/hacktricks-training.md}}

## CloudFormation

Para mais informações, acesse:

{{#ref}}
../aws-services/aws-cloudformation-and-codestar-enum.md
{{#endref}}

### Pilha de Inicialização do CDK

O AWS CDK implanta uma pilha CFN chamada `CDKToolkit`. Esta pilha suporta um parâmetro `TrustedAccounts` que permite que contas externas implantem projetos CDK na conta da vítima. Um atacante pode abusar disso para conceder a si mesmo acesso indefinido à conta da vítima, seja usando o AWS cli para reimplantar a pilha com parâmetros, ou o AWS CDK cli.
```bash
# CDK
cdk bootstrap --trust 1234567890

# AWS CLI
aws cloudformation update-stack --use-previous-template --parameters ParameterKey=TrustedAccounts,ParameterValue=1234567890
```
{{#include ../../../banners/hacktricks-training.md}}
