# AWS - IAM Persistence

{{#include ../../../../banners/hacktricks-training.md}}

## IAM

Za više informacija pogledajte:

{{#ref}}
../../aws-services/aws-iam-enum.md
{{#endref}}

### Uobičajene IAM Persistence

- Kreirajte korisnika
- Dodajte kontrolisanog korisnika u privilegovanu grupu
- Kreirajte access keys (novog korisnika ili svih korisnika)
- Dodelite dodatne dozvole kontrolisanim korisnicima/grupama (attached policies ili inline policies)
- Onemogućite MFA / Dodajte sopstveni MFA uređaj
- Napravite Role Chain Juggling situaciju (više o tome dole u STS persistence)

### Backdoor Role Trust Policies

Možete ubaciti backdoor u trust policy kako biste mogli da je assume-ujete za eksterni resurs koji kontrolišete (ili za sve):
```json
{
"Version": "2012-10-17",
"Statement": [
{
"Effect": "Allow",
"Principal": {
"AWS": ["*", "arn:aws:iam::123213123123:root"]
},
"Action": "sts:AssumeRole"
}
]
}
```
### Backdoor Policy Version

Dodelite administratorske dozvole policy-ju koja nije u svojoj poslednjoj verziji (poslednja verzija treba da izgleda legitimno), a zatim tu verziju policy-ja dodelite kontrolisanom korisniku/grupi.

### Backdoor / Create Identity Provider

Ako nalog već veruje u uobičajenog identity providera (na primer Github), uslovi trust-a mogu se pojačati tako da ih napadač može zloupotrebiti.

{{#include ../../../../banners/hacktricks-training.md}}
