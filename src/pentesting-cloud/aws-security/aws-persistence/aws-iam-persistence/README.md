# AWS - IAM Persistence

{{#include ../../../../banners/hacktricks-training.md}}

## IAM

अधिक जानकारी के लिए देखें:

{{#ref}}
../../aws-services/aws-iam-enum.md
{{#endref}}

### सामान्य IAM Persistence

- एक user बनाएं
- किसी controlled user को एक privileged group में जोड़ें
- access keys बनाएं (नए user के या सभी users के लिए)
- controlled users/groups को अतिरिक्त permissions दें (attached policies या inline policies के माध्यम से)
- MFA अक्षम करें / अपना MFA device जोड़ें
- Role Chain Juggling स्थिति बनाएं (नीचे STS persistence में अधिक जानकारी)

### Backdoor Role Trust Policies

आप एक trust policy में backdoor जोड़ सकते हैं ताकि आप इसे अपने द्वारा नियंत्रित external resource के लिए assume कर सकें (या सभी के लिए):
```json
{
"Version": "2012-10-17",
"Statement": [
{
"Effect": "Allow",
"Principal": {
"AWS": ["*", "arn:aws:iam::123213123123:root"]
},
"Action": "sts:AssumeRole"
}
]
}
```
### Backdoor Policy Version

एक policy के किसी पुराने version में Administrator permissions दें (आखिरी version को वैध दिखना चाहिए), फिर उस version को नियंत्रित user/group को असाइन करें।

### Backdoor / Create Identity Provider

यदि account पहले से ही किसी सामान्य identity provider (जैसे Github) पर भरोसा करता है, तो trust की शर्तें बढ़ा दी जा सकती हैं ताकि attacker उनका दुरुपयोग कर सके।

{{#include ../../../../banners/hacktricks-training.md}}
