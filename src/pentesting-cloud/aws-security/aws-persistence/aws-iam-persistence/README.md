# AWS - IAM Persistence

{{#include ../../../../banners/hacktricks-training.md}}

## IAM

Για περισσότερες πληροφορίες, δείτε:

{{#ref}}
../../aws-services/aws-iam-enum.md
{{#endref}}

### Συνηθισμένες IAM Persistence

- Δημιουργία χρήστη
- Προσθήκη ελεγχόμενου χρήστη σε προνομιούχα ομάδα
- Δημιουργία access keys (του νέου χρήστη ή όλων των χρηστών)
- Παροχή επιπλέον δικαιωμάτων σε ελεγχόμενους χρήστες/ομάδες (attached policies ή inline policies)
- Απενεργοποίηση MFA / Προσθήκη δικής σου MFA συσκευής
- Δημιουργία κατάστασης Role Chain Juggling (περισσότερα παρακάτω στο STS persistence)

### Backdoor Role Trust Policies

Μπορείς να backdoor-άρεις μια trust policy ώστε να μπορείς να assume αυτήν για έναν εξωτερικό πόρο που ελέγχεις (ή για όλους):
```json
{
"Version": "2012-10-17",
"Statement": [
{
"Effect": "Allow",
"Principal": {
"AWS": ["*", "arn:aws:iam::123213123123:root"]
},
"Action": "sts:AssumeRole"
}
]
}
```
### Backdoor Policy Version

Δώστε Administrator permissions σε μια policy που δεν είναι στην τελευταία της έκδοση (η τελευταία έκδοση πρέπει να φαίνεται νόμιμη), στη συνέχεια αναθέστε αυτήν την έκδοση της policy σε έναν ελεγχόμενο user/group.

### Backdoor / Create Identity Provider

Εάν ο λογαριασμός ήδη εμπιστεύεται έναν κοινό identity provider (όπως το Github), οι όροι της εμπιστοσύνης μπορούν να αυξηθούν ώστε ο επιτιθέμενος να τους εκμεταλλευτεί.

{{#include ../../../../banners/hacktricks-training.md}}
