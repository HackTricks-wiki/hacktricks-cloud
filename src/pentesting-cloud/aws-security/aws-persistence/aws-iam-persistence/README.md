# AWS - IAM Persistence

{{#include ../../../../banners/hacktricks-training.md}}

## IAM

Vir meer inligting, sien:

{{#ref}}
../../aws-services/aws-iam-enum.md
{{#endref}}

### Algemene IAM Persistence

- Skep 'n user
- Voeg 'n beheerde user by 'n privileged group
- Skep access keys (van die nuwe user of van alle users)
- Gee ekstra toestemmings aan beheerde users/groups (attached policies of inline policies)
- Deaktiveer MFA / Voeg jou eie MFA device by
- Skep 'n Role Chain Juggling situasie (meer hieroor hieronder in STS persistence)

### Backdoor Role Trust Policies

Jy kan 'n backdoor in 'n trust policy plaas om dit te kan assume vir 'n external resource wat deur jou beheer word (of vir almal):
```json
{
"Version": "2012-10-17",
"Statement": [
{
"Effect": "Allow",
"Principal": {
"AWS": ["*", "arn:aws:iam::123213123123:root"]
},
"Action": "sts:AssumeRole"
}
]
}
```
### Backdoor Policy Version

Gee Administrator-permissies aan 'n policy wat nie in sy laaste weergawe is nie (die laaste weergawe moet geloofwaardig lyk), en ken dan daardie weergawe van die policy toe aan 'n beheerde user/group.

### Backdoor / Create Identity Provider

Indien die account reeds 'n algemene identity provider (soos Github) vertrou, kan die trust-voorwaardes uitgebrei word sodat die aanvaller dit kan misbruik.

{{#include ../../../../banners/hacktricks-training.md}}
