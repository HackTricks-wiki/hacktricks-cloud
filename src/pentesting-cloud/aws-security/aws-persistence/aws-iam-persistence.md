# AWS - IAM Persistence

{{#include ../../../banners/hacktricks-training.md}}

## IAM

Per ulteriori informazioni accedi a:

{{#ref}}
../aws-services/aws-iam-enum.md
{{#endref}}

### Persistenza IAM comune

- Crea un utente
- Aggiungi un utente controllato a un gruppo privilegiato
- Crea chiavi di accesso (del nuovo utente o di tutti gli utenti)
- Concedi permessi extra a utenti/gruppi controllati (policy collegate o policy inline)
- Disabilita MFA / Aggiungi il tuo dispositivo MFA
- Crea una situazione di catena di ruoli (maggiore dettagli su questo di seguito nella persistenza STS)

### Politiche di fiducia del ruolo backdoor

Potresti inserire una backdoor in una politica di fiducia per poterla assumere per una risorsa esterna controllata da te (o da chiunque):
```json
{
"Version": "2012-10-17",
"Statement": [
{
"Effect": "Allow",
"Principal": {
"AWS": ["*", "arn:aws:iam::123213123123:root"]
},
"Action": "sts:AssumeRole"
}
]
}
```
### Backdoor Policy Version

Dai permessi di Amministratore a una policy che non è nella sua ultima versione (l'ultima versione dovrebbe sembrare legittima), quindi assegna quella versione della policy a un utente/gruppo controllato.

### Backdoor / Create Identity Provider

Se l'account sta già fidandosi di un provider di identità comune (come Github), le condizioni della fiducia potrebbero essere aumentate in modo che l'attaccante possa abusarne.

{{#include ../../../banners/hacktricks-training.md}}
