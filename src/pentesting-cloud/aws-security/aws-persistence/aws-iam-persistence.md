# AWS - IAM 持久性

{{#include ../../../banners/hacktricks-training.md}}

## IAM

有关更多信息，请访问：

{{#ref}}
../aws-services/aws-iam-enum.md
{{#endref}}

### 常见的 IAM 持久性

- 创建用户
- 将受控用户添加到特权组
- 创建访问密钥（新用户或所有用户的访问密钥）
- 授予受控用户/组额外权限（附加策略或内联策略）
- 禁用 MFA / 添加您自己的 MFA 设备
- 创建角色链 juggling 情况（有关此内容，请参见下面的 STS 持久性）

### 后门角色信任策略

您可以在信任策略中设置后门，以便能够假设它用于由您控制的外部资源（或对所有人）：
```json
{
"Version": "2012-10-17",
"Statement": [
{
"Effect": "Allow",
"Principal": {
"AWS": ["*", "arn:aws:iam::123213123123:root"]
},
"Action": "sts:AssumeRole"
}
]
}
```
### 后门策略版本

将管理员权限授予一个不是其最后版本的策略（最后版本应该看起来合法），然后将该版本的策略分配给一个受控用户/组。

### 后门 / 创建身份提供者

如果账户已经信任一个常见的身份提供者（例如 Github），则可以增加信任的条件，以便攻击者可以利用它们。

{{#include ../../../banners/hacktricks-training.md}}
