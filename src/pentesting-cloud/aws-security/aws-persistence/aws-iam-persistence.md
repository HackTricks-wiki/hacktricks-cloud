# AWS - IAM Persistence

{{#include ../../../banners/hacktricks-training.md}}

## IAM

Aby uzyskać więcej informacji, przejdź do:

{{#ref}}
../aws-services/aws-iam-enum.md
{{#endref}}

### Powszechna trwałość IAM

- Utwórz użytkownika
- Dodaj kontrolowanego użytkownika do uprzywilejowanej grupy
- Utwórz klucze dostępu (nowego użytkownika lub wszystkich użytkowników)
- Przyznaj dodatkowe uprawnienia kontrolowanym użytkownikom/grupom (polityki dołączone lub polityki inline)
- Wyłącz MFA / Dodaj własne urządzenie MFA
- Utwórz sytuację z łańcuchem ról (więcej na ten temat poniżej w trwałości STS)

### Polityki zaufania ról backdoor

Możesz wprowadzić backdoor do polityki zaufania, aby móc ją przyjąć dla zewnętrznego zasobu kontrolowanego przez Ciebie (lub dla wszystkich):
```json
{
"Version": "2012-10-17",
"Statement": [
{
"Effect": "Allow",
"Principal": {
"AWS": ["*", "arn:aws:iam::123213123123:root"]
},
"Action": "sts:AssumeRole"
}
]
}
```
### Wersja Polityki Backdoor

Nadaj uprawnienia Administratora polityce, która nie jest jej ostatnią wersją (ostatnia wersja powinna wyglądać na legitną), a następnie przypisz tę wersję polityki do kontrolowanego użytkownika/grupy.

### Backdoor / Utwórz Dostawcę Tożsamości

Jeśli konto już ufa powszechnemu dostawcy tożsamości (takiemu jak Github), warunki zaufania mogą być zwiększone, aby atakujący mógł je wykorzystać.

{{#include ../../../banners/hacktricks-training.md}}
