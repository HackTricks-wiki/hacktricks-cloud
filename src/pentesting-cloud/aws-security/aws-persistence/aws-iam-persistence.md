# AWS - IAM Persistenz

{{#include ../../../banners/hacktricks-training.md}}

## IAM

Für weitere Informationen zugreifen:

{{#ref}}
../aws-services/aws-iam-enum.md
{{#endref}}

### Häufige IAM Persistenz

- Erstellen Sie einen Benutzer
- Fügen Sie einen kontrollierten Benutzer einer privilegierten Gruppe hinzu
- Erstellen Sie Zugriffsschlüssel (des neuen Benutzers oder aller Benutzer)
- Gewähren Sie zusätzlichen Berechtigungen an kontrollierte Benutzer/Gruppen (angehängte Richtlinien oder Inline-Richtlinien)
- Deaktivieren Sie MFA / Fügen Sie Ihr eigenes MFA-Gerät hinzu
- Erstellen Sie eine Rollenkette Juggling-Situation (mehr dazu weiter unten in der STS-Persistenz)

### Backdoor-Rollenvertrauensrichtlinien

Sie könnten eine Vertrauensrichtlinie hinterlegen, um sie für eine von Ihnen kontrollierte externe Ressource (oder für alle) annehmen zu können:
```json
{
"Version": "2012-10-17",
"Statement": [
{
"Effect": "Allow",
"Principal": {
"AWS": ["*", "arn:aws:iam::123213123123:root"]
},
"Action": "sts:AssumeRole"
}
]
}
```
### Backdoor-Policy-Version

Geben Sie Administratorberechtigungen an eine Richtlinie in nicht ihrer letzten Version (die letzte Version sollte legitim aussehen), und weisen Sie diese Version der Richtlinie einem kontrollierten Benutzer/einer kontrollierten Gruppe zu.

### Backdoor / Identitätsanbieter erstellen

Wenn das Konto bereits einem gängigen Identitätsanbieter (wie Github) vertraut, könnten die Bedingungen des Vertrauens erhöht werden, sodass der Angreifer sie ausnutzen kann.

{{#include ../../../banners/hacktricks-training.md}}
