# AWS Lambda – Runtime Pinning/Rollback Abuse via PutRuntimeManagementConfig

Nadużyj `lambda:PutRuntimeManagementConfig`, aby przypiąć funkcję do konkretnej wersji runtime (Manual) lub zamrozić aktualizacje (FunctionUpdate). Pozwala to zachować kompatybilność ze złośliwymi warstwami/wrapperami i może utrzymać funkcję na przestarzałym, podatnym runtime, co ułatwia exploitację i długotrwałe utrzymywanie dostępu.

Wymagania: `lambda:InvokeFunction`, `logs:FilterLogEvents`, `lambda:PutRuntimeManagementConfig`, `lambda:GetRuntimeManagementConfig`.

Przykład (us-east-1):
- Wywołanie: `aws lambda invoke --function-name  /tmp/ping.json --payload {} --region us-east-1 > /dev/null; sleep 5`
- Zamrożenie aktualizacji: `aws lambda put-runtime-management-config --function-name  --update-runtime-on FunctionUpdate --region us-east-1`
- Weryfikacja: `aws lambda get-runtime-management-config --function-name  --region us-east-1`

Opcjonalnie przypnij do konkretnej wersji runtime, wyciągając Runtime Version ARN z logów INIT_START i używając `--update-runtime-on Manual --runtime-version-arn <arn>`.
