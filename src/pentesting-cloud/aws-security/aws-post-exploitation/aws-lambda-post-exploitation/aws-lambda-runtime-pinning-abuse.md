# AWS Lambda – Runtime Pinning/Rollback Abuse via PutRuntimeManagementConfig

Abuse `lambda:PutRuntimeManagementConfig` करके किसी function को एक विशिष्ट runtime version (Manual) पर पिन करें या अपडेट्स को फ्रीज़ करें (FunctionUpdate)। यह malicious layers/wrappers के साथ संगतता बनाए रखता है और फ़ंक्शन को एक पुरानी, कमजोर runtime पर रोक कर exploitation और लंबी अवधि की persistence में मदद कर सकता है।

आवश्यकताएँ: `lambda:InvokeFunction`, `logs:FilterLogEvents`, `lambda:PutRuntimeManagementConfig`, `lambda:GetRuntimeManagementConfig`.

उदाहरण (us-east-1):
- इवोक (Invoke): `aws lambda invoke --function-name  /tmp/ping.json --payload {} --region us-east-1 > /dev/null; sleep 5`
- अपडेट फ्रीज़ करें (Freeze updates): `aws lambda put-runtime-management-config --function-name  --update-runtime-on FunctionUpdate --region us-east-1`
- सत्यापित करें (Verify): `aws lambda get-runtime-management-config --function-name  --region us-east-1`

वैकल्पिक रूप से, INIT_START logs से Runtime Version ARN निकालकर और `--update-runtime-on Manual --runtime-version-arn <arn>` का उपयोग करके किसी विशिष्ट runtime version पर पिन करें।
