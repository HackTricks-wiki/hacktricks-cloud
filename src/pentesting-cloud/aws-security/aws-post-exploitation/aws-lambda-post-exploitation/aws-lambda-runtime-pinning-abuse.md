# AWS Lambda – Runtime Pinning/Rollback Abuse via PutRuntimeManagementConfig

Abuse `lambda:PutRuntimeManagementConfig` 以将函数锁定到特定的 runtime 版本（Manual）或冻结更新（FunctionUpdate）。这可以保持与恶意 layers/wrappers 的兼容性，并能使函数停留在过时、存在漏洞的 runtime 上，从而便于 exploitation 和长期 persistence。

要求: `lambda:InvokeFunction`, `logs:FilterLogEvents`, `lambda:PutRuntimeManagementConfig`, `lambda:GetRuntimeManagementConfig`.

示例 (us-east-1):
- 调用: `aws lambda invoke --function-name  /tmp/ping.json --payload {} --region us-east-1 > /dev/null; sleep 5`
- 冻结更新: `aws lambda put-runtime-management-config --function-name  --update-runtime-on FunctionUpdate --region us-east-1`
- 验证: `aws lambda get-runtime-management-config --function-name  --region us-east-1`

可选地，通过从 INIT_START 日志中提取 Runtime Version ARN 并使用 `--update-runtime-on Manual --runtime-version-arn <arn>` 将运行时固定到特定版本。
