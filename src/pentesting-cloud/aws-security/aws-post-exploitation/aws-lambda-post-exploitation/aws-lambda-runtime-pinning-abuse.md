# AWS Lambda – Runtime Pinning/Rollback Abuse via PutRuntimeManagementConfig

{{#include ../../../../banners/hacktricks-training.md}}

Missbrauche `lambda:PutRuntimeManagementConfig`, um eine Funktion an eine bestimmte Runtime-Version zu pinnen (Manual) oder Updates einzufrieren (FunctionUpdate). Dadurch bleibt die Kompatibilität mit bösartigen Layern/Wrappern erhalten und die Funktion kann auf einer veralteten, verwundbaren Runtime verbleiben, um Exploitation und langfristige Persistenz zu erleichtern.

Voraussetzungen: `lambda:InvokeFunction`, `logs:FilterLogEvents`, `lambda:PutRuntimeManagementConfig`, `lambda:GetRuntimeManagementConfig`.

Beispiel (us-east-1):
- Aufrufen: `aws lambda invoke --function-name  /tmp/ping.json --payload {} --region us-east-1 > /dev/null; sleep 5`
- Updates einfrieren: `aws lambda put-runtime-management-config --function-name  --update-runtime-on FunctionUpdate --region us-east-1`
- Überprüfen: `aws lambda get-runtime-management-config --function-name  --region us-east-1`

Optional kann man an eine bestimmte Runtime-Version pinnen, indem man die Runtime Version ARN aus den INIT_START-Logs extrahiert und `--update-runtime-on Manual --runtime-version-arn <arn>` verwendet.

{{#include ../../../../banners/hacktricks-training.md}}
