# AWS - CloudFront Post Exploitation

{{#include ../../../../banners/hacktricks-training.md}}

## CloudFront

Für weitere Informationen siehe:

{{#ref}}
../../aws-services/aws-cloudfront-enum.md
{{#endref}}

### Man-in-the-Middle

This [**blog post**](https://medium.com/@adan.alvarez/how-attackers-can-misuse-aws-cloudfront-access-to-make-it-rain-cookies-acf9ce87541c) schlägt ein paar verschiedene Szenarien vor, in denen eine **Lambda** hinzugefügt (oder modifiziert, falls sie bereits verwendet wird) in eine **Kommunikation durch CloudFront** werden könnte, mit dem Zweck, Benutzerinformationen zu **stehlen** (wie das Session **cookie**) und die **Antwort** zu **modifizieren** (Einfügen eines bösartigen JS-Skripts).

#### scenario 1: MitM where CloudFront is configured to access some HTML of a bucket

- **Erstelle** die bösartige **Funktion**.
- **Verknüpfe** sie mit der CloudFront-Distribution.
- Setze den **Event-Typ auf "Viewer Response"**.

Indem man die Antwort ausliest, könnte man das Session cookie des Benutzers stehlen und ein bösartiges JS injizieren.

#### scenario 2: MitM where CloudFront is already using a lambda function

- **Ändere den Code** der Lambda-Funktion, um sensible Informationen zu stehlen

You can check the [**tf code to recreate this scenarios here**](https://github.com/adanalvarez/AWS-Attack-Scenarios/tree/main).

{{#include ../../../../banners/hacktricks-training.md}}
