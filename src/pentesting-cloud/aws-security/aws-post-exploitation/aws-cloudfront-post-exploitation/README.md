# AWS - CloudFront Post-exploitation

{{#include ../../../../banners/hacktricks-training.md}}

## CloudFront

Pour plus d'informations, consultez :

{{#ref}}
../../aws-services/aws-cloudfront-enum.md
{{#endref}}

### Man-in-the-Middle

This [**blog post**](https://medium.com/@adan.alvarez/how-attackers-can-misuse-aws-cloudfront-access-to-make-it-rain-cookies-acf9ce87541c) propose quelques scénarios différents où une **Lambda** pourrait être ajoutée (ou modifiée si elle est déjà utilisée) dans une **communication through CloudFront** dans le but de **voler** des informations utilisateur (comme le cookie de session) et de **modifier** la **réponse** (en injectant un script JS malveillant).

#### scénario 1 : MitM où CloudFront est configuré pour accéder à du HTML d'un bucket

- **Créer** la **fonction** malveillante.
- **Associer** la à la distribution CloudFront.
- Définir le **type d'événement sur "Viewer Response"**.

En accédant à la réponse, vous pouvez voler le cookie des utilisateurs et injecter un JS malveillant.

#### scénario 2 : MitM où CloudFront utilise déjà une Lambda function

- **Modifier le code** de la Lambda function pour voler des informations sensibles

Vous pouvez consulter le [**tf code pour recréer ces scénarios ici**](https://github.com/adanalvarez/AWS-Attack-Scenarios/tree/main).

{{#include ../../../../banners/hacktricks-training.md}}
