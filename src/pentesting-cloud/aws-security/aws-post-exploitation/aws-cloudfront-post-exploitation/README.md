# AWS - CloudFront Post Exploitation

{{#include ../../../../banners/hacktricks-training.md}}

## CloudFront

Daha fazla bilgi için bakınız:

{{#ref}}
../../aws-services/aws-cloudfront-enum.md
{{#endref}}

### `cloudfront:Delete*`
cloudfront:Delete* izni verilmiş bir saldırgan distributions, policies ve diğer kritik CDN yapılandırma nesnelerini silebilir — örneğin distributions, cache/origin policies, key groups, origin access identities, functions/configs ve ilgili kaynaklar. Bu, servis kesintisine, içerik kaybına ve yapılandırma veya adli kanıtların kaldırılmasına yol açabilir.

Bir distribution'ı silmek için saldırgan şunu kullanabilir:
```bash
aws cloudfront delete-distribution \
--id <DISTRIBUTION_ID> \
--if-match <ETAG>
```
### Man-in-the-Middle

Bu [**blog post**](https://medium.com/@adan.alvarez/how-attackers-can-misuse-aws-cloudfront-access-to-make-it-rain-cookies-acf9ce87541c) birkaç farklı senaryo öneriyor; bu senaryolarda bir **Lambda** eklenebilir (veya zaten kullanılıyorsa değiştirilebilir) **CloudFront** üzerinden geçen bir iletişime, amaç kullanıcı bilgilerini **çalmak** (ör. oturum **cookie**'sini) ve **yanıtı** **değiştirmek** (zararlı bir JS scripti enjekte etmek).

#### senaryo 1: CloudFront'un bir bucket içindeki bazı HTML'e erişecek şekilde yapılandırıldığı MitM

- **Oluşturun** kötü amaçlı **function**.
- **İlişkilendirin** bunu CloudFront distribution ile.
- **Etkinlik türünü "Viewer Response" olarak ayarlayın**.

Yanıta erişerek kullanıcıların cookie'sini çalabilir ve kötü amaçlı bir JS enjekte edebilirsiniz.

#### senaryo 2: CloudFront'un zaten bir lambda function kullandığı MitM

- Lambda function'ın kodunu hassas bilgileri çalmak için **değiştirin**.

You can check the [**tf code to recreate this scenarios here**](https://github.com/adanalvarez/AWS-Attack-Scenarios/tree/main).

{{#include ../../../../banners/hacktricks-training.md}}
