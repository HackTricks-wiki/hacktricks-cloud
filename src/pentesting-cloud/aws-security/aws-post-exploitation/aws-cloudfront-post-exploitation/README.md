# AWS - CloudFront Post Exploitation

{{#include ../../../../banners/hacktricks-training.md}}

## CloudFront

अधिक जानकारी के लिए देखें:

{{#ref}}
../../aws-services/aws-cloudfront-enum.md
{{#endref}}

### `cloudfront:Delete*`
यदि किसी attacker को cloudfront:Delete* अनुमतियाँ दी जाती हैं, तो वह distributions, policies और अन्य महत्वपूर्ण CDN configuration objects को हटा सकता है — उदाहरण के लिए distributions, cache/origin policies, key groups, origin access identities, functions/configs और संबंधित संसाधन। इससे सेवा में बाधा, कंटेंट का नुकसान, और configuration या forensic artifacts के हटाए जाने का खतरा उत्पन्न हो सकता है।

किसी distribution को हटाने के लिए attacker निम्न का उपयोग कर सकता है:
```bash
aws cloudfront delete-distribution \
--id <DISTRIBUTION_ID> \
--if-match <ETAG>
```
### Man-in-the-Middle

यह [**blog post**](https://medium.com/@adan.alvarez/how-attackers-can-misuse-aws-cloudfront-access-to-make-it-rain-cookies-acf9ce87541c) कुछ अलग परिदृश्यों का प्रस्ताव करता है जहाँ एक **Lambda** को **CloudFront के माध्यम से संचार** में जोड़ा जा सकता है (या यदि यह पहले से उपयोग में है तो संशोधित किया जा सकता है) ताकि उपयोगकर्ता जानकारी **चोरी** की जा सके (जैसे session **cookie**) और **response** को बदला जा सके (एक malicious JS script inject करना)।

#### परिदृश्य 1: MitM जहाँ CloudFront को किसी बकेट के कुछ HTML तक पहुँचने के लिए कॉन्फ़िगर किया गया है

- **बनाएँ** दुष्ट **function**।
- इसे CloudFront distribution के साथ जोड़ें।
- **event type** को "Viewer Response" पर सेट करें।

Response तक पहुँच कर आप उपयोगकर्ताओं का **cookie** चुरा सकते हैं और एक malicious JS इनजेक्ट कर सकते हैं।

#### परिदृश्य 2: MitM जहाँ CloudFront पहले से ही एक lambda function का उपयोग कर रहा है

- lambda function के कोड को संशोधित करें ताकि संवेदनशील जानकारी चुराई जा सके

आप यह [**tf code to recreate this scenarios here**](https://github.com/adanalvarez/AWS-Attack-Scenarios/tree/main) देख सकते हैं।

{{#include ../../../../banners/hacktricks-training.md}}
