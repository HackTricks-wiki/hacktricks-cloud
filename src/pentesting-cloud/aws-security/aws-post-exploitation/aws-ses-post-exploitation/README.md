# AWS - SES Post Exploitation

{{#include ../../../../banners/hacktricks-training.md}}

## SES

詳細は次を参照してください:

{{#ref}}
../../aws-services/aws-ses-enum.md
{{#endref}}

### `ses:SendEmail`

メールを送信する。
```bash
aws ses send-email --from sender@example.com --destination file://emails.json --message file://message.json
aws sesv2 send-email --from sender@example.com --destination file://emails.json --message file://message.json
```
まだテストしていません。

### `ses:SendRawEmail`

メールを送信する。
```bash
aws ses send-raw-email --raw-message file://message.json
```
まだテストしていません。

### `ses:SendTemplatedEmail`

テンプレートに基づいてメールを送信します。
```bash
aws ses  send-templated-email --source <value> --destination <value> --template <value>
```
未検証。

### `ses:SendBulkTemplatedEmail`

複数の宛先にメールを送信する
```bash
aws ses send-bulk-templated-email --source <value> --template <value>
```
まだテストしていません。

### `ses:SendBulkEmail`

複数の宛先にメールを送信します。
```
aws sesv2 send-bulk-email --default-content <value> --bulk-email-entries <value>
```
### `ses:SendBounce`

受信したメールに対して**バウンスメール**を送信します（そのメールを受け取れなかったことを示します）。これはメール受信から**24時間まで**しか実行できません。
```bash
aws ses send-bounce --original-message-id <value> --bounce-sender <value> --bounced-recipient-info-list <value>
```
まだテストしていません。

### `ses:SendCustomVerificationEmail`

カスタマイズされた確認メールを送信します。テンプレートメールを作成するための権限も必要になる場合があります。
```bash
aws ses send-custom-verification-email --email-address <value> --template-name <value>
aws sesv2 send-custom-verification-email --email-address <value> --template-name <value>
```
要テスト。

## SES sandbox を回避するための WorkMail pivot

`ses:GetAccount` がアカウントがまだ SES sandbox にあることを示し、`ses:ListIdentities` が検証済みの送信者を返さない場合、攻撃者は orgs を作成し、ドメインを検証し、メールボックスを登録することで、**pivot to WorkMail** し、即時に送信できます（sandbox なし、デフォルトのクォータがより高い）。

{{#ref}}
../aws-workmail-post-exploitation/README.md
{{#endref}}

## 参考資料

- [Threat Actors Using AWS WorkMail in Phishing Campaigns](https://www.rapid7.com/blog/post/dr-threat-actors-aws-workmail-phishing-campaigns)

{{#include ../../../../banners/hacktricks-training.md}}
