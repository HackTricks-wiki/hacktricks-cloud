# AWS - SES Post Exploitation

{{#include ../../../../banners/hacktricks-training.md}}

## SES

更多信息，请查看：

{{#ref}}
../../aws-services/aws-ses-enum.md
{{#endref}}

### `ses:SendEmail`

发送电子邮件。
```bash
aws ses send-email --from sender@example.com --destination file://emails.json --message file://message.json
aws sesv2 send-email --from sender@example.com --destination file://emails.json --message file://message.json
```
仍需测试。

### `ses:SendRawEmail`

发送电子邮件。
```bash
aws ses send-raw-email --raw-message file://message.json
```
仍待测试。

### `ses:SendTemplatedEmail`

基于模板发送电子邮件。
```bash
aws ses  send-templated-email --source <value> --destination <value> --template <value>
```
仍需测试。

### `ses:SendBulkTemplatedEmail`

向多个收件人发送电子邮件
```bash
aws ses send-bulk-templated-email --source <value> --template <value>
```
尚待测试。

### `ses:SendBulkEmail`

向多个目标发送邮件。
```
aws sesv2 send-bulk-email --default-content <value> --bulk-email-entries <value>
```
### `ses:SendBounce`

对已接收的邮件发送**退信**（表示该邮件无法被接收）。这只能在收到邮件后的**24 小时内**完成。
```bash
aws ses send-bounce --original-message-id <value> --bounce-sender <value> --bounced-recipient-info-list <value>
```
尚待测试。

### `ses:SendCustomVerificationEmail`

这将发送一封自定义的验证邮件。你可能还需要权限来创建邮件模板。
```bash
aws ses send-custom-verification-email --email-address <value> --template-name <value>
aws sesv2 send-custom-verification-email --email-address <value> --template-name <value>
```
仍待测试。

## WorkMail pivot 绕过 SES sandbox

当 `ses:GetAccount` 显示账户仍在 SES sandbox 中且 `ses:ListIdentities` 未返回任何已验证的发件人时，攻击者可以 **pivot to WorkMail** 来立即发送（不受 sandbox 限制且默认配额更高），方法是创建组织（orgs）、验证域名并注册邮箱。

{{#ref}}
../aws-workmail-post-exploitation/README.md
{{#endref}}

## 参考资料

- [Threat Actors Using AWS WorkMail in Phishing Campaigns](https://www.rapid7.com/blog/post/dr-threat-actors-aws-workmail-phishing-campaigns)

{{#include ../../../../banners/hacktricks-training.md}}
