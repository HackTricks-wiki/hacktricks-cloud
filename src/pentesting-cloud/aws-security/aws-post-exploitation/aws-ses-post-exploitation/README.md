# AWS - SES 사후 침해 활동

{{#include ../../../../banners/hacktricks-training.md}}

## SES

자세한 정보는 다음을 확인하세요:

{{#ref}}
../../aws-services/aws-ses-enum.md
{{#endref}}

### `ses:SendEmail`

이메일을 전송합니다.
```bash
aws ses send-email --from sender@example.com --destination file://emails.json --message file://message.json
aws sesv2 send-email --from sender@example.com --destination file://emails.json --message file://message.json
```
아직 테스트되지 않음.

### `ses:SendRawEmail`

이메일을 전송합니다.
```bash
aws ses send-raw-email --raw-message file://message.json
```
아직 테스트 필요.

### `ses:SendTemplatedEmail`

템플릿을 기반으로 이메일을 전송합니다.
```bash
aws ses  send-templated-email --source <value> --destination <value> --template <value>
```
아직 테스트 필요.

### `ses:SendBulkTemplatedEmail`

여러 대상에게 이메일을 전송
```bash
aws ses send-bulk-templated-email --source <value> --template <value>
```
아직 테스트 필요.

### `ses:SendBulkEmail`

여러 대상에게 이메일을 전송합니다.
```
aws sesv2 send-bulk-email --default-content <value> --bulk-email-entries <value>
```
### `ses:SendBounce`

수신된 이메일에 대해 **bounce email**을 발송하여(해당 이메일을 받을 수 없었음을 표시) 처리합니다. 이 작업은 이메일 수신 후 **24h 이내에만** 가능합니다.
```bash
aws ses send-bounce --original-message-id <value> --bounce-sender <value> --bounced-recipient-info-list <value>
```
아직 테스트 필요.

### `ses:SendCustomVerificationEmail`

이는 맞춤형 검증 이메일을 전송합니다. 템플릿 이메일을 생성하려면 권한이 필요할 수도 있습니다.
```bash
aws ses send-custom-verification-email --email-address <value> --template-name <value>
aws sesv2 send-custom-verification-email --email-address <value> --template-name <value>
```
아직 테스트 필요.

## WorkMail pivot로 SES sandbox 우회

`ses:GetAccount`가 계정이 아직 SES sandbox에 있음을 보여주고 `ses:ListIdentities`가 검증된 발신자가 없음을 반환할 때, 공격자는 조직을 생성하고 도메인을 검증하며 메일박스를 등록하여 즉시 전송할 수 있도록 **pivot to WorkMail** 할 수 있습니다(샌드박스 없음 및 더 높은 기본 할당량).

{{#ref}}
../aws-workmail-post-exploitation/README.md
{{#endref}}

## 참고자료

- [Threat Actors Using AWS WorkMail in Phishing Campaigns](https://www.rapid7.com/blog/post/dr-threat-actors-aws-workmail-phishing-campaigns)

{{#include ../../../../banners/hacktricks-training.md}}
