# AWS - SES Post-exploitation

{{#include ../../../../banners/hacktricks-training.md}}

## SES

Pour plus d'informations, consultez :

{{#ref}}
../../aws-services/aws-ses-enum.md
{{#endref}}

### `ses:SendEmail`

Envoyer un e-mail.
```bash
aws ses send-email --from sender@example.com --destination file://emails.json --message file://message.json
aws sesv2 send-email --from sender@example.com --destination file://emails.json --message file://message.json
```
Encore à tester.

### `ses:SendRawEmail`

Envoyer un e-mail.
```bash
aws ses send-raw-email --raw-message file://message.json
```
Encore à tester.

### `ses:SendTemplatedEmail`

Envoyer un e-mail basé sur un modèle.
```bash
aws ses  send-templated-email --source <value> --destination <value> --template <value>
```
Encore à tester.

### `ses:SendBulkTemplatedEmail`

Envoyer un e-mail à plusieurs destinataires
```bash
aws ses send-bulk-templated-email --source <value> --template <value>
```
Encore à tester.

### `ses:SendBulkEmail`

Envoyer un e-mail à plusieurs destinataires.
```
aws sesv2 send-bulk-email --default-content <value> --bulk-email-entries <value>
```
### `ses:SendBounce`

Envoyer un **e-mail de rebond** sur un e-mail reçu (indiquant que l'e-mail n'a pas pu être reçu). Cela ne peut être fait **que jusqu'à 24h après la réception** de l'e-mail.
```bash
aws ses send-bounce --original-message-id <value> --bounce-sender <value> --bounced-recipient-info-list <value>
```
Encore à tester.

### `ses:SendCustomVerificationEmail`

Ceci enverra un email de vérification personnalisé. Il se peut que vous ayez également besoin des autorisations pour créer le modèle d'email.
```bash
aws ses send-custom-verification-email --email-address <value> --template-name <value>
aws sesv2 send-custom-verification-email --email-address <value> --template-name <value>
```
Encore à tester.

## WorkMail pivot pour contourner le sandbox SES

Lorsque `ses:GetAccount` indique que le compte est toujours dans le SES sandbox et que `ses:ListIdentities` ne renvoie aucun expéditeur vérifié, les attaquants peuvent **pivot to WorkMail** pour envoyer immédiatement (pas de sandbox et quotas par défaut plus élevés) en créant des organisations, en vérifiant des domaines et en enregistrant des boîtes aux lettres.

{{#ref}}
../aws-workmail-post-exploitation/README.md
{{#endref}}

## Références

- [Threat Actors Using AWS WorkMail in Phishing Campaigns](https://www.rapid7.com/blog/post/dr-threat-actors-aws-workmail-phishing-campaigns)

{{#include ../../../../banners/hacktricks-training.md}}
