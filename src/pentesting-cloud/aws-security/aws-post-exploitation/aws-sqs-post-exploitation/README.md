# AWS - SQS Post Exploitation

{{#include ../../../../banners/hacktricks-training.md}}

## SQS

有关更多信息，请查看：

{{#ref}}
../../aws-services/aws-sqs-and-sns-enum.md
{{#endref}}

### `sqs:SendMessage` , `sqs:SendMessageBatch`

attacker 可能会向 SQS 队列发送恶意或不需要的消息，可能导致数据损坏、触发非预期操作或耗尽资源。
```bash
aws sqs send-message --queue-url <value> --message-body <value>
aws sqs send-message-batch --queue-url <value> --entries <value>
```
**潜在影响**: 漏洞利用、数据损坏、非预期操作或资源耗尽。

### `sqs:ReceiveMessage`, `sqs:DeleteMessage`, `sqs:ChangeMessageVisibility`

攻击者可能接收、删除或修改 SQS 队列中消息的可见性，导致消息丢失、数据损坏或依赖这些消息的应用程序发生服务中断。
```bash
aws sqs receive-message --queue-url <value>
aws sqs delete-message --queue-url <value> --receipt-handle <value>
aws sqs change-message-visibility --queue-url <value> --receipt-handle <value> --visibility-timeout <value>
```
**潜在影响**: 窃取敏感信息、消息丢失、数据损坏，以及依赖受影响消息的应用程序发生服务中断。

### `sqs:DeleteQueue`

攻击者可能删除整个 SQS 队列，导致消息丢失并影响依赖该队列的应用程序。
```bash
aws sqs delete-queue --queue-url <value>
```
**潜在影响**: 消息丢失以及使用已删除队列的应用可能出现服务中断。

### `sqs:PurgeQueue`

攻击者可能清空 SQS 队列中的所有消息，导致消息丢失并可能扰乱依赖这些消息的应用程序。
```bash
aws sqs purge-queue --queue-url <value>
```
**Potential Impact**: 对依赖被清除消息的应用可能导致消息丢失与服务中断。

### `sqs:SetQueueAttributes`

攻击者可能修改 SQS 队列的属性，从而可能影响其性能、安全性或可用性。
```bash
aws sqs set-queue-attributes --queue-url <value> --attributes <value>
```
**潜在影响**: 配置错误可能导致性能下降、安全问题或可用性降低。

### `sqs:TagQueue` , `sqs:UntagQueue`

攻击者可能会向 SQS 资源添加、修改或删除标签，从而干扰组织的基于标签的成本分配、资源跟踪和访问控制策略。
```bash
aws sqs tag-queue --queue-url <value> --tags Key=<key>,Value=<value>
aws sqs untag-queue --queue-url <value> --tag-keys <key>
```
**潜在影响**: 成本分配、资源跟踪，以及基于标签的访问控制策略的中断。

### `sqs:RemovePermission`

An attacker 可能通过删除与 SQS 队列 关联的策略来撤销合法用户或服务的权限。这可能导致依赖该队列的应用程序的正常运行中断。
```bash
aws sqs remove-permission --queue-url <value> --label <value>
```
**潜在影响**: 由于未经授权移除权限，依赖该队列的应用程序的正常运行可能会中断。

### More SQS Post-Exploitation Techniques

{{#ref}}
aws-sqs-dlq-redrive-exfiltration.md
{{#endref}}

{{#ref}}
aws-sqs-sns-injection.md
{{#endref}}

{{#include ../../../../banners/hacktricks-training.md}}
