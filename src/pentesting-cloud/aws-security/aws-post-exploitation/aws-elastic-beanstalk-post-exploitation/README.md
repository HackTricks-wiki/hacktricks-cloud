# AWS - Elastic Beanstalk Post Exploitation

{{#include ../../../../banners/hacktricks-training.md}}

## Elastic Beanstalk

詳細情報:

{{#ref}}
../../aws-services/aws-elastic-beanstalk-enum.md
{{#endref}}

### `elasticbeanstalk:DeleteApplicationVersion`

> [!NOTE]
> TODO: これにさらに権限が必要かテストする

攻撃者が `elasticbeanstalk:DeleteApplicationVersion` 権限を持っていると、**既存のアプリケーションバージョンを削除できる**。この操作はアプリケーションのデプロイパイプラインを混乱させる可能性があり、バックアップがなければ特定のアプリケーションバージョンの喪失を引き起こすことがある。
```bash
aws elasticbeanstalk delete-application-version --application-name my-app --version-label my-version
```
**Potential Impact**: アプリケーションのデプロイの中断およびアプリケーションバージョンの喪失の可能性。

### `elasticbeanstalk:TerminateEnvironment`

> [!NOTE]
> TODO: これにさらに権限が必要か確認する

`elasticbeanstalk:TerminateEnvironment` の権限を持つ攻撃者は **既存の Elastic Beanstalk 環境を終了させることができ**、環境がバックアップに対応していない場合はアプリケーションのダウンタイムや潜在的なデータ損失を引き起こします。
```bash
aws elasticbeanstalk terminate-environment --environment-name my-existing-env
```
**Potential Impact**: アプリケーションのダウンタイム、データ損失の可能性、およびサービスの中断。

### `elasticbeanstalk:DeleteApplication`

> [!NOTE]
> TODO: この操作にさらに権限が必要かどうかを確認する

`elasticbeanstalk:DeleteApplication` の権限を持つ攻撃者は、**Elastic Beanstalk のアプリケーション全体を削除する**（すべてのバージョンと環境を含む）ことができます。バックアップがない場合、この操作によりアプリケーションのリソースや設定が大幅に失われる可能性があります。
```bash
aws elasticbeanstalk delete-application --application-name my-app --terminate-env-by-force
```
**潜在的な影響**: アプリケーションのリソース、設定、環境、およびアプリケーションのバージョンの喪失により、サービス停止や潜在的なデータ損失を引き起こす可能性があります。

### `elasticbeanstalk:SwapEnvironmentCNAMEs`

> [!NOTE]
> TODO: 追加で権限が必要かテストする

`elasticbeanstalk:SwapEnvironmentCNAMEs` 権限を持つ攻撃者は、**2つの Elastic Beanstalk 環境の CNAME レコードを入れ替える**ことができ、これによりユーザーに誤ったバージョンのアプリケーションが提供されたり、意図しない動作を引き起こしたりする可能性があります。
```bash
aws elasticbeanstalk swap-environment-cnames --source-environment-name my-env-1 --destination-environment-name my-env-2
```
**潜在的な影響**: 環境が入れ替わることでユーザーに誤ったバージョンのアプリケーションが配信されたり、アプリケーション内で意図しない動作が発生する可能性があります。

### `elasticbeanstalk:AddTags`, `elasticbeanstalk:RemoveTags`

> [!NOTE]
> TODO: これにさらに多くの権限が必要かどうかをテストする

`elasticbeanstalk:AddTags` および `elasticbeanstalk:RemoveTags` の権限を持つ攻撃者は、**Elastic Beanstalk リソースのタグを追加または削除する**ことができます。 この操作により、リソースの割り当てミス、請求の誤り、またはリソース管理の問題が発生する可能性があります。
```bash
aws elasticbeanstalk add-tags --resource-arn arn:aws:elasticbeanstalk:us-west-2:123456789012:environment/my-app/my-env --tags Key=MaliciousTag,Value=1

aws elasticbeanstalk remove-tags --resource-arn arn:aws:elasticbeanstalk:us-west-2:123456789012:environment/my-app/my-env --tag-keys MaliciousTag
```
**潜在的な影響**: タグの追加や削除により、リソースの割り当て、請求、またはリソース管理が不適切になる可能性があります。

{{#include ../../../../banners/hacktricks-training.md}}
