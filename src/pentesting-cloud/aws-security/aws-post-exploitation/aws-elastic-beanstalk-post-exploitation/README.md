# AWS - Elastic Beanstalk Post Exploitation

{{#include ../../../../banners/hacktricks-training.md}}

## Elastic Beanstalk

更多信息：

{{#ref}}
../../aws-services/aws-elastic-beanstalk-enum.md
{{#endref}}

### `elasticbeanstalk:DeleteApplicationVersion`

> [!NOTE]
> TODO：测试是否需要额外的权限

拥有权限 `elasticbeanstalk:DeleteApplicationVersion` 的攻击者可以 **删除现有的应用版本**。该操作可能会扰乱应用部署流水线，或导致特定应用版本在未备份的情况下丢失。
```bash
aws elasticbeanstalk delete-application-version --application-name my-app --version-label my-version
```
**潜在影响**：中断应用部署并可能导致应用版本丢失。

### `elasticbeanstalk:TerminateEnvironment`

> [!NOTE]
> TODO：测试是否为此需要更多权限

拥有 `elasticbeanstalk:TerminateEnvironment` 权限的攻击者可以 **终止现有的 Elastic Beanstalk environment**，导致应用停机，并且如果该环境未配置备份，可能造成数据丢失。
```bash
aws elasticbeanstalk terminate-environment --environment-name my-existing-env
```
**潜在影响**：应用停机、潜在数据丢失和服务中断。

### `elasticbeanstalk:DeleteApplication`

> [!NOTE]
> TODO: 测试是否需要更多权限

具有 `elasticbeanstalk:DeleteApplication` 权限的攻击者可以 **删除整个 Elastic Beanstalk 应用**，包括其所有版本和环境。如果没有备份，此操作可能导致应用资源和配置的重大丢失。
```bash
aws elasticbeanstalk delete-application --application-name my-app --terminate-env-by-force
```
**潜在影响**：应用资源、配置、环境和应用版本的丢失，可能导致服务中断和潜在的数据丢失。

### `elasticbeanstalk:SwapEnvironmentCNAMEs`

> [!NOTE]
> TODO：测试是否需要更多权限

具有 `elasticbeanstalk:SwapEnvironmentCNAMEs` 权限的攻击者可以**交换两个 Elastic Beanstalk 环境的 CNAME 记录**，这可能导致向用户提供错误的应用版本或引发意外的行为。
```bash
aws elasticbeanstalk swap-environment-cnames --source-environment-name my-env-1 --destination-environment-name my-env-2
```
**潜在影响**: 向用户提供错误的应用版本，或因环境被交换而导致应用出现意外行为。

### `elasticbeanstalk:AddTags`, `elasticbeanstalk:RemoveTags`

> [!NOTE]
> TODO: 测试是否需要更多权限

拥有 `elasticbeanstalk:AddTags` 和 `elasticbeanstalk:RemoveTags` 权限的攻击者可以**在 Elastic Beanstalk 资源上添加或移除 tags**。此操作可能导致资源分配错误、计费问题或资源管理异常。
```bash
aws elasticbeanstalk add-tags --resource-arn arn:aws:elasticbeanstalk:us-west-2:123456789012:environment/my-app/my-env --tags Key=MaliciousTag,Value=1

aws elasticbeanstalk remove-tags --resource-arn arn:aws:elasticbeanstalk:us-west-2:123456789012:environment/my-app/my-env --tag-keys MaliciousTag
```
**潜在影响**: 由于添加或删除标签，导致资源分配、计费或资源管理不正确。

{{#include ../../../../banners/hacktricks-training.md}}
