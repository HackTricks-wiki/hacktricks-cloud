# AWS - SNS Post Exploitation

{{#include ../../../../banners/hacktricks-training.md}}

## SNS

Para más información:

{{#ref}}
../../aws-services/aws-sns-enum.md
{{#endref}}

### Interrumpir mensajes

En varios casos, los SNS topics se usan para enviar mensajes a plataformas que están siendo monitorizadas (correos electrónicos, slack messages...). Si un atacante impide el envío de los mensajes que alertan sobre su presencia en la nube, podría permanecer sin ser detectado.

### `sns:DeleteTopic`

Un atacante podría eliminar un SNS topic entero, provocando pérdida de mensajes e impactando aplicaciones que dependen de dicho topic.
```bash
aws sns delete-topic --topic-arn <value>
```
**Impacto potencial**: Pérdida de mensajes e interrupción del servicio para las aplicaciones que usan el topic eliminado.

### `sns:Publish`

Un atacante podría enviar mensajes maliciosos o no deseados al topic de SNS, potencialmente provocando corrupción de datos, desencadenando acciones no deseadas o agotando recursos.
```bash
aws sns publish --topic-arn <value> --message <value>
```
**Impacto potencial**: Corrupción de datos, acciones no intencionadas o agotamiento de recursos.

### `sns:SetTopicAttributes`

Un atacante podría modificar los atributos de un SNS topic, afectando potencialmente su rendimiento, seguridad o disponibilidad.
```bash
aws sns set-topic-attributes --topic-arn <value> --attribute-name <value> --attribute-value <value>
```
**Impacto potencial**: Misconfiguraciones que pueden provocar degradación del rendimiento, problemas de seguridad o disminución de la disponibilidad.

### `sns:Subscribe` , `sns:Unsubscribe`

Un atacante podría suscribirse o anular la suscripción a un tema de SNS, obteniendo potencialmente acceso no autorizado a los mensajes o interrumpiendo el funcionamiento normal de las aplicaciones que dependen del tema.
```bash
aws sns subscribe --topic-arn <value> --protocol <value> --endpoint <value>
aws sns unsubscribe --subscription-arn <value>
```
**Impacto potencial**: Acceso no autorizado a mensajes, interrupción del servicio para aplicaciones que dependen del topic afectado.

### `sns:AddPermission` , `sns:RemovePermission`

Un atacante podría otorgar a usuarios o servicios no autorizados acceso a un SNS topic, o revocar permisos a usuarios legítimos, causando interrupciones en el funcionamiento normal de las aplicaciones que dependen del topic.
```bash
aws sns add-permission --topic-arn <value> --label <value> --aws-account-id <value> --action-name <value>
aws sns remove-permission --topic-arn <value> --label <value>
```
**Impacto potencial**: Acceso no autorizado al topic, exposición de mensajes o manipulación del topic por usuarios o servicios no autorizados, interrupción del funcionamiento normal de las aplicaciones que dependen del topic.

### `sns:TagResource` , `sns:UntagResource`

Un atacante podría agregar, modificar o eliminar etiquetas de los recursos de SNS, interrumpiendo la asignación de costos de su organización, el seguimiento de recursos y las políticas de control de acceso basadas en etiquetas.
```bash
aws sns tag-resource --resource-arn <value> --tags Key=<key>,Value=<value>
aws sns untag-resource --resource-arn <value> --tag-keys <key>
```
**Impacto potencial**: Interrupción de la asignación de costos, el seguimiento de recursos y las políticas de control de acceso basadas en etiquetas.

### Más SNS Post-Exploitation Techniques

{{#ref}}
aws-sns-data-protection-bypass.md
{{#endref}}

{{#ref}}
aws-sns-fifo-replay-exfil.md
{{#endref}}

{{#ref}}
aws-sns-firehose-exfil.md
{{#endref}}

{{#include ../../../../banners/hacktricks-training.md}}
