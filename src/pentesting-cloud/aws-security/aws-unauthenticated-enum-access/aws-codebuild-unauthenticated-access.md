# AWS - CodeBuild Unauthenticated Access

{{#include ../../../banners/hacktricks-training.md}}

## CodeBuild

Aby uzyskać więcej informacji, sprawdź tę stronę:

{{#ref}}
../aws-services/aws-codebuild-enum.md
{{#endref}}

### buildspec.yml

Jeśli uzyskasz dostęp do zapisu w repozytorium zawierającym plik o nazwie **`buildspec.yml`**, możesz **wprowadzić tylne wejście** do tego pliku, który określa **komendy, które będą wykonywane** w projekcie CodeBuild i wyeksportować sekrety, skompromitować to, co jest robione, a także skompromitować **poświadczenia roli IAM CodeBuild**.

Zauważ, że nawet jeśli nie ma pliku **`buildspec.yml`**, ale wiesz, że Codebuild jest używany (lub inny CI/CD), **modyfikacja jakiegoś legalnego kodu**, który ma być wykonany, może również dać ci powłokę odwrotną na przykład.

Aby uzyskać powiązane informacje, możesz sprawdzić stronę o tym, jak atakować Github Actions (podobnie jak to):

{{#ref}}
../../../pentesting-ci-cd/github-security/abusing-github-actions/
{{#endref}}

## Self-hosted GitHub Actions runners in AWS CodeBuild <a href="#action-runner" id="action-runner"></a>

Jak [**wskazano w dokumentacji**](https://docs.aws.amazon.com/codebuild/latest/userguide/action-runner.html), możliwe jest skonfigurowanie **CodeBuild** do uruchamiania **self-hosted Github actions**, gdy workflow jest uruchamiany w skonfigurowanym repozytorium Github. Można to wykryć, sprawdzając konfigurację projektu CodeBuild, ponieważ **`Event type`** musi zawierać: **`WORKFLOW_JOB_QUEUED`** i w workflow Github, ponieważ wybierze **self-hosted** runnera w ten sposób:
```bash
runs-on: codebuild-<project-name>-${{ github.run_id }}-${{ github.run_attempt }}
```
Nowa relacja między Github Actions a AWS tworzy kolejny sposób na kompromitację AWS z Github, ponieważ kod w Github będzie uruchamiany w projekcie CodeBuild z dołączoną rolą IAM.

{{#include ../../../banners/hacktricks-training.md}}
