# AWS - CodeBuild Μη αυθεντικοποιημένη Πρόσβαση

{{#include ../../../../banners/hacktricks-training.md}}

## CodeBuild

Για περισσότερες πληροφορίες δείτε αυτή τη σελίδα:

{{#ref}}
../../aws-services/aws-codebuild-enum.md
{{#endref}}

### buildspec.yml

Εάν αποκτήσετε write access σε ένα repository που περιέχει ένα αρχείο με όνομα **`buildspec.yml`**, θα μπορούσατε να **backdoor** αυτό το αρχείο, το οποίο καθορίζει τις **commands that are going to be executed** μέσα σε ένα CodeBuild project και να exfiltrate the secrets, compromise what is done και επίσης να compromise τα **CodeBuild IAM role credentials**.

Σημειώστε ότι ακόμη και αν δεν υπάρχει κάποιο **`buildspec.yml`** αρχείο αλλά γνωρίζετε ότι χρησιμοποιείται το Codebuild (ή κάποιο διαφορετικό CI/CD) **modifying some legit code** που πρόκειται να εκτελεστεί μπορεί επίσης να σας δώσει ένα reverse shell για παράδειγμα.

Για σχετικές πληροφορίες μπορείτε να δείτε τη σελίδα για το πώς να επιτεθείτε σε Github Actions (παρόμοιο με αυτό):

{{#ref}}
../../../../pentesting-ci-cd/github-security/abusing-github-actions/
{{#endref}}

## Self-hosted GitHub Actions runners in AWS CodeBuild <a href="#action-runner" id="action-runner"></a>

Όπως [**αναφέρεται στα docs**](https://docs.aws.amazon.com/codebuild/latest/userguide/action-runner.html), είναι δυνατό να διαμορφώσετε το **CodeBuild** ώστε να τρέχει **self-hosted Github actions** όταν ενεργοποιείται ένα workflow μέσα σε ένα διαμορφωμένο Github repo. Αυτό μπορεί να εντοπιστεί ελέγχοντας τη ρύθμιση του CodeBuild project επειδή το **`Event type`** πρέπει να περιέχει: **`WORKFLOW_JOB_QUEUED`** και σε ένα Github Workflow επειδή θα επιλέξει έναν **self-hosted** runner όπως το παρακάτω:
```bash
runs-on: codebuild-<project-name>-${{ github.run_id }}-${{ github.run_attempt }}
```
Αυτή η νέα σχέση μεταξύ Github Actions και AWS δημιουργεί έναν ακόμη τρόπο να παραβιαστεί το AWS από το Github, καθώς ο κώδικας στο Github θα εκτελείται σε ένα έργο CodeBuild με συνημμένο ρόλο IAM.

{{#include ../../../../banners/hacktricks-training.md}}
