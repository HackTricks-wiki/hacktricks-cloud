# AWS - CodeBuild Nieautoryzowany dostęp

{{#include ../../../../banners/hacktricks-training.md}}

## CodeBuild

Aby uzyskać więcej informacji, sprawdź tę stronę:

{{#ref}}
../../aws-services/aws-codebuild-enum.md
{{#endref}}

### buildspec.yml

Jeśli uzyskasz uprawnienia zapisu do repozytorium zawierającego plik o nazwie **`buildspec.yml`**, możesz backdoorować ten plik, który określa **polecenia, które będą wykonywane** w projekcie CodeBuild, exfiltrate secrets, przejąć wykonywane czynności, a także przejąć poświadczenia roli IAM CodeBuild.

Zauważ, że nawet jeśli nie ma pliku **`buildspec.yml`**, ale wiesz, że używany jest CodeBuild (lub inne CI/CD), **modyfikacja jakiegoś legalnego kodu**, który będzie wykonywany, może również dać na przykład reverse shell.

Dla powiązanych informacji możesz sprawdzić stronę o tym, jak atakować Github Actions (podobne do tego):

{{#ref}}
../../../../pentesting-ci-cd/github-security/abusing-github-actions/
{{#endref}}

## Self-hosted GitHub Actions runners in AWS CodeBuild <a href="#action-runner" id="action-runner"></a>

As [**indicated in the docs**](https://docs.aws.amazon.com/codebuild/latest/userguide/action-runner.html), It's possible to configure **CodeBuild** to run **self-hosted Github actions** when a workflow is triggered inside a Github repo configured. This can be detected checking the CodeBuild project configuration because the **`Event type`** needs to contain: **`WORKFLOW_JOB_QUEUED`** and in a Github Workflow because it will select a **self-hosted** runner like this:
```bash
runs-on: codebuild-<project-name>-${{ github.run_id }}-${{ github.run_attempt }}
```
Ta nowa relacja między Github Actions a AWS tworzy kolejny sposób na compromise AWS z poziomu Github, ponieważ kod w Github będzie uruchamiany w projekcie CodeBuild z dołączoną rolą IAM.

{{#include ../../../../banners/hacktricks-training.md}}
