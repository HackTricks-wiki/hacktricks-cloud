# AWS - ECR Unauthenticated Enum

{{#include ../../../banners/hacktricks-training.md}}

## ECR

Für weitere Informationen siehe:

{{#ref}}
../aws-services/aws-ecr-enum.md
{{#endref}}

### Öffentliche Registrierungsrepositories (Bilder)

Wie im Abschnitt ECS Enum erwähnt, ist ein öffentliches Repository **für jeden zugänglich** und verwendet das Format **`public.ecr.aws/<random>/<name>`**. Wenn ein Angreifer eine URL zu einem öffentlichen Repository findet, könnte er **das Bild herunterladen und nach sensiblen Informationen** in den Metadaten und dem Inhalt des Bildes suchen.
```bash
aws ecr describe-repositories --query 'repositories[?repositoryUriPublic == `true`].repositoryName' --output text
```
> [!WARNING]
> Dies könnte auch in **privaten Registrierungen** passieren, wo eine Registrierungsrichtlinie oder eine Repository-Richtlinie **Zugriff gewährt, zum Beispiel auf `"AWS": "*"`**. Jeder mit einem AWS-Konto könnte auf dieses Repo zugreifen.

### Private Repo auflisten

Die Tools [**skopeo**](https://github.com/containers/skopeo) und [**crane**](https://github.com/google/go-containerregistry/blob/main/cmd/crane/doc/crane.md) können verwendet werden, um zugängliche Repositories innerhalb einer privaten Registrierungsstelle aufzulisten.
```bash
# Get image names
skopeo list-tags docker://<PRIVATE_REGISTRY_URL> | grep -oP '(?<=^Name: ).+'
crane ls <PRIVATE_REGISTRY_URL> | sed 's/ .*//'
```
{{#include ../../../banners/hacktricks-training.md}}
