# AWS - ECR 인증되지 않은 열거

{{#include ../../../banners/hacktricks-training.md}}

## ECR

자세한 정보는 다음을 확인하세요:

{{#ref}}
../aws-services/aws-ecr-enum.md
{{#endref}}

### 공개 레지스트리 리포지토리 (이미지)

ECS Enum 섹션에서 언급했듯이, 공개 레지스트리는 **누구나 접근할 수 있습니다** 형식은 **`public.ecr.aws/<random>/<name>`**입니다. 공격자가 공개 리포지토리 URL을 찾으면 **이미지를 다운로드하고 메타데이터 및 이미지 내용에서 민감한 정보를 검색할 수 있습니다.**
```bash
aws ecr describe-repositories --query 'repositories[?repositoryUriPublic == `true`].repositoryName' --output text
```
> [!WARNING]
> 이것은 **개인 레지스트리**에서도 발생할 수 있으며, 레지스트리 정책이나 리포지토리 정책이 **예를 들어 `"AWS": "*"`**에 대한 접근을 허용하고 있습니다. AWS 계정이 있는 누구나 해당 리포지토리에 접근할 수 있습니다.

### 개인 리포지토리 열거

도구 [**skopeo**](https://github.com/containers/skopeo)와 [**crane**](https://github.com/google/go-containerregistry/blob/main/cmd/crane/doc/crane.md)를 사용하여 개인 레지스트리 내에서 접근 가능한 리포지토리를 나열할 수 있습니다.
```bash
# Get image names
skopeo list-tags docker://<PRIVATE_REGISTRY_URL> | grep -oP '(?<=^Name: ).+'
crane ls <PRIVATE_REGISTRY_URL> | sed 's/ .*//'
```
{{#include ../../../banners/hacktricks-training.md}}
