# AWS - ECR Unauthenticated Enum

{{#include ../../../banners/hacktricks-training.md}}

## ECR

Para más información, consulta:

{{#ref}}
../aws-services/aws-ecr-enum.md
{{#endref}}

### Repositorios de registro público (imágenes)

Como se mencionó en la sección de Enum de ECS, un registro público es **accesible por cualquier persona** y utiliza el formato **`public.ecr.aws/<random>/<name>`**. Si un atacante localiza una URL de repositorio público, podría **descargar la imagen y buscar información sensible** en los metadatos y el contenido de la imagen.
```bash
aws ecr describe-repositories --query 'repositories[?repositoryUriPublic == `true`].repositoryName' --output text
```
> [!WARNING]
> Esto también podría suceder en **registros privados** donde una política de registro o una política de repositorio está **otorgando acceso, por ejemplo, a `"AWS": "*"`**. Cualquiera con una cuenta de AWS podría acceder a ese repositorio.

### Enumerar Repositorio Privado

Las herramientas [**skopeo**](https://github.com/containers/skopeo) y [**crane**](https://github.com/google/go-containerregistry/blob/main/cmd/crane/doc/crane.md) se pueden usar para listar los repositorios accesibles dentro de un registro privado.
```bash
# Get image names
skopeo list-tags docker://<PRIVATE_REGISTRY_URL> | grep -oP '(?<=^Name: ).+'
crane ls <PRIVATE_REGISTRY_URL> | sed 's/ .*//'
```
{{#include ../../../banners/hacktricks-training.md}}
