# AWS - Cognito Unauthenticated Enum

{{#include ../../../banners/hacktricks-training.md}}

## Unauthenticated Cognito

Το Cognito είναι μια υπηρεσία AWS που επιτρέπει στους προγραμματιστές να **παρέχουν στους χρήστες της εφαρμογής τους πρόσβαση σε υπηρεσίες AWS**. Οι προγραμματιστές θα παρέχουν **ρόλους IAM σε αυθεντικοποιημένους χρήστες** στην εφαρμογή τους (πιθανώς οι άνθρωποι θα μπορούν απλώς να εγγραφούν) και μπορούν επίσης να παρέχουν έναν **ρόλο IAM σε μη αυθεντικοποιημένους χρήστες**.

Για βασικές πληροφορίες σχετικά με το Cognito, ελέγξτε:

{{#ref}}
../aws-services/aws-cognito-enum/
{{#endref}}

### Identity Pool ID

Οι Identity Pools μπορούν να παρέχουν **ρόλους IAM σε μη αυθεντικοποιημένους χρήστες** που απλώς **γνωρίζουν το Identity Pool ID** (το οποίο είναι αρκετά κοινό να **βρείτε**), και ένας επιτιθέμενος με αυτές τις πληροφορίες θα μπορούσε να προσπαθήσει να **πρόσβαση σε αυτόν τον ρόλο IAM** και να τον εκμεταλλευτεί.\
Επιπλέον, οι ρόλοι IAM θα μπορούσαν επίσης να ανατεθούν σε **αυθεντικοποιημένους χρήστες** που έχουν πρόσβαση στην Identity Pool. Εάν ένας επιτιθέμενος μπορεί να **εγγραφεί ως χρήστης** ή έχει ήδη **πρόσβαση στον πάροχο ταυτότητας** που χρησιμοποιείται στην identity pool, θα μπορούσε να έχει πρόσβαση στον **ρόλο IAM που παρέχεται σε αυθεντικοποιημένους** χρήστες και να καταχραστεί τα προνόμιά του.

[**Δείτε πώς να το κάνετε αυτό εδώ**](../aws-services/aws-cognito-enum/cognito-identity-pools.md).

### User Pool ID

Από προεπιλογή, το Cognito επιτρέπει την **εγγραφή νέου χρήστη**. Η δυνατότητα εγγραφής ενός χρήστη μπορεί να σας δώσει **πρόσβαση** στην **υποκείμενη εφαρμογή** ή στον **ρόλο πρόσβασης IAM που έχει αυθεντικοποιηθεί μιας Identity Pool** που δέχεται ως πάροχο ταυτότητας το Cognito User Pool. [**Δείτε πώς να το κάνετε αυτό εδώ**](../aws-services/aws-cognito-enum/cognito-user-pools.md#registration).

### Pacu modules for pentesting and enumeration

[Pacu](https://github.com/RhinoSecurityLabs/pacu), το πλαίσιο εκμετάλλευσης AWS, περιλαμβάνει τώρα τα modules "cognito\_\_enum" και "cognito\_\_attack" που αυτοματοποιούν την καταμέτρηση όλων των περιουσιακών στοιχείων Cognito σε έναν λογαριασμό και επισημαίνουν αδύναμες ρυθμίσεις, χαρακτηριστικά χρηστών που χρησιμοποιούνται για τον έλεγχο πρόσβασης, κ.λπ., και επίσης αυτοματοποιούν τη δημιουργία χρηστών (συμπεριλαμβανομένης της υποστήριξης MFA) και την κλιμάκωση προνομίων με βάση τροποποιήσιμα προσαρμοσμένα χαρακτηριστικά, χρησιμοποιήσιμα διαπιστευτήρια identity pool, ρόλους που μπορούν να αναληφθούν σε id tokens, κ.λπ.

Για περιγραφή των λειτουργιών των modules, δείτε το μέρος 2 της [ανάρτησης στο blog](https://rhinosecuritylabs.com/aws/attacking-aws-cognito-with-pacu-p2). Για οδηγίες εγκατάστασης, δείτε την κύρια σελίδα [Pacu](https://github.com/RhinoSecurityLabs/pacu).

#### Usage

Δείγμα χρήσης `cognito__attack` για να προσπαθήσετε να δημιουργήσετε χρήστη και όλους τους διαύλους privesc κατά ενός συγκεκριμένου identity pool και client user pool:
```bash
Pacu (new:test) > run cognito__attack --username randomuser --email XX+sdfs2@gmail.com --identity_pools
us-east-2:a06XXXXX-c9XX-4aXX-9a33-9ceXXXXXXXXX --user_pool_clients
59f6tuhfXXXXXXXXXXXXXXXXXX@us-east-2_0aXXXXXXX
```
Δείγμα χρήσης cognito\_\_enum για τη συλλογή όλων των πισινών χρηστών, πελατών πισινών χρηστών, πισινών ταυτοτήτων, χρηστών κ.λπ. που είναι ορατές στον τρέχοντα λογαριασμό AWS:
```bash
Pacu (new:test) > run cognito__enum
```
{{#include ../../../banners/hacktricks-training.md}}
