# AWS - Cognito Ongeauthentiseerde Enum

{{#include ../../../banners/hacktricks-training.md}}

## Ongeauthentiseerde Cognito

Cognito is 'n AWS-diens wat ontwikkelaars in staat stel om **hul app-gebruikers toegang tot AWS-dienste te gee**. Ontwikkelaars sal **IAM-rolle aan geverifieerde gebruikers** in hul app toeken (potensieel kan mense net aanmeld) en hulle kan ook 'n **IAM-rol aan ongeauthentiseerde gebruikers** toeken.

Vir basiese inligting oor Cognito, kyk:

{{#ref}}
../aws-services/aws-cognito-enum/
{{#endref}}

### Identiteit Pool ID

Identiteit Pools kan **IAM-rolle aan ongeauthentiseerde gebruikers** toeken wat net **die Identiteit Pool ID** ken (wat redelik algemeen is om te **vind**), en 'n aanvaller met hierdie inligting kan probeer om **toegang tot daardie IAM-rol** te verkry en dit te misbruik.\
Boonop kan IAM-rolle ook toegeken word aan **geauthentiseerde gebruikers** wat toegang tot die Identiteit Pool het. As 'n aanvaller **'n gebruiker kan registreer** of reeds **toegang tot die identiteitsverskaffer** het wat in die identiteits pool gebruik word, kan jy toegang verkry tot die **IAM-rol wat aan geauthentiseerde** gebruikers gegee word en sy voorregte misbruik.

[**Kyk hoe om dit hier te doen**](../aws-services/aws-cognito-enum/cognito-identity-pools.md).

### Gebruiker Pool ID

Standaard laat Cognito toe om **nuwe gebruikers te registreer**. In staat wees om 'n gebruiker te registreer, kan jou **toegang** gee tot die **onderliggende toepassing** of tot die **geauthentiseerde IAM-toegang rol van 'n Identiteit Pool** wat die Cognito Gebruiker Pool as identiteitsverskaffer aanvaar. [**Kyk hoe om dit hier te doen**](../aws-services/aws-cognito-enum/cognito-user-pools.md#registration).

### Pacu modules vir pentesting en enumerasie

[Pacu](https://github.com/RhinoSecurityLabs/pacu), die AWS-uitbuitingsraamwerk, sluit nou die "cognito\_\_enum" en "cognito\_\_attack" modules in wat die enumerasie van alle Cognito-bates in 'n rekening outomatiseer en swak konfigurasies, gebruikersattributen wat vir toegangbeheer gebruik word, ens., merk, en ook die skepping van gebruikers outomatiseer (insluitend MFA-ondersteuning) en voorregte-eskalasie gebaseer op aanpasbare aangepaste attributen, bruikbare identiteits pool akkrediteer, aanneembare rolle in id tokens, ens.

Vir 'n beskrywing van die modules se funksies, sien deel 2 van die [blogpos](https://rhinosecuritylabs.com/aws/attacking-aws-cognito-with-pacu-p2). Vir installasie-instruksies, sien die hoof [Pacu](https://github.com/RhinoSecurityLabs/pacu) bladsy.

#### Gebruik

Voorbeeld `cognito__attack` gebruik om te probeer om gebruiker te skep en alle privesc vektore teen 'n gegewe identiteits pool en gebruiker pool kliënt:
```bash
Pacu (new:test) > run cognito__attack --username randomuser --email XX+sdfs2@gmail.com --identity_pools
us-east-2:a06XXXXX-c9XX-4aXX-9a33-9ceXXXXXXXXX --user_pool_clients
59f6tuhfXXXXXXXXXXXXXXXXXX@us-east-2_0aXXXXXXX
```
Voorbeeld cognito\_\_enum gebruik om al die gebruikerspoele, gebruikerspoel kliënte, identiteitspoele, gebruikers, ens. wat sigbaar is in die huidige AWS-rekening te versamel:
```bash
Pacu (new:test) > run cognito__enum
```
{{#include ../../../banners/hacktricks-training.md}}
