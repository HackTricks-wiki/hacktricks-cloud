# AWS - ECR Unauthenticated Enum

{{#include ../../../../banners/hacktricks-training.md}}

## ECR

자세한 내용은 다음을 확인하세요:

{{#ref}}
../../aws-services/aws-ecr-enum.md
{{#endref}}

### Public registry 저장소(이미지)

앞서 ECS Enum 섹션에서 언급한 바와 같이, public registry는 **누구나 접근할 수 있으며** 형식은 **`public.ecr.aws/<random>/<name>`** 입니다. 공개 저장소 URL을 공격자가 발견하면, 해당 이미지를 **다운로드하고 이미지의 메타데이터와 내용에서 민감한 정보를 검색할 수 있습니다**.
```bash
aws ecr describe-repositories --query 'repositories[?repositoryUriPublic == `true`].repositoryName' --output text
```
> [!WARNING]
> 이 문제는 레지스트리 정책이나 리포지토리 정책이 예를 들어 **`"AWS": "*"`** 로 접근을 허용하는 경우 **private registries**에서도 발생할 수 있습니다. AWS 계정을 가진 누구나 해당 repo에 접근할 수 있습니다.

### Private Repo 열거

도구 [**skopeo**](https://github.com/containers/skopeo) 및 [**crane**](https://github.com/google/go-containerregistry/blob/main/cmd/crane/doc/crane.md) 를 사용하여 프라이빗 레지스트리 내에서 접근 가능한 저장소를 나열할 수 있습니다.
```bash
# Get image names
skopeo list-tags docker://<PRIVATE_REGISTRY_URL> | grep -oP '(?<=^Name: ).+'
crane ls <PRIVATE_REGISTRY_URL> | sed 's/ .*//'
```
{{#include ../../../../banners/hacktricks-training.md}}
