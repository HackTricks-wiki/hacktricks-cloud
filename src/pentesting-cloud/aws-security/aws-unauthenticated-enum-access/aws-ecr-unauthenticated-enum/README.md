# AWS - ECR Unauthenticated Enum

{{#include ../../../../banners/hacktricks-training.md}}

## ECR

Aby uzyskać więcej informacji, sprawdź:

{{#ref}}
../../aws-services/aws-ecr-enum.md
{{#endref}}

### Public registry repositories (images)

Jak wspomniano w sekcji ECS Enum, publiczny rejestr jest **dostępny dla każdego** i używa formatu **`public.ecr.aws/<random>/<name>`**. Jeśli atakujący znajdzie URL publicznego repozytorium, może **pobrać obraz i przeszukać metadane oraz zawartość obrazu w poszukiwaniu wrażliwych informacji**.
```bash
aws ecr describe-repositories --query 'repositories[?repositoryUriPublic == `true`].repositoryName' --output text
```
> [!WARNING]
> To może się również zdarzyć w przypadku **rejestrów prywatnych**, gdy polityka rejestru lub polityka repozytorium **przyznaje dostęp, na przykład do `"AWS": "*"`**. Każdy posiadający konto AWS mógłby uzyskać dostęp do tego repozytorium.

### Wyliczanie prywatnego repozytorium

Narzędzia [**skopeo**](https://github.com/containers/skopeo) i [**crane**](https://github.com/google/go-containerregistry/blob/main/cmd/crane/doc/crane.md) można użyć do wypisania dostępnych repozytoriów w rejestrze prywatnym.
```bash
# Get image names
skopeo list-tags docker://<PRIVATE_REGISTRY_URL> | grep -oP '(?<=^Name: ).+'
crane ls <PRIVATE_REGISTRY_URL> | sed 's/ .*//'
```
{{#include ../../../../banners/hacktricks-training.md}}
