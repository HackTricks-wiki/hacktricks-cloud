# AWS - ECR Unauthenticated Enum

{{#include ../../../../banners/hacktricks-training.md}}

## ECR

更多信息请参见：

{{#ref}}
../../aws-services/aws-ecr-enum.md
{{#endref}}

### 公共注册表仓库（镜像）

如同在 ECS Enum 部分所述，公共注册表是 **任何人均可访问** 的，其格式为 **`public.ecr.aws/<random>/<name>`**。如果 attacker 定位到一个公共仓库的 URL，他可能会 **下载镜像并在镜像的元数据与内容中搜索敏感信息**。
```bash
aws ecr describe-repositories --query 'repositories[?repositoryUriPublic == `true`].repositoryName' --output text
```
> [!WARNING]
> 这也可能发生在**私有注册表**，当注册表策略或仓库策略**授予访问，例如 `"AWS": "*"`**。任何拥有 AWS 账户的人都可以访问该仓库。

### 枚举私有 Repo

可以使用工具 [**skopeo**](https://github.com/containers/skopeo) 和 [**crane**](https://github.com/google/go-containerregistry/blob/main/cmd/crane/doc/crane.md) 来列出私有注册表中可访问的仓库。
```bash
# Get image names
skopeo list-tags docker://<PRIVATE_REGISTRY_URL> | grep -oP '(?<=^Name: ).+'
crane ls <PRIVATE_REGISTRY_URL> | sed 's/ .*//'
```
{{#include ../../../../banners/hacktricks-training.md}}
