# Amazon Macie - `Reveal Sample` Bütünlüğü Kontrolünü Atlatma

AWS Macie, AWS ortamlarında kimlik bilgileri, kişisel olarak tanımlanabilir bilgiler (PII) ve diğer gizli veriler gibi hassas verileri otomatik olarak tespit eden bir güvenlik hizmetidir. Macie, bir S3 kovasında saklanan bir AWS gizli anahtarı gibi hassas bir kimlik bilgisi tespit ettiğinde, sahibinin tespit edilen verinin bir "örneğini" görüntülemesine olanak tanıyan bir bulgu oluşturur. Genellikle, hassas dosya S3 kovasından kaldırıldığında, gizlinin artık geri alınamayacağı beklenir.

Ancak, yeterli izinlere sahip bir saldırganın **aynı isimle** ancak farklı, hassas olmayan sahte veriler içeren bir dosyayı **yeniden yükleyebileceği** bir **atlatma** tespit edilmiştir. Bu, Macie'nin yeni yüklenen dosyayı orijinal bulgu ile ilişkilendirmesine neden olur ve saldırgana daha önce tespit edilen gizli veriyi çıkarmak için **"Reveal Sample" özelliğini** kullanma imkanı tanır. Bu sorun, silinmiş olduğu varsayılan gizlilerin bu yöntemle geri alınabilir olması nedeniyle önemli bir güvenlik riski oluşturmaktadır.

<img src="https://github.com/user-attachments/assets/c44228ae-12cd-41bd-9a04-57f503a63281" height="800" width="auto"/>

## Tekrar Üretme Adımları:

1. Hassas veriler içeren bir dosya (örneğin, `test-secret.txt`) bir S3 kovasına yükleyin, örneğin bir AWS gizli anahtarı. AWS Macie'nin tarama yapmasını ve bir bulgu oluşturmasını bekleyin.

2. AWS Macie Bulgularına gidin, oluşturulan bulguyu bulun ve tespit edilen gizli veriyi görüntülemek için **Reveal Sample** özelliğini kullanın.

3. `test-secret.txt` dosyasını S3 kovasından silin ve artık mevcut olmadığını doğrulayın.

4. Sahte veriler içeren yeni bir `test-secret.txt` dosyası oluşturun ve bunu **saldırganın hesabı** ile aynı S3 kovasına yeniden yükleyin.

5. AWS Macie Bulgularına geri dönün, orijinal bulguyu erişin ve tekrar **Reveal Sample**'a tıklayın.

6. Dosyanın silinmiş ve farklı içerikle **farklı hesaplardan, bizim durumumuzda saldırganın hesabı** ile değiştirilmiş olmasına rağmen Macie'nin hala orijinal gizli veriyi ortaya çıkardığını gözlemleyin.

## Özet:

Bu güvenlik açığı, yeterli AWS IAM izinlerine sahip bir saldırgana, orijinal dosya S3'ten silinmiş olsa bile daha önce tespit edilen gizli verileri geri alma imkanı tanır. Eğer bir AWS gizli anahtarı, erişim belirteci veya diğer hassas kimlik bilgileri ifşa edilirse, bir saldırgan bu açığı kullanarak bunları geri alabilir ve AWS kaynaklarına yetkisiz erişim sağlayabilir. Bu, ayrıcalık yükselmesine, yetkisiz veri erişimine veya bulut varlıklarının daha fazla tehlikeye girmesine yol açabilir ve veri ihlalleri ile hizmet kesintilerine neden olabilir.
