# Amazon Macie - Omseil `Reveal Sample` Integriteitskontrole

AWS Macie is 'n sekuriteitsdiens wat outomaties sensitiewe data binne AWS-omgewings opspoor, soos geloofsbriewe, persoonlik identifiseerbare inligting (PII), en ander vertroulike data. Wanneer Macie 'n sensitiewe geloofsbewys identifiseer, soos 'n AWS geheime sleutel wat in 'n S3-bucket gestoor is, genereer dit 'n bevinding wat die eienaar toelaat om 'n "monster" van die opgespoorde data te sien. Gewoonlik, sodra die sensitiewe lêer uit die S3-bucket verwyder is, word verwag dat die geheim nie weer verkry kan word nie.

Echter, 'n **omseiling** is geïdentifiseer waar 'n aanvaller met voldoende regte **'n lêer met dieselfde naam kan heroplaai** maar wat verskillende, nie-sensitiewe dummy data bevat. Dit veroorsaak dat Macie die nuut opgelaaide lêer met die oorspronklike bevinding assosieer, wat die aanvaller in staat stel om die **"Reveal Sample" kenmerk** te gebruik om die voorheen opgespoorde geheim te onttrek. Hierdie probleem stel 'n beduidende sekuriteitsrisiko voor, aangesien geheime wat veronderstel was om verwyder te wees, steeds deur hierdie metode verkrybaar bly.

<img src="https://github.com/user-attachments/assets/c44228ae-12cd-41bd-9a04-57f503a63281" height="800" width="auto"/>

## Stappe om te herhaal:

1. Laai 'n lêer op (bv. `test-secret.txt`) na 'n S3-bucket met sensitiewe data, soos 'n AWS geheime sleutel. Wag vir AWS Macie om te skandeer en 'n bevinding te genereer.

2. Navigeer na AWS Macie Findings, vind die gegenereerde bevinding, en gebruik die **Reveal Sample** kenmerk om die opgespoorde geheim te sien.

3. Verwyder `test-secret.txt` uit die S3-bucket en verifieer dat dit nie meer bestaan nie.

4. Skep 'n nuwe lêer met die naam `test-secret.txt` met dummy data en laai dit weer op na dieselfde S3-bucket met behulp van **die aanvaller se rekening**.

5. Keer terug na AWS Macie Findings, toegang die oorspronklike bevinding, en klik weer op **Reveal Sample**.

6. Observeer dat Macie steeds die oorspronklike geheim onthul, ten spyte daarvan dat die lêer verwyder en met verskillende inhoud **van verskillende rekeninge, in ons geval sal dit die aanvaller se rekening wees** vervang is.

## Samevatting:

Hierdie kwesbaarheid laat 'n aanvaller met voldoende AWS IAM-regte toe om voorheen opgespoorde geheime te herstel, selfs nadat die oorspronklike lêer uit S3 verwyder is. As 'n AWS geheime sleutel, toegangstoken, of ander sensitiewe geloofsbewys blootgestel word, kan 'n aanvaller hierdie fout benut om dit te verkry en ongeoorloofde toegang tot AWS-hulpbronne te verkry. Dit kan lei tot regte-omhoog, ongeoorloofde data-toegang, of verdere kompromie van wolk bates, wat lei tot datalekke en diensonderbrekings.
