# AWS - MSK Privesc

{{#include ../../../../banners/hacktricks-training.md}}

## MSK

MSK (Kafka) の詳細は次を参照してください:

{{#ref}}
../../aws-services/aws-msk-enum.md
{{#endref}}

### `msk:ListClusters`, `msk:UpdateSecurity`

これらの **privileges** と **access to the VPC where the kafka brokers are** があれば、**None authentication** を追加してそれらにアクセスできるようにできます。
```bash
aws msk --client-authentication <value> --cluster-arn <value> --current-version <value>
```
VPC へのアクセスが必要です。なぜなら、**Kafka を公開した状態では None authentication を有効にできない**からです。もし公開されている場合、**SASL/SCRAM** 認証が使用されていると、アクセスするために**シークレットを読み取る**ことができる（シークレットを読み取るには追加の権限が必要です）。\
もし**IAM role-based authentication**が使用され、**kafka が公開されている**場合でも、これらの権限を悪用して自分がアクセスできるように権限を付与させることができます。

{{#include ../../../../banners/hacktricks-training.md}}
