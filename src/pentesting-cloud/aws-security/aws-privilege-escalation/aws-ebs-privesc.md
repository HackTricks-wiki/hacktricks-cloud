# AWS - EBS Privesc

{{#include ../../../banners/hacktricks-training.md}}

## EBS

### `ebs:ListSnapshotBlocks`, `ebs:GetSnapshotBlock`, `ec2:DescribeSnapshots`

拥有这些权限的攻击者将能够**在本地下载和分析卷快照**，并在其中搜索敏感信息（如秘密或源代码）。了解如何做到这一点：

{{#ref}}
../aws-post-exploitation/aws-ec2-ebs-ssm-and-vpc-post-exploitation/aws-ebs-snapshot-dump.md
{{#endref}}

其他权限也可能有用，例如：`ec2:DescribeInstances`，`ec2:DescribeVolumes`，`ec2:DeleteSnapshot`，`ec2:CreateSnapshot`，`ec2:CreateTags`

工具 [https://github.com/Static-Flow/CloudCopy](https://github.com/Static-Flow/CloudCopy) 执行此攻击以**从域控制器提取密码**。

**潜在影响：** 通过在快照中定位敏感信息间接提升权限（您甚至可以获取Active Directory密码）。

### **`ec2:CreateSnapshot`**

任何拥有**`EC2:CreateSnapshot`**权限的AWS用户都可以通过创建**域控制器的快照**来窃取所有域用户的哈希，将其挂载到他们控制的实例上，并**导出NTDS.dit和SYSTEM**注册表蜂巢文件，以便与Impacket的secretsdump项目一起使用。

您可以使用此工具来自动化攻击：[https://github.com/Static-Flow/CloudCopy](https://github.com/Static-Flow/CloudCopy)，或者在创建快照后使用之前的技术之一。

{{#include ../../../banners/hacktricks-training.md}}
