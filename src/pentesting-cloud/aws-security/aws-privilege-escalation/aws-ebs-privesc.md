# AWS - EBS Privesc

{{#include ../../../banners/hacktricks-training.md}}

## EBS

### `ebs:ListSnapshotBlocks`, `ebs:GetSnapshotBlock`, `ec2:DescribeSnapshots`

Un atacante con esos permisos podrá **descargar y analizar instantáneas de volúmenes localmente** y buscar información sensible en ellas (como secretos o código fuente). Encuentra cómo hacer esto en:

{{#ref}}
../aws-post-exploitation/aws-ec2-ebs-ssm-and-vpc-post-exploitation/aws-ebs-snapshot-dump.md
{{#endref}}

Otros permisos también pueden ser útiles, como: `ec2:DescribeInstances`, `ec2:DescribeVolumes`, `ec2:DeleteSnapshot`, `ec2:CreateSnapshot`, `ec2:CreateTags`

La herramienta [https://github.com/Static-Flow/CloudCopy](https://github.com/Static-Flow/CloudCopy) realiza este ataque para **extraer contraseñas de un controlador de dominio**.

**Impacto Potencial:** Privesc indirecto al localizar información sensible en la instantánea (incluso podrías obtener contraseñas de Active Directory).

### **`ec2:CreateSnapshot`**

Cualquier usuario de AWS que posea el **`EC2:CreateSnapshot`** permiso puede robar los hashes de todos los usuarios del dominio creando una **instantánea del Controlador de Dominio**, montándola en una instancia que controlan y **exportando el archivo NTDS.dit y el registro SYSTEM** para su uso con el proyecto secretsdump de Impacket.

Puedes usar esta herramienta para automatizar el ataque: [https://github.com/Static-Flow/CloudCopy](https://github.com/Static-Flow/CloudCopy) o podrías usar una de las técnicas anteriores después de crear una instantánea.

{{#include ../../../banners/hacktricks-training.md}}
