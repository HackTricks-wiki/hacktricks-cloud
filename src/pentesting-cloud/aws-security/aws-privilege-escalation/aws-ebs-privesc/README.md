# AWS - EBS Privesc

{{#include ../../../../banners/hacktricks-training.md}}

## EBS

### `ebs:ListSnapshotBlocks`, `ebs:GetSnapshotBlock`, `ec2:DescribeSnapshots`

Atakujący posiadający te uprawnienia może potencjalnie **pobrać i przeanalizować snapshoty woluminów lokalnie** oraz przeszukać je w poszukiwaniu wrażliwych informacji (np. sekretów lub kodu źródłowego). Zobacz, jak to zrobić w:

{{#ref}}
../../aws-post-exploitation/aws-ec2-ebs-ssm-and-vpc-post-exploitation/aws-ebs-snapshot-dump.md
{{#endref}}

Inne uprawnienia mogą być również przydatne, takie jak: `ec2:DescribeInstances`, `ec2:DescribeVolumes`, `ec2:DeleteSnapshot`, `ec2:CreateSnapshot`, `ec2:CreateTags`

Narzędzie [https://github.com/Static-Flow/CloudCopy](https://github.com/Static-Flow/CloudCopy) przeprowadza ten atak, aby e**wydobyć hasła z Domain Controller**.

**Potencjalny wpływ:** Pośredne privesc przez zlokalizowanie wrażliwych informacji w snapshotcie (możesz nawet uzyskać hasła Active Directory).

### **`ec2:CreateSnapshot`**

Każdy użytkownik AWS posiadający uprawnienie **`EC2:CreateSnapshot`** może pozyskać hashe wszystkich użytkowników domeny, tworząc **snapshot Domain Controller**, podłączając go do instancji, którą kontroluje, oraz **eksportując NTDS.dit i hive rejestru SYSTEM** do wykorzystania z projektem Impacket's secretsdump.

Możesz użyć tego narzędzia do zautomatyzowania ataku: [https://github.com/Static-Flow/CloudCopy](https://github.com/Static-Flow/CloudCopy) lub możesz zastosować jedną z poprzednich technik po utworzeniu snapshotu.

{{#include ../../../../banners/hacktricks-training.md}}
