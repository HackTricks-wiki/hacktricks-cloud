# AWS - EBS Privesc

{{#include ../../../../banners/hacktricks-training.md}}

## EBS

### `ebs:ListSnapshotBlocks`, `ebs:GetSnapshotBlock`, `ec2:DescribeSnapshots`

Атакуючий з такими дозволами може потенційно **завантажити та локально проаналізувати знімки томів** і шукати в них чутливу інформацію (наприклад secrets або вихідний код). Дізнатися, як це зробити, можна в:

{{#ref}}
../../aws-post-exploitation/aws-ec2-ebs-ssm-and-vpc-post-exploitation/aws-ebs-snapshot-dump.md
{{#endref}}

Інші дозволи також можуть бути корисні, такі як: `ec2:DescribeInstances`, `ec2:DescribeVolumes`, `ec2:DeleteSnapshot`, `ec2:CreateSnapshot`, `ec2:CreateTags`

Інструмент [https://github.com/Static-Flow/CloudCopy](https://github.com/Static-Flow/CloudCopy) виконує цю атаку для **витягнення паролів з контролера домену**.

**Potential Impact:** Indirect privesc шляхом знаходження чутливої інформації у знімку (ви навіть можете отримати паролі Active Directory).

### **`ec2:CreateSnapshot`**

Any AWS user possessing the **`EC2:CreateSnapshot`** permission can steal the hashes of all domain users by creating a **snapshot of the Domain Controller** mounting it to an instance they control and **exporting the NTDS.dit and SYSTEM** registry hive file for use with Impacket's secretsdump project.

You can use this tool to automate the attack: [https://github.com/Static-Flow/CloudCopy](https://github.com/Static-Flow/CloudCopy) or you could use one of the previous techniques after creating a snapshot.

{{#include ../../../../banners/hacktricks-training.md}}
