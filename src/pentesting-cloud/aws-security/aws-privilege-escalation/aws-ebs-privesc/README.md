# AWS - EBS Privesc

{{#include ../../../../banners/hacktricks-training.md}}

## EBS

### `ebs:ListSnapshotBlocks`, `ebs:GetSnapshotBlock`, `ec2:DescribeSnapshots`

拥有这些权限的攻击者可能能够**在本地下载并分析卷快照**，并在其中搜索敏感信息（例如 secrets 或源代码）。在以下位置了解如何执行此操作：

{{#ref}}
../../aws-post-exploitation/aws-ec2-ebs-ssm-and-vpc-post-exploitation/aws-ebs-snapshot-dump.md
{{#endref}}

其他权限也可能有用，例如：`ec2:DescribeInstances`, `ec2:DescribeVolumes`, `ec2:DeleteSnapshot`, `ec2:CreateSnapshot`, `ec2:CreateTags`

该工具 [https://github.com/Static-Flow/CloudCopy](https://github.com/Static-Flow/CloudCopy) 执行此攻击以 e**xtract passwords from a domain controller**。

**潜在影响：** 通过在快照中定位敏感信息实现间接 privesc（你甚至可能获取 Active Directory 密码）。

### **`ec2:CreateSnapshot`**

任何拥有 **`EC2:CreateSnapshot`** 权限的 AWS 用户都可以通过创建 Domain Controller 的**快照**、将其挂载到他们控制的实例上，并**导出 NTDS.dit 和 SYSTEM** 注册表 hive 文件以供 Impacket 的 secretsdump 项目使用，从而窃取所有域用户的哈希。

你可以使用该工具来自动化攻击： [https://github.com/Static-Flow/CloudCopy](https://github.com/Static-Flow/CloudCopy)，或者在创建快照后使用之前的某种技术。

{{#include ../../../../banners/hacktricks-training.md}}
