# AWS - EBS Privesc

{{#include ../../../../banners/hacktricks-training.md}}

## EBS

### `ebs:ListSnapshotBlocks`, `ebs:GetSnapshotBlock`, `ec2:DescribeSnapshots`

Ένας επιτιθέμενος με αυτές τις άδειες θα μπορεί ενδεχομένως να **κατεβάσει και να αναλύσει τοπικά snapshot των volumes** και να αναζητήσει ευαίσθητες πληροφορίες σε αυτά (όπως secrets ή πηγαίο κώδικα). Βρείτε πώς να το κάνετε στο:

{{#ref}}
../../aws-post-exploitation/aws-ec2-ebs-ssm-and-vpc-post-exploitation/aws-ebs-snapshot-dump.md
{{#endref}}

Άλλες άδειες που μπορεί επίσης να είναι χρήσιμες είναι: `ec2:DescribeInstances`, `ec2:DescribeVolumes`, `ec2:DeleteSnapshot`, `ec2:CreateSnapshot`, `ec2:CreateTags`

Το εργαλείο [https://github.com/Static-Flow/CloudCopy](https://github.com/Static-Flow/CloudCopy) εκτελεί αυτή την επίθεση για να εξάγει κωδικούς από έναν Domain Controller.

**Potential Impact:** Έμμεσο privesc μέσω εντοπισμού ευαίσθητων πληροφοριών στο snapshot (μπορείτε ακόμη και να αποκτήσετε Active Directory passwords).

### **`ec2:CreateSnapshot`**

Οποιοσδήποτε AWS user που κατέχει την άδεια **`EC2:CreateSnapshot`** μπορεί να κλέψει τα hashes όλων των domain χρηστών δημιουργώντας ένα **snapshot του Domain Controller**, προσαρτώντας το σε ένα instance που ελέγχει και **εξάγοντας το NTDS.dit and SYSTEM** registry hive αρχείο για χρήση με το Impacket's secretsdump project.

Μπορείτε να χρησιμοποιήσετε αυτό το εργαλείο για να αυτοματοποιήσετε την επίθεση: [https://github.com/Static-Flow/CloudCopy](https://github.com/Static-Flow/CloudCopy) ή μπορείτε να χρησιμοποιήσετε μία από τις προηγούμενες τεχνικές μετά τη δημιουργία ενός snapshot.

{{#include ../../../../banners/hacktricks-training.md}}
