# AWS - EBS Privesc

{{#include ../../../../banners/hacktricks-training.md}}

## EBS

### `ebs:ListSnapshotBlocks`, `ebs:GetSnapshotBlock`, `ec2:DescribeSnapshots`

Ein Angreifer mit diesen Berechtigungen kann potenziell **Volumesnapshots lokal herunterladen und analysieren** und darin nach sensiblen Informationen suchen (z. B. Geheimnisse oder Quellcode). Siehe, wie man das macht in:

{{#ref}}
../../aws-post-exploitation/aws-ec2-ebs-ssm-and-vpc-post-exploitation/aws-ebs-snapshot-dump.md
{{#endref}}

Weitere Berechtigungen können ebenfalls nützlich sein, wie z. B.: `ec2:DescribeInstances`, `ec2:DescribeVolumes`, `ec2:DeleteSnapshot`, `ec2:CreateSnapshot`, `ec2:CreateTags`

Das Tool [https://github.com/Static-Flow/CloudCopy](https://github.com/Static-Flow/CloudCopy) führt diesen Angriff durch, um **Passwörter von einem Domänencontroller zu extrahieren**.

**Potential Impact:** Indirekte Privilegieneskalation durch Auffinden sensibler Informationen im Snapshot (du könntest sogar Active Directory-Passwörter erhalten).

### **`ec2:CreateSnapshot`**

Jeder AWS-Benutzer mit der Berechtigung **`EC2:CreateSnapshot`** kann die Hashes aller Domänenbenutzer stehlen, indem er einen **Snapshot des Domänencontrollers** erstellt, ihn an eine von ihm kontrollierte Instanz anhängt und die **NTDS.dit und die SYSTEM-Registry-Hive-Datei** exportiert, um sie mit Impacket's secretsdump zu verwenden.

Du kannst dieses Tool verwenden, um den Angriff zu automatisieren: [https://github.com/Static-Flow/CloudCopy](https://github.com/Static-Flow/CloudCopy) oder du könntest eine der vorherigen Techniken nach Erstellung eines Snapshots verwenden.

{{#include ../../../../banners/hacktricks-training.md}}
