# AWS - MQ Privesc

{{#include ../../../banners/hacktricks-training.md}}

## MQ

Aby uzyskać więcej informacji na temat MQ, sprawdź:

{{#ref}}
../aws-services/aws-mq-enum.md
{{#endref}}

### `mq:ListBrokers`, `mq:CreateUser`

Dzięki tym uprawnieniom możesz **utworzyć nowego użytkownika w brokerze ActiveMQ** (to nie działa w RabbitMQ):
```bash
aws mq list-brokers
aws mq create-user --broker-id <value> --console-access --password <value> --username <value>
```
**Potencjalny wpływ:** Uzyskanie dostępu do wrażliwych informacji poprzez nawigację w ActiveMQ

### `mq:ListBrokers`, `mq:ListUsers`, `mq:UpdateUser`

Dzięki tym uprawnieniom możesz **utworzyć nowego użytkownika w brokerze ActimeMQ** (to nie działa w RabbitMQ):
```bash
aws mq list-brokers
aws mq list-users --broker-id <value>
aws mq update-user --broker-id <value> --console-access --password <value> --username <value>
```
**Potencjalny wpływ:** Uzyskanie dostępu do wrażliwych informacji poprzez nawigację w ActiveMQ

### `mq:ListBrokers`, `mq:UpdateBroker`

Jeśli broker używa **LDAP** do autoryzacji z **ActiveMQ**, możliwe jest **zmienienie** **konfiguracji** serwera LDAP na **taki kontrolowany przez atakującego**. W ten sposób atakujący będzie mógł **ukraść wszystkie poświadczenia przesyłane przez LDAP**.
```bash
aws mq list-brokers
aws mq update-broker --broker-id <value> --ldap-server-metadata=...
```
Jeśli w jakiś sposób udałoby ci się znaleźć oryginalne poświadczenia używane przez ActiveMQ, mógłbyś przeprowadzić atak MitM, ukraść poświadczenia, użyć ich na oryginalnym serwerze i wysłać odpowiedź (może po prostu ponownie używając skradzionych poświadczeń, mógłbyś to zrobić).

**Potencjalny wpływ:** Ukraść poświadczenia ActiveMQ

{{#include ../../../banners/hacktricks-training.md}}
