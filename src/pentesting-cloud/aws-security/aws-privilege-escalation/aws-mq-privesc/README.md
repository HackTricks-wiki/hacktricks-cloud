# AWS - MQ Privesc

{{#include ../../../../banners/hacktricks-training.md}}

## MQ

MQ hakkında daha fazla bilgi için bakınız:

{{#ref}}
../../aws-services/aws-mq-enum.md
{{#endref}}

### `mq:ListBrokers`, `mq:CreateUser`

Bu izinlerle **ActimeMQ broker'ında yeni bir kullanıcı oluşturabilirsiniz** (bu RabbitMQ'da çalışmaz):
```bash
aws mq list-brokers
aws mq create-user --broker-id <value> --console-access --password <value> --username <value>
```
**Olası Etki:** ActiveMQ üzerinden gezinerek hassas bilgilere erişim

### `mq:ListBrokers`, `mq:ListUsers`, `mq:UpdateUser`

Bu izinlerle **bir ActimeMQ broker'ında yeni bir kullanıcı oluşturabilirsiniz** (bu RabbitMQ'da çalışmaz):
```bash
aws mq list-brokers
aws mq list-users --broker-id <value>
aws mq update-user --broker-id <value> --console-access --password <value> --username <value>
```
**Potansiyel Etki:** ActiveMQ içinde gezinerek hassas bilgilere erişim

### `mq:ListBrokers`, `mq:UpdateBroker`

Eğer bir broker **ActiveMQ** ile yetkilendirme için **LDAP** kullanıyorsa. Kullanılan LDAP sunucusunun **yapılandırmasını** **saldırganın kontrolündeki bir sunucuya** **değiştirmek** mümkündür. Böylece saldırgan **LDAP üzerinden gönderilen tüm kimlik bilgilerini çalabilecektir**.
```bash
aws mq list-brokers
aws mq update-broker --broker-id <value> --ldap-server-metadata=...
```
Eğer bir şekilde ActiveMQ tarafından kullanılan orijinal credentials'ı bulabilirseniz, bir MitM gerçekleştirebilir, creds'i çalabilir, orijinal sunucuda bunları kullanıp yanıtı gönderebilirsiniz (belki çalınan creds'i yeniden kullanarak bunu yapabilirsiniz).

**Olası Etki:** ActiveMQ credentials çalınması

{{#include ../../../../banners/hacktricks-training.md}}
