# AWS - MQ Enum

{{#include ../../../banners/hacktricks-training.md}}

## Amazon MQ

### Utangulizi wa Wakala wa Ujumbe

**Wakala wa ujumbe** hutumikia kama wasaidizi, wakirahisisha mawasiliano kati ya mifumo tofauti ya programu, ambayo inaweza kujengwa kwenye majukwaa mbalimbali na kuandikwa kwa lugha tofauti. **Amazon MQ** inarahisisha uwekaji, uendeshaji, na matengenezo ya wakala wa ujumbe kwenye AWS. Inatoa huduma zinazodhibitiwa kwa **Apache ActiveMQ** na **RabbitMQ**, kuhakikisha upatikanaji usio na mshono na masasisho ya toleo la programu kiotomatiki.

### AWS - RabbitMQ

RabbitMQ ni programu maarufu ya **kuweka ujumbe kwenye foleni**, pia inajulikana kama _wakala wa ujumbe_ au _msimamizi wa foleni_. Kimsingi ni mfumo ambapo foleni zinawekwa. Programu zinawasiliana na foleni hizi ili **kutuma na kupokea ujumbe**. Ujumbe katika muktadha huu unaweza kubeba aina mbalimbali za taarifa, kuanzia amri za kuanzisha michakato kwenye programu nyingine (labda kwenye seva tofauti) hadi ujumbe wa maandiko rahisi. Ujumbe unashikiliwa na programu ya msimamizi wa foleni hadi unaporejeshwa na kusindika na programu inayopokea. AWS inatoa suluhisho rahisi la kutumia kwa kuhost na kusimamia seva za RabbitMQ.

### AWS - ActiveMQ

Apache ActiveMQÂ® ni wakala maarufu wa ujumbe wa wazi, unaotegemea Java, unaojulikana kwa ufanisi wake. Inasaidia protokali nyingi za viwango vya tasnia, ikitoa ulinganifu mpana wa wateja katika aina mbalimbali za lugha na majukwaa. Watumiaji wanaweza:

- Kuunganisha na wateja waliandikwa kwa JavaScript, C, C++, Python, .Net, na zaidi.
- Kutumia protokali ya **AMQP** kuunganisha programu kutoka majukwaa tofauti.
- Kutumia **STOMP** juu ya websockets kwa kubadilishana ujumbe wa programu za wavuti.
- Kusimamia vifaa vya IoT kwa **MQTT**.
- Kudumisha miundombinu ya **JMS** iliyopo na kupanua uwezo wake.

Uwezo na kubadilika kwa ActiveMQ hufanya iwe sawa kwa mahitaji mengi ya ujumbe.

## Enumeration
```bash
# List brokers
aws mq list-brokers

# Get broker info
aws mq describe-broker --broker-id <broker-id>
## Find endpoints in .BrokerInstances
## Find if public accessible in .PubliclyAccessible

# List usernames (only for ActiveMQ)
aws mq list-users --broker-id <broker-id>

# Get user info (PASSWORD NOT INCLUDED)
aws mq describe-user --broker-id <broker-id> --username <username>

# Lits configurations (only for ActiveMQ)
aws mq list-configurations
## Here you can find if simple or LDAP authentication is used

# Creacte Active MQ user
aws mq create-user --broker-id <value> --password <value> --username <value> --console-access
```
> [!WARNING]
> TODO: Onyesha jinsi ya kuhesabu RabbitMQ na ActiveMQ ndani na jinsi ya kusikiliza kwenye foleni zote na kutuma data (tuma PR ikiwa unajua jinsi ya kufanya hivi)

## Privesc

{{#ref}}
../aws-privilege-escalation/aws-mq-privesc.md
{{#endref}}

## Unauthenticated Access

{{#ref}}
../aws-unauthenticated-enum-access/aws-mq-unauthenticated-enum.md
{{#endref}}

## Persistence

Ikiwa unajua taarifa za kuingia kwenye konsoli ya wavuti ya RabbitMQ, unaweza kuunda mtumiaji mpya mwenye mamlaka ya admin.

## References

- [https://www.cloudamqp.com/blog/part1-rabbitmq-for-beginners-what-is-rabbitmq.html](https://www.cloudamqp.com/blog/part1-rabbitmq-for-beginners-what-is-rabbitmq.html)
- [https://activemq.apache.org/](https://activemq.apache.org/)

{{#include ../../../banners/hacktricks-training.md}}
