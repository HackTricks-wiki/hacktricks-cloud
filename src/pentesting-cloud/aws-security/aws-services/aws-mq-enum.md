# AWS - MQ Enum

{{#include ../../../banners/hacktricks-training.md}}

## Amazon MQ

### Εισαγωγή στους Μεσολαβητές Μηνυμάτων

**Οι μεσολαβητές μηνυμάτων** λειτουργούν ως μεσάζοντες, διευκολύνοντας την επικοινωνία μεταξύ διαφορετικών συστημάτων λογισμικού, τα οποία μπορεί να είναι κατασκευασμένα σε ποικιλία πλατφορμών και προγραμματισμένα σε διαφορετικές γλώσσες. **Το Amazon MQ** απλοποιεί την ανάπτυξη, λειτουργία και συντήρηση των μεσολαβητών μηνυμάτων στο AWS. Παρέχει διαχειριζόμενες υπηρεσίες για **Apache ActiveMQ** και **RabbitMQ**, εξασφαλίζοντας απρόσκοπτη προμήθεια και αυτόματες ενημερώσεις έκδοσης λογισμικού.

### AWS - RabbitMQ

Το RabbitMQ είναι ένα εξέχον **λογισμικό διαχείρισης μηνυμάτων**, γνωστό επίσης ως _μεσολαβητής μηνυμάτων_ ή _διαχειριστής ουρών_. Είναι θεμελιωδώς ένα σύστημα όπου οι ουρές είναι ρυθμισμένες. Οι εφαρμογές αλληλεπιδρούν με αυτές τις ουρές για να **στέλνουν και να λαμβάνουν μηνύματα**. Τα μηνύματα σε αυτό το πλαίσιο μπορούν να μεταφέρουν μια ποικιλία πληροφοριών, από εντολές για την εκκίνηση διαδικασιών σε άλλες εφαρμογές (πιθανώς σε διαφορετικούς διακομιστές) έως απλά κείμενα. Τα μηνύματα κρατούνται από το λογισμικό διαχειριστή ουρών μέχρι να ανακτηθούν και να επεξεργαστούν από μια εφαρμογή λήψης. Το AWS παρέχει μια εύχρηστη λύση για τη φιλοξενία και διαχείριση διακομιστών RabbitMQ.

### AWS - ActiveMQ

Το Apache ActiveMQ® είναι ένας κορυφαίος ανοιχτού κώδικα, Java-based **μεσολαβητής μηνυμάτων** γνωστός για την ευελιξία του. Υποστηρίζει πολλαπλά πρωτόκολλα βιομηχανίας, προσφέροντας εκτενή συμβατότητα πελατών σε μια ευρεία γκάμα γλωσσών και πλατφορμών. Οι χρήστες μπορούν να:

- Συνδεθούν με πελάτες γραμμένους σε JavaScript, C, C++, Python, .Net και άλλα.
- Εκμεταλλευτούν το πρωτόκολλο **AMQP** για την ενσωμάτωση εφαρμογών από διαφορετικές πλατφόρμες.
- Χρησιμοποιήσουν **STOMP** μέσω websockets για ανταλλαγές μηνυμάτων σε εφαρμογές ιστού.
- Διαχειριστούν συσκευές IoT με **MQTT**.
- Διατηρήσουν την υπάρχουσα υποδομή **JMS** και να επεκτείνουν τις δυνατότητές της.

Η ανθεκτικότητα και η ευελιξία του ActiveMQ το καθιστούν κατάλληλο για μια πληθώρα απαιτήσεων μηνυμάτων.

## Enumeration
```bash
# List brokers
aws mq list-brokers

# Get broker info
aws mq describe-broker --broker-id <broker-id>
## Find endpoints in .BrokerInstances
## Find if public accessible in .PubliclyAccessible

# List usernames (only for ActiveMQ)
aws mq list-users --broker-id <broker-id>

# Get user info (PASSWORD NOT INCLUDED)
aws mq describe-user --broker-id <broker-id> --username <username>

# Lits configurations (only for ActiveMQ)
aws mq list-configurations
## Here you can find if simple or LDAP authentication is used

# Creacte Active MQ user
aws mq create-user --broker-id <value> --password <value> --username <value> --console-access
```
> [!WARNING]
> TODO: Υποδείξτε πώς να καταγράψετε το RabbitMQ και το ActiveMQ εσωτερικά και πώς να ακούσετε σε όλες τις ουρές και να στείλετε δεδομένα (στείλτε PR αν ξέρετε πώς να το κάνετε αυτό)

## Privesc

{{#ref}}
../aws-privilege-escalation/aws-mq-privesc.md
{{#endref}}

## Unauthenticated Access

{{#ref}}
../aws-unauthenticated-enum-access/aws-mq-unauthenticated-enum.md
{{#endref}}

## Persistence

Αν γνωρίζετε τα διαπιστευτήρια για να αποκτήσετε πρόσβαση στην κονσόλα ιστού RabbitMQ, μπορείτε να δημιουργήσετε έναν νέο χρήστη με δικαιώματα διαχειριστή.

## References

- [https://www.cloudamqp.com/blog/part1-rabbitmq-for-beginners-what-is-rabbitmq.html](https://www.cloudamqp.com/blog/part1-rabbitmq-for-beginners-what-is-rabbitmq.html)
- [https://activemq.apache.org/](https://activemq.apache.org/)

{{#include ../../../banners/hacktricks-training.md}}
