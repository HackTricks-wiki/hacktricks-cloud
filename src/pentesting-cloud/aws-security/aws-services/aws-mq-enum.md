# AWS - MQ Enum

{{#include ../../../banners/hacktricks-training.md}}

## Amazon MQ

### Einführung in Nachrichtenbroker

**Nachrichtenbroker** dienen als Vermittler und erleichtern die Kommunikation zwischen verschiedenen Softwaresystemen, die auf unterschiedlichen Plattformen basieren und in verschiedenen Sprachen programmiert sein können. **Amazon MQ** vereinfacht die Bereitstellung, den Betrieb und die Wartung von Nachrichtenbrokern auf AWS. Es bietet verwaltete Dienste für **Apache ActiveMQ** und **RabbitMQ** und sorgt für nahtlose Bereitstellung und automatische Softwareversionsupdates.

### AWS - RabbitMQ

RabbitMQ ist eine prominente **Nachrichtenwarteschlangen-Software**, auch bekannt als _Nachrichtenbroker_ oder _Warteschlangenmanager_. Es ist grundsätzlich ein System, in dem Warteschlangen konfiguriert sind. Anwendungen interagieren mit diesen Warteschlangen, um **Nachrichten zu senden und zu empfangen**. Nachrichten können in diesem Kontext eine Vielzahl von Informationen tragen, von Befehlen zur Initiierung von Prozessen in anderen Anwendungen (möglicherweise auf anderen Servern) bis hin zu einfachen Textnachrichten. Die Nachrichten werden von der Warteschlangenmanager-Software gehalten, bis sie von einer empfangenden Anwendung abgerufen und verarbeitet werden. AWS bietet eine benutzerfreundliche Lösung zum Hosten und Verwalten von RabbitMQ-Servern.

### AWS - ActiveMQ

Apache ActiveMQ® ist ein führender Open-Source, Java-basierter **Nachrichtenbroker**, der für seine Vielseitigkeit bekannt ist. Er unterstützt mehrere branchenübliche Protokolle und bietet umfassende Client-Kompatibilität über eine Vielzahl von Sprachen und Plattformen. Benutzer können:

- Mit Clients verbinden, die in JavaScript, C, C++, Python, .Net und mehr geschrieben sind.
- Das **AMQP**-Protokoll nutzen, um Anwendungen von verschiedenen Plattformen zu integrieren.
- **STOMP** über Websockets für den Nachrichtenaustausch in Webanwendungen verwenden.
- IoT-Geräte mit **MQTT** verwalten.
- Bestehende **JMS**-Infrastruktur beibehalten und deren Fähigkeiten erweitern.

Die Robustheit und Flexibilität von ActiveMQ machen es geeignet für eine Vielzahl von Messaging-Anforderungen.

## Enumeration
```bash
# List brokers
aws mq list-brokers

# Get broker info
aws mq describe-broker --broker-id <broker-id>
## Find endpoints in .BrokerInstances
## Find if public accessible in .PubliclyAccessible

# List usernames (only for ActiveMQ)
aws mq list-users --broker-id <broker-id>

# Get user info (PASSWORD NOT INCLUDED)
aws mq describe-user --broker-id <broker-id> --username <username>

# Lits configurations (only for ActiveMQ)
aws mq list-configurations
## Here you can find if simple or LDAP authentication is used

# Creacte Active MQ user
aws mq create-user --broker-id <value> --password <value> --username <value> --console-access
```
> [!WARNING]
> TODO: Geben Sie an, wie man RabbitMQ und ActiveMQ intern enumeriert und wie man in allen Warteschlangen mithört und Daten sendet (senden Sie einen PR, wenn Sie wissen, wie man das macht)

## Privesc

{{#ref}}
../aws-privilege-escalation/aws-mq-privesc.md
{{#endref}}

## Unauthenticated Access

{{#ref}}
../aws-unauthenticated-enum-access/aws-mq-unauthenticated-enum.md
{{#endref}}

## Persistence

Wenn Sie die Anmeldeinformationen zum Zugriff auf die RabbitMQ-Webkonsole kennen, können Sie einen neuen Benutzer mit Administratorrechten erstellen.

## References

- [https://www.cloudamqp.com/blog/part1-rabbitmq-for-beginners-what-is-rabbitmq.html](https://www.cloudamqp.com/blog/part1-rabbitmq-for-beginners-what-is-rabbitmq.html)
- [https://activemq.apache.org/](https://activemq.apache.org/)

{{#include ../../../banners/hacktricks-training.md}}
