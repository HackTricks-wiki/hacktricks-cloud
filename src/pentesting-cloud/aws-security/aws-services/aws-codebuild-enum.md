# AWS - Codebuild Enum

{{#include ../../../banners/hacktricks-training.md}}

## CodeBuild

AWS **CodeBuild** को एक **fully managed continuous integration service** के रूप में माना जाता है। इस सेवा का मुख्य उद्देश्य स्रोत कोड को compile करने, tests चलाने, और सॉफ़्टवेयर को deployment के लिए package करने की प्रक्रियाओं को ऑटोमेट करना है। CodeBuild का प्रमुख लाभ यह है कि यह उपयोगकर्ताओं को build servers को provision, manage और scale करने की आवश्यकता से मुक्त करता है क्योंकि यह सेवा ये कार्य स्वयं संभालती है। AWS CodeBuild की प्रमुख विशेषताएँ शामिल हैं:

1. **Managed Service**: CodeBuild build servers का प्रबंधन और स्केलिंग करता है, जिससे उपयोगकर्ताओं को सर्वर रखरखाव से मुक्ति मिलती है।
2. **Continuous Integration**: यह development और deployment वर्कफ़्लो के साथ एकीकृत होता है, सॉफ़्टवेयर रिलीज़ प्रक्रिया के build और test चरणों को ऑटोमेट करता है।
3. **Package Production**: build और test चरणों के बाद यह सॉफ़्टवेयर पैकेज तैयार करता है और उन्हें deployment के लिए तैयार करता है।

AWS CodeBuild अन्य AWS सेवाओं के साथ सहज रूप से एकीकृत होता है, जिससे CI/CD (Continuous Integration/Continuous Deployment) पाइपलाइन की दक्षता और विश्वसनीयता बढ़ती है।

### **Github/Gitlab/Bitbucket क्रेडेंशियल्स**

#### **डिफ़ॉल्ट स्रोत क्रेडेंशियल्स**

यह legacy विकल्प है जहाँ कुछ **access** (जैसे Github token या app) को कॉन्फ़िगर किया जा सकता है जिसे **codebuild projects में साझा** किया जाता है ताकि सभी प्रोजेक्ट इस कॉन्फ़िगर किए गए क्रेडेंशियल सेट का उपयोग कर सकें।

स्टोर किए गए क्रेडेंशियल्स (tokens, passwords...) **codebuild द्वारा प्रबंधित** होते हैं और इन्हें AWS APIs से पुनःप्राप्त करने का कोई सार्वजनिक तरीका नहीं है।

#### कस्टम स्रोत क्रेडेंशियल

Repository प्लेटफ़ॉर्म (Github, Gitlab और Bitbucket) पर निर्भर करते हुए अलग-अलग विकल्प उपलब्ध होते हैं। पर सामान्यतः, कोई भी विकल्प जो **token या password स्टोर करने की आवश्यकता करता है वह इसे secrets manager में secret के रूप में स्टोर करता है**।

यह अनुमति देता है कि **विभिन्न codebuild प्रोजेक्ट्स प्रदाताओं के लिए अलग-अलग कॉन्फ़िगर किए गए एक्सेस का उपयोग कर सकें** बजाय केवल कॉन्फ़िगर किए गए डिफ़ॉल्ट वाले का उपयोग करने के।

### Enumeration
```bash
# List external repo creds (such as github tokens)
## It doesn't return the token but just the ARN where it's located
aws codebuild list-source-credentials

# Projects
aws codebuild list-shared-projects
aws codebuild list-projects
aws codebuild batch-get-projects --names <project_name> # Check for creds in env vars

# Builds
aws codebuild list-builds
aws codebuild list-builds-for-project --project-name <p_name>
aws codebuild list-build-batches
aws codebuild list-build-batches-for-project --project-name <p_name>

# Reports
aws codebuild list-reports
aws codebuild describe-test-cases --report-arn <ARN>
```
> [!TIP]
> यदि आपके पास `codebuild:StartBuild` है, तो याद रखें कि आप अक्सर build time पर env vars ओवरराइड कर सकते हैं (`--environment-variables-override`). यह कुछ हमलों के लिए पर्याप्त हो सकता है, भले ही `UpdateProject` या `buildspec` ओवरराइड न हों (उदाहरण के लिए: artifact/upload buckets को redirect करके secrets को exfiltrate करना, या language/runtime env vars का दुरुपयोग करके commands execute करना)।

### Privesc

निम्नलिखित पृष्ठ पर, आप देख सकते हैं कि कैसे **abuse codebuild permissions to escalate privileges**:

{{#ref}}
../aws-privilege-escalation/aws-codebuild-privesc/README.md
{{#endref}}

### Post Exploitation

{{#ref}}
../aws-post-exploitation/aws-codebuild-post-exploitation/
{{#endref}}

### Unauthenticated Access

{{#ref}}
../aws-unauthenticated-enum-access/aws-codebuild-unauthenticated-access/README.md
{{#endref}}

## References

- [https://docs.aws.amazon.com/managedservices/latest/userguide/code-build.html](https://docs.aws.amazon.com/managedservices/latest/userguide/code-build.html)

{{#include ../../../banners/hacktricks-training.md}}
