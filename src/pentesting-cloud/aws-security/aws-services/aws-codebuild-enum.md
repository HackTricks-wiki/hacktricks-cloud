# AWS - Codebuild Enum

{{#include ../../../banners/hacktricks-training.md}}

## CodeBuild

AWS **CodeBuild** ist als ein **voll verwalteter Continuous-Integration-Service** bekannt. Der Hauptzweck dieses Dienstes besteht darin, die Abfolge aus Kompilieren von Quellcode, Ausführen von Tests und Verpacken der Software für Deployments zu automatisieren. Der wichtigste Vorteil von CodeBuild liegt darin, dass Nutzer keine Build-Server provisionieren, verwalten oder skalieren müssen, da der Dienst diese Aufgaben übernimmt. Wichtige Funktionen von AWS CodeBuild umfassen:

1. **Managed Service**: CodeBuild verwaltet und skaliert die Build-Server, wodurch Nutzer von Serverwartung entlastet werden.
2. **Continuous Integration**: Es integriert sich in den Entwicklungs- und Deployment-Workflow und automatisiert die Build- und Testphasen des Software-Release-Prozesses.
3. **Package Production**: Nach den Build- und Testphasen bereitet es die Softwarepakete vor und macht sie bereit für das Deployment.

AWS CodeBuild integriert sich nahtlos mit anderen AWS-Services und erhöht so die Effizienz und Zuverlässigkeit der CI/CD-Pipeline.

### **Github/Gitlab/Bitbucket Credentials**

#### **Default source credentials**

Dies ist die Legacy-Option, bei der es möglich ist, einige **Zugänge** (wie ein Github-Token oder eine App) zu konfigurieren, die **über CodeBuild-Projekte hinweg geteilt werden**, sodass alle Projekte diese konfigurierte Anmeldeinformationen verwenden können.

Die gespeicherten Anmeldeinformationen (Token, Passwörter ...) werden **von CodeBuild verwaltet** und es gibt keinen öffentlichen Weg, sie über AWS APIs abzurufen.

#### Custom source credential

Abhängig von der Repository-Plattform (Github, Gitlab und Bitbucket) werden verschiedene Optionen bereitgestellt. Im Allgemeinen wird jedoch jede Option, die erfordert, ein Token oder ein Passwort zu **speichern**, dieses als Secret im Secrets Manager ablegen.

Dies ermöglicht, dass **verschiedene CodeBuild-Projekte verschiedene konfigurierte Zugänge** zu den Anbietern verwenden können, anstatt nur den konfigurierten Standardzugang zu nutzen.

### Enumeration
```bash
# List external repo creds (such as github tokens)
## It doesn't return the token but just the ARN where it's located
aws codebuild list-source-credentials

# Projects
aws codebuild list-shared-projects
aws codebuild list-projects
aws codebuild batch-get-projects --names <project_name> # Check for creds in env vars

# Builds
aws codebuild list-builds
aws codebuild list-builds-for-project --project-name <p_name>
aws codebuild list-build-batches
aws codebuild list-build-batches-for-project --project-name <p_name>

# Reports
aws codebuild list-reports
aws codebuild describe-test-cases --report-arn <ARN>
```
> [!TIP]
> Wenn Sie `codebuild:StartBuild` haben, denken Sie daran, dass Sie häufig env vars zur Build-Zeit überschreiben können (`--environment-variables-override`). Das ist für einige Angriffe ausreichend, selbst ohne `UpdateProject`- oder `buildspec`-Overrides (zum Beispiel: redirecting artifact/upload buckets to exfiltrate secrets, or abusing language/runtime env vars to execute commands).

### Privesc

Auf der folgenden Seite können Sie nachlesen, wie man **abuse codebuild permissions to escalate privileges**:

{{#ref}}
../aws-privilege-escalation/aws-codebuild-privesc/README.md
{{#endref}}

### Post Exploitation

{{#ref}}
../aws-post-exploitation/aws-codebuild-post-exploitation/
{{#endref}}

### Unauthenticated Access

{{#ref}}
../aws-unauthenticated-enum-access/aws-codebuild-unauthenticated-access/README.md
{{#endref}}

## Referenzen

- [https://docs.aws.amazon.com/managedservices/latest/userguide/code-build.html](https://docs.aws.amazon.com/managedservices/latest/userguide/code-build.html)

{{#include ../../../banners/hacktricks-training.md}}
