# AWS - Security Hub Enum

{{#include ../../../../banners/hacktricks-training.md}}

## Security Hub

**Security Hub** 收集来自 **AWS 账户**、服务和支持的第三方合作伙伴产品的安全 **数据**，并帮助您 **分析您的安全** 趋势，识别最高优先级的安全问题。

它 **集中管理跨账户的安全相关警报**，并提供一个用户界面来查看这些警报。最大的限制是它 **不集中管理跨区域的警报**，仅限于跨账户。

**特点**

- 区域性（发现不跨区域）
- 多账户支持
- 来自以下的发现：
- Guard Duty
- Config
- Inspector
- Macie
- 第三方
- 针对 CIS 标准自生成的发现

## Enumeration
```
# Get basic info
aws securityhub describe-hub

# Get securityhub org config
aws securityhub describe-organization-configuration #If the current account isn't the security hub admin, you will get an error

# Get the configured admin for securityhub
aws securityhub get-administrator-account
aws securityhub get-master-account # Another way
aws securityhub list-organization-admin-accounts # Another way

# Get enabled standards
aws securityhub get-enabled-standards

# Get the findings
aws securityhub get-findings

# Get insights
aws securityhub get-insights

# Get Automation rules (must be from the admin account)
aws securityhub list-automation-rules

# Get members (must be from the admin account)
aws securityhub list-members
aws securityhub get-members --account-ids <acc-id>
```
## 绕过检测

TODO, PRs accepted

## 参考文献

- [https://cloudsecdocs.com/aws/services/logging/other/#general-info](https://cloudsecdocs.com/aws/services/logging/other/#general-info)
- [https://docs.aws.amazon.com/securityhub/latest/userguide/what-is-securityhub.html](https://docs.aws.amazon.com/securityhub/latest/userguide/what-is-securityhub.html)

{{#include ../../../../banners/hacktricks-training.md}}
