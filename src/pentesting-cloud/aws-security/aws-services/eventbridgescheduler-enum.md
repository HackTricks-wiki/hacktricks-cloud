# AWS - Enumeración del Programador de EventBridge

## Programador de EventBridge

{{#include ../../../banners/hacktricks-training.md}}

## Programador de EventBridge

**Amazon EventBridge Scheduler** es un programador **sin servidor totalmente gestionado diseñado para crear, ejecutar y gestionar tareas** a gran escala. Te permite programar millones de tareas en más de 270 servicios de AWS y más de 6,000 operaciones de API, todo desde un servicio central. Con fiabilidad incorporada y sin infraestructura que gestionar, EventBridge Scheduler simplifica la programación, reduce los costos de mantenimiento y se escala automáticamente para satisfacer la demanda. Puedes configurar expresiones cron o de tasa para horarios recurrentes, establecer invocaciones únicas y definir ventanas de entrega flexibles con opciones de reintento, asegurando que las tareas se entreguen de manera confiable según la disponibilidad de los objetivos posteriores.

Hay un límite inicial de 1,000,000 de horarios por región por cuenta. Incluso la página oficial de cuotas sugiere: "Se recomienda eliminar los horarios únicos una vez que se hayan completado."&#x20;

### Tipos de Horarios

Tipos de Horarios en el Programador de EventBridge:

1. **Horarios únicos** – Ejecuta una tarea en un momento específico, por ejemplo, el 21 de diciembre a las 7 AM UTC.
2. **Horarios basados en tasa** – Establece tareas recurrentes basadas en una frecuencia, por ejemplo, cada 2 horas.
3. **Horarios basados en cron** – Establece tareas recurrentes utilizando una expresión cron, por ejemplo, cada viernes a las 4 PM.

Dos Mecanismos para Manejar Eventos Fallidos:

1. **Política de Reintento** – Define el número de intentos de reintento para un evento fallido y cuánto tiempo mantenerlo sin procesar antes de considerarlo un fallo.
2. **Cola de Mensajes Muertos (DLQ)** – Una cola estándar de Amazon SQS donde se entregan los eventos fallidos después de que se agotan los reintentos. Las DLQ ayudan a solucionar problemas con tu horario o su objetivo posterior.

### Objetivos

Hay 2 tipos de objetivos para un programador [**plantillados (docs)**](https://docs.aws.amazon.com/scheduler/latest/UserGuide/managing-targets-templated.html), que son comúnmente utilizados y AWS los hizo más fáciles de configurar, y [**universales (docs)**](https://docs.aws.amazon.com/scheduler/latest/UserGuide/managing-targets-universal.html), que se pueden usar para llamar a cualquier API de AWS.

**Objetivos plantillados** admiten los siguientes servicios:

- CodeBuild – StartBuild
- CodePipeline – StartPipelineExecution
- Amazon ECS – RunTask
- Parámetros: EcsParameters
- EventBridge – PutEvents
- Parámetros: EventBridgeParameters
- Amazon Inspector – StartAssessmentRun
- Kinesis – PutRecord
- Parámetros: KinesisParameters
- Firehose – PutRecord
- Lambda – Invoke
- SageMaker – StartPipelineExecution
- Parámetros: SageMakerPipelineParameters
- Amazon SNS – Publish
- Amazon SQS – SendMessage
- Parámetros: SqsParameters
- Step Functions – StartExecution

### Enumeración
```bash
# List all EventBridge Scheduler schedules
aws scheduler list-schedules

# List all EventBridge Scheduler schedule groups
aws scheduler list-schedule-groups

# Describe a specific schedule to retrieve more details
aws scheduler get-schedule --name <schedule_name>

# Describe a specific schedule group
aws scheduler get-schedule-group --name <group_name>

# List tags for a specific schedule (helpful in identifying any custom tags or permissions)
aws scheduler list-tags-for-resource --resource-arn <schedule_group_arn>
```
### Privesc

En la siguiente página, puedes verificar cómo **abusar de los permisos del programador de eventbridge para escalar privilegios**:

{{#ref}}
../aws-privilege-escalation/eventbridgescheduler-privesc.md
{{#endref}}

## Referencias

- [https://docs.aws.amazon.com/scheduler/latest/UserGuide/what-is-scheduler.html](https://docs.aws.amazon.com/scheduler/latest/UserGuide/what-is-scheduler.html)

{{#include ../../../banners/hacktricks-training.md}}
