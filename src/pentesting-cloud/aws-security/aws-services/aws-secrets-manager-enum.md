# AWS - Secrets Manager Enum

{{#include ../../../banners/hacktricks-training.md}}

## AWS Secrets Manager

AWS Secrets Manager est conçu pour **éliminer l'utilisation de secrets codés en dur dans les applications en les remplaçant par un appel API**. Ce service sert de **dépôt centralisé pour tous vos secrets**, garantissant qu'ils sont gérés de manière uniforme à travers toutes les applications.

Le gestionnaire simplifie le **processus de rotation des secrets**, améliorant considérablement la posture de sécurité des données sensibles comme les identifiants de base de données. De plus, des secrets comme les clés API peuvent être automatiquement tournés avec l'intégration de fonctions lambda.

L'accès aux secrets est strictement contrôlé par des politiques détaillées basées sur l'identité IAM et des politiques basées sur les ressources.

Pour accorder l'accès aux secrets à un utilisateur d'un autre compte AWS, il est nécessaire de :

1. Autoriser l'utilisateur à accéder au secret.
2. Accorder la permission à l'utilisateur de déchiffrer le secret en utilisant KMS.
3. Modifier la politique de clé pour permettre à l'utilisateur externe de l'utiliser.

**AWS Secrets Manager s'intègre avec AWS KMS pour chiffrer vos secrets au sein d'AWS Secrets Manager.**

### **Enumeration**
```bash
aws secretsmanager list-secrets #Get metadata of all secrets
aws secretsmanager list-secret-version-ids --secret-id <secret_name> # Get versions
aws secretsmanager describe-secret --secret-id <secret_name> # Get metadata
aws secretsmanager get-secret-value --secret-id <secret_name> # Get value
aws secretsmanager get-secret-value --secret-id <secret_name> --version-id <version-id> # Get value of a different version
aws secretsmanager get-resource-policy --secret-id --secret-id <secret_name>
```
### Privesc

{{#ref}}
../aws-privilege-escalation/aws-secrets-manager-privesc.md
{{#endref}}

### Post Exploitation

{{#ref}}
../aws-post-exploitation/aws-secrets-manager-post-exploitation.md
{{#endref}}

### Persistence

{{#ref}}
../aws-persistence/aws-secrets-manager-persistence.md
{{#endref}}

{{#include ../../../banners/hacktricks-training.md}}
