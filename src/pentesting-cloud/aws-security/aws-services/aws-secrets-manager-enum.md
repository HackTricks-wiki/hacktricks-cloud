# AWS - Secrets Manager Enum

{{#include ../../../banners/hacktricks-training.md}}

## AWS Secrets Manager

AWS Secrets Manager ist darauf ausgelegt, **die Verwendung von hartcodierten Geheimnissen in Anwendungen zu eliminieren, indem sie durch einen API-Aufruf ersetzt werden**. Dieser Dienst dient als **zentraler Speicher für all Ihre Geheimnisse** und stellt sicher, dass sie einheitlich über alle Anwendungen verwaltet werden.

Der Manager vereinfacht den **Prozess der Rotation von Geheimnissen** und verbessert erheblich die Sicherheitslage sensibler Daten wie Datenbankanmeldeinformationen. Darüber hinaus können Geheimnisse wie API-Schlüssel automatisch rotiert werden, wenn Lambda-Funktionen integriert sind.

Der Zugriff auf Geheimnisse wird durch detaillierte IAM identitätsbasierte Richtlinien und ressourcenbasierte Richtlinien streng kontrolliert.

Um einem Benutzer aus einem anderen AWS-Konto den Zugriff auf Geheimnisse zu gewähren, ist es notwendig:

1. Den Benutzer zu autorisieren, auf das Geheimnis zuzugreifen.
2. Dem Benutzer die Berechtigung zu erteilen, das Geheimnis mit KMS zu entschlüsseln.
3. Die Schlüsselrichtlinie zu ändern, um dem externen Benutzer die Nutzung zu ermöglichen.

**AWS Secrets Manager integriert sich mit AWS KMS, um Ihre Geheimnisse innerhalb von AWS Secrets Manager zu verschlüsseln.**

### **Enumeration**
```bash
aws secretsmanager list-secrets #Get metadata of all secrets
aws secretsmanager list-secret-version-ids --secret-id <secret_name> # Get versions
aws secretsmanager describe-secret --secret-id <secret_name> # Get metadata
aws secretsmanager get-secret-value --secret-id <secret_name> # Get value
aws secretsmanager get-secret-value --secret-id <secret_name> --version-id <version-id> # Get value of a different version
aws secretsmanager get-resource-policy --secret-id --secret-id <secret_name>
```
### Privesc

{{#ref}}
../aws-privilege-escalation/aws-secrets-manager-privesc.md
{{#endref}}

### Post Exploitation

{{#ref}}
../aws-post-exploitation/aws-secrets-manager-post-exploitation.md
{{#endref}}

### Persistence

{{#ref}}
../aws-persistence/aws-secrets-manager-persistence.md
{{#endref}}

{{#include ../../../banners/hacktricks-training.md}}
