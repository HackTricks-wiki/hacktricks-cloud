# AWS - EMR Enum

{{#include ../../../banners/hacktricks-training.md}}

## EMR

AWS'nin Elastic MapReduce (EMR) hizmeti, 4.8.0 sürümünden itibaren, EMR kümeleri içinde dinlenme ve aktarımda verilerin şifreleme ayarlarını belirtme imkanı sunarak veri korumasını artıran bir **güvenlik yapılandırması** özelliği tanıttı. EMR kümeleri, büyük veri çerçevelerini işlemek için tasarlanmış ölçeklenebilir EC2 örnek gruplarıdır.

Ana özellikler şunlardır:

- **Küme Şifreleme Varsayılanı**: Varsayılan olarak, bir küme içindeki dinlenme halindeki veriler şifrelenmez. Ancak, şifrelemenin etkinleştirilmesi, birkaç özelliğe erişim sağlar:
- **Linux Unified Key Setup**: EBS küme hacimlerini şifreler. Kullanıcılar AWS Anahtar Yönetim Servisi (KMS) veya özel bir anahtar sağlayıcı seçebilir.
- **Açık Kaynak HDFS Şifrelemesi**: Hadoop için iki şifreleme seçeneği sunar:
- Güvenli Hadoop RPC (Uzak Prosedür Çağrısı), gizlilik ayarına sahip olup, Basit Kimlik Doğrulama Güvenlik Katmanı'nı kullanır.
- HDFS Blok transfer şifrelemesi, true olarak ayarlanmış olup, AES-256 algoritmasını kullanır.
- **Aktarımda Şifreleme**: Verilerin aktarım sırasında güvenliğini sağlamaya odaklanır. Seçenekler şunlardır:
- **Açık Kaynak Taşıma Katmanı Güvenliği (TLS)**: Şifreleme, bir sertifika sağlayıcısı seçilerek etkinleştirilebilir:
- **PEM**: PEM sertifikalarının manuel olarak oluşturulmasını ve bir zip dosyasına paketlenmesini gerektirir, S3 kovasından referans alınır.
- **Özel**: Şifreleme nesneleri sağlayan bir sertifika sağlayıcısı olarak özel bir Java sınıfı eklemeyi içerir.

Bir TLS sertifika sağlayıcısı güvenlik yapılandırmasına entegre edildikten sonra, EMR sürümüne bağlı olarak aşağıdaki uygulama spesifik şifreleme özellikleri etkinleştirilebilir:

- **Hadoop**:
- TLS kullanarak şifrelenmiş shuffle'ı azaltabilir.
- Dinlenme şifrelemesi ile Güvenli Hadoop RPC ve HDFS Blok Transferi AES-256 ile etkinleştirilmiştir.
- **Presto** (EMR sürüm 5.6.0+):
- Presto düğümleri arasındaki iç iletişim SSL ve TLS kullanılarak güvence altına alınmıştır.
- **Tez Shuffle Handler**:
- Şifreleme için TLS kullanır.
- **Spark**:
- Akka protokolü için TLS kullanır.
- Blok Transfer Servisi için Basit Kimlik Doğrulama Güvenlik Katmanı ve 3DES kullanır.
- Dış shuffle servisi, Basit Kimlik Doğrulama Güvenlik Katmanı ile güvence altına alınmıştır.

Bu özellikler, özellikle depolama ve iletim aşamalarında veri koruma ile ilgili olarak EMR kümelerinin güvenlik duruşunu artırır.

#### Enumeration
```bash
aws emr list-clusters
aws emr describe-cluster --cluster-id <id>
aws emr list-instances --cluster-id <id>
aws emr list-instance-fleets --cluster-id <id>
aws emr list-steps --cluster-id <id>
aws emr list-notebook-executions
aws emr list-security-configurations
aws emr list-studios #Get studio URLs
```
#### Privesc

{{#ref}}
../aws-privilege-escalation/aws-emr-privesc.md
{{#endref}}

## Referanslar

- [https://cloudacademy.com/course/domain-three-designing-secure-applications-and-architectures/elastic-mapreduce-emr-encryption-1/](https://cloudacademy.com/course/domain-three-designing-secure-applications-and-architectures/elastic-mapreduce-emr-encryption-1/)

{{#include ../../../banners/hacktricks-training.md}}
