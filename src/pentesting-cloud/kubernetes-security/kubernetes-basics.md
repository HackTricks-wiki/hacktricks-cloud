# Kubernetes Basics

## Kubernetes Basics

{{#include ../../banners/hacktricks-training.md}}

**–û—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π –∞–≤—Ç–æ—Ä —Ü—ñ—î—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏** [**–•–æ—Ä—Ö–µ**](https://www.linkedin.com/in/jorge-belmonte-a924b616b/) **(—á–∏—Ç–∞–π—Ç–µ –π–æ–≥–æ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω—É –ø—É–±–ª—ñ–∫–∞—Ü—ñ—é** [**—Ç—É—Ç**](https://sickrov.github.io)**)**

## –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ —Ç–∞ –æ—Å–Ω–æ–≤–∏

### –©–æ —Ä–æ–±–∏—Ç—å Kubernetes?

- –î–æ–∑–≤–æ–ª—è—î –∑–∞–ø—É—Å–∫–∞—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω–æ–º—É –¥–≤–∏–≥—É–Ω—ñ.
- –ü–ª–∞–Ω—É–≤–∞–Ω–Ω—è –¥–æ–∑–≤–æ–ª—è—î –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –º—ñ—Å—ñ—ó –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤.
- –ü—ñ–¥—Ç—Ä–∏–º—É—î –∂–∏—Ç—Ç—î–∑–¥–∞—Ç–Ω—ñ—Å—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤.
- –î–æ–∑–≤–æ–ª—è—î –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—é –º—ñ–∂ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏.
- –î–æ–∑–≤–æ–ª—è—î —Ç–µ—Ö–Ω—ñ–∫–∏ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è.
- –û–±—Ä–æ–±–ª—è—î –æ–±—Å—è–≥–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó.

### –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

![](https://sickrov.github.io/media/Screenshot-68.jpg)

- **–í—É–∑–æ–ª**: –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –∑ –ø–æ–¥–æ–º –∞–±–æ –ø–æ–¥–∞–º–∏.
- **–ü–æ–¥**: –æ–±–≥–æ—Ä—Ç–∫–∞ –Ω–∞–≤–∫–æ–ª–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∞–±–æ –∫—ñ–ª—å–∫–æ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤. –ü–æ–¥ –ø–æ–≤–∏–Ω–µ–Ω –º—ñ—Å—Ç–∏—Ç–∏ –ª–∏—à–µ –æ–¥–∏–Ω –¥–æ–¥–∞—Ç–æ–∫ (—Ç–æ–º—É –∑–∞–∑–≤–∏—á–∞–π –ø–æ–¥ –∑–∞–ø—É—Å–∫–∞—î –ª–∏—à–µ 1 –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä). –ü–æ–¥ —î —Å–ø–æ—Å–æ–±–æ–º, —è–∫–∏–º Kubernetes –∞–±—Å—Ç—Ä–∞–≥—É—î —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—é –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤.
- **–°–µ—Ä–≤—ñ—Å**: –ö–æ–∂–µ–Ω –ø–æ–¥ –º–∞—î 1 –≤–Ω—É—Ç—Ä—ñ—à–Ω—é **IP-–∞–¥—Ä–µ—Å—É** –∑ –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ–≥–æ –¥—ñ–∞–ø–∞–∑–æ–Ω—É –≤—É–∑–ª–∞. –û–¥–Ω–∞–∫ –π–æ–≥–æ —Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –≤—ñ–¥–∫—Ä–∏—Ç–∏ —á–µ—Ä–µ–∑ —Å–µ—Ä–≤—ñ—Å. **–°–µ—Ä–≤—ñ—Å —Ç–∞–∫–æ–∂ –º–∞—î IP-–∞–¥—Ä–µ—Å—É** —ñ –π–æ–≥–æ –º–µ—Ç–∞ - –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –∑–≤'—è–∑–æ–∫ –º—ñ–∂ –ø–æ–¥–∞–º–∏, —Ç–æ–º—É —è–∫—â–æ –æ–¥–∏–Ω –∑ –Ω–∏—Ö –∑–ª–∞–º–∞—î—Ç—å—Å—è, **–Ω–æ–≤–∏–π –∑–∞–º—ñ–Ω–Ω–∏–∫** (–∑ —ñ–Ω—à–æ—é –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ—é IP) **–±—É–¥–µ –¥–æ—Å—Ç—É–ø–Ω–∏–π** —á–µ—Ä–µ–∑ **—Ç—É –∂ IP-–∞–¥—Ä–µ—Å—É —Å–µ—Ä–≤—ñ—Å—É**. –ô–æ–≥–æ –º–æ–∂–Ω–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ —è–∫ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π –∞–±–æ –∑–æ–≤–Ω—ñ—à–Ω—ñ–π. –°–µ—Ä–≤—ñ—Å —Ç–∞–∫–æ–∂ –¥—ñ—î —è–∫ **–±–∞–ª–∞–Ω—Å—É–≤–∞–ª—å–Ω–∏–∫ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, –∫–æ–ª–∏ 2 –ø–æ–¥–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω—ñ** –¥–æ –æ–¥–Ω–æ–≥–æ —Å–µ—Ä–≤—ñ—Å—É.\
–ö–æ–ª–∏ **—Å–µ—Ä–≤—ñ—Å** —Å—Ç–≤–æ—Ä–µ–Ω–æ, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –∫—ñ–Ω—Ü–µ–≤—ñ —Ç–æ—á–∫–∏ –∫–æ–∂–Ω–æ–≥–æ —Å–µ—Ä–≤—ñ—Å—É, –∑–∞–ø—É—Å—Ç–∏–≤—à–∏ `kubectl get endpoints`
- **Kubelet**: –û—Å–Ω–æ–≤–Ω–∏–π –∞–≥–µ–Ω—Ç –≤—É–∑–ª–∞. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç, —è–∫–∏–π –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î –∑–≤'—è–∑–æ–∫ –º—ñ–∂ –≤—É–∑–ª–æ–º —ñ kubectl, —ñ –º–æ–∂–µ –∑–∞–ø—É—Å–∫–∞—Ç–∏ –ª–∏—à–µ –ø–æ–¥–∏ (—á–µ—Ä–µ–∑ API-—Å–µ—Ä–≤–µ—Ä). Kubelet –Ω–µ –∫–µ—Ä—É—î –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏, —è–∫—ñ –Ω–µ –±—É–ª–∏ —Å—Ç–≤–æ—Ä–µ–Ω—ñ Kubernetes.
- **Kube-proxy**: —Ü–µ —Å–µ—Ä–≤—ñ—Å, –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–∏–π –∑–∞ –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—é (—Å–µ—Ä–≤—ñ—Å–∏) –º—ñ–∂ apiserver —ñ –≤—É–∑–ª–æ–º. –û—Å–Ω–æ–≤–æ—é —î IPtables –¥–ª—è –≤—É–∑–ª—ñ–≤. –ù–∞–π–±—ñ–ª—å—à –¥–æ—Å–≤—ñ–¥—á–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –º–æ–∂—É—Ç—å –≤—Å—Ç–∞–Ω–æ–≤–ª—é–≤–∞—Ç–∏ —ñ–Ω—à—ñ kube-proxies –≤—ñ–¥ —ñ–Ω—à–∏—Ö –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫—ñ–≤.
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä Sidecar**: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏ Sidecar - —Ü–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏, —è–∫—ñ –ø–æ–≤–∏–Ω–Ω—ñ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ —Ä–∞–∑–æ–º –∑ –æ—Å–Ω–æ–≤–Ω–∏–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º —É –ø–æ–¥—ñ. –¶–µ–π —à–∞–±–ª–æ–Ω Sidecar —Ä–æ–∑—à–∏—Ä—é—î —Ç–∞ –ø–æ–∫—Ä–∞—â—É—î —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å –ø–æ—Ç–æ—á–Ω–∏—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤ –±–µ–∑ —ó—Ö –∑–º—ñ–Ω–∏. –°—å–æ–≥–æ–¥–Ω—ñ –º–∏ –∑–Ω–∞—î–º–æ, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—é –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤, —â–æ–± –æ–±–µ—Ä–Ω—É—Ç–∏ –≤—Å—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –¥–ª—è –∑–∞–ø—É—Å–∫—É –¥–æ–¥–∞—Ç–∫–∞ –≤ –±—É–¥—å-—è–∫–æ–º—É –º—ñ—Å—Ü—ñ. –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤–∏–∫–æ–Ω—É—î –ª–∏—à–µ –æ–¥–Ω—É –∑–∞–¥–∞—á—É —ñ —Ä–æ–±–∏—Ç—å —Ü–µ –¥—É–∂–µ –¥–æ–±—Ä–µ.
- **–ì–æ–ª–æ–≤–Ω–∏–π –ø—Ä–æ—Ü–µ—Å:**
- **Api Server:** –¶–µ —Å–ø–æ—Å—ñ–±, —è–∫–∏–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ —Ç–∞ –ø–æ–¥–∏ —Å–ø—ñ–ª–∫—É—é—Ç—å—Å—è –∑ –≥–æ–ª–æ–≤–Ω–∏–º –ø—Ä–æ—Ü–µ—Å–æ–º. –î–æ–∑–≤–æ–ª—è—é—Ç—å—Å—è –ª–∏—à–µ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω—ñ –∑–∞–ø–∏—Ç–∏.
- **–ü–ª–∞–Ω—É–≤–∞–ª—å–Ω–∏–∫**: –ü–ª–∞–Ω—É–≤–∞–Ω–Ω—è —Å—Ç–æ—Å—É—î—Ç—å—Å—è –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è —Ç–æ–≥–æ, —â–æ–± –ø–æ–¥–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª–∏ –≤—É–∑–ª–∞–º, —â–æ–± Kubelet –º—ñ–≥ —ó—Ö –∑–∞–ø—É—Å–∫–∞—Ç–∏. –í—ñ–Ω –º–∞—î –¥–æ—Å—Ç–∞—Ç–Ω—å–æ —ñ–Ω—Ç–µ–ª–µ–∫—Ç—É, —â–æ–± –≤–∏—Ä—ñ—à–∏—Ç–∏, —è–∫–∏–π –≤—É–∑–æ–ª –º–∞—î –±—ñ–ª—å—à–µ –¥–æ—Å—Ç—É–ø–Ω–∏—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤, —ñ –ø—Ä–∏–∑–Ω–∞—á–∏—Ç–∏ –Ω–æ–≤–∏–π –ø–æ–¥. –ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –ø–ª–∞–Ω—É–≤–∞–ª—å–Ω–∏–∫ –Ω–µ –∑–∞–ø—É—Å–∫–∞—î –Ω–æ–≤—ñ –ø–æ–¥–∏, –≤—ñ–Ω –ª–∏—à–µ —Å–ø—ñ–ª–∫—É—î—Ç—å—Å—è –∑ –ø—Ä–æ—Ü–µ—Å–æ–º Kubelet, —â–æ –ø—Ä–∞—Ü—é—î –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –≤—É–∑–ª–∞, —è–∫–∏–π –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–æ–≤–∏–π –ø–æ–¥.
- **Kube Controller manager**: –í—ñ–Ω –ø–µ—Ä–µ–≤—ñ—Ä—è—î —Ä–µ—Å—É—Ä—Å–∏, —Ç–∞–∫—ñ —è–∫ –Ω–∞–±–æ—Ä–∏ —Ä–µ–ø–ª—ñ–∫ –∞–±–æ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è, —â–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø—Ä–∞—Ü—é—î –ø—Ä–∞–≤–∏–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ–¥—ñ–≤ –∞–±–æ –≤—É–∑–ª—ñ–≤. –£ —Ä–∞–∑—ñ –≤—ñ–¥—Å—É—Ç–Ω–æ—Å—Ç—ñ –ø–æ–¥–∞ –≤—ñ–Ω –∑–≤'—è–∂–µ—Ç—å—Å—è –∑ –ø–ª–∞–Ω—É–≤–∞–ª—å–Ω–∏–∫–æ–º, —â–æ–± –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –Ω–æ–≤–∏–π. –í—ñ–Ω –∫–æ–Ω—Ç—Ä–æ–ª—é—î —Ä–µ–ø–ª—ñ–∫–∞—Ü—ñ—é, —Ç–æ–∫–µ–Ω–∏ —Ç–∞ –æ–±–ª—ñ–∫–æ–≤—ñ —Å–µ—Ä–≤—ñ—Å–∏ –¥–ª—è API.
- **etcd**: –°—Ö–æ–≤–∏—â–µ –¥–∞–Ω–∏—Ö, –ø–æ—Å—Ç—ñ–π–Ω–µ, —É–∑–≥–æ–¥–∂–µ–Ω–µ —Ç–∞ —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–µ. –¶–µ –±–∞–∑–∞ –¥–∞–Ω–∏—Ö Kubernetes —ñ —Å—Ö–æ–≤–∏—â–µ –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–Ω—è, –¥–µ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –ø–æ–≤–Ω–∏–π —Å—Ç–∞–Ω –∫–ª–∞—Å—Ç–µ—Ä—ñ–≤ (–∫–æ–∂–Ω–∞ –∑–º—ñ–Ω–∞ —Ç—É—Ç —Ä–µ—î—Å—Ç—Ä—É—î—Ç—å—Å—è). –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏, —Ç–∞–∫—ñ —è–∫ –ø–ª–∞–Ω—É–≤–∞–ª—å–Ω–∏–∫ –∞–±–æ –º–µ–Ω–µ–¥–∂–µ—Ä –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä–∞, –∑–∞–ª–µ–∂–∞—Ç—å –≤—ñ–¥ —Ü–∏—Ö –¥–∞–Ω–∏—Ö, —â–æ–± –∑–Ω–∞—Ç–∏, —è–∫—ñ –∑–º—ñ–Ω–∏ –≤—ñ–¥–±—É–ª–∏—Å—è (–¥–æ—Å—Ç—É–ø–Ω—ñ —Ä–µ—Å—É—Ä—Å–∏ –≤—É–∑–ª—ñ–≤, –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–ø—É—â–µ–Ω–∏—Ö –ø–æ–¥—ñ–≤...)
- **Cloud controller manager**: –¶–µ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ø–æ—Ç–æ–∫–∞–º–∏ —Ç–∞ –¥–æ–¥–∞—Ç–∫–∞–º–∏, —Ç–æ–±—Ç–æ: —è–∫—â–æ —É –≤–∞—Å —î –∫–ª–∞—Å—Ç–µ—Ä–∏ –≤ AWS –∞–±–æ OpenStack.

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –æ—Å–∫—ñ–ª—å–∫–∏ –º–æ–∂–µ –±—É—Ç–∏ –∫—ñ–ª—å–∫–∞ –≤—É–∑–ª—ñ–≤ (—è–∫—ñ –∑–∞–ø—É—Å–∫–∞—é—Ç—å –∫—ñ–ª—å–∫–∞ –ø–æ–¥—ñ–≤), —Ç–∞–∫–æ–∂ –º–æ–∂–µ –±—É—Ç–∏ –∫—ñ–ª—å–∫–∞ –≥–æ–ª–æ–≤–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤, –¥–æ—Å—Ç—É–ø –¥–æ —è–∫–∏—Ö –¥–æ API-—Å–µ—Ä–≤–µ—Ä–∞ –∑–±–∞–ª–∞–Ω—Å–æ–≤–∞–Ω–æ, –∞ —ó—Ö etcd —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–æ–≤–∞–Ω–æ.

**–¢–æ–º–∏:**

–ö–æ–ª–∏ –ø–æ–¥ —Å—Ç–≤–æ—Ä—é—î –¥–∞–Ω—ñ, —è–∫—ñ –Ω–µ –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ –≤—Ç—Ä–∞—á–µ–Ω—ñ, –∫–æ–ª–∏ –ø–æ–¥ –∑–Ω–∏–∫–∞—î, —ó—Ö —Å–ª—ñ–¥ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –≤ —Ñ—ñ–∑–∏—á–Ω–æ–º—É —Ç–æ–º—ñ. **Kubernetes –¥–æ–∑–≤–æ–ª—è—î –ø—Ä–∏–∫—Ä—ñ–ø–∏—Ç–∏ —Ç–æ–º –¥–æ –ø–æ–¥–∞ –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö**. –¢–æ–º –º–æ–∂–µ –±—É—Ç–∏ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º—É –∫–æ–º–ø'—é—Ç–µ—Ä—ñ –∞–±–æ –≤ **–≤—ñ–¥–¥–∞–ª–µ–Ω–æ–º—É —Å—Ö–æ–≤–∏—â—ñ**. –Ø–∫—â–æ –≤–∏ –∑–∞–ø—É—Å–∫–∞—î—Ç–µ –ø–æ–¥–∏ –Ω–∞ —Ä—ñ–∑–Ω–∏—Ö —Ñ—ñ–∑–∏—á–Ω–∏—Ö –≤—É–∑–ª–∞—Ö, –≤–∞–º —Å–ª—ñ–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤—ñ–¥–¥–∞–ª–µ–Ω–µ —Å—Ö–æ–≤–∏—â–µ, —â–æ–± —É—Å—ñ –ø–æ–¥–∏ –º–æ–≥–ª–∏ –¥–æ –Ω—å–æ–≥–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø.

**–Ü–Ω—à—ñ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó:**

- **ConfigMap**: –í–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ **URL-–∞–¥—Ä–µ—Å–∏** –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ —Å–µ—Ä–≤—ñ—Å—ñ–≤. –ü–æ–¥ –æ—Ç—Ä–∏–º–∞—î –¥–∞–Ω—ñ –∑–≤—ñ–¥—Å–∏, —â–æ–± –∑–Ω–∞—Ç–∏, —è–∫ —Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è –∑ —ñ–Ω—à–∏–º–∏ —Å–µ—Ä–≤—ñ—Å–∞–º–∏ (–ø–æ–¥–∏). –ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Ü–µ –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–µ –º—ñ—Å—Ü–µ –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö!
- **Secret**: –¶–µ –º—ñ—Å—Ü–µ –¥–ª—è **–∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —Å–µ–∫—Ä–µ—Ç–Ω–∏—Ö –¥–∞–Ω–∏—Ö**, —Ç–∞–∫–∏—Ö —è–∫ –ø–∞—Ä–æ–ª—ñ, API-–∫–ª—é—á—ñ... –∑–∞–∫–æ–¥–æ–≤–∞–Ω–∏—Ö —É B64. –ü–æ–¥ –∑–º–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ü–∏—Ö –¥–∞–Ω–∏—Ö, —â–æ–± –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ.
- **Deployments**: –¶–µ –º—ñ—Å—Ü–µ, –¥–µ –≤–∫–∞–∑—É—é—Ç—å—Å—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏, —è–∫—ñ –±—É–¥—É—Ç—å –∑–∞–ø—É—â–µ–Ω—ñ Kubernetes. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑–∞–∑–≤–∏—á–∞–π –Ω–µ –ø—Ä–∞—Ü—é—î –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –∑ –ø–æ–¥–∞–º–∏, –ø–æ–¥–∏ –∞–±—Å—Ç—Ä–∞–≥–æ–≤–∞–Ω—ñ –≤ **ReplicaSets** (–∫—ñ–ª—å–∫—ñ—Å—Ç—å –æ–¥–Ω–∞–∫–æ–≤–∏—Ö –ø–æ–¥—ñ–≤, —â–æ —Ä–µ–ø–ª—ñ–∫—É—é—Ç—å—Å—è), —è–∫—ñ –∑–∞–ø—É—Å–∫–∞—é—Ç—å—Å—è —á–µ—Ä–µ–∑ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è. –ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—ñ –¥–ª—è **–±–µ–∑—Å—Ç–∞–Ω—Ü—ñ–π–Ω–∏—Ö** –¥–æ–¥–∞—Ç–∫—ñ–≤. –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –¥–ª—è —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è - —Ü–µ —ñ–º'—è —Ç–∞ –æ–±—Ä–∞–∑ –¥–ª—è –∑–∞–ø—É—Å–∫—É.
- **StatefulSet**: –¶–µ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ –¥–ª—è –¥–æ–¥–∞—Ç–∫—ñ–≤, —Ç–∞–∫–∏—Ö —è–∫ **–±–∞–∑–∏ –¥–∞–Ω–∏—Ö**, —è–∫—ñ –ø–æ—Ç—Ä–µ–±—É—é—Ç—å **–¥–æ—Å—Ç—É–ø—É –¥–æ –æ–¥–Ω–æ–≥–æ –π —Ç–æ–≥–æ –∂ —Å—Ö–æ–≤–∏—â–∞**.
- **Ingress**: –¶–µ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è, —è–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è **–ø—É–±–ª—ñ—á–Ω–æ–≥–æ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è –¥–æ–¥–∞—Ç–∫–∞ –∑ URL-–∞–¥—Ä–µ—Å–æ—é**. –ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Ü–µ —Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤, –∞–ª–µ —Ü–µ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Å–ø–æ—Å—ñ–± –≤—ñ–¥–∫—Ä–∏—Ç–∏ –¥–æ–¥–∞—Ç–æ–∫.
- –Ø–∫—â–æ –≤–∏ —Ä–µ–∞–ª—ñ–∑—É—î—Ç–µ Ingress, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –±—É–¥–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ **Ingress Controllers**. Ingress Controller - —Ü–µ **–ø–æ–¥**, —è–∫–∏–π –±—É–¥–µ –∫—ñ–Ω—Ü–µ–≤–æ—é —Ç–æ—á–∫–æ—é, —â–æ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏–º–µ –∑–∞–ø–∏—Ç–∏, –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏–º–µ —ó—Ö —ñ –±–∞–ª–∞–Ω—Å—É–≤–∞—Ç–∏–º–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ —Å–µ—Ä–≤—ñ—Å–∏. Ingress controller **–Ω–∞–¥—Å–∏–ª–∞—Ç–∏–º–µ –∑–∞–ø–∏—Ç –Ω–∞ –æ—Å–Ω–æ–≤—ñ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏—Ö –ø—Ä–∞–≤–∏–ª ingress**. –ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –ø—Ä–∞–≤–∏–ª–∞ ingress –º–æ–∂—É—Ç—å –≤–∫–∞–∑—É–≤–∞—Ç–∏ –Ω–∞ —Ä—ñ–∑–Ω—ñ —à–ª—è—Ö–∏ –∞–±–æ –Ω–∞–≤—ñ—Ç—å –ø—ñ–¥–¥–æ–º–µ–Ω–∏ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤ Kubernetes.
- –ö—Ä–∞—â–æ—é –ø—Ä–∞–∫—Ç–∏–∫–æ—é –±–µ–∑–ø–µ–∫–∏ –±—É–¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ö–º–∞—Ä–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å—É–≤–∞–ª—å–Ω–∏–∫–∞ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∞–±–æ –ø—Ä–æ–∫—Å—ñ-—Å–µ—Ä–≤–µ—Ä–∞ —è–∫ —Ç–æ—á–∫–∏ –≤—Ö–æ–¥—É, —â–æ–± –∂–æ–¥–Ω–∞ —á–∞—Å—Ç–∏–Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞ Kubernetes –Ω–µ –±—É–ª–∞ –≤—ñ–¥–∫—Ä–∏—Ç–∞.
- –ö–æ–ª–∏ –æ—Ç—Ä–∏–º—É—î—Ç—å—Å—è –∑–∞–ø–∏—Ç, —è–∫–∏–π –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∂–æ–¥–Ω–æ–º—É –ø—Ä–∞–≤–∏–ª—É ingress, –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä ingress –Ω–∞–ø—Ä–∞–≤–∏—Ç—å –π–æ–≥–æ –Ω–∞ "**Default backend**". –í–∏ –º–æ–∂–µ—Ç–µ `describe` –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä ingress, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –∞–¥—Ä–µ—Å—É —Ü—å–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞.
- `minikube addons enable ingress`

### –Ü–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ PKI - –¶–µ–Ω—Ç—Ä —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó CA:

![](https://sickrov.github.io/media/Screenshot-66.jpg)

- CA —î –Ω–∞–¥—ñ–π–Ω–∏–º –∫–æ—Ä–µ–Ω–µ–º –¥–ª—è –≤—Å—ñ—Ö —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç—ñ–≤ —É –∫–ª–∞—Å—Ç–µ—Ä—ñ.
- –î–æ–∑–≤–æ–ª—è—î –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ –æ–¥–∏–Ω –æ–¥–Ω–æ–≥–æ.
- –£—Å—ñ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞ –ø—ñ–¥–ø–∏—Å–∞–Ω—ñ CA.
- ETCd –º–∞—î —Å–≤—ñ–π –≤–ª–∞—Å–Ω–∏–π —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç.
- —Ç–∏–ø–∏:
- —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç apiserver.
- —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç kubelet.
- —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç –ø–ª–∞–Ω—É–≤–∞–ª—å–Ω–∏–∫–∞.

## –û—Å–Ω–æ–≤–Ω—ñ –¥—ñ—ó

### Minikube

**Minikube** –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥–µ—è–∫–∏—Ö **—à–≤–∏–¥–∫–∏—Ö —Ç–µ—Å—Ç—ñ–≤** –Ω–∞ Kubernetes –±–µ–∑ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è —Ü—ñ–ª–æ–≥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ Kubernetes. –í—ñ–Ω –∑–∞–ø—É—Å—Ç–∏—Ç—å **–≥–æ–ª–æ–≤–Ω—ñ —Ç–∞ –≤—É–∑–ª–æ–≤—ñ –ø—Ä–æ—Ü–µ—Å–∏ –Ω–∞ –æ–¥–Ω–æ–º—É –∫–æ–º–ø'—é—Ç–µ—Ä—ñ**. Minikube –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏–º–µ virtualbox –¥–ª—è –∑–∞–ø—É—Å–∫—É –≤—É–∑–ª–∞. –î–∏–≤—ñ—Ç—å—Å—è [**—Ç—É—Ç, —è–∫ –π–æ–≥–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏**](https://minikube.sigs.k8s.io/docs/start/).
```
$ minikube start
üòÑ  minikube v1.19.0 on Ubuntu 20.04
‚ú®  Automatically selected the virtualbox driver. Other choices: none, ssh
üíø  Downloading VM boot image ...
> minikube-v1.19.0.iso.sha256: 65 B / 65 B [-------------] 100.00% ? p/s 0s
> minikube-v1.19.0.iso: 244.49 MiB / 244.49 MiB  100.00% 1.78 MiB p/s 2m17.
üëç  Starting control plane node minikube in cluster minikube
üíæ  Downloading Kubernetes v1.20.2 preload ...
> preloaded-images-k8s-v10-v1...: 491.71 MiB / 491.71 MiB  100.00% 2.59 MiB
üî•  Creating virtualbox VM (CPUs=2, Memory=3900MB, Disk=20000MB) ...
üê≥  Preparing Kubernetes v1.20.2 on Docker 20.10.4 ...
‚ñ™ Generating certificates and keys ...
‚ñ™ Booting up control plane ...
‚ñ™ Configuring RBAC rules ...
üîé  Verifying Kubernetes components...
‚ñ™ Using image gcr.io/k8s-minikube/storage-provisioner:v5
üåü  Enabled addons: storage-provisioner, default-storageclass
üèÑ  Done! kubectl is now configured to use "minikube" cluster and "default" namespace by defaul

$ minikube status
host: Running
kubelet: Running
apiserver: Running
kubeconfig: Configured

---- ONCE YOU HAVE A K8 SERVICE RUNNING WITH AN EXTERNAL SERVICE -----
$ minikube service mongo-express-service
(This will open your browser to access the service exposed port)

$ minikube delete
üî•  Deleting "minikube" in virtualbox ...
üíÄ  Removed all traces of the "minikube" cluster
```
### Kubectl –û—Å–Ω–æ–≤–∏

**`Kubectl`** - —Ü–µ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞ –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä—ñ–≤ kubernetes. –í—ñ–Ω —Å–ø—ñ–ª–∫—É—î—Ç—å—Å—è –∑ Api —Å–µ—Ä–≤–µ—Ä–æ–º –≥–æ–ª–æ–≤–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥—ñ–π —É kubernetes –∞–±–æ –¥–ª—è –∑–∞–ø–∏—Ç—É –¥–∞–Ω–∏—Ö.
```bash
kubectl version #Get client and server version
kubectl get pod
kubectl get services
kubectl get deployment
kubectl get replicaset
kubectl get secret
kubectl get all
kubectl get ingress
kubectl get endpoints

#kubectl create deployment <deployment-name> --image=<docker image>
kubectl create deployment nginx-deployment --image=nginx
#Access the configuration of the deployment and modify it
#kubectl edit deployment <deployment-name>
kubectl edit deployment nginx-deployment
#Get the logs of the pod for debbugging (the output of the docker container running)
#kubectl logs <replicaset-id/pod-id>
kubectl logs nginx-deployment-84cd76b964
#kubectl describe pod <pod-id>
kubectl describe pod mongo-depl-5fd6b7d4b4-kkt9q
#kubectl exec -it <pod-id> -- bash
kubectl exec -it mongo-depl-5fd6b7d4b4-kkt9q -- bash
#kubectl describe service <service-name>
kubectl describe service mongodb-service
#kubectl delete deployment <deployment-name>
kubectl delete deployment mongo-depl
#Deploy from config file
kubectl apply -f deployment.yml
```
### Minikube Dashboard

–î–∞—à–±–æ—Ä–¥ –¥–æ–∑–≤–æ–ª—è—î –≤–∞–º –ª–µ–≥—à–µ –±–∞—á–∏—Ç–∏, —â–æ –≤–∏–∫–æ–Ω—É—î minikube, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ URL –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –Ω—å–æ–≥–æ –≤:
```
minikube dashboard --url


üîå  Enabling dashboard ...
‚ñ™ Using image kubernetesui/dashboard:v2.3.1
‚ñ™ Using image kubernetesui/metrics-scraper:v1.0.7
ü§î  Verifying dashboard health ...
üöÄ  Launching proxy ...
ü§î  Verifying proxy health ...
http://127.0.0.1:50034/api/v1/namespaces/kubernetes-dashboard/services/http:kubernetes-dashboard:/proxy/
```
### YAML –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω—ñ —Ñ–∞–π–ª–∏ –ø—Ä–∏–∫–ª–∞–¥–∏

–ö–æ–∂–µ–Ω –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–∏–π —Ñ–∞–π–ª –º–∞—î 3 —á–∞—Å—Ç–∏–Ω–∏: **–º–µ—Ç–∞–¥–∞–Ω—ñ**, **—Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è** (—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏), **—Å—Ç–∞—Ç—É—Å** (–±–∞–∂–∞–Ω–∏–π —Å—Ç–∞–Ω).\
–í—Å–µ—Ä–µ–¥–∏–Ω—ñ —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ñ–∞–π–ª—É –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –≤–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ —à–∞–±–ª–æ–Ω, –≤–∏–∑–Ω–∞—á–µ–Ω–∏–π –∑ –Ω–æ–≤–æ—é —Å—Ç—Ä—É–∫—Ç—É—Ä–æ—é –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó, —â–æ –≤–∏–∑–Ω–∞—á–∞—î –æ–±—Ä–∞–∑ –¥–ª—è –∑–∞–ø—É—Å–∫—É:

**–ü—Ä–∏–∫–ª–∞–¥ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è + —Å–ª—É–∂–±–∏, –æ–≥–æ–ª–æ—à–µ–Ω–∏—Ö –≤ –æ–¥–Ω–æ–º—É –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–æ–º—É —Ñ–∞–π–ª—ñ (–∑** [**—Ç—É—Ç**](https://gitlab.com/nanuchi/youtube-tutorial-series/-/blob/master/demo-kubernetes-components/mongo.yaml)**)**

–û—Å–∫—ñ–ª—å–∫–∏ —Å–ª—É–∂–±–∞ –∑–∞–∑–≤–∏—á–∞–π –ø–æ–≤'—è–∑–∞–Ω–∞ –∑ –æ–¥–Ω–∏–º —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è–º, –º–æ–∂–ª–∏–≤–æ –æ–≥–æ–ª–æ—Å–∏—Ç–∏ –æ–±–∏–¥–≤–∞ –≤ –æ–¥–Ω–æ–º—É –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–æ–º—É —Ñ–∞–π–ª—ñ (—Å–ª—É–∂–±–∞, –æ–≥–æ–ª–æ—à–µ–Ω–∞ –≤ —Ü—ñ–π –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó, –¥–æ—Å—Ç—É–ø–Ω–∞ –ª–∏—à–µ –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ):
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
name: mongodb-deployment
labels:
app: mongodb
spec:
replicas: 1
selector:
matchLabels:
app: mongodb
template:
metadata:
labels:
app: mongodb
spec:
containers:
- name: mongodb
image: mongo
ports:
- containerPort: 27017
env:
- name: MONGO_INITDB_ROOT_USERNAME
valueFrom:
secretKeyRef:
name: mongodb-secret
key: mongo-root-username
- name: MONGO_INITDB_ROOT_PASSWORD
valueFrom:
secretKeyRef:
name: mongodb-secret
key: mongo-root-password
---
apiVersion: v1
kind: Service
metadata:
name: mongodb-service
spec:
selector:
app: mongodb
ports:
- protocol: TCP
port: 27017
targetPort: 27017
```
**–ü—Ä–∏–∫–ª–∞–¥ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –∑–æ–≤–Ω—ñ—à–Ω—å–æ–≥–æ —Å–µ—Ä–≤—ñ—Å—É**

–¶–µ–π —Å–µ—Ä–≤—ñ—Å –±—É–¥–µ –¥–æ—Å—Ç—É–ø–Ω–∏–π –∑–æ–≤–Ω—ñ (–ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∞—Ç—Ä–∏–±—É—Ç–∏ `nodePort` —Ç–∞ `type: LoadBlancer`):
```yaml
---
apiVersion: v1
kind: Service
metadata:
name: mongo-express-service
spec:
selector:
app: mongo-express
type: LoadBalancer
ports:
- protocol: TCP
port: 8081
targetPort: 8081
nodePort: 30000
```
> [!NOTE]
> –¶–µ –∫–æ—Ä–∏—Å–Ω–æ –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è, –∞–ª–µ –¥–ª—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–≥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ —É –≤–∞—Å –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ –ª–∏—à–µ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ —Å–µ—Ä–≤—ñ—Å–∏ —Ç–∞ Ingress –¥–ª—è –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è –ø—Ä–æ–≥—Ä–∞–º–∏.

**–ü—Ä–∏–∫–ª–∞–¥ —Ñ–∞–π–ª—É –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó Ingress**

–¶–µ –≤—ñ–¥–∫—Ä–∏—î –ø—Ä–æ–≥—Ä–∞–º—É –∑–∞ –∞–¥—Ä–µ—Å–æ—é `http://dashboard.com`.
```yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
name: dashboard-ingress
namespace: kubernetes-dashboard
spec:
rules:
- host: dashboard.com
http:
paths:
- backend:
serviceName: kubernetes-dashboard
servicePort: 80
```
**–ü—Ä–∏–∫–ª–∞–¥ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–æ–≥–æ —Ñ–∞–π–ª—É —Å–µ–∫—Ä–µ—Ç—ñ–≤**

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –ø–∞—Ä–æ–ª—ñ –∑–∞–∫–æ–¥–æ–≤–∞–Ω—ñ –≤ B64 (—â–æ –Ω–µ —î –±–µ–∑–ø–µ—á–Ω–∏–º!)
```yaml
apiVersion: v1
kind: Secret
metadata:
name: mongodb-secret
type: Opaque
data:
mongo-root-username: dXNlcm5hbWU=
mongo-root-password: cGFzc3dvcmQ=
```
**–ü—Ä–∏–∫–ª–∞–¥ ConfigMap**

**ConfigMap** - —Ü–µ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è, —è–∫–∞ –Ω–∞–¥–∞—î—Ç—å—Å—è –ø–æ–¥–∞–º, —â–æ–± –≤–æ–Ω–∏ –∑–Ω–∞–ª–∏, —è–∫ –∑–Ω–∞—Ö–æ–¥–∏—Ç–∏ —Ç–∞ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —ñ–Ω—à–∏—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤. –£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –∫–æ–∂–µ–Ω –ø–æ–¥ –±—É–¥–µ –∑–Ω–∞—Ç–∏, —â–æ —ñ–º'—è `mongodb-service` —î –∞–¥—Ä–µ—Å–æ—é –ø–æ–¥–∞, –∑ —è–∫–∏–º –≤–æ–Ω–∏ –º–æ–∂—É—Ç—å —Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è (—Ü–µ–π –ø–æ–¥ –±—É–¥–µ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ mongodb):
```yaml
apiVersion: v1
kind: ConfigMap
metadata:
name: mongodb-configmap
data:
database_url: mongodb-service
```
–¢–æ–¥—ñ, –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ **deployment config** —Ü—è –∞–¥—Ä–µ—Å–∞ –º–æ–∂–µ –±—É—Ç–∏ –≤–∫–∞–∑–∞–Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–∏–º —á–∏–Ω–æ–º, —â–æ–± –≤–æ–Ω–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞–ª–∞—Å—è –≤ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ pod:
```yaml
[...]
spec:
[...]
template:
[...]
spec:
containers:
- name: mongo-express
image: mongo-express
ports:
- containerPort: 8081
env:
- name: ME_CONFIG_MONGODB_SERVER
valueFrom:
configMapKeyRef:
name: mongodb-configmap
key: database_url
[...]
```
**–ü—Ä–∏–∫–ª–∞–¥ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –æ–±—Å—è–≥—É**

–í–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ —Ä—ñ–∑–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ —Ñ–∞–π–ª—ñ–≤ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è yaml –∑–∞ –∞–¥—Ä–µ—Å–æ—é [https://gitlab.com/nanuchi/youtube-tutorial-series/-/tree/master/kubernetes-volumes](https://gitlab.com/nanuchi/youtube-tutorial-series/-/tree/master/kubernetes-volumes).\
**–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –æ–±—Å—è–≥–∏ –Ω–µ –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –ø—Ä–æ—Å—Ç–æ—Ä—ñ–≤ —ñ–º–µ–Ω**

### –ü—Ä–æ—Å—Ç–æ—Ä–∏ —ñ–º–µ–Ω

Kubernetes –ø—ñ–¥—Ç—Ä–∏–º—É—î **–¥–µ–∫—ñ–ª—å–∫–∞ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–∏—Ö –∫–ª–∞—Å—Ç–µ—Ä—ñ–≤**, —è–∫—ñ –±–∞–∑—É—é—Ç—å—Å—è –Ω–∞ –æ–¥–Ω–æ–º—É —Ñ—ñ–∑–∏—á–Ω–æ–º—É –∫–ª–∞—Å—Ç–µ—Ä—ñ. –¶—ñ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω—ñ –∫–ª–∞—Å—Ç–µ—Ä–∏ –Ω–∞–∑–∏–≤–∞—é—Ç—å—Å—è **–ø—Ä–æ—Å—Ç–æ—Ä–∞–º–∏ —ñ–º–µ–Ω**. –í–æ–Ω–∏ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—ñ –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞—Ö –∑ –±–∞–≥–∞—Ç—å–º–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏, —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∏–º–∏ –ø–æ –∫—ñ–ª—å–∫–æ—Ö –∫–æ–º–∞–Ω–¥–∞—Ö –∞–±–æ –ø—Ä–æ–µ–∫—Ç–∞—Ö. –î–ª—è –∫–ª–∞—Å—Ç–µ—Ä—ñ–≤ –∑ –∫—ñ–ª—å–∫–æ–º–∞ –¥–æ –¥–µ—Å—è—Ç–∫—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –≤–∞–º –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –∞–±–æ –¥—É–º–∞—Ç–∏ –ø—Ä–æ –ø—Ä–æ—Å—Ç–æ—Ä–∏ —ñ–º–µ–Ω. –í–∏ –ø–æ–≤–∏–Ω–Ω—ñ –ø–æ—á–∞—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ø—Ä–æ—Å—Ç–æ—Ä–∏ —ñ–º–µ–Ω, —â–æ–± –º–∞—Ç–∏ –∫—Ä–∞—â–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å —ñ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—é –∫–æ–∂–Ω–æ—ó —á–∞—Å—Ç–∏–Ω–∏ –ø—Ä–æ–≥—Ä–∞–º–∏, —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–æ—ó –≤ kubernetes.

–ü—Ä–æ—Å—Ç–æ—Ä–∏ —ñ–º–µ–Ω –∑–∞–±–µ–∑–ø–µ—á—É—é—Ç—å –æ–±–ª–∞—Å—Ç—å –¥–ª—è —ñ–º–µ–Ω. –Ü–º–µ–Ω–∞ —Ä–µ—Å—É—Ä—Å—ñ–≤ –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ —É–Ω—ñ–∫–∞–ª—å–Ω–∏–º–∏ –≤ –º–µ–∂–∞—Ö –ø—Ä–æ—Å—Ç–æ—Ä—É —ñ–º–µ–Ω, –∞–ª–µ –Ω–µ –º—ñ–∂ –ø—Ä–æ—Å—Ç–æ—Ä–∞–º–∏ —ñ–º–µ–Ω. –ü—Ä–æ—Å—Ç–æ—Ä–∏ —ñ–º–µ–Ω –Ω–µ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∫–ª–∞–¥–µ–Ω–∏–º–∏ –æ–¥–∏–Ω –≤ –æ–¥–Ω–æ–≥–æ, —ñ **–∫–æ–∂–µ–Ω** —Ä–µ—Å—É—Ä—Å Kubernetes –º–æ–∂–µ –±—É—Ç–∏ **—Ç—ñ–ª—å–∫–∏ –≤** **–æ–¥–Ω–æ–º—É** **–ø—Ä–æ—Å—Ç–æ—Ä—ñ —ñ–º–µ–Ω**.

–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —î 4 –ø—Ä–æ—Å—Ç–æ—Ä–∏ —ñ–º–µ–Ω, —è–∫—â–æ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ minikube:
```
kubectl get namespace
NAME              STATUS   AGE
default           Active   1d
kube-node-lease   Active   1d
kube-public       Active   1d
kube-system       Active   1d
```
- **kube-system**: –¶–µ –Ω–µ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–æ –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏, —ñ –≤–∞–º –Ω–µ —Å–ª—ñ–¥ –π–æ–≥–æ —á—ñ–ø–∞—Ç–∏. –¶–µ –¥–ª—è –ø—Ä–æ—Ü–µ—Å—ñ–≤ master —ñ kubectl.
- **kube-public**: –ü—É–±–ª—ñ—á–Ω–æ –¥–æ—Å—Ç—É–ø–Ω—ñ –¥–∞–Ω—ñ. –ú—ñ—Å—Ç–∏—Ç—å configmap, —è–∫–∏–π –º—ñ—Å—Ç–∏—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–ª–∞—Å—Ç–µ—Ä.
- **kube-node-lease**: –í–∏–∑–Ω–∞—á–∞—î –¥–æ—Å—Ç—É–ø–Ω—ñ—Å—Ç—å –≤—É–∑–ª–∞.
- **default**: –ü—Ä–æ—Å—Ç—ñ—Ä —ñ–º–µ–Ω, —è–∫–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –±—É–¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤.
```bash
#Create namespace
kubectl create namespace my-namespace
```
> [!NOTE]
> –ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –±—ñ–ª—å—à—ñ—Å—Ç—å —Ä–µ—Å—É—Ä—Å—ñ–≤ Kubernetes (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, pods, services, replication controllers —Ç–∞ —ñ–Ω—à—ñ) –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è –≤ –¥–µ—è–∫–∏—Ö –ø—Ä–æ—Å—Ç–æ—Ä–∞—Ö —ñ–º–µ–Ω. –û–¥–Ω–∞–∫ —ñ–Ω—à—ñ —Ä–µ—Å—É—Ä—Å–∏, —Ç–∞–∫—ñ —è–∫ —Ä–µ—Å—É—Ä—Å–∏ –ø—Ä–æ—Å—Ç–æ—Ä—É —ñ–º–µ–Ω —Ç–∞ –Ω–∏–∑—å–∫–æ—Ä—ñ–≤–Ω–µ–≤—ñ —Ä–µ—Å—É—Ä—Å–∏, —Ç–∞–∫—ñ —è–∫ nodes —ñ persistenVolumes, –Ω–µ –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è –≤ –ø—Ä–æ—Å—Ç–æ—Ä—ñ —ñ–º–µ–Ω. –©–æ–± –ø–æ–±–∞—á–∏—Ç–∏, —è–∫—ñ —Ä–µ—Å—É—Ä—Å–∏ Kubernetes —î –≤ –ø—Ä–æ—Å—Ç–æ—Ä—ñ —ñ–º–µ–Ω, –∞ —è–∫—ñ –Ω—ñ:
>
> ```bash
> kubectl api-resources --namespaced=true #–í –ø—Ä–æ—Å—Ç–æ—Ä—ñ —ñ–º–µ–Ω
> kubectl api-resources --namespaced=false #–ù–µ –≤ –ø—Ä–æ—Å—Ç–æ—Ä—ñ —ñ–º–µ–Ω
> ```

–í–∏ –º–æ–∂–µ—Ç–µ –∑–±–µ—Ä–µ–≥—Ç–∏ –ø—Ä–æ—Å—Ç—ñ—Ä —ñ–º–µ–Ω –¥–ª—è –≤—Å—ñ—Ö –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö –∫–æ–º–∞–Ω–¥ kubectl —É —Ü—å–æ–º—É –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ.
```bash
kubectl config set-context --current --namespace=<insert-namespace-name-here>
```
### Helm

Helm —î **–º–µ–Ω–µ–¥–∂–µ—Ä–æ–º –ø–∞–∫–µ—Ç—ñ–≤** –¥–ª—è Kubernetes. –í—ñ–Ω –¥–æ–∑–≤–æ–ª—è—î —É–ø–∞–∫–æ–≤—É–≤–∞—Ç–∏ YAML —Ñ–∞–π–ª–∏ —Ç–∞ —Ä–æ–∑–ø–æ–≤—Å—é–¥–∂—É–≤–∞—Ç–∏ —ó—Ö —É –ø—É–±–ª—ñ—á–Ω–∏—Ö —ñ –ø—Ä–∏–≤–∞—Ç–Ω–∏—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—è—Ö. –¶—ñ –ø–∞–∫–µ—Ç–∏ –Ω–∞–∑–∏–≤–∞—é—Ç—å—Å—è **Helm Charts**.
```
helm search <keyword>
```
Helm —Ç–∞–∫–æ–∂ —î —à–∞–±–ª–æ–Ω–Ω–∏–º –¥–≤–∏–≥—É–Ω–æ–º, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î –≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω—ñ —Ñ–∞–π–ª–∏ –∑ –∑–º—ñ–Ω–Ω–∏–º–∏:

## Kubernetes —Å–µ–∫—Ä–µ—Ç–∏

**–°–µ–∫—Ä–µ—Ç** - —Ü–µ –æ–±'—î–∫—Ç, —è–∫–∏–π **–º—ñ—Å—Ç–∏—Ç—å —á—É—Ç–ª–∏–≤—ñ –¥–∞–Ω—ñ**, —Ç–∞–∫—ñ —è–∫ –ø–∞—Ä–æ–ª—å, —Ç–æ–∫–µ–Ω –∞–±–æ –∫–ª—é—á. –¢–∞–∫—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é —ñ–Ω–∞–∫—à–µ –º–æ–∂–Ω–∞ –±—É–ª–æ –± –ø–æ–º—ñ—Å—Ç–∏—Ç–∏ –≤ —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—é Pod –∞–±–æ –≤ –æ–±—Ä–∞–∑. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –º–æ–∂—É—Ç—å —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –°–µ–∫—Ä–µ—Ç–∏, –∞ —Å–∏—Å—Ç–µ–º–∞ —Ç–∞–∫–æ–∂ —Å—Ç–≤–æ—Ä—é—î –°–µ–∫—Ä–µ—Ç–∏. –Ü–º'—è –æ–±'—î–∫—Ç–∞ –°–µ–∫—Ä–µ—Ç—É –ø–æ–≤–∏–Ω–Ω–æ –±—É—Ç–∏ –¥—ñ–π—Å–Ω–∏–º **DNS –ø—ñ–¥–¥–æ–º–µ–Ω–æ–º**. –ß–∏—Ç–∞–π—Ç–µ —Ç—É—Ç [–æ—Ñ—ñ—Ü—ñ–π–Ω—É –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—é](https://kubernetes.io/docs/concepts/configuration/secret/).

–°–µ–∫—Ä–µ—Ç–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ —Ç–∞–∫–∏–º–∏, —è–∫:

- API, SSH –∫–ª—é—á—ñ.
- OAuth —Ç–æ–∫–µ–Ω–∏.
- –û–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ, –ø–∞—Ä–æ–ª—ñ (–≤ —á–∏—Å—Ç–æ–º—É –≤–∏–≥–ª—è–¥—ñ –∞–±–æ b64 + —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è).
- –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –∞–±–æ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ.
- –ö–æ–¥ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö, —Ä—è–¥–∫–∏‚Ä¶ .

–Ü—Å–Ω—É—é—Ç—å —Ä—ñ–∑–Ω—ñ —Ç–∏–ø–∏ —Å–µ–∫—Ä–µ—Ç—ñ–≤ —É Kubernetes

| –í–±—É–¥–æ–≤–∞–Ω–∏–π —Ç–∏–ø                       | –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è                               |
| ------------------------------------ | ------------------------------------------ |
| **Opaque**                           | **–ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ñ –¥–∞–Ω—ñ, –≤–∏–∑–Ω–∞—á–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º)** |
| kubernetes.io/service-account-token  | —Ç–æ–∫–µ–Ω –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É —Å–ª—É–∂–±–∏            |
| kubernetes.io/dockercfg              | —Å–µ—Ä—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π —Ñ–∞–π–ª \~/.dockercfg         |
| kubernetes.io/dockerconfigjson       | —Å–µ—Ä—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π —Ñ–∞–π–ª \~/.docker/config.json |
| kubernetes.io/basic-auth             | –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ –¥–ª—è –±–∞–∑–æ–≤–æ—ó –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó  |
| kubernetes.io/ssh-auth               | –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ –¥–ª—è SSH –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó      |
| kubernetes.io/tls                    | –¥–∞–Ω—ñ –¥–ª—è TLS –∫–ª—ñ—î–Ω—Ç–∞ –∞–±–æ —Å–µ—Ä–≤–µ—Ä–∞          |
| bootstrap.kubernetes.io/token        | –¥–∞–Ω—ñ —Ç–æ–∫–µ–Ω–∞ –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è              |

> [!NOTE]
> **–¢–∏–ø Opaque —î —Ç–∏–ø–æ–º –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º, —Ç–∏–ø–æ–≤–æ—é –ø–∞—Ä–æ—é –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–Ω—è, –≤–∏–∑–Ω–∞—á–µ–Ω–æ—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏.**

**–Ø–∫ –ø—Ä–∞—Ü—é—é—Ç—å —Å–µ–∫—Ä–µ—Ç–∏:**

![](https://sickrov.github.io/media/Screenshot-164.jpg)

–ù–∞—Å—Ç—É–ø–Ω–∏–π –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–∏–π —Ñ–∞–π–ª –≤–∏–∑–Ω–∞—á–∞—î **—Å–µ–∫—Ä–µ—Ç** –ø—ñ–¥ –Ω–∞–∑–≤–æ—é `mysecret` –∑ 2 –ø–∞—Ä–∞–º–∏ –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–Ω—è `username: YWRtaW4=` —Ç–∞ `password: MWYyZDFlMmU2N2Rm`. –í—ñ–Ω —Ç–∞–∫–æ–∂ –≤–∏–∑–Ω–∞—á–∞—î **pod** –ø—ñ–¥ –Ω–∞–∑–≤–æ—é `secretpod`, —è–∫–∏–π –º–∞—Ç–∏–º–µ `username` —Ç–∞ `password`, –≤–∏–∑–Ω–∞—á–µ–Ω—ñ –≤ `mysecret`, –¥–æ—Å—Ç—É–ø–Ω–∏–º–∏ –≤ **–∑–º—ñ–Ω–Ω–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞** `SECRET_USERNAME` \_\_ —Ç–∞ \_\_ `SECRET_PASSWOR`. –í—ñ–Ω —Ç–∞–∫–æ–∂ **–º–æ–Ω—Ç—É—î** —Å–µ–∫—Ä–µ—Ç `username` –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ `mysecret` –∑–∞ —à–ª—è—Ö–æ–º `/etc/foo/my-group/my-username` –∑ –ø—Ä–∞–≤–∞–º–∏ `0640`.
```yaml:secretpod.yaml
apiVersion: v1
kind: Secret
metadata:
name: mysecret
type: Opaque
data:
username: YWRtaW4=
password: MWYyZDFlMmU2N2Rm
---
apiVersion: v1
kind: Pod
metadata:
name: secretpod
spec:
containers:
- name: secretpod
image: nginx
env:
- name: SECRET_USERNAME
valueFrom:
secretKeyRef:
name: mysecret
key: username
- name: SECRET_PASSWORD
valueFrom:
secretKeyRef:
name: mysecret
key: password
volumeMounts:
- name: foo
mountPath: "/etc/foo"
restartPolicy: Never
volumes:
- name: foo
secret:
secretName: mysecret
items:
- key: username
path: my-group/my-username
mode: 0640
```

```bash
kubectl apply -f <secretpod.yaml>
kubectl get pods #Wait until the pod secretpod is running
kubectl exec -it  secretpod -- bash
env | grep SECRET && cat /etc/foo/my-group/my-username && echo
```
### Secrets in etcd <a href="#discover-secrets-in-etcd" id="discover-secrets-in-etcd"></a>

**etcd** - —Ü–µ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–µ —Ç–∞ –≤–∏—Å–æ–∫–æ –¥–æ—Å—Ç—É–ø–Ω–µ **—Å—Ö–æ–≤–∏—â–µ –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–Ω—è**, —è–∫–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —è–∫ –æ—Å–Ω–æ–≤–Ω–µ —Å—Ö–æ–≤–∏—â–µ Kubernetes –¥–ª—è –≤—Å—ñ—Ö –¥–∞–Ω–∏—Ö –∫–ª–∞—Å—Ç–µ—Ä–∞. –î–∞–≤–∞–π—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Å–µ–∫—Ä–µ—Ç—ñ–≤, –∑–±–µ—Ä–µ–∂–µ–Ω–∏—Ö –≤ etcd:
```bash
cat /etc/kubernetes/manifests/kube-apiserver.yaml | grep etcd
```
–í–∏ –ø–æ–±–∞—á–∏—Ç–µ, –¥–µ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏, –∫–ª—é—á—ñ —Ç–∞ URL-–∞–¥—Ä–µ—Å–∏ —Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω—ñ —É —Ñ–∞–π–ª–æ–≤—ñ–π —Å–∏—Å—Ç–µ–º—ñ. –Ø–∫ —Ç—ñ–ª—å–∫–∏ –≤–∏ —ó—Ö –æ—Ç—Ä–∏–º–∞—î—Ç–µ, –≤–∏ –∑–º–æ–∂–µ—Ç–µ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ etcd.
```bash
#ETCDCTL_API=3 etcdctl --cert <path to client.crt> --key <path to client.ket> --cacert <path to CA.cert> endpoint=[<ip:port>] health

ETCDCTL_API=3 etcdctl --cert /etc/kubernetes/pki/apiserver-etcd-client.crt --key /etc/kubernetes/pki/apiserver-etcd-client.key --cacert /etc/kubernetes/pki/etcd/etcd/ca.cert endpoint=[127.0.0.1:1234] health
```
–Ø–∫—â–æ –≤–∏ –∑–º–æ–∂–µ—Ç–µ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–≤'—è–∑–æ–∫, –≤–∏ –∑–º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å–µ–∫—Ä–µ—Ç–∏:
```bash
#ETCDCTL_API=3 etcdctl --cert <path to client.crt> --key <path to client.ket> --cacert <path to CA.cert> endpoint=[<ip:port>] get <path/to/secret>

ETCDCTL_API=3 etcdctl --cert /etc/kubernetes/pki/apiserver-etcd-client.crt --key /etc/kubernetes/pki/apiserver-etcd-client.key --cacert /etc/kubernetes/pki/etcd/etcd/ca.cert endpoint=[127.0.0.1:1234] get /registry/secrets/default/secret_02
```
**–î–æ–¥–∞–≤–∞–Ω–Ω—è —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –¥–æ ETCD**

–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –≤—Å—ñ —Å–µ–∫—Ä–µ—Ç–∏ **–∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —É –≤—ñ–¥–∫—Ä–∏—Ç–æ–º—É** —Ç–µ–∫—Å—Ç—ñ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ etcd, —è–∫—â–æ –≤–∏ –Ω–µ –∑–∞—Å—Ç–æ—Å—É—î—Ç–µ —à–∞—Ä —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è. –ù–∞—Å—Ç—É–ø–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥ –±–∞–∑—É—î—Ç—å—Å—è –Ω–∞ [https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/](https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/)
```yaml:encryption.yaml
apiVersion: apiserver.config.k8s.io/v1
kind: EncryptionConfiguration
resources:
- resources:
- secrets
providers:
- aescbc:
keys:
- name: key1
secret: cjjPMcWpTPKhAdieVtd+KhG4NN+N6e3NmBPMXJvbfrY= #Any random key
- identity: {}
```
–ü—ñ—Å–ª—è —Ü—å–æ–≥–æ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –ø—Ä–∞–ø–æ—Ä–µ—Ü—å `--encryption-provider-config` –Ω–∞ `kube-apiserver`, —â–æ–± –≤–∫–∞–∑–∞—Ç–∏ –Ω–∞ –º—ñ—Å—Ü–µ —Ä–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è —Å—Ç–≤–æ—Ä–µ–Ω–æ–≥–æ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–æ–≥–æ —Ñ–∞–π–ª—É. –í–∏ –º–æ–∂–µ—Ç–µ –∑–º—ñ–Ω–∏—Ç–∏ `/etc/kubernetes/manifest/kube-apiserver.yaml` —ñ –¥–æ–¥–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω—ñ —Ä—è–¥–∫–∏:
```yaml
containers:
- command:
- kube-apiserver
- --encriyption-provider-config=/etc/kubernetes/etcd/<configFile.yaml>
```
–ü—Ä–æ–∫—Ä—É—Ç—ñ—Ç—å —É–Ω–∏–∑ —É volumeMounts:
```yaml
- mountPath: /etc/kubernetes/etcd
name: etcd
readOnly: true
```
–ü—Ä–æ–∫—Ä—É—Ç—ñ—Ç—å —É–Ω–∏–∑ —É volumeMounts –¥–æ hostPath:
```yaml
- hostPath:
path: /etc/kubernetes/etcd
type: DirectoryOrCreate
name: etcd
```
**–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —â–æ –¥–∞–Ω—ñ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ**

–î–∞–Ω—ñ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ –ø—Ä–∏ –∑–∞–ø–∏—Å—É –≤ etcd. –ü—ñ—Å–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫—É –≤–∞—à–æ–≥–æ `kube-apiserver`, –±—É–¥—å-—è–∫–∏–π –Ω–æ–≤–æ—Å—Ç–≤–æ—Ä–µ–Ω–∏–π –∞–±–æ –æ–Ω–æ–≤–ª–µ–Ω–∏–π —Å–µ–∫—Ä–µ—Ç –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π –ø—Ä–∏ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—ñ. –©–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º—É –∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞ `etcdctl`, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –≤–º—ñ—Å—Ç –≤–∞—à–æ–≥–æ —Å–µ–∫—Ä–µ—Ç—É.

1.  –°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤–∏–π —Å–µ–∫—Ä–µ—Ç –ø—ñ–¥ –Ω–∞–∑–≤–æ—é `secret1` —É –ø—Ä–æ—Å—Ç–æ—Ä—ñ —ñ–º–µ–Ω `default`:

```
kubectl create secret generic secret1 -n default --from-literal=mykey=mydata
```

2.  –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –∫–æ–º–∞–Ω–¥–Ω–∏–π —Ä—è–¥–æ–∫ etcdctl, –ø—Ä–æ—á–∏—Ç–∞–π—Ç–µ —Ü–µ–π —Å–µ–∫—Ä–µ—Ç –∑ etcd:

`ETCDCTL_API=3 etcdctl get /registry/secrets/default/secret1 [...] | hexdump -C`

–¥–µ `[...]` –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –∞—Ä–≥—É–º–µ–Ω—Ç–∏ –¥–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ —Å–µ—Ä–≤–µ—Ä–∞ etcd.

3.  –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —â–æ –∑–±–µ—Ä–µ–∂–µ–Ω–∏–π —Å–µ–∫—Ä–µ—Ç –º–∞—î –ø—Ä–µ—Ñ—ñ–∫—Å `k8s:enc:aescbc:v1:`, —â–æ –≤–∫–∞–∑—É—î –Ω–∞ —Ç–µ, —â–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä `aescbc` –∑–∞—à–∏—Ñ—Ä—É–≤–∞–≤ –æ—Ç—Ä–∏–º–∞–Ω—ñ –¥–∞–Ω—ñ.
4.  –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —â–æ —Å–µ–∫—Ä–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π –ø—Ä–∏ –æ—Ç—Ä–∏–º–∞–Ω–Ω—ñ —á–µ—Ä–µ–∑ API:

```
kubectl describe secret secret1 -n default
```

–ø–æ–≤–∏–Ω–µ–Ω –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ `mykey: bXlkYXRh`, mydata –∑–∞–∫–æ–¥–æ–≤–∞–Ω–æ, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [–¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è —Å–µ–∫—Ä–µ—Ç—É](https://kubernetes.io/docs/concepts/configuration/secret#decoding-a-secret), —â–æ–± –ø–æ–≤–Ω—ñ—Å—Ç—é –¥–µ–∫–æ–¥—É–≤–∞—Ç–∏ —Å–µ–∫—Ä–µ—Ç.

**–û—Å–∫—ñ–ª—å–∫–∏ —Å–µ–∫—Ä–µ—Ç–∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ –ø—Ä–∏ –∑–∞–ø–∏—Å—É, –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–µ–∫—Ä–µ—Ç—É –∑–∞—à–∏—Ñ—Ä—É—î —Ü–µ–π –≤–º—ñ—Å—Ç:**
```
kubectl get secrets --all-namespaces -o json | kubectl replace -f -
```
**–û—Å—Ç–∞–Ω–Ω—ñ –ø–æ—Ä–∞–¥–∏:**

- –ù–∞–º–∞–≥–∞–π—Ç–µ—Å—è –Ω–µ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ —Å–µ–∫—Ä–µ—Ç–∏ —É —Ñ–∞–π–ª–æ–≤—ñ–π —Å–∏—Å—Ç–µ–º—ñ, –æ—Ç—Ä–∏–º—É–π—Ç–µ —ó—Ö –∑ —ñ–Ω—à–∏—Ö –º—ñ—Å—Ü—å.
- –ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ [https://www.vaultproject.io/](https://www.vaultproject.io) –¥–ª—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ–≥–æ –∑–∞—Ö–∏—Å—Ç—É –≤–∞—à–∏—Ö —Å–µ–∫—Ä–µ—Ç—ñ–≤.
- [https://kubernetes.io/docs/concepts/configuration/secret/#risks](https://kubernetes.io/docs/concepts/configuration/secret/#risks)
- [https://docs.cyberark.com/Product-Doc/OnlineHelp/AAM-DAP/11.2/en/Content/Integrations/Kubernetes_deployApplicationsConjur-k8s-Secrets.htm](https://docs.cyberark.com/Product-Doc/OnlineHelp/AAM-DAP/11.2/en/Content/Integrations/Kubernetes_deployApplicationsConjur-k8s-Secrets.htm)

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

{{#ref}}
https://sickrov.github.io/
{{#endref}}

{{#ref}}
https://www.youtube.com/watch?v=X48VuDVv0do
{{#endref}}

{{#include ../../banners/hacktricks-training.md}}
