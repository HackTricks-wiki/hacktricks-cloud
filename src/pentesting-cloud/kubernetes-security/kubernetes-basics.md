# Kubernetes Basics

## Kubernetes Basics

{{#include ../../banners/hacktricks-training.md}}

**ÎŸ Î±ÏÏ‡Î¹ÎºÏŒÏ‚ ÏƒÏ…Î³Î³ÏÎ±Ï†Î­Î±Ï‚ Î±Ï…Ï„Î®Ï‚ Ï„Î·Ï‚ ÏƒÎµÎ»Î¯Î´Î±Ï‚ ÎµÎ¯Î½Î±Î¹** [**Jorge**](https://www.linkedin.com/in/jorge-belmonte-a924b616b/) **(Î´Î¹Î±Î²Î¬ÏƒÏ„Îµ Ï„Î·Î½ Î±ÏÏ‡Î¹ÎºÎ® Ï„Î¿Ï… Î±Î½Î¬ÏÏ„Î·ÏƒÎ·** [**ÎµÎ´Ï**](https://sickrov.github.io)**)**

## Architecture & Basics

### Î¤Î¹ ÎºÎ¬Î½ÎµÎ¹ Ï„Î¿ Kubernetes;

- Î•Ï€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ· ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ/Ï‰Î½ ÏƒÎµ Î¼Î¹Î± Î¼Î·Ï‡Î±Î½Î® ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ.
- ÎŸ Ï€ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÎ¼ÏŒÏ‚ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ Î±Ï€Î¿ÏƒÏ„Î¿Î»Î® ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ Î¼Îµ Î±Ï€Î¿Î´Î¿Ï„Î¹ÎºÏŒ Ï„ÏÏŒÏ€Î¿.
- Î”Î¹Î±Ï„Î·ÏÎµÎ¯ Ï„Î± ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ ÎµÎ½ÎµÏÎ³Î¬.
- Î•Ï€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î¹Ï‚ ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯ÎµÏ‚ Î¼ÎµÏ„Î±Î¾Ï Ï„Ï‰Î½ ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ.
- Î•Ï€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„ÎµÏ‡Î½Î¹ÎºÎ­Ï‚ Î±Î½Î¬Ï€Ï„Ï…Î¾Î·Ï‚.
- Î”Î¹Î±Ï‡ÎµÎ¹ÏÎ¯Î¶ÎµÏ„Î±Î¹ ÏŒÎ³ÎºÎ¿Ï…Ï‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¹ÏÎ½.

### Architecture

![](https://sickrov.github.io/media/Screenshot-68.jpg)

- **Node**: Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¹ÎºÏŒ ÏƒÏÏƒÏ„Î·Î¼Î± Î¼Îµ pod Î® pods.
- **Pod**: Î ÎµÏÎ¹Ï„ÏÎ»Î¹Î³Î¼Î± Î³ÏÏÏ‰ Î±Ï€ÏŒ Î­Î½Î± ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ Î® Ï€Î¿Î»Î»Î±Ï€Î»Î¬ ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ. ÎˆÎ½Î± pod Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Î¼ÏŒÎ½Î¿ Î¼Î¯Î± ÎµÏ†Î±ÏÎ¼Î¿Î³Î® (Î­Ï„ÏƒÎ¹ ÏƒÏ…Î½Î®Î¸Ï‰Ï‚, Î­Î½Î± pod ÎµÎºÏ„ÎµÎ»ÎµÎ¯ Î¼ÏŒÎ½Î¿ 1 ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ). Î¤Î¿ pod ÎµÎ¯Î½Î±Î¹ Î¿ Ï„ÏÏŒÏ€Î¿Ï‚ Ï€Î¿Ï… Ï„Î¿ kubernetes Î±Ï†Î±Î¹ÏÎµÎ¯ Ï„Î·Î½ Ï„ÎµÏ‡Î½Î¿Î»Î¿Î³Î¯Î± ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ Ï€Î¿Ï… ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹.
- **Service**: ÎšÎ¬Î¸Îµ pod Î­Ï‡ÎµÎ¹ 1 ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ® **Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· IP** Î±Ï€ÏŒ Ï„Î·Î½ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ® Ï€ÎµÏÎ¹Î¿Ï‡Î® Ï„Î¿Ï… ÎºÏŒÎ¼Î²Î¿Ï…. Î©ÏƒÏ„ÏŒÏƒÎ¿, Î¼Ï€Î¿ÏÎµÎ¯ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± ÎµÎºÏ„ÎµÎ¸ÎµÎ¯ Î¼Î­ÏƒÏ‰ Î¼Î¹Î±Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚. Î— **Ï…Ï€Î·ÏÎµÏƒÎ¯Î± Î­Ï‡ÎµÎ¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î¼Î¹Î± Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· IP** ÎºÎ±Î¹ Î¿ ÏƒÏ„ÏŒÏ‡Î¿Ï‚ Ï„Î·Ï‚ ÎµÎ¯Î½Î±Î¹ Î½Î± Î´Î¹Î±Ï„Î·ÏÎµÎ¯ Ï„Î·Î½ ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î± Î¼ÎµÏ„Î±Î¾Ï Ï„Ï‰Î½ pods, Î­Ï„ÏƒÎ¹ ÏÏƒÏ„Îµ Î±Î½ Î­Î½Î± Ï€ÎµÎ¸Î¬Î½ÎµÎ¹, Î· **Î½Î­Î± Î±Î½Ï„Î¹ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·** (Î¼Îµ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ® ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ® IP) **Î¸Î± ÎµÎ¯Î½Î±Î¹ Ï€ÏÎ¿ÏƒÎ²Î¬ÏƒÎ¹Î¼Î·** ÎµÎºÏ„ÎµÎ¸ÎµÎ¹Î¼Î­Î½Î· ÏƒÏ„Î·Î½ **Î¯Î´Î¹Î± IP Ï„Î·Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚**. ÎœÏ€Î¿ÏÎµÎ¯ Î½Î± ÏÏ…Î¸Î¼Î¹ÏƒÏ„ÎµÎ¯ Ï‰Ï‚ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ® Î® ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÎ®. Î— Ï…Ï€Î·ÏÎµÏƒÎ¯Î± Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯ ÎµÏ€Î¯ÏƒÎ·Ï‚ Ï‰Ï‚ **Î¹ÏƒÎ¿ÎºÎ±Ï„Î±Î½Î¿Î¼Î·Ï„Î®Ï‚ Ï†Î¿ÏÏ„Î¯Î¿Ï… ÏŒÏ„Î±Î½ 2 pods ÎµÎ¯Î½Î±Î¹ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î±** ÏƒÏ„Î·Î½ Î¯Î´Î¹Î± Ï…Ï€Î·ÏÎµÏƒÎ¯Î±.\
ÎŒÏ„Î±Î½ Î¼Î¹Î± **Ï…Ï€Î·ÏÎµÏƒÎ¯Î±** ÎµÎ¯Î½Î±Î¹ **Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î·Î¼Î­Î½Î·**, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Ï„Î± endpoints ÎºÎ¬Î¸Îµ Ï…Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚ ÎµÎºÏ„ÎµÎ»ÏÎ½Ï„Î±Ï‚ `kubectl get endpoints`
- **Kubelet**: ÎšÏÏÎ¹Î¿Ï‚ Ï€ÏÎ¬ÎºÏ„Î¿ÏÎ±Ï‚ ÎºÏŒÎ¼Î²Î¿Ï…. Î¤Î¿ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î¿ Ï€Î¿Ï… ÎºÎ±Î¸Î¿ÏÎ¯Î¶ÎµÎ¹ Ï„Î·Î½ ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î± Î¼ÎµÏ„Î±Î¾Ï Ï„Î¿Ï… ÎºÏŒÎ¼Î²Î¿Ï… ÎºÎ±Î¹ Ï„Î¿Ï… kubectl, ÎºÎ±Î¹ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯ Î¼ÏŒÎ½Î¿ pods (Î¼Î­ÏƒÏ‰ Ï„Î¿Ï… API server). ÎŸ kubelet Î´ÎµÎ½ Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¯Î¶ÎµÏ„Î±Î¹ ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ Ï€Î¿Ï… Î´ÎµÎ½ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎ±Î½ Î±Ï€ÏŒ Ï„Î¿ Kubernetes.
- **Kube-proxy**: ÎµÎ¯Î½Î±Î¹ Î· Ï…Ï€Î·ÏÎµÏƒÎ¯Î± Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ Ï…Ï€ÎµÏÎ¸Ï…Î½Î· Î³Î¹Î± Ï„Î¹Ï‚ ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯ÎµÏ‚ (Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚) Î¼ÎµÏ„Î±Î¾Ï Ï„Î¿Ï… apiserver ÎºÎ±Î¹ Ï„Î¿Ï… ÎºÏŒÎ¼Î²Î¿Ï…. Î— Î²Î¬ÏƒÎ· ÎµÎ¯Î½Î±Î¹ Î­Î½Î± IPtables Î³Î¹Î± Ï„Î¿Ï…Ï‚ ÎºÏŒÎ¼Î²Î¿Ï…Ï‚. ÎŸÎ¹ Ï€Î¹Î¿ Î­Î¼Ï€ÎµÎ¹ÏÎ¿Î¹ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Î½ Î½Î± ÎµÎ³ÎºÎ±Ï„Î±ÏƒÏ„Î®ÏƒÎ¿Ï…Î½ Î¬Î»Î»Î¿Ï…Ï‚ kube-proxies Î±Ï€ÏŒ Î¬Î»Î»Î¿Ï…Ï‚ Ï€ÏÎ¿Î¼Î·Î¸ÎµÏ…Ï„Î­Ï‚.
- **Sidecar container**: Î¤Î± ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ sidecar ÎµÎ¯Î½Î±Î¹ Ï„Î± ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ Ï€Î¿Ï… Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎºÏ„ÎµÎ»Î¿ÏÎ½Ï„Î±Î¹ Î¼Î±Î¶Î¯ Î¼Îµ Ï„Î¿ ÎºÏÏÎ¹Î¿ ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ ÏƒÏ„Î¿ pod. Î‘Ï…Ï„ÏŒ Ï„Î¿ Î¼Î¿Ï„Î¯Î²Î¿ sidecar ÎµÏ€ÎµÎºÏ„ÎµÎ¯Î½ÎµÎ¹ ÎºÎ±Î¹ ÎµÎ½Î¹ÏƒÏ‡ÏÎµÎ¹ Ï„Î· Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¹ÎºÏŒÏ„Î·Ï„Î± Ï„Ï‰Î½ Ï„ÏÎµÏ‡ÏŒÎ½Ï„Ï‰Î½ ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± Ï„Î± Î±Î»Î»Î¬Î¾ÎµÎ¹. Î£Î®Î¼ÎµÏÎ±, Î³Î½Ï‰ÏÎ¯Î¶Î¿Ï…Î¼Îµ ÏŒÏ„Î¹ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ¼Îµ Ï„Î·Î½ Ï„ÎµÏ‡Î½Î¿Î»Î¿Î³Î¯Î± ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ Î³Î¹Î± Î½Î± Ï€ÎµÏÎ¹Ï„Ï…Î»Î¯Î¾Î¿Ï…Î¼Îµ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ ÎµÎ¾Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚ Î³Î¹Î± Ï„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Î½Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ Î¿Ï€Î¿Ï…Î´Î®Ï€Î¿Ï„Îµ. ÎˆÎ½Î± ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ ÎºÎ¬Î½ÎµÎ¹ Î¼ÏŒÎ½Î¿ Î­Î½Î± Ï€ÏÎ¬Î³Î¼Î± ÎºÎ±Î¹ Ï„Î¿ ÎºÎ¬Î½ÎµÎ¹ Ï€Î¿Î»Ï ÎºÎ±Î»Î¬.
- **Master process:**
- **Api Server:** Î•Î¯Î½Î±Î¹ Î¿ Ï„ÏÏŒÏ€Î¿Ï‚ Ï€Î¿Ï… Î¿Î¹ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚ ÎºÎ±Î¹ Ï„Î± pods Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½ Î³Î¹Î± Î½Î± ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¿ÏÎ½ Î¼Îµ Ï„Î· Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± master. ÎœÏŒÎ½Î¿ Î¿Î¹ Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¹Î·Î¼Î­Î½ÎµÏ‚ Î±Î¹Ï„Î®ÏƒÎµÎ¹Ï‚ Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Î½Ï„Î±Î¹.
- **Scheduler**: ÎŸ Ï€ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÎ¼ÏŒÏ‚ Î±Î½Î±Ï†Î­ÏÎµÏ„Î±Î¹ ÏƒÏ„Î· Î´Î¹Î±ÏƒÏ†Î¬Î»Î¹ÏƒÎ· ÏŒÏ„Î¹ Ï„Î± Pods Î±Î½Ï„Î¹ÏƒÏ„Î¿Î¹Ï‡Î¯Î¶Î¿Î½Ï„Î±Î¹ ÏƒÎµ Nodes Î­Ï„ÏƒÎ¹ ÏÏƒÏ„Îµ Î¿ Kubelet Î½Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï„Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹. ÎˆÏ‡ÎµÎ¹ Î±ÏÎºÎµÏ„Î® Î½Î¿Î·Î¼Î¿ÏƒÏÎ½Î· Î³Î¹Î± Î½Î± Î±Ï€Î¿Ï†Î±ÏƒÎ¯ÏƒÎµÎ¹ Ï€Î¿Î¹Î¿Ï‚ ÎºÏŒÎ¼Î²Î¿Ï‚ Î­Ï‡ÎµÎ¹ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ¿Ï…Ï‚ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î¿Ï…Ï‚ Ï€ÏŒÏÎ¿Ï…Ï‚ ÎºÎ±Î¹ Î½Î± Î±Î½Î±Î¸Î­ÏƒÎµÎ¹ Ï„Î¿ Î½Î­Î¿ pod ÏƒÎµ Î±Ï…Ï„ÏŒÎ½. Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Î¿ Ï€ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÏ„Î®Ï‚ Î´ÎµÎ½ Î¾ÎµÎºÎ¹Î½Î¬ Î½Î­Î± pods, Î±Ï€Î»ÏÏ‚ ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½ÎµÎ¯ Î¼Îµ Ï„Î· Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± Kubelet Ï€Î¿Ï… ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿Î½ ÎºÏŒÎ¼Î²Î¿, Î· Î¿Ï€Î¿Î¯Î± Î¸Î± ÎµÎºÎºÎ¹Î½Î®ÏƒÎµÎ¹ Ï„Î¿ Î½Î­Î¿ pod.
- **Kube Controller manager**: Î•Î»Î­Î³Ï‡ÎµÎ¹ Ï€ÏŒÏÎ¿Ï…Ï‚ ÏŒÏ€Ï‰Ï‚ ÏƒÏÎ½Î¿Î»Î± Î±Î½Î±Ï€Î±ÏÎ±Î³Ï‰Î³Î®Ï‚ Î® Î±Î½Î±Ï€Ï„ÏÎ¾ÎµÎ¹Ï‚ Î³Î¹Î± Î½Î± ÎµÎ»Î­Î³Î¾ÎµÎ¹ Î±Î½, Î³Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Î¿ ÏƒÏ‰ÏƒÏ„ÏŒÏ‚ Î±ÏÎ¹Î¸Î¼ÏŒÏ‚ pods Î® ÎºÏŒÎ¼Î²Ï‰Î½ ÎµÎºÏ„ÎµÎ»Î¿ÏÎ½Ï„Î±Î¹. Î£Îµ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ· Ï€Î¿Ï… Î­Î½Î± pod Î»ÎµÎ¯Ï€ÎµÎ¹, Î¸Î± ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î®ÏƒÎµÎ¹ Î¼Îµ Ï„Î¿Î½ Ï€ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÏ„Î® Î³Î¹Î± Î½Î± Î¾ÎµÎºÎ¹Î½Î®ÏƒÎµÎ¹ Î­Î½Î± Î½Î­Î¿. Î•Î»Î­Î³Ï‡ÎµÎ¹ Ï„Î·Î½ Î±Î½Î±Ï€Î±ÏÎ±Î³Ï‰Î³Î®, Ï„Î± tokens ÎºÎ±Î¹ Ï„Î¹Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼Î¿Ï Ï€ÏÎ¿Ï‚ Ï„Î¿ API.
- **etcd**: Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½, Î¼ÏŒÎ½Î¹Î¼Î·, ÏƒÏ…Î½ÎµÏ€Î®Ï‚ ÎºÎ±Î¹ ÎºÎ±Ï„Î±Î½ÎµÎ¼Î·Î¼Î­Î½Î·. Î•Î¯Î½Î±Î¹ Î· Î²Î¬ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Ï„Î¿Ï… Kubernetes ÎºÎ±Î¹ Î· Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· ÎºÎ»ÎµÎ¹Î´Î¹Î¿Ï-Ï„Î¹Î¼Î®Ï‚ ÏŒÏ€Î¿Ï… Î´Î¹Î±Ï„Î·ÏÎµÎ¯ Ï„Î·Î½ Ï€Î»Î®ÏÎ· ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· Ï„Ï‰Î½ ÎºÎ»Î¬ÏƒÎµÏ‰Î½ (ÎºÎ¬Î¸Îµ Î±Î»Î»Î±Î³Î® ÎºÎ±Ï„Î±Î³ÏÎ¬Ï†ÎµÏ„Î±Î¹ ÎµÎ´Ï). Î£Ï„Î¿Î¹Ï‡ÎµÎ¯Î± ÏŒÏ€Ï‰Ï‚ Î¿ Scheduler Î® Î¿ Controller manager ÎµÎ¾Î±ÏÏ„ÏÎ½Ï„Î±Î¹ Î±Ï€ÏŒ Î±Ï…Ï„Î¬ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î³Î¹Î± Î½Î± Î³Î½Ï‰ÏÎ¯Î¶Î¿Ï…Î½ Ï€Î¿Î¹ÎµÏ‚ Î±Î»Î»Î±Î³Î­Ï‚ Î­Ï‡Î¿Ï…Î½ ÏƒÏ…Î¼Î²ÎµÎ¯ (Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î¿Î¹ Ï€ÏŒÏÎ¿Î¹ Ï„Ï‰Î½ ÎºÏŒÎ¼Î²Ï‰Î½, Î±ÏÎ¹Î¸Î¼ÏŒÏ‚ ÎµÎºÏ„ÎµÎ»Î¿ÏÎ¼ÎµÎ½Ï‰Î½ pods...)
- **Cloud controller manager**: Î•Î¯Î½Î±Î¹ Î¿ ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿Ï‚ ÎµÎ»ÎµÎ³ÎºÏ„Î®Ï‚ Î³Î¹Î± ÏÎ¿Î­Ï‚ ÎµÎ»Î­Î³Ï‡Î¿Ï… ÎºÎ±Î¹ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚, Î´Î·Î»Î±Î´Î®: Î±Î½ Î­Ï‡ÎµÏ„Îµ ÎºÎ»Î¬ÏƒÎµÎ¹Ï‚ ÏƒÎµ AWS Î® OpenStack.

Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ ÎºÎ±Î¸ÏÏ‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î±ÏÎºÎµÏ„Î¿Î¯ ÎºÏŒÎ¼Î²Î¿Î¹ (Ï€Î¿Ï… ÎµÎºÏ„ÎµÎ»Î¿ÏÎ½ Î±ÏÎºÎµÏ„Î¬ pods), Î¼Ï€Î¿ÏÎµÎ¯ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î±ÏÎºÎµÏ„Î­Ï‚ Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯ÎµÏ‚ master Ï„Ï‰Î½ Î¿Ï€Î¿Î¯Ï‰Î½ Î· Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î¿Î½ Api server ÎµÎ¯Î½Î±Î¹ Î¹ÏƒÎ¿ÎºÎ±Ï„Î±Î½ÎµÎ¼Î·Î¼Î­Î½Î· ÎºÎ±Î¹ Ï„Î¿ etcd ÏƒÏ…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼Î­Î½Î¿.

**Volumes:**

ÎŒÏ„Î±Î½ Î­Î½Î± pod Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯ Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï€Î¿Ï… Î´ÎµÎ½ Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï‡Î±Î¸Î¿ÏÎ½ ÏŒÏ„Î±Î½ Ï„Î¿ pod ÎµÎ¾Î±Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯, Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏ…Ï„Î¿ÏÎ½ ÏƒÎµ Î­Î½Î±Î½ Ï†Ï…ÏƒÎ¹ÎºÏŒ ÏŒÎ³ÎºÎ¿. **Î¤Î¿ Kubernetes ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ Ï€ÏÎ¿ÏƒÎ¸Î®ÎºÎ· ÎµÎ½ÏŒÏ‚ ÏŒÎ³ÎºÎ¿Ï… ÏƒÎµ Î­Î½Î± pod Î³Î¹Î± Î½Î± Î´Î¹Î±Ï„Î·ÏÎ·Î¸Î¿ÏÎ½ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±**. ÎŸ ÏŒÎ³ÎºÎ¿Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯Î½Î±Î¹ ÏƒÏ„Î· Ï„Î¿Ï€Î¹ÎºÎ® Î¼Î·Ï‡Î±Î½Î® Î® ÏƒÎµ Î¼Î¹Î± **Î±Ï€Î¿Î¼Î±ÎºÏÏ…ÏƒÎ¼Î­Î½Î· Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·**. Î•Î¬Î½ ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Îµ pods ÏƒÎµ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¿ÏÏ‚ Ï†Ï…ÏƒÎ¹ÎºÎ¿ÏÏ‚ ÎºÏŒÎ¼Î²Î¿Ï…Ï‚, Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Î¼Î¹Î± Î±Ï€Î¿Î¼Î±ÎºÏÏ…ÏƒÎ¼Î­Î½Î· Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· ÏÏƒÏ„Îµ ÏŒÎ»Î± Ï„Î± pods Î½Î± Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Î­Ï‡Î¿Ï…Î½ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Î±Ï…Ï„Î®Î½.

**Î†Î»Î»ÎµÏ‚ ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚:**

- **ConfigMap**: ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÏÏ…Î¸Î¼Î¯ÏƒÎµÏ„Îµ **URLs** Î³Î¹Î± Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚. Î¤Î¿ pod Î¸Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÎ¹ Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î±Ï€ÏŒ ÎµÎ´Ï Î³Î¹Î± Î½Î± Î³Î½Ï‰ÏÎ¯Î¶ÎµÎ¹ Ï€ÏÏ‚ Î½Î± ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½ÎµÎ¯ Î¼Îµ Ï„Î¹Ï‚ Ï…Ï€ÏŒÎ»Î¿Î¹Ï€ÎµÏ‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ (pods). Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Î±Ï…Ï„ÏŒ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ ÏƒÏ…Î½Î¹ÏƒÏ„ÏÎ¼ÎµÎ½Î¿ Î¼Î­ÏÎ¿Ï‚ Î³Î¹Î± Î½Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏÏƒÎµÏ„Îµ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î±!
- **Secret**: Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Î¼Î­ÏÎ¿Ï‚ Î³Î¹Î± Î½Î± **Î±Ï€Î¿Î¸Î·ÎºÎµÏÏƒÎµÏ„Îµ Î¼Ï…ÏƒÏ„Î¹ÎºÎ¬ Î´ÎµÎ´Î¿Î¼Î­Î½Î±** ÏŒÏ€Ï‰Ï‚ ÎºÏ‰Î´Î¹ÎºÎ¿ÏÏ‚ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚, API keys... ÎºÏ‰Î´Î¹ÎºÎ¿Ï€Î¿Î¹Î·Î¼Î­Î½Î± ÏƒÎµ B64. Î¤Î¿ pod Î¸Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î­Ï‡ÎµÎ¹ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Î±Ï…Ï„Î¬ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î³Î¹Î± Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Ï„Î± Î±Ï€Î±Î¹Ï„Î¿ÏÎ¼ÎµÎ½Î± Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î±.
- **Deployments**: Î•Î´Ï Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎ¿Î½Ï„Î±Î¹ Ï„Î± ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î± Ï€Î¿Ï… Î¸Î± ÎµÎºÏ„ÎµÎ»Î¿ÏÎ½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿ kubernetes. ÎˆÎ½Î±Ï‚ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ Î´ÎµÎ½ Î¸Î± ÎµÏÎ³Î¬Î¶ÎµÏ„Î±Î¹ Î±Ï€ÎµÏ…Î¸ÎµÎ¯Î±Ï‚ Î¼Îµ pods, Ï„Î± pods ÎµÎ¯Î½Î±Î¹ Î±Ï†Î±Î¹ÏÎµÎ¼Î­Î½Î± ÏƒÎµ **ReplicaSets** (Î±ÏÎ¹Î¸Î¼ÏŒÏ‚ Î¯Î´Î¹Ï‰Î½ pods Ï€Î¿Ï… Î±Î½Î±Ï€Î±ÏÎ¬Î³Î¿Î½Ï„Î±Î¹), Ï„Î± Î¿Ï€Î¿Î¯Î± ÎµÎºÏ„ÎµÎ»Î¿ÏÎ½Ï„Î±Î¹ Î¼Î­ÏƒÏ‰ Î±Î½Î±Ï€Ï„ÏÎ¾ÎµÏ‰Î½. Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Î¿Î¹ Î±Î½Î±Ï€Ï„ÏÎ¾ÎµÎ¹Ï‚ ÎµÎ¯Î½Î±Î¹ Î³Î¹Î± **stateless** ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚. Î— ÎµÎ»Î¬Ï‡Î¹ÏƒÏ„Î· ÏÏÎ¸Î¼Î¹ÏƒÎ· Î³Î¹Î± Î¼Î¹Î± Î±Î½Î¬Ï€Ï„Ï…Î¾Î· ÎµÎ¯Î½Î±Î¹ Ï„Î¿ ÏŒÎ½Î¿Î¼Î± ÎºÎ±Î¹ Î· ÎµÎ¹ÎºÏŒÎ½Î± Ï€Î¿Ï… Î¸Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹.
- **StatefulSet**: Î‘Ï…Ï„ÏŒ Ï„Î¿ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î¿ Ï€ÏÎ¿Î¿ÏÎ¯Î¶ÎµÏ„Î±Î¹ ÎµÎ¹Î´Î¹ÎºÎ¬ Î³Î¹Î± ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ ÏŒÏ€Ï‰Ï‚ **Î²Î¬ÏƒÎµÎ¹Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½** Ï€Î¿Ï… Ï‡ÏÎµÎ¹Î¬Î¶Î¿Î½Ï„Î±Î¹ **Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î·Î½ Î¯Î´Î¹Î± Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·**.
- **Ingress**: Î‘Ï…Ï„Î® ÎµÎ¯Î½Î±Î¹ Î· ÏÏÎ¸Î¼Î¹ÏƒÎ· Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î³Î¹Î± Î½Î± **ÎµÎºÎ¸Î­ÏƒÎµÎ¹ Ï„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Î´Î·Î¼ÏŒÏƒÎ¹Î± Î¼Îµ Î¼Î¹Î± URL**. Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Î±Ï…Ï„ÏŒ Î¼Ï€Î¿ÏÎµÎ¯ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± Î³Î¯Î½ÎµÎ¹ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÎ­Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚, Î±Î»Î»Î¬ Î±Ï…Ï„ÏŒÏ‚ ÎµÎ¯Î½Î±Î¹ Î¿ ÏƒÏ‰ÏƒÏ„ÏŒÏ‚ Ï„ÏÏŒÏ€Î¿Ï‚ Î³Î¹Î± Î½Î± ÎµÎºÎ¸Î­ÏƒÎµÏ„Îµ Ï„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®.
- Î•Î¬Î½ Ï…Î»Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Î­Î½Î± Ingress, Î¸Î± Ï‡ÏÎµÎ¹Î±ÏƒÏ„ÎµÎ¯ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ **Ingress Controllers**. ÎŸ Ingress Controller ÎµÎ¯Î½Î±Î¹ Î­Î½Î± **pod** Ï€Î¿Ï… Î¸Î± ÎµÎ¯Î½Î±Î¹ Ï„Î¿ endpoint Ï€Î¿Ï… Î¸Î± Î´Î­Ï‡ÎµÏ„Î±Î¹ Ï„Î¹Ï‚ Î±Î¹Ï„Î®ÏƒÎµÎ¹Ï‚ ÎºÎ±Î¹ Î¸Î± Ï„Î¹Ï‚ ÎµÎ»Î­Î³Ï‡ÎµÎ¹ ÎºÎ±Î¹ Î¸Î± Ï„Î¹Ï‚ Î¹ÏƒÎ¿ÎºÎ±Ï„Î±Î½Î­Î¼ÎµÎ¹ ÏƒÏ„Î¹Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚. ÎŸ ingress controller Î¸Î± **ÏƒÏ„ÎµÎ¯Î»ÎµÎ¹ Ï„Î·Î½ Î±Î¯Ï„Î·ÏƒÎ· Î¼Îµ Î²Î¬ÏƒÎ· Ï„Î¿Ï…Ï‚ ÎºÎ±Î½ÏŒÎ½ÎµÏ‚ ingress Ï€Î¿Ï… Î­Ï‡Î¿Ï…Î½ ÏÏ…Î¸Î¼Î¹ÏƒÏ„ÎµÎ¯**. Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Î¿Î¹ ÎºÎ±Î½ÏŒÎ½ÎµÏ‚ ingress Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Î´ÎµÎ¯Ï‡Î½Î¿Ï…Î½ ÏƒÎµ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ­Ï‚ Î´Î¹Î±Î´ÏÎ¿Î¼Î­Ï‚ Î® Î±ÎºÏŒÎ¼Î· ÎºÎ±Î¹ Ï…Ï€Î¿Ï„Î¿Î¼ÎµÎ¯Ï‚ ÏƒÎµ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ­Ï‚ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ­Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ kubernetes.
- ÎœÎ¹Î± ÎºÎ±Î»ÏÏ„ÎµÏÎ· Ï€ÏÎ±ÎºÏ„Î¹ÎºÎ® Î±ÏƒÏ†Î¬Î»ÎµÎ¹Î±Ï‚ Î¸Î± Î®Ï„Î±Î½ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Î­Î½Î±Î½ Î¹ÏƒÎ¿ÎºÎ±Ï„Î±Î½Î¿Î¼Î·Ï„Î® Ï†Î¿ÏÏ„Î¯Î¿Ï… cloud Î® Î­Î½Î±Î½ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® proxy Ï‰Ï‚ ÏƒÎ·Î¼ÎµÎ¯Î¿ ÎµÎ¹ÏƒÏŒÎ´Î¿Ï… Î³Î¹Î± Î½Î± Î¼Î·Î½ ÎµÎºÏ„ÎµÎ¸ÎµÎ¯ ÎºÎ±Î¼Î¯Î± Î¼Î­ÏÎ¿Ï‚ Ï„Î¿Ï… ÎºÎ»Î¬ÏƒÎ¼Î±Ï„Î¿Ï‚ Kubernetes.
- ÎŒÏ„Î±Î½ Î»Î·Ï†Î¸ÎµÎ¯ Î¼Î¹Î± Î±Î¯Ï„Î·ÏƒÎ· Ï€Î¿Ï… Î´ÎµÎ½ Ï„Î±Î¹ÏÎ¹Î¬Î¶ÎµÎ¹ Î¼Îµ ÎºÎ±Î½Î­Î½Î±Î½ ÎºÎ±Î½ÏŒÎ½Î± ingress, Î¿ ingress controller Î¸Î± Ï„Î·Î½ ÎºÎ±Ï„ÎµÏ…Î¸ÏÎ½ÎµÎ¹ ÏƒÏ„Î¿ "**Default backend**". ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± `describe` Ï„Î¿Î½ ingress controller Î³Î¹Î± Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ Ï„Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Î±Ï…Ï„Î¿Ï Ï„Î¿Ï… Ï€Î±ÏÎ±Î¼Î­Ï„ÏÎ¿Ï….
- `minikube addons enable ingress`

### PKI infrastructure - Certificate Authority CA:

![](https://sickrov.github.io/media/Screenshot-66.jpg)

- CA ÎµÎ¯Î½Î±Î¹ Î· Î±Î¾Î¹ÏŒÏ€Î¹ÏƒÏ„Î· ÏÎ¯Î¶Î± Î³Î¹Î± ÏŒÎ»Î± Ï„Î± Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Ï„Î¹ÎºÎ¬ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ ÎºÎ»Î¬ÏƒÎ¼Î±.
- Î•Ï€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÏ„Î± ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î± Î½Î± ÎµÏ€Î¹ÎºÏ…ÏÏÎ½Î¿Ï…Î½ Ï„Î¿ Î­Î½Î± Ï„Î¿ Î¬Î»Î»Î¿.
- ÎŒÎ»Î± Ï„Î± Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Ï„Î¹ÎºÎ¬ Ï„Î¿Ï… ÎºÎ»Î¬ÏƒÎ¼Î±Ï„Î¿Ï‚ Ï…Ï€Î¿Î³ÏÎ¬Ï†Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î·Î½ CA.
- Î¤Î¿ ETCd Î­Ï‡ÎµÎ¹ Ï„Î¿ Î´Î¹ÎºÏŒ Ï„Î¿Ï… Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Ï„Î¹ÎºÏŒ.
- Ï„ÏÏ€Î¿Î¹:
- Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Ï„Î¹ÎºÏŒ apiserver.
- Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Ï„Î¹ÎºÏŒ kubelet.
- Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Ï„Î¹ÎºÏŒ scheduler.

## Basic Actions

### Minikube

**Minikube** Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Î³Î¹Î± Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ Î¼ÎµÏÎ¹ÎºÎ­Ï‚ **Î³ÏÎ®Î³Î¿ÏÎµÏ‚ Î´Î¿ÎºÎ¹Î¼Î­Ï‚** ÏƒÏ„Î¿ kubernetes Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ Î½Î± Î±Î½Î±Ï€Ï„ÏÎ¾ÎµÏ„Îµ Î­Î½Î± Î¿Î»ÏŒÎºÎ»Î·ÏÎ¿ Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½ kubernetes. Î˜Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯ Ï„Î¹Ï‚ **Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯ÎµÏ‚ master ÎºÎ±Î¹ node ÏƒÎµ Î¼Î¯Î± Î¼Î·Ï‡Î±Î½Î®**. Î¤Î¿ Minikube Î¸Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Ï„Î¿ virtualbox Î³Î¹Î± Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ Ï„Î¿Î½ ÎºÏŒÎ¼Î²Î¿. Î”ÎµÎ¯Ï„Îµ [**ÎµÎ´Ï Ï€ÏÏ‚ Î½Î± Ï„Î¿ ÎµÎ³ÎºÎ±Ï„Î±ÏƒÏ„Î®ÏƒÎµÏ„Îµ**](https://minikube.sigs.k8s.io/docs/start/).
```
$ minikube start
ğŸ˜„  minikube v1.19.0 on Ubuntu 20.04
âœ¨  Automatically selected the virtualbox driver. Other choices: none, ssh
ğŸ’¿  Downloading VM boot image ...
> minikube-v1.19.0.iso.sha256: 65 B / 65 B [-------------] 100.00% ? p/s 0s
> minikube-v1.19.0.iso: 244.49 MiB / 244.49 MiB  100.00% 1.78 MiB p/s 2m17.
ğŸ‘  Starting control plane node minikube in cluster minikube
ğŸ’¾  Downloading Kubernetes v1.20.2 preload ...
> preloaded-images-k8s-v10-v1...: 491.71 MiB / 491.71 MiB  100.00% 2.59 MiB
ğŸ”¥  Creating virtualbox VM (CPUs=2, Memory=3900MB, Disk=20000MB) ...
ğŸ³  Preparing Kubernetes v1.20.2 on Docker 20.10.4 ...
â–ª Generating certificates and keys ...
â–ª Booting up control plane ...
â–ª Configuring RBAC rules ...
ğŸ”  Verifying Kubernetes components...
â–ª Using image gcr.io/k8s-minikube/storage-provisioner:v5
ğŸŒŸ  Enabled addons: storage-provisioner, default-storageclass
ğŸ„  Done! kubectl is now configured to use "minikube" cluster and "default" namespace by defaul

$ minikube status
host: Running
kubelet: Running
apiserver: Running
kubeconfig: Configured

---- ONCE YOU HAVE A K8 SERVICE RUNNING WITH AN EXTERNAL SERVICE -----
$ minikube service mongo-express-service
(This will open your browser to access the service exposed port)

$ minikube delete
ğŸ”¥  Deleting "minikube" in virtualbox ...
ğŸ’€  Removed all traces of the "minikube" cluster
```
### Kubectl Î’Î±ÏƒÎ¹ÎºÎ¬

**`Kubectl`** ÎµÎ¯Î½Î±Î¹ Ï„Î¿ ÎµÏÎ³Î±Î»ÎµÎ¯Î¿ Î³ÏÎ±Î¼Î¼Î®Ï‚ ÎµÎ½Ï„Î¿Î»ÏÎ½ Î³Î¹Î± Ï„Î± clusters kubernetes. Î•Ï€Î¹ÎºÎ¿Î¹Î½Ï‰Î½ÎµÎ¯ Î¼Îµ Ï„Î¿Î½ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® Api Ï„Î·Ï‚ ÎºÏÏÎ¹Î±Ï‚ Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î±Ï‚ Î³Î¹Î± Î½Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯ ÎµÎ½Î­ÏÎ³ÎµÎ¹ÎµÏ‚ ÏƒÏ„Î¿ kubernetes Î® Î³Î¹Î± Î½Î± Î¶Î·Ï„Î¬ Î´ÎµÎ´Î¿Î¼Î­Î½Î±.
```bash
kubectl version #Get client and server version
kubectl get pod
kubectl get services
kubectl get deployment
kubectl get replicaset
kubectl get secret
kubectl get all
kubectl get ingress
kubectl get endpoints

#kubectl create deployment <deployment-name> --image=<docker image>
kubectl create deployment nginx-deployment --image=nginx
#Access the configuration of the deployment and modify it
#kubectl edit deployment <deployment-name>
kubectl edit deployment nginx-deployment
#Get the logs of the pod for debbugging (the output of the docker container running)
#kubectl logs <replicaset-id/pod-id>
kubectl logs nginx-deployment-84cd76b964
#kubectl describe pod <pod-id>
kubectl describe pod mongo-depl-5fd6b7d4b4-kkt9q
#kubectl exec -it <pod-id> -- bash
kubectl exec -it mongo-depl-5fd6b7d4b4-kkt9q -- bash
#kubectl describe service <service-name>
kubectl describe service mongodb-service
#kubectl delete deployment <deployment-name>
kubectl delete deployment mongo-depl
#Deploy from config file
kubectl apply -f deployment.yml
```
### Minikube Dashboard

ÎŸ Ï€Î¯Î½Î±ÎºÎ±Ï‚ ÎµÎ»Î­Î³Ï‡Î¿Ï… ÏƒÎ±Ï‚ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Î½Î± Î²Î»Î­Ï€ÎµÏ„Îµ Ï€Î¹Î¿ ÎµÏÎºÎ¿Î»Î± Ï„Î¹ ÎµÎºÏ„ÎµÎ»ÎµÎ¯ Ï„Î¿ minikube, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Ï„Î¿ URL Î³Î¹Î± Î½Î± Ï„Î¿ Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ ÎµÎ´Ï:
```
minikube dashboard --url


ğŸ”Œ  Enabling dashboard ...
â–ª Using image kubernetesui/dashboard:v2.3.1
â–ª Using image kubernetesui/metrics-scraper:v1.0.7
ğŸ¤”  Verifying dashboard health ...
ğŸš€  Launching proxy ...
ğŸ¤”  Verifying proxy health ...
http://127.0.0.1:50034/api/v1/namespaces/kubernetes-dashboard/services/http:kubernetes-dashboard:/proxy/
```
### YAML configuration files examples

ÎšÎ¬Î¸Îµ Î±ÏÏ‡ÎµÎ¯Î¿ ÏÏÎ¸Î¼Î¹ÏƒÎ·Ï‚ Î­Ï‡ÎµÎ¹ 3 Î¼Î­ÏÎ·: **metadata**, **specification** (Ï„Î¹ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ Î½Î± ÎµÎºÎºÎ¹Î½Î®ÏƒÎµÎ¹), **status** (ÎµÏ€Î¹Î¸Ï…Î¼Î·Ï„Î® ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·).\
ÎœÎ­ÏƒÎ± ÏƒÏ„Î· ÏÏÎ¸Î¼Î¹ÏƒÎ· Ï„Î¿Ï… Î±ÏÏ‡ÎµÎ¯Î¿Ï… ÏÏÎ¸Î¼Î¹ÏƒÎ·Ï‚ Î±Î½Î¬Ï€Ï„Ï…Î¾Î·Ï‚ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Ï„Î¿ Ï€ÏÏŒÏ„Ï…Ï€Î¿ Ï€Î¿Ï… Î¿ÏÎ¯Î¶ÎµÏ„Î±Î¹ Î¼Îµ Î¼Î¹Î± Î½Î­Î± Î´Î¿Î¼Î® ÏÏÎ¸Î¼Î¹ÏƒÎ·Ï‚ Ï€Î¿Ï… Î¿ÏÎ¯Î¶ÎµÎ¹ Ï„Î·Î½ ÎµÎ¹ÎºÏŒÎ½Î± Ï€Î¿Ï… Î¸Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹:

**Example of Deployment + Service declared in the same configuration file (from** [**here**](https://gitlab.com/nanuchi/youtube-tutorial-series/-/blob/master/demo-kubernetes-components/mongo.yaml)**)**

ÎšÎ±Î¸ÏÏ‚ Î¼Î¹Î± Ï…Ï€Î·ÏÎµÏƒÎ¯Î± ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ ÏƒÏ‡ÎµÏ„Î¯Î¶ÎµÏ„Î±Î¹ Î¼Îµ Î¼Î¹Î± Î±Î½Î¬Ï€Ï„Ï…Î¾Î·, ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒÎ½ Î½Î± Î´Î·Î»Ï‰Î¸Î¿ÏÎ½ ÎºÎ±Î¹ Î¿Î¹ Î´ÏÎ¿ ÏƒÏ„Î¿ Î¯Î´Î¹Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ ÏÏÎ¸Î¼Î¹ÏƒÎ·Ï‚ (Î· Ï…Ï€Î·ÏÎµÏƒÎ¯Î± Ï€Î¿Ï… Î´Î·Î»ÏÎ½ÎµÏ„Î±Î¹ ÏƒÎµ Î±Ï…Ï„Î® Ï„Î· ÏÏÎ¸Î¼Î¹ÏƒÎ· ÎµÎ¯Î½Î±Î¹ Ï€ÏÎ¿ÏƒÎ²Î¬ÏƒÎ¹Î¼Î· Î¼ÏŒÎ½Î¿ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ¬):
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
name: mongodb-deployment
labels:
app: mongodb
spec:
replicas: 1
selector:
matchLabels:
app: mongodb
template:
metadata:
labels:
app: mongodb
spec:
containers:
- name: mongodb
image: mongo
ports:
- containerPort: 27017
env:
- name: MONGO_INITDB_ROOT_USERNAME
valueFrom:
secretKeyRef:
name: mongodb-secret
key: mongo-root-username
- name: MONGO_INITDB_ROOT_PASSWORD
valueFrom:
secretKeyRef:
name: mongodb-secret
key: mongo-root-password
---
apiVersion: v1
kind: Service
metadata:
name: mongodb-service
spec:
selector:
app: mongodb
ports:
- protocol: TCP
port: 27017
targetPort: 27017
```
**Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î´Î¹Î±Î¼ÏŒÏÏ†Ï‰ÏƒÎ·Ï‚ ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÎ®Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚**

Î‘Ï…Ï„Î® Î· Ï…Ï€Î·ÏÎµÏƒÎ¯Î± Î¸Î± ÎµÎ¯Î½Î±Î¹ Ï€ÏÎ¿ÏƒÎ²Î¬ÏƒÎ¹Î¼Î· ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÎ¬ (ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î± Ï‡Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÎ¬ `nodePort` ÎºÎ±Î¹ `type: LoadBlancer`):
```yaml
---
apiVersion: v1
kind: Service
metadata:
name: mongo-express-service
spec:
selector:
app: mongo-express
type: LoadBalancer
ports:
- protocol: TCP
port: 8081
targetPort: 8081
nodePort: 30000
```
> [!NOTE]
> Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Ï‡ÏÎ®ÏƒÎ¹Î¼Î¿ Î³Î¹Î± Î´Î¿ÎºÎ¹Î¼Î­Ï‚, Î±Î»Î»Î¬ Î³Î¹Î± Ï€Î±ÏÎ±Î³Ï‰Î³Î® Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î­Ï‡ÎµÏ„Îµ Î¼ÏŒÎ½Î¿ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ­Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ ÎºÎ±Î¹ Î­Î½Î± Ingress Î³Î¹Î± Î½Î± ÎµÎºÎ¸Î­ÏƒÎµÏ„Îµ Ï„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®.

**Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î±ÏÏ‡ÎµÎ¯Î¿Ï… ÏÏÎ¸Î¼Î¹ÏƒÎ·Ï‚ Ingress**

Î‘Ï…Ï„ÏŒ Î¸Î± ÎµÎºÎ¸Î­ÏƒÎµÎ¹ Ï„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î® ÏƒÏ„Î¿ `http://dashboard.com`.
```yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
name: dashboard-ingress
namespace: kubernetes-dashboard
spec:
rules:
- host: dashboard.com
http:
paths:
- backend:
serviceName: kubernetes-dashboard
servicePort: 80
```
**Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î±ÏÏ‡ÎµÎ¯Î¿Ï… ÏÏÎ¸Î¼Î¹ÏƒÎ·Ï‚ Ï€Î±ÏÎ±Î¼Î­Ï„ÏÏ‰Î½ Î¼Ï…ÏƒÏ„Î¹ÎºÏÎ½**

Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ Ï€ÏÏ‚ Î¿Î¹ ÎºÏ‰Î´Î¹ÎºÎ¿Î¯ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ ÎµÎ¯Î½Î±Î¹ ÎºÏ‰Î´Î¹ÎºÎ¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿Î¹ ÏƒÎµ B64 (Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Î±ÏƒÏ†Î±Î»Î­Ï‚!)
```yaml
apiVersion: v1
kind: Secret
metadata:
name: mongodb-secret
type: Opaque
data:
mongo-root-username: dXNlcm5hbWU=
mongo-root-password: cGFzc3dvcmQ=
```
**Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± ConfigMap**

ÎˆÎ½Î± **ConfigMap** ÎµÎ¯Î½Î±Î¹ Î· ÏÏÎ¸Î¼Î¹ÏƒÎ· Ï€Î¿Ï… Ï€Î±ÏÎ­Ï‡ÎµÏ„Î±Î¹ ÏƒÏ„Î± pods ÏÏƒÏ„Îµ Î½Î± Î³Î½Ï‰ÏÎ¯Î¶Î¿Ï…Î½ Ï€ÏÏ‚ Î½Î± ÎµÎ½Ï„Î¿Ï€Î¯Î¶Î¿Ï…Î½ ÎºÎ±Î¹ Î½Î± Î­Ï‡Î¿Ï…Î½ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Î¬Î»Î»ÎµÏ‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚. Î£Îµ Î±Ï…Ï„Î® Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ·, ÎºÎ¬Î¸Îµ pod Î¸Î± Î³Î½Ï‰ÏÎ¯Î¶ÎµÎ¹ ÏŒÏ„Î¹ Ï„Î¿ ÏŒÎ½Î¿Î¼Î± `mongodb-service` ÎµÎ¯Î½Î±Î¹ Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· ÎµÎ½ÏŒÏ‚ pod Î¼Îµ Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¿ÏÎ½ (Î±Ï…Ï„ÏŒ Ï„Î¿ pod Î¸Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯ Î­Î½Î± mongodb):
```yaml
apiVersion: v1
kind: ConfigMap
metadata:
name: mongodb-configmap
data:
database_url: mongodb-service
```
Î¤ÏŒÏ„Îµ, Î¼Î­ÏƒÎ± ÏƒÎµ Î¼Î¹Î± **deployment config** Î±Ï…Ï„Î® Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÏ„ÎµÎ¯ Î¼Îµ Ï„Î¿Î½ ÎµÎ¾Î®Ï‚ Ï„ÏÏŒÏ€Î¿ ÏÏƒÏ„Îµ Î½Î± Ï†Î¿ÏÏ„Ï‰Î¸ÎµÎ¯ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ env Ï„Î¿Ï… pod:
```yaml
[...]
spec:
[...]
template:
[...]
spec:
containers:
- name: mongo-express
image: mongo-express
ports:
- containerPort: 8081
env:
- name: ME_CONFIG_MONGODB_SERVER
valueFrom:
configMapKeyRef:
name: mongodb-configmap
key: database_url
[...]
```
**Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î´Î¹Î±Î¼ÏŒÏÏ†Ï‰ÏƒÎ·Ï‚ ÏŒÎ³ÎºÎ¿Ï…**

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î´Î¹Î¬Ï†Î¿ÏÎ± Ï€Î±ÏÎ±Î´ÎµÎ¯Î³Î¼Î±Ï„Î± Î±ÏÏ‡ÎµÎ¯Ï‰Î½ Î´Î¹Î±Î¼ÏŒÏÏ†Ï‰ÏƒÎ·Ï‚ Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·Ï‚ yaml ÏƒÏ„Î¿ [https://gitlab.com/nanuchi/youtube-tutorial-series/-/tree/master/kubernetes-volumes](https://gitlab.com/nanuchi/youtube-tutorial-series/-/tree/master/kubernetes-volumes).\
**Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Î¿Î¹ ÏŒÎ³ÎºÎ¿Î¹ Î´ÎµÎ½ Î²ÏÎ¯ÏƒÎºÎ¿Î½Ï„Î±Î¹ Î¼Î­ÏƒÎ± ÏƒÎµ namespaces**

### Namespaces

Î¤Î¿ Kubernetes Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ **Ï€Î¿Î»Î»Î±Ï€Î»Î¿ÏÏ‚ ÎµÎ¹ÎºÎ¿Î½Î¹ÎºÎ¿ÏÏ‚ ÎºÎ»Î¬Î´Î¿Ï…Ï‚** Ï€Î¿Ï… Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿Î½ Î¯Î´Î¹Î¿ Ï†Ï…ÏƒÎ¹ÎºÏŒ ÎºÎ»Î¬Î´Î¿. Î‘Ï…Ï„Î¿Î¯ Î¿Î¹ ÎµÎ¹ÎºÎ¿Î½Î¹ÎºÎ¿Î¯ ÎºÎ»Î¬Î´Î¿Î¹ Î¿Î½Î¿Î¼Î¬Î¶Î¿Î½Ï„Î±Î¹ **namespaces**. Î‘Ï…Ï„Î¿Î¯ Ï€ÏÎ¿Î¿ÏÎ¯Î¶Î¿Î½Ï„Î±Î¹ Î³Î¹Î± Ï‡ÏÎ®ÏƒÎ· ÏƒÎµ Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½Ï„Î± Î¼Îµ Ï€Î¿Î»Î»Î¿ÏÏ‚ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚ Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ Î´Î¹Î±ÏƒÎºÎ¿ÏÏ€Î¹ÏƒÎ¼Î­Î½Î¿Î¹ ÏƒÎµ Ï€Î¿Î»Î»Î­Ï‚ Î¿Î¼Î¬Î´ÎµÏ‚ Î® Î­ÏÎ³Î±. Î“Î¹Î± ÎºÎ»Î¬Î´Î¿Ï…Ï‚ Î¼Îµ Î»Î¯Î³Î¿Ï…Ï‚ Î­Ï‰Ï‚ Î´ÎµÎºÎ¬Î´ÎµÏ‚ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚, Î´ÎµÎ½ Î¸Î± Ï‡ÏÎµÎ¹Î±ÏƒÏ„ÎµÎ¯ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Î® Î½Î± ÏƒÎºÎµÏ†Ï„ÎµÎ¯Ï„Îµ ÎºÎ±Î¸ÏŒÎ»Î¿Ï… namespaces. Î ÏÎ­Ï€ÎµÎ¹ Î½Î± Î±ÏÏ‡Î¯ÏƒÎµÏ„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Îµ namespaces Î¼ÏŒÎ½Î¿ Î³Î¹Î± Î½Î± Î­Ï‡ÎµÏ„Îµ ÎºÎ±Î»ÏÏ„ÎµÏÎ¿ Î­Î»ÎµÎ³Ï‡Î¿ ÎºÎ±Î¹ Î¿ÏÎ³Î¬Î½Ï‰ÏƒÎ· ÎºÎ¬Î¸Îµ Î¼Î­ÏÎ¿Ï…Ï‚ Ï„Î·Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚ Ï€Î¿Ï… Î­Ï‡ÎµÎ¹ Î±Î½Î±Ï€Ï„Ï…Ï‡Î¸ÎµÎ¯ ÏƒÏ„Î¿ kubernetes.

Î¤Î± namespaces Ï€Î±ÏÎ­Ï‡Î¿Ï…Î½ Î­Î½Î± Ï€ÎµÎ´Î¯Î¿ Î³Î¹Î± Î¿Î½ÏŒÎ¼Î±Ï„Î±. Î¤Î± Î¿Î½ÏŒÎ¼Î±Ï„Î± Ï„Ï‰Î½ Ï€ÏŒÏÏ‰Î½ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ Î¼Î¿Î½Î±Î´Î¹ÎºÎ¬ ÎµÎ½Ï„ÏŒÏ‚ ÎµÎ½ÏŒÏ‚ namespace, Î±Î»Î»Î¬ ÏŒÏ‡Î¹ ÏƒÎµ ÏŒÎ»Î· Ï„Î·Î½ Î­ÎºÏ„Î±ÏƒÎ· Ï„Ï‰Î½ namespaces. Î¤Î± namespaces Î´ÎµÎ½ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± ÎµÎ¯Î½Î±Î¹ Ï†Ï‰Î»Î¹Î±ÏƒÎ¼Î­Î½Î± Ï„Î¿ Î­Î½Î± Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ Î¬Î»Î»Î¿ ÎºÎ±Î¹ **ÎºÎ¬Î¸Îµ** Ï€ÏŒÏÎ¿Ï‚ Ï„Î¿Ï… Kubernetes Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯Î½Î±Î¹ **ÏƒÎµ** **Î­Î½Î±** **namespace**.

Î¥Ï€Î¬ÏÏ‡Î¿Ï…Î½ 4 namespaces Î±Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î® Î±Î½ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Îµ minikube:
```
kubectl get namespace
NAME              STATUS   AGE
default           Active   1d
kube-node-lease   Active   1d
kube-public       Active   1d
kube-system       Active   1d
```
- **kube-system**: Î”ÎµÎ½ Ï€ÏÎ¿Î¿ÏÎ¯Î¶ÎµÏ„Î±Î¹ Î³Î¹Î± Ï‡ÏÎ®ÏƒÎ· Î±Ï€ÏŒ Ï„Î¿Ï…Ï‚ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚ ÎºÎ±Î¹ Î´ÎµÎ½ Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï„Î¿ Î±Î³Î³Î¯Î¶ÎµÏ„Îµ. Î•Î¯Î½Î±Î¹ Î³Î¹Î± Ï„Î¹Ï‚ Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯ÎµÏ‚ master ÎºÎ±Î¹ kubectl.
- **kube-public**: Î”Î·Î¼ÏŒÏƒÎ¹Î± Ï€ÏÎ¿ÏƒÎ²Î¬ÏƒÎ¹Î¼Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±. Î ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Î­Î½Î± configmap Ï€Î¿Ï… Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Ï„Î¿Ï… cluster.
- **kube-node-lease**: ÎšÎ±Î¸Î¿ÏÎ¯Î¶ÎµÎ¹ Ï„Î· Î´Î¹Î±Î¸ÎµÏƒÎ¹Î¼ÏŒÏ„Î·Ï„Î± ÎµÎ½ÏŒÏ‚ ÎºÏŒÎ¼Î²Î¿Ï….
- **default**: ÎŸ Ï‡ÏÏÎ¿Ï‚ Î¿Î½Î¿Î¼Î¬Ï„Ï‰Î½ Ï€Î¿Ï… Î¸Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Î¿ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î³Î¹Î± Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ Ï€ÏŒÏÎ¿Ï…Ï‚.
```bash
#Create namespace
kubectl create namespace my-namespace
```
> [!NOTE]
> Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Î¿Î¹ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€ÏŒÏÎ¿Î¹ Kubernetes (Ï€.Ï‡. pods, services, replication controllers ÎºÎ±Î¹ Î¬Î»Î»Î¿Î¹) Î²ÏÎ¯ÏƒÎºÎ¿Î½Ï„Î±Î¹ ÏƒÎµ ÎºÎ¬Ï€Î¿Î¹Î± namespaces. Î©ÏƒÏ„ÏŒÏƒÎ¿, Î¬Î»Î»Î¿Î¹ Ï€ÏŒÏÎ¿Î¹ ÏŒÏ€Ï‰Ï‚ Î¿Î¹ Ï€ÏŒÏÎ¿Î¹ namespace ÎºÎ±Î¹ Î¿Î¹ Ï‡Î±Î¼Î·Î»Î¿Ï ÎµÏ€Î¹Ï€Î­Î´Î¿Ï… Ï€ÏŒÏÎ¿Î¹, ÏŒÏ€Ï‰Ï‚ Î¿Î¹ ÎºÏŒÎ¼Î²Î¿Î¹ ÎºÎ±Î¹ Ï„Î± persistenVolumes Î´ÎµÎ½ Î²ÏÎ¯ÏƒÎºÎ¿Î½Ï„Î±Î¹ ÏƒÎµ namespace. Î“Î¹Î± Î½Î± Î´ÎµÎ¯Ï„Îµ Ï€Î¿Î¹ÎµÏ‚ Ï€ÏŒÏÎ¿Î¹ Kubernetes ÎµÎ¯Î½Î±Î¹ ÎºÎ±Î¹ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÏƒÎµ namespace:
>
> ```bash
> kubectl api-resources --namespaced=true #Î£Îµ Î­Î½Î± namespace
> kubectl api-resources --namespaced=false #ÎŒÏ‡Î¹ ÏƒÎµ Î­Î½Î± namespace
> ```

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏÏƒÎµÏ„Îµ Ï„Î¿ namespace Î³Î¹Î± ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ ÎµÏ€ÏŒÎ¼ÎµÎ½ÎµÏ‚ ÎµÎ½Ï„Î¿Î»Î­Ï‚ kubectl ÏƒÎµ Î±Ï…Ï„ÏŒ Ï„Î¿ Ï€Î»Î±Î¯ÏƒÎ¹Î¿.
```bash
kubectl config set-context --current --namespace=<insert-namespace-name-here>
```
### Helm

Helm ÎµÎ¯Î½Î±Î¹ Î¿ **Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®Ï‚ Ï€Î±ÎºÎ­Ï„Ï‰Î½** Î³Î¹Î± Ï„Î¿ Kubernetes. Î•Ï€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î· ÏƒÏ…ÏƒÎºÎµÏ…Î±ÏƒÎ¯Î± Î±ÏÏ‡ÎµÎ¯Ï‰Î½ YAML ÎºÎ±Î¹ Ï„Î· Î´Î¹Î±Î½Î¿Î¼Î® Ï„Î¿Ï…Ï‚ ÏƒÎµ Î´Î·Î¼ÏŒÏƒÎ¹ÎµÏ‚ ÎºÎ±Î¹ Î¹Î´Î¹Ï‰Ï„Î¹ÎºÎ­Ï‚ Î±Ï€Î¿Î¸Î®ÎºÎµÏ‚. Î‘Ï…Ï„Î¬ Ï„Î± Ï€Î±ÎºÎ­Ï„Î± Î¿Î½Î¿Î¼Î¬Î¶Î¿Î½Ï„Î±Î¹ **Helm Charts**.
```
helm search <keyword>
```
Helm ÎµÎ¯Î½Î±Î¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î¼Î¹Î± Î¼Î·Ï‡Î±Î½Î® Ï€ÏÎ¿Ï„ÏÏ€Ï‰Î½ Ï€Î¿Ï… ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î±ÏÏ‡ÎµÎ¯Ï‰Î½ ÏÏ…Î¸Î¼Î¯ÏƒÎµÏ‰Î½ Î¼Îµ Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î­Ï‚:

## Kubernetes Î¼Ï…ÏƒÏ„Î¹ÎºÎ¬

ÎˆÎ½Î± **ÎœÏ…ÏƒÏ„Î¹ÎºÏŒ** ÎµÎ¯Î½Î±Î¹ Î­Î½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Ï€Î¿Ï… **Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ ÎµÏ…Î±Î¯ÏƒÎ¸Î·Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±** ÏŒÏ€Ï‰Ï‚ Î­Î½Î±Ï‚ ÎºÏ‰Î´Î¹ÎºÏŒÏ‚ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚, Î­Î½Î± Î´Î¹Î±ÎºÏÎ¹Ï„Î¹ÎºÏŒ Î® Î­Î½Î± ÎºÎ»ÎµÎ¹Î´Î¯. Î¤Î­Ï„Î¿Î¹ÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Î½ Î±Î»Î»Î¹ÏÏ‚ Î½Î± Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î·Î¸Î¿ÏÎ½ ÏƒÎµ Î¼Î¹Î± Ï€ÏÎ¿Î´Î¹Î±Î³ÏÎ±Ï†Î® Pod Î® ÏƒÎµ Î¼Î¹Î± ÎµÎ¹ÎºÏŒÎ½Î±. ÎŸÎ¹ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎ¿Ï…Î½ ÎœÏ…ÏƒÏ„Î¹ÎºÎ¬ ÎºÎ±Î¹ Ï„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯ ÎµÏ€Î¯ÏƒÎ·Ï‚ ÎœÏ…ÏƒÏ„Î¹ÎºÎ¬. Î¤Î¿ ÏŒÎ½Î¿Î¼Î± ÎµÎ½ÏŒÏ‚ Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼Î­Î½Î¿Ï… ÎœÏ…ÏƒÏ„Î¹ÎºÎ¿Ï Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ Î­Î³ÎºÏ…ÏÎ¿ **ÏŒÎ½Î¿Î¼Î± Ï…Ï€Î¿Ï„Î¿Î¼Î­Î± DNS**. Î”Î¹Î±Î²Î¬ÏƒÏ„Îµ ÎµÎ´Ï [Ï„Î·Î½ ÎµÏ€Î¯ÏƒÎ·Î¼Î· Ï„ÎµÎºÎ¼Î·ÏÎ¯Ï‰ÏƒÎ·](https://kubernetes.io/docs/concepts/configuration/secret/).

Î¤Î± ÎœÏ…ÏƒÏ„Î¹ÎºÎ¬ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯Î½Î±Î¹ Ï€ÏÎ¬Î³Î¼Î±Ï„Î± ÏŒÏ€Ï‰Ï‚:

- API, SSH ÎšÎ»ÎµÎ¹Î´Î¹Î¬.
- OAuth Î´Î¹Î±ÎºÏÎ¹Ï„Î¹ÎºÎ¬.
- Î”Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î±, ÎšÏ‰Î´Î¹ÎºÎ¿Î¯ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ (ÎºÎ±Î¸Î±ÏÎ¿Ï ÎºÎµÎ¹Î¼Î­Î½Î¿Ï… Î® b64 + ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ¬Ï†Î·ÏƒÎ·).
- Î Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î® ÏƒÏ‡ÏŒÎ»Î¹Î±.
- ÎšÏ‰Î´Î¹ÎºÏŒÏ‚ ÏƒÏÎ½Î´ÎµÏƒÎ·Ï‚ Î²Î¬ÏƒÎ·Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½, ÏƒÏ…Î¼Î²Î¿Î»Î¿ÏƒÎµÎ¹ÏÎ­Ï‚â€¦ .

Î¥Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¿Î¯ Ï„ÏÏ€Î¿Î¹ Î¼Ï…ÏƒÏ„Î¹ÎºÏÎ½ ÏƒÏ„Î¿ Kubernetes

| Î¤ÏÏ€Î¿Ï‚ Î•Î½ÏƒÏ‰Î¼Î±Ï„Ï‰Î¼Î­Î½Î¿Ï…                     | Î§ÏÎ®ÏƒÎ·                                     |
| ----------------------------------- | ----------------------------------------- |
| **Opaque**                          | **Ï„Ï…Ï‡Î±Î¯Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï€Î¿Ï… Î¿ÏÎ¯Î¶Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿Î½ Ï‡ÏÎ®ÏƒÏ„Î· (Î ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î®)** |
| kubernetes.io/service-account-token | Î´Î¹Î±ÎºÏÎ¹Ï„Î¹ÎºÏŒ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼Î¿Ï Ï…Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚                     |
| kubernetes.io/dockercfg             | ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿ \~/.dockercfg Î±ÏÏ‡ÎµÎ¯Î¿             |
| kubernetes.io/dockerconfigjson      | ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿ \~/.docker/config.json Î±ÏÏ‡ÎµÎ¯Î¿    |
| kubernetes.io/basic-auth            | Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î± Î³Î¹Î± Î²Î±ÏƒÎ¹ÎºÎ® Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ·      |
| kubernetes.io/ssh-auth              | Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î± Î³Î¹Î± Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ· SSH        |
| kubernetes.io/tls                   | Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î³Î¹Î± Î­Î½Î±Î½ Ï€ÎµÎ»Î¬Ï„Î· Î® Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® TLS           |
| bootstrap.kubernetes.io/token       | Î´ÎµÎ´Î¿Î¼Î­Î½Î± bootstrap token                      |

> [!NOTE]
> **ÎŸ Ï„ÏÏ€Î¿Ï‚ Opaque ÎµÎ¯Î½Î±Î¹ Î¿ Ï€ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î¿Ï‚, Ï„Î¿ Ï„Ï…Ï€Î¹ÎºÏŒ Î¶ÎµÏÎ³Î¿Ï‚ ÎºÎ»ÎµÎ¹Î´Î¹Î¿Ï-Ï„Î¹Î¼Î®Ï‚ Ï€Î¿Ï… Î¿ÏÎ¯Î¶ÎµÏ„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿Ï…Ï‚ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚.**

**Î ÏÏ‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¿ÏÎ½ Ï„Î± Î¼Ï…ÏƒÏ„Î¹ÎºÎ¬:**

![](https://sickrov.github.io/media/Screenshot-164.jpg)

Î¤Î¿ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Î±ÏÏ‡ÎµÎ¯Î¿ ÏÏ…Î¸Î¼Î¯ÏƒÎµÏ‰Î½ Î¿ÏÎ¯Î¶ÎµÎ¹ Î­Î½Î± **Î¼Ï…ÏƒÏ„Î¹ÎºÏŒ** Ï€Î¿Ï… Î¿Î½Î¿Î¼Î¬Î¶ÎµÏ„Î±Î¹ `mysecret` Î¼Îµ 2 Î¶ÎµÏÎ³Î· ÎºÎ»ÎµÎ¹Î´Î¹Î¿Ï-Ï„Î¹Î¼Î®Ï‚ `username: YWRtaW4=` ÎºÎ±Î¹ `password: MWYyZDFlMmU2N2Rm`. ÎŸÏÎ¯Î¶ÎµÎ¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î­Î½Î± **pod** Ï€Î¿Ï… Î¿Î½Î¿Î¼Î¬Î¶ÎµÏ„Î±Î¹ `secretpod` Ï€Î¿Ï… Î¸Î± Î­Ï‡ÎµÎ¹ Ï„Î¿ `username` ÎºÎ±Î¹ Ï„Î¿ `password` Ï€Î¿Ï… Î¿ÏÎ¯Î¶Î¿Î½Ï„Î±Î¹ ÏƒÏ„Î¿ `mysecret` ÎµÎºÏ„ÎµÎ¸ÎµÎ¹Î¼Î­Î½Î± ÏƒÏ„Î¹Ï‚ **Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î­Ï‚ Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½Ï„Î¿Ï‚** `SECRET_USERNAME` \_\_ ÎºÎ±Î¹ \_\_ `SECRET_PASSWOR`. Î˜Î± **Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î®ÏƒÎµÎ¹** ÎµÏ€Î¯ÏƒÎ·Ï‚ Ï„Î¿ Î¼Ï…ÏƒÏ„Î¹ÎºÏŒ `username` Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ `mysecret` ÏƒÏ„Î· Î´Î¹Î±Î´ÏÎ¿Î¼Î® `/etc/foo/my-group/my-username` Î¼Îµ Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î± `0640`.
```yaml:secretpod.yaml
apiVersion: v1
kind: Secret
metadata:
name: mysecret
type: Opaque
data:
username: YWRtaW4=
password: MWYyZDFlMmU2N2Rm
---
apiVersion: v1
kind: Pod
metadata:
name: secretpod
spec:
containers:
- name: secretpod
image: nginx
env:
- name: SECRET_USERNAME
valueFrom:
secretKeyRef:
name: mysecret
key: username
- name: SECRET_PASSWORD
valueFrom:
secretKeyRef:
name: mysecret
key: password
volumeMounts:
- name: foo
mountPath: "/etc/foo"
restartPolicy: Never
volumes:
- name: foo
secret:
secretName: mysecret
items:
- key: username
path: my-group/my-username
mode: 0640
```

```bash
kubectl apply -f <secretpod.yaml>
kubectl get pods #Wait until the pod secretpod is running
kubectl exec -it  secretpod -- bash
env | grep SECRET && cat /etc/foo/my-group/my-username && echo
```
### Secrets in etcd <a href="#discover-secrets-in-etcd" id="discover-secrets-in-etcd"></a>

**etcd** ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± ÏƒÏ…Î½ÎµÏ€Î®Ï‚ ÎºÎ±Î¹ ÎµÎ¾Î±Î¹ÏÎµÏ„Î¹ÎºÎ¬ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î· **Î±Ï€Î¿Î¸Î®ÎºÎ· ÎºÎ»ÎµÎ¹Î´Î¹ÏÎ½-Ï„Î¹Î¼ÏÎ½** Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Ï‰Ï‚ Î±Ï€Î¿Î¸Î®ÎºÎ· Ï…Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î·Ï‚ Ï„Î¿Ï… Kubernetes Î³Î¹Î± ÏŒÎ»Î± Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï„Î¿Ï… ÎºÎ»Î¬ÏƒÏ„ÎµÏ. Î‘Ï‚ Î±Ï€Î¿ÎºÏ„Î®ÏƒÎ¿Ï…Î¼Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î± Î¼Ï…ÏƒÏ„Î¹ÎºÎ¬ Ï€Î¿Ï… Î±Ï€Î¿Î¸Î·ÎºÎµÏÎ¿Î½Ï„Î±Î¹ ÏƒÏ„Î¿ etcd:
```bash
cat /etc/kubernetes/manifests/kube-apiserver.yaml | grep etcd
```
Î˜Î± Î´ÎµÎ¯Ï„Îµ Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Ï„Î¹ÎºÎ¬, ÎºÎ»ÎµÎ¹Î´Î¹Î¬ ÎºÎ±Î¹ Î´Î¹ÎµÏ…Î¸ÏÎ½ÏƒÎµÎ¹Ï‚ URL Ï€Î¿Ï… Î²ÏÎ¯ÏƒÎºÎ¿Î½Ï„Î±Î¹ ÏƒÏ„Î¿ FS. ÎœÏŒÎ»Î¹Ï‚ Ï„Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ, Î¸Î± Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ etcd.
```bash
#ETCDCTL_API=3 etcdctl --cert <path to client.crt> --key <path to client.ket> --cacert <path to CA.cert> endpoint=[<ip:port>] health

ETCDCTL_API=3 etcdctl --cert /etc/kubernetes/pki/apiserver-etcd-client.crt --key /etc/kubernetes/pki/apiserver-etcd-client.key --cacert /etc/kubernetes/pki/etcd/etcd/ca.cert endpoint=[127.0.0.1:1234] health
```
ÎœÏŒÎ»Î¹Ï‚ ÎµÏ€Î¹Ï„ÏÏ‡ÎµÏ„Îµ Î½Î± ÎµÎ´ÏÎ±Î¹ÏÏƒÎµÏ„Îµ Ï„Î·Î½ ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±, Î¸Î± ÎµÎ¯ÏƒÏ„Îµ ÏƒÎµ Î¸Î­ÏƒÎ· Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ Ï„Î± Î¼Ï…ÏƒÏ„Î¹ÎºÎ¬:
```bash
#ETCDCTL_API=3 etcdctl --cert <path to client.crt> --key <path to client.ket> --cacert <path to CA.cert> endpoint=[<ip:port>] get <path/to/secret>

ETCDCTL_API=3 etcdctl --cert /etc/kubernetes/pki/apiserver-etcd-client.crt --key /etc/kubernetes/pki/apiserver-etcd-client.key --cacert /etc/kubernetes/pki/etcd/etcd/ca.cert endpoint=[127.0.0.1:1234] get /registry/secrets/default/secret_02
```
**Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ¬Ï†Î·ÏƒÎ·Ï‚ ÏƒÏ„Î¿ ETCD**

Î‘Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î®, ÏŒÎ»Î± Ï„Î± Î¼Ï…ÏƒÏ„Î¹ÎºÎ¬ ÎµÎ¯Î½Î±Î¹ **Î±Ï€Î¿Î¸Î·ÎºÎµÏ…Î¼Î­Î½Î± ÏƒÎµ Î±Ï€Î»ÏŒ** ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ etcd, ÎµÎºÏ„ÏŒÏ‚ Î±Î½ ÎµÏ†Î±ÏÎ¼ÏŒÏƒÎµÏ„Îµ Î­Î½Î± ÎµÏ€Î¯Ï€ÎµÎ´Î¿ ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ¬Ï†Î·ÏƒÎ·Ï‚. Î¤Î¿ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î²Î±ÏƒÎ¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ [https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/](https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/)
```yaml:encryption.yaml
apiVersion: apiserver.config.k8s.io/v1
kind: EncryptionConfiguration
resources:
- resources:
- secrets
providers:
- aescbc:
keys:
- name: key1
secret: cjjPMcWpTPKhAdieVtd+KhG4NN+N6e3NmBPMXJvbfrY= #Any random key
- identity: {}
```
ÎœÎµÏ„Î¬ Î±Ï€ÏŒ Î±Ï…Ï„ÏŒ, Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î¿ÏÎ¯ÏƒÎµÏ„Îµ Ï„Î·Î½ Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿ `--encryption-provider-config` ÏƒÏ„Î¿Î½ `kube-apiserver` Î³Î¹Î± Î½Î± Î´ÎµÎ¯Î¾ÎµÏ„Îµ Ï„Î·Î½ Ï„Î¿Ï€Î¿Î¸ÎµÏƒÎ¯Î± Ï„Î¿Ï… Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î·Î¸Î­Î½Ï„Î¿Ï‚ Î±ÏÏ‡ÎµÎ¯Î¿Ï… ÏÏ…Î¸Î¼Î¯ÏƒÎµÏ‰Î½. ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î¿ `/etc/kubernetes/manifest/kube-apiserver.yaml` ÎºÎ±Î¹ Î½Î± Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎµÏ„Îµ Ï„Î¹Ï‚ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Î³ÏÎ±Î¼Î¼Î­Ï‚:
```yaml
containers:
- command:
- kube-apiserver
- --encriyption-provider-config=/etc/kubernetes/etcd/<configFile.yaml>
```
ÎšÎ¬Î½Ï„Îµ ÎºÏÎ»Î¹ÏƒÎ· Ï€ÏÎ¿Ï‚ Ï„Î± ÎºÎ¬Ï„Ï‰ ÏƒÏ„Î± volumeMounts:
```yaml
- mountPath: /etc/kubernetes/etcd
name: etcd
readOnly: true
```
Scroll down in the volumeMounts to hostPath:
```yaml
- hostPath:
path: /etc/kubernetes/etcd
type: DirectoryOrCreate
name: etcd
```
**Î•Ï€Î±Î»Î®Î¸ÎµÏ…ÏƒÎ· ÏŒÏ„Î¹ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÎµÎ¯Î½Î±Î¹ ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ±Ï†Î·Î¼Î­Î½Î±**

Î¤Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ±Ï†Î¿ÏÎ½Ï„Î±Î¹ ÏŒÏ„Î±Î½ Î³ÏÎ¬Ï†Î¿Î½Ï„Î±Î¹ ÏƒÏ„Î¿ etcd. ÎœÎµÏ„Î¬ Ï„Î·Î½ ÎµÏ€Î±Î½ÎµÎºÎºÎ¯Î½Î·ÏƒÎ· Ï„Î¿Ï… `kube-apiserver`, Î¿Ï€Î¿Î¹Î¿Î´Î®Ï€Î¿Ï„Îµ Î½Î­Î¿ Î® ÎµÎ½Î·Î¼ÎµÏÏ‰Î¼Î­Î½Î¿ Î¼Ï…ÏƒÏ„Î¹ÎºÏŒ Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ±Ï†Î·Î¼Î­Î½Î¿ ÏŒÏ„Î±Î½ Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÏ„Î±Î¹. Î“Î¹Î± Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î¿ Ï€ÏÏŒÎ³ÏÎ±Î¼Î¼Î± Î³ÏÎ±Î¼Î¼Î®Ï‚ ÎµÎ½Ï„Î¿Î»ÏÎ½ `etcdctl` Î³Î¹Î± Î½Î± Î±Î½Î±ÎºÏ„Î®ÏƒÎµÏ„Îµ Ï„Î¿ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ Ï„Î¿Ï… Î¼Ï…ÏƒÏ„Î¹ÎºÎ¿Ï ÏƒÎ±Ï‚.

1.  Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÏ„Îµ Î­Î½Î± Î½Î­Î¿ Î¼Ï…ÏƒÏ„Î¹ÎºÏŒ Î¼Îµ Ï„Î¿ ÏŒÎ½Î¿Î¼Î± `secret1` ÏƒÏ„Î¿ namespace `default`:

```
kubectl create secret generic secret1 -n default --from-literal=mykey=mydata
```

2.  Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î·Î½ ÎµÎ½Ï„Î¿Î»Î® etcdctl, Î´Î¹Î±Î²Î¬ÏƒÏ„Îµ Î±Ï…Ï„ÏŒ Ï„Î¿ Î¼Ï…ÏƒÏ„Î¹ÎºÏŒ Î±Ï€ÏŒ Ï„Î¿ etcd:

`ETCDCTL_API=3 etcdctl get /registry/secrets/default/secret1 [...] | hexdump -C`

ÏŒÏ€Î¿Ï… `[...]` Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ Ï„Î± ÎµÏ€Î¹Ï€Î»Î­Î¿Î½ ÎµÏ€Î¹Ï‡ÎµÎ¹ÏÎ®Î¼Î±Ï„Î± Î³Î¹Î± Ï„Î· ÏƒÏÎ½Î´ÎµÏƒÎ· Î¼Îµ Ï„Î¿Î½ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® etcd.

3.  Î•Ï€Î±Î»Î·Î¸ÎµÏÏƒÏ„Îµ ÏŒÏ„Î¹ Ï„Î¿ Î±Ï€Î¿Î¸Î·ÎºÎµÏ…Î¼Î­Î½Î¿ Î¼Ï…ÏƒÏ„Î¹ÎºÏŒ Î­Ï‡ÎµÎ¹ Ï€ÏÏŒÎ¸ÎµÎ¼Î± `k8s:enc:aescbc:v1:`, Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎµÎ¹ ÏŒÏ„Î¹ Î¿ Ï€Î¬ÏÎ¿Ï‡Î¿Ï‚ `aescbc` Î­Ï‡ÎµÎ¹ ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ±Ï†Î®ÏƒÎµÎ¹ Ï„Î± Î±Ï€Î¿Ï„ÎµÎ»Î­ÏƒÎ¼Î±Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±.
4.  Î•Ï€Î±Î»Î·Î¸ÎµÏÏƒÏ„Îµ ÏŒÏ„Î¹ Ï„Î¿ Î¼Ï…ÏƒÏ„Î¹ÎºÏŒ Î±Ï€Î¿ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ±Ï†ÎµÎ¯Ï„Î±Î¹ ÏƒÏ‰ÏƒÏ„Î¬ ÏŒÏ„Î±Î½ Î±Î½Î±ÎºÏ„Î¬Ï„Î±Î¹ Î¼Î­ÏƒÏ‰ Ï„Î¿Ï… API:

```
kubectl describe secret secret1 -n default
```

Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï„Î±Î¹ÏÎ¹Î¬Î¶ÎµÎ¹ Î¼Îµ `mykey: bXlkYXRh`, Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î¼Î¿Ï… ÎµÎ¯Î½Î±Î¹ ÎºÏ‰Î´Î¹ÎºÎ¿Ï€Î¿Î¹Î·Î¼Î­Î½Î±, ÎµÎ»Î­Î³Î¾Ï„Îµ [Î±Ï€Î¿ÎºÏ‰Î´Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ· ÎµÎ½ÏŒÏ‚ Î¼Ï…ÏƒÏ„Î¹ÎºÎ¿Ï](https://kubernetes.io/docs/concepts/configuration/secret#decoding-a-secret) Î³Î¹Î± Î½Î± Î±Ï€Î¿ÎºÏ‰Î´Î¹ÎºÎ¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï€Î»Î®ÏÏ‰Ï‚ Ï„Î¿ Î¼Ï…ÏƒÏ„Î¹ÎºÏŒ.

**Î”ÎµÎ´Î¿Î¼Î­Î½Î¿Ï… ÏŒÏ„Î¹ Ï„Î± Î¼Ï…ÏƒÏ„Î¹ÎºÎ¬ ÎµÎ¯Î½Î±Î¹ ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ±Ï†Î·Î¼Î­Î½Î± ÎºÎ±Ï„Î¬ Ï„Î·Î½ ÎµÎ³Î³ÏÎ±Ï†Î®, Î· ÎµÎºÏ„Î­Î»ÎµÏƒÎ· Î¼Î¹Î±Ï‚ ÎµÎ½Î·Î¼Î­ÏÏ‰ÏƒÎ·Ï‚ ÏƒÎµ Î­Î½Î± Î¼Ï…ÏƒÏ„Î¹ÎºÏŒ Î¸Î± ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ±Ï†Î®ÏƒÎµÎ¹ Î±Ï…Ï„ÏŒ Ï„Î¿ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿:**
```
kubectl get secrets --all-namespaces -o json | kubectl replace -f -
```
**Î¤ÎµÎ»Î¹ÎºÎ­Ï‚ ÏƒÏ…Î¼Î²Î¿Ï…Î»Î­Ï‚:**

- Î ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÏ„Îµ Î½Î± Î¼Î·Î½ ÎºÏÎ±Ï„Î¬Ï„Îµ Î¼Ï…ÏƒÏ„Î¹ÎºÎ¬ ÏƒÏ„Î¿ FS, Î±Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï„Î± Î±Ï€ÏŒ Î¬Î»Î»ÎµÏ‚ Ï€Î·Î³Î­Ï‚.
- Î”ÎµÎ¯Ï„Îµ Ï„Î¿ [https://www.vaultproject.io/](https://www.vaultproject.io) Î³Î¹Î± Î½Î± Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎµÏ„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ· Ï€ÏÎ¿ÏƒÏ„Î±ÏƒÎ¯Î± ÏƒÏ„Î± Î¼Ï…ÏƒÏ„Î¹ÎºÎ¬ ÏƒÎ±Ï‚.
- [https://kubernetes.io/docs/concepts/configuration/secret/#risks](https://kubernetes.io/docs/concepts/configuration/secret/#risks)
- [https://docs.cyberark.com/Product-Doc/OnlineHelp/AAM-DAP/11.2/en/Content/Integrations/Kubernetes_deployApplicationsConjur-k8s-Secrets.htm](https://docs.cyberark.com/Product-Doc/OnlineHelp/AAM-DAP/11.2/en/Content/Integrations/Kubernetes_deployApplicationsConjur-k8s-Secrets.htm)

## Î‘Î½Î±Ï†Î¿ÏÎ­Ï‚

{{#ref}}
https://sickrov.github.io/
{{#endref}}

{{#ref}}
https://www.youtube.com/watch?v=X48VuDVv0do
{{#endref}}

{{#include ../../banners/hacktricks-training.md}}
