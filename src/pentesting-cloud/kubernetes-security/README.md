# Kubernetes Pentesting

{{#include ../../banners/hacktricks-training.md}}

## Kubernetes Basics

Si no sabes nada sobre Kubernetes, este es un **buen comienzo**. Léelo para aprender sobre la **arquitectura, componentes y acciones básicas** en Kubernetes:

{{#ref}}
kubernetes-basics.md
{{#endref}}

### Labs to practice and learn

- [https://securekubernetes.com/](https://securekubernetes.com)
- [https://madhuakula.com/kubernetes-goat/index.html](https://madhuakula.com/kubernetes-goat/index.html)

## Hardening Kubernetes / Automatic Tools

{{#ref}}
kubernetes-hardening/
{{#endref}}

## Manual Kubernetes Pentest

### From the Outside

Hay varios **servicios de Kubernetes que podrías encontrar expuestos** en Internet (o dentro de redes internas). Si los encuentras, sabes que hay un entorno de Kubernetes allí.

Dependiendo de la configuración y tus privilegios, podrías ser capaz de abusar de ese entorno, para más información:

{{#ref}}
pentesting-kubernetes-services/
{{#endref}}

### Enumeration inside a Pod

Si logras **comprometer un Pod**, lee la siguiente página para aprender cómo enumerar y tratar de **escalar privilegios/escapar**:

{{#ref}}
attacking-kubernetes-from-inside-a-pod.md
{{#endref}}

### Enumerating Kubernetes with Credentials

Podrías haber logrado comprometer **credenciales de usuario, un token de usuario o algún token de cuenta de servicio**. Puedes usarlo para hablar con el servicio API de Kubernetes y tratar de **enumerarlo para aprender más** sobre él:

{{#ref}}
kubernetes-enumeration.md
{{#endref}}

Otro detalle importante sobre la enumeración y el abuso de permisos en Kubernetes es el **Control de Acceso Basado en Roles de Kubernetes (RBAC)**. Si quieres abusar de los permisos, primero deberías leer sobre ello aquí:

{{#ref}}
kubernetes-role-based-access-control-rbac.md
{{#endref}}

#### Conociendo sobre RBAC y habiendo enumerado el entorno, ahora puedes intentar abusar de los permisos con:

{{#ref}}
abusing-roles-clusterroles-in-kubernetes/
{{#endref}}

### Privesc to a different Namespace

Si has comprometido un namespace, potencialmente puedes escapar a otros namespaces con permisos/recursos más interesantes:

{{#ref}}
kubernetes-namespace-escalation.md
{{#endref}}

### From Kubernetes to the Cloud

Si has comprometido una cuenta de K8s o un pod, podrías ser capaz de moverte a otras nubes. Esto se debe a que en nubes como AWS o GCP es posible **dar permisos a un SA de K8s sobre la nube**.

{{#ref}}
kubernetes-pivoting-to-clouds.md
{{#endref}}

{{#include ../../banners/hacktricks-training.md}}
