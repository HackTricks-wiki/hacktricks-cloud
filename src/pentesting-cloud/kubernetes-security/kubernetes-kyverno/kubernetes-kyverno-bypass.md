# Kubernetes Kyverno bypass

**Ο αρχικός συγγραφέας αυτής της σελίδας είναι** [**Guillaume**](https://www.linkedin.com/in/guillaume-chapela-ab4b9a196)

## Κατάχρηση κακής διαμόρφωσης πολιτικών

### Καταμέτρηση κανόνων

Η επισκόπηση μπορεί να βοηθήσει στο να γνωρίζουμε ποιες κανόνες είναι ενεργοί, σε ποιον τρόπο και ποιος μπορεί να τους παρακάμψει.
```bash
$ kubectl get clusterpolicies
$ kubectl get policies
```
### Enumerate Excluded

Για κάθε ClusterPolicy και Policy, μπορείτε να καθορίσετε μια λίστα εξαιρούμενων οντοτήτων, συμπεριλαμβανομένων:

- Ομάδες: `excludedGroups`
- Χρήστες: `excludedUsers`
- Λογαριασμοί Υπηρεσιών (SA): `excludedServiceAccounts`
- Ρόλοι: `excludedRoles`
- Ρόλοι Cluster: `excludedClusterRoles`

Αυτές οι εξαιρούμενες οντότητες θα είναι απαλλαγμένες από τις απαιτήσεις της πολιτικής, και η Kyverno δεν θα επιβάλει την πολιτική για αυτές.

## Example

Let's dig into one clusterpolicy example :
```
$ kubectl get clusterpolicies MYPOLICY -o yaml
```
Αναζητήστε τις εξαιρούμενες οντότητες:
```yaml
exclude:
any:
- clusterRoles:
- cluster-admin
- subjects:
- kind: User
name: system:serviceaccount:DUMMYNAMESPACE:admin
- kind: User
name: system:serviceaccount:TEST:thisisatest
- kind: User
name: system:serviceaccount:AHAH:*
```
Μέσα σε ένα cluster, πολλαπλά πρόσθετα στοιχεία, operators και εφαρμογές μπορεί να απαιτούν εξαίρεση από μια πολιτική cluster. Ωστόσο, αυτό μπορεί να εκμεταλλευτεί με την στόχευση προνομιακών οντοτήτων. Σε ορισμένες περιπτώσεις, μπορεί να φαίνεται ότι ένα namespace δεν υπάρχει ή ότι δεν έχετε άδεια να προσποιηθείτε έναν χρήστη, κάτι που μπορεί να είναι ένδειξη κακής διαμόρφωσης.

## Abusing ValidatingWebhookConfiguration

Another way to bypass policies is to focus on the ValidatingWebhookConfiguration resource :

{{#ref}}
../kubernetes-validatingwebhookconfiguration.md
{{#endref}}

## More info

For more info check [https://madhuakula.com/kubernetes-goat/docs/scenarios/scenario-22/securing-kubernetes-clusters-using-kyverno-policy-engine/welcome/](https://madhuakula.com/kubernetes-goat/docs/scenarios/scenario-22/securing-kubernetes-clusters-using-kyverno-policy-engine/welcome/)
