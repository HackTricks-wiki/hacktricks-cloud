# GWS - Post Exploitation

{{#include ../../banners/hacktricks-training.md}}

## Google Groups Privesc

デフォルトでは、workspace内の**グループ**は組織の任意のメンバーによって**自由にアクセス**できます。\
Workspaceは**グループに権限を付与する**ことも許可しているため（GCP権限も含む）、グループに参加でき、追加の権限がある場合、攻撃者は**その経路を悪用して権限を昇格**させる可能性があります。

組織内の誰でも参加できるグループに参加するには、コンソールへのアクセスが必要な場合があります。グループ情報は[**https://groups.google.com/all-groups**](https://groups.google.com/all-groups)で確認してください。

### Access Groups Mail info

もし**Googleユーザーセッションを侵害**できた場合、[**https://groups.google.com/all-groups**](https://groups.google.com/all-groups)から、ユーザーがメンバーであるメールグループに送信されたメールの履歴を確認でき、**認証情報**や他の**機密データ**を見つけることができるかもしれません。

## GCP <--> GWS Pivoting

{{#ref}}
../gcp-security/gcp-to-workspace-pivoting/
{{#endref}}

## Takeout - Download Everything Google Knows about an account

もし**被害者のGoogleアカウント内にセッションがある**場合、[**https://takeout.google.com**](https://takeout.google.com/u/1/?pageId=none)からそのアカウントに関するすべての情報をダウンロードできます。

## Vault - Download all the Workspace data of users

もし組織が**Google Vaultを有効にしている**場合、[**https://vault.google.com**](https://vault.google.com/u/1/)にアクセスして、すべての**情報**を**ダウンロード**できるかもしれません。

## Contacts download

[**https://contacts.google.com**](https://contacts.google.com/u/1/?hl=es&tab=mC)から、ユーザーのすべての**連絡先**をダウンロードできます。

## Cloudsearch

[**https://cloudsearch.google.com/**](https://cloudsearch.google.com)では、ユーザーがアクセスできる**すべてのWorkspaceコンテンツ**（メール、ドライブ、サイトなど）を検索できます。機密情報を**迅速に見つける**のに理想的です。

## Google Chat

[**https://mail.google.com/chat**](https://mail.google.com/chat)では、Googleの**チャット**にアクセスでき、会話の中に機密情報が含まれているかもしれません（もしあれば）。

## Google Drive Mining

文書を**共有**する際、アクセスできる**人々**を一人ずつ**指定**することができますが、**会社全体**（または特定の**グループ**）と**リンクを生成**して共有することもできます。

文書を共有する際、詳細設定でこのファイルを**検索可能にする**こともできます（**デフォルト**では**無効**です）。ただし、ユーザーが文書を表示すると、それは彼らによって検索可能になることに注意が必要です。

簡単のために、ほとんどの人は一人ずつアクセスできる人を追加するのではなく、リンクを生成して共有します。

すべての文書を見つけるための提案された方法：

- 内部チャット、フォーラムで検索...
- **スパイダー**として知られている**文書**を検索し、他の文書への**参照**を探します。これは[ **PaperChaser**](https://github.com/mandatoryprogrammer/PaperChaser)を使ってApp Script内で行うことができます。

## **Keep Notes**

[**https://keep.google.com/**](https://keep.google.com)では、ユーザーのノートにアクセスでき、**機密**の**情報**が保存されているかもしれません。

### Modify App Scripts

[**https://script.google.com/**](https://script.google.com/)では、ユーザーのAPPスクリプトを見つけることができます。

## **Administrate Workspace**

[**https://admin.google.com**/](https://admin.google.com)では、十分な権限があれば、組織全体のWorkspace設定を変更できるかもしれません。

また、[**https://admin.google.com/ac/emaillogsearch**](https://admin.google.com/ac/emaillogsearch)でユーザーの請求書を検索することでメールを見つけることもできます。

## References

- [https://www.youtube-nocookie.com/embed/6AsVUS79gLw](https://www.youtube-nocookie.com/embed/6AsVUS79gLw) - Matthew Bryant - Hacking G Suite: The Power of Dark Apps Script Magic
- [https://www.youtube.com/watch?v=KTVHLolz6cE](https://www.youtube.com/watch?v=KTVHLolz6cE) - Mike Felch and Beau Bullock - OK Google, How do I Red Team GSuite?

{{#include ../../banners/hacktricks-training.md}}
