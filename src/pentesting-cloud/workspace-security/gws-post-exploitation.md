# GWS - Post Exploitation

{{#include ../../banners/hacktricks-training.md}}

## Google Groups Privesc

默认情况下，在workspace中，**组**可以被组织中的任何成员**自由访问**。\
Workspace还允许**授予组权限**（甚至是GCP权限），因此如果可以加入的组具有额外权限，攻击者可能会**利用该路径提升权限**。

您可能需要访问控制台以加入允许组织中任何人加入的组。请在[**https://groups.google.com/all-groups**](https://groups.google.com/all-groups)中检查组信息。

### 访问组邮件信息

如果您成功**入侵了一个谷歌用户会话**，您可以从[**https://groups.google.com/all-groups**](https://groups.google.com/all-groups)查看用户所加入的邮件组的邮件历史记录，您可能会找到**凭证**或其他**敏感数据**。

## GCP <--> GWS Pivoting

{{#ref}}
../gcp-security/gcp-to-workspace-pivoting/
{{#endref}}

## Takeout - 下载谷歌知道的关于账户的所有信息

如果您在受害者的谷歌账户中**有一个会话**，您可以从[**https://takeout.google.com**](https://takeout.google.com/u/1/?pageId=none)下载谷歌保存的关于该账户的所有信息。

## Vault - 下载用户的所有Workspace数据

如果一个组织启用了**Google Vault**，您可能能够访问[**https://vault.google.com**](https://vault.google.com/u/1/)并**下载**所有**信息**。

## 联系人下载

从[**https://contacts.google.com**](https://contacts.google.com/u/1/?hl=es&tab=mC)您可以下载用户的所有**联系人**。

## Cloudsearch

在[**https://cloudsearch.google.com/**](https://cloudsearch.google.com)中，您可以搜索用户可以访问的**所有Workspace内容**（电子邮件、云端硬盘、网站...）。理想用于**快速查找敏感信息**。

## Google Chat

在[**https://mail.google.com/chat**](https://mail.google.com/chat)中，您可以访问Google **聊天**，您可能会在对话中找到敏感信息（如果有的话）。

## Google Drive Mining

在**共享**文档时，您可以**指定**可以逐个访问它的**人员**，也可以通过**生成链接**与您的**整个公司**（**或**某些特定**组**）**共享**。

在共享文档时，在高级设置中，您还可以**允许人们搜索**此文件（**默认**情况下此选项是**禁用**的）。然而，重要的是要注意，一旦用户查看了文档，它就可以被他们搜索。

为了简单起见，大多数人会生成并共享一个链接，而不是逐个添加可以访问文档的人。

一些建议的查找所有文档的方法：

- 在内部聊天、论坛中搜索...
- **蜘蛛**已知的**文档**，搜索对其他文档的**引用**。您可以在App Script中使用[ **PaperChaser**](https://github.com/mandatoryprogrammer/PaperChaser)来完成此操作。

## **Keep Notes**

在[**https://keep.google.com/**](https://keep.google.com)中，您可以访问用户的笔记，**敏感** **信息**可能保存在这里。

### 修改App Scripts

在[**https://script.google.com/**](https://script.google.com/)中，您可以找到用户的APP Scripts。

## **Administrate Workspace**

在[**https://admin.google.com**/](https://admin.google.com)中，如果您拥有足够的权限，您可能能够修改整个组织的Workspace设置。

您还可以通过在[**https://admin.google.com/ac/emaillogsearch**](https://admin.google.com/ac/emaillogsearch)中搜索所有用户的发票来查找电子邮件。

## References

- [https://www.youtube-nocookie.com/embed/6AsVUS79gLw](https://www.youtube-nocookie.com/embed/6AsVUS79gLw) - Matthew Bryant - Hacking G Suite: The Power of Dark Apps Script Magic
- [https://www.youtube.com/watch?v=KTVHLolz6cE](https://www.youtube.com/watch?v=KTVHLolz6cE) - Mike Felch and Beau Bullock - OK Google, How do I Red Team GSuite?

{{#include ../../banners/hacktricks-training.md}}
