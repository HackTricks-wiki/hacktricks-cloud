# GWS - Post Exploitation

{{#include ../../banners/hacktricks-training.md}}

## Google Groups Privesc

Per impostazione predefinita in workspace un **gruppo** può essere **liberamente accessibile** da qualsiasi membro dell'organizzazione.\
Workspace consente anche di **concedere permessi ai gruppi** (anche permessi GCP), quindi se i gruppi possono essere uniti e hanno permessi extra, un attaccante potrebbe **sfruttare quel percorso per elevare i privilegi**.

Potresti aver bisogno di accesso alla console per unirti a gruppi che possono essere uniti da chiunque nell'org. Controlla le informazioni sui gruppi in [**https://groups.google.com/all-groups**](https://groups.google.com/all-groups).

### Access Groups Mail info

Se sei riuscito a **compromettere una sessione utente google**, da [**https://groups.google.com/all-groups**](https://groups.google.com/all-groups) puoi vedere la cronologia delle email inviate ai gruppi di posta di cui l'utente è membro, e potresti trovare **credenziali** o altri **dati sensibili**.

## GCP <--> GWS Pivoting

{{#ref}}
../gcp-security/gcp-to-workspace-pivoting/
{{#endref}}

## Takeout - Scarica tutto ciò che Google sa su un account

Se hai una **sessione all'interno dell'account google della vittima** puoi scaricare tutto ciò che Google salva su quell'account da [**https://takeout.google.com**](https://takeout.google.com/u/1/?pageId=none)

## Vault - Scarica tutti i dati di Workspace degli utenti

Se un'organizzazione ha **Google Vault abilitato**, potresti essere in grado di accedere a [**https://vault.google.com**](https://vault.google.com/u/1/) e **scaricare** tutte le **informazioni**.

## Contatti download

Da [**https://contacts.google.com**](https://contacts.google.com/u/1/?hl=es&tab=mC) puoi scaricare tutti i **contatti** dell'utente.

## Cloudsearch

In [**https://cloudsearch.google.com/**](https://cloudsearch.google.com) puoi semplicemente cercare **tra tutto il contenuto di Workspace** (email, drive, siti...) a cui un utente ha accesso. Ideale per **trovare rapidamente informazioni sensibili**.

## Google Chat

In [**https://mail.google.com/chat**](https://mail.google.com/chat) puoi accedere a una **Chat** di Google, e potresti trovare informazioni sensibili nelle conversazioni (se presenti).

## Google Drive Mining

Quando **condividi** un documento puoi **specificare** le **persone** che possono accedervi una per una, **condividerlo** con l'intera **azienda** (**o** con alcuni **gruppi** specifici) generando un **link**.

Quando condividi un documento, nelle impostazioni avanzate puoi anche **permettere alle persone di cercare** questo file (per **default** questo è **disabilitato**). Tuttavia, è importante notare che una volta che gli utenti visualizzano un documento, è ricercabile da loro.

Per semplicità, la maggior parte delle persone genererà e condividerà un link invece di aggiungere le persone che possono accedere al documento una per una.

Alcuni modi proposti per trovare tutti i documenti:

- Cerca in chat interne, forum...
- **Spider** documenti **noti** cercando **riferimenti** ad altri documenti. Puoi farlo all'interno di uno Script App con [**PaperChaser**](https://github.com/mandatoryprogrammer/PaperChaser)

## **Keep Notes**

In [**https://keep.google.com/**](https://keep.google.com) puoi accedere alle note dell'utente, **informazioni** **sensibili** potrebbero essere salvate qui.

### Modifica App Scripts

In [**https://script.google.com/**](https://script.google.com/) puoi trovare gli APP Scripts dell'utente.

## **Amministra Workspace**

In [**https://admin.google.com**/](https://admin.google.com), potresti essere in grado di modificare le impostazioni di Workspace dell'intera organizzazione se hai abbastanza permessi.

Puoi anche trovare email cercando tra tutte le fatture dell'utente in [**https://admin.google.com/ac/emaillogsearch**](https://admin.google.com/ac/emaillogsearch)

## Riferimenti

- [https://www.youtube-nocookie.com/embed/6AsVUS79gLw](https://www.youtube-nocookie.com/embed/6AsVUS79gLw) - Matthew Bryant - Hacking G Suite: The Power of Dark Apps Script Magic
- [https://www.youtube.com/watch?v=KTVHLolz6cE](https://www.youtube.com/watch?v=KTVHLolz6cE) - Mike Felch e Beau Bullock - OK Google, come faccio a Red Team GSuite?

{{#include ../../banners/hacktricks-training.md}}
