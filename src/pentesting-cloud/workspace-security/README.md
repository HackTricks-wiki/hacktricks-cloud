# GWS - Workspace Pentesting

{{#include ../../banners/hacktricks-training.md}}

## Entry Points

### Google Platforms and OAuth Apps Phishing

Перевірте, як ви можете використовувати різні платформи Google, такі як Drive, Chat, Groups... для відправки жертві фішингового посилання та як виконати фішинг Google OAuth у:

{{#ref}}
gws-google-platforms-phishing/
{{#endref}}

### Password Spraying

Щоб протестувати паролі з усіма електронними адресами, які ви знайшли (або які ви згенерували на основі шаблону імені електронної пошти, який ви могли виявити), ви можете використовувати інструмент, такий як [**https://github.com/ustayready/CredKing**](https://github.com/ustayready/CredKing) (хоча він виглядає непідтримуваним), який використовуватиме AWS lambdas для зміни IP-адреси.

## Post-Exploitation

Якщо ви скомпрометували деякі облікові дані або сесію користувача, ви можете виконати кілька дій для доступу до потенційно чутливої інформації користувача та спробувати підвищити привілеї:

{{#ref}}
gws-post-exploitation.md
{{#endref}}

### GWS <-->GCP Pivoting

Дізнайтеся більше про різні техніки півотування між GWS та GCP у:

{{#ref}}
../gcp-security/gcp-to-workspace-pivoting/
{{#endref}}

## GWS <--> GCPW | GCDS | Directory Sync (AD & EntraID)

- **GCPW (Google Credential Provider for Windows)**: Це єдиний вхід, який надає Google Workspaces, щоб користувачі могли входити в свої ПК з Windows, використовуючи **свої облікові дані Workspace**. Більше того, це **зберігатиме токени для доступу до Google Workspace** в деяких місцях на ПК.
- **GCDS (Google CLoud DIrectory Sync)**: Це інструмент, який можна використовувати для **синхронізації ваших користувачів та груп активного каталогу з вашим Workspace**. Інструмент вимагає **облікових даних суперкористувача Workspace та привілейованого користувача AD**. Тому, можливо, його можна знайти всередині доменного сервера, який час від часу синхронізує користувачів.
- **Admin Directory Sync**: Дозволяє синхронізувати користувачів з AD та EntraID у безсерверному процесі з [https://admin.google.com/ac/sync/externaldirectories](https://admin.google.com/ac/sync/externaldirectories).

{{#ref}}
gws-workspace-sync-attacks-gcpw-gcds-gps-directory-sync-with-ad-and-entraid/
{{#endref}}

## Persistence

Якщо ви скомпрометували деякі облікові дані або сесію користувача, перевірте ці варіанти для підтримки постійності:

{{#ref}}
gws-persistence.md
{{#endref}}

## Account Compromised Recovery

- Вийти з усіх сесій
- Змінити пароль користувача
- Згенерувати нові резервні коди 2FA
- Видалити паролі додатків
- Видалити OAuth додатки
- Видалити пристрої 2FA
- Видалити пересилання електронної пошти
- Видалити фільтри електронної пошти
- Видалити електронну пошту/телефони для відновлення
- Видалити зловмисні синхронізовані смартфони
- Видалити погані Android додатки
- Видалити погані делегування облікового запису

## References

- [https://www.youtube-nocookie.com/embed/6AsVUS79gLw](https://www.youtube-nocookie.com/embed/6AsVUS79gLw) - Matthew Bryant - Hacking G Suite: The Power of Dark Apps Script Magic
- [https://www.youtube.com/watch?v=KTVHLolz6cE](https://www.youtube.com/watch?v=KTVHLolz6cE) - Mike Felch and Beau Bullock - OK Google, How do I Red Team GSuite?

{{#include ../../banners/hacktricks-training.md}}
