# GWS - Workspace Pentesting

{{#include ../../banners/hacktricks-training.md}}

## Entry Points

### Google Platforms and OAuth Apps Phishing

Proverite kako možete koristiti različite Google platforme kao što su Drive, Chat, Groups... da pošaljete žrtvi phishing link i kako da izvršite Google OAuth Phishing u:

{{#ref}}
gws-google-platforms-phishing/
{{#endref}}

### Password Spraying

Da biste testirali lozinke sa svim emailovima koje ste pronašli (ili koje ste generisali na osnovu obrazaca imena emaila koje ste možda otkrili), možete koristiti alat kao što je [**https://github.com/ustayready/CredKing**](https://github.com/ustayready/CredKing) (iako izgleda da nije održavan) koji će koristiti AWS lambde za promenu IP adrese.

## Post-Exploitation

Ako ste kompromitovali neke kredencijale ili sesiju korisnika, možete izvršiti nekoliko akcija da pristupite potencijalno osetljivim informacijama korisnika i pokušate da eskalirate privilegije:

{{#ref}}
gws-post-exploitation.md
{{#endref}}

### GWS <-->GCP Pivoting

Pročitajte više o različitim tehnikama za pivotiranje između GWS i GCP u:

{{#ref}}
../gcp-security/gcp-to-workspace-pivoting/
{{#endref}}

## GWS <--> GCPW | GCDS | Directory Sync (AD & EntraID)

- **GCPW (Google Credential Provider for Windows)**: Ovo je jedinstveno prijavljivanje koje Google Workspaces pruža tako da korisnici mogu da se prijave na svojim Windows PC-ima koristeći **svoje Workspace kredencijale**. Štaviše, ovo će **čuvati tokene za pristup Google Workspace-u** na nekim mestima na PC-u.
- **GCDS (Google Cloud Directory Sync)**: Ovo je alat koji se može koristiti za **sinhronizaciju vaših korisnika i grupa iz aktivnog direktorijuma sa vašim Workspace-om**. Alat zahteva **kredencijale superkorisnika Workspace-a i privilegovanog AD korisnika**. Tako da, može biti moguće pronaći ga unutar domen servera koji bi povremeno sinhronizovao korisnike.
- **Admin Directory Sync**: Omogućava vam da sinhronizujete korisnike iz AD i EntraID u serverless procesu sa [https://admin.google.com/ac/sync/externaldirectories](https://admin.google.com/ac/sync/externaldirectories).

{{#ref}}
gws-workspace-sync-attacks-gcpw-gcds-gps-directory-sync-with-ad-and-entraid/
{{#endref}}

## Persistence

Ako ste kompromitovali neke kredencijale ili sesiju korisnika, proverite ove opcije za održavanje postojanosti:

{{#ref}}
gws-persistence.md
{{#endref}}

## Account Compromised Recovery

- Odjavite se iz svih sesija
- Promenite lozinku korisnika
- Generišite nove 2FA rezervne kodove
- Uklonite App lozinke
- Uklonite OAuth aplikacije
- Uklonite 2FA uređaje
- Uklonite email prosledjivače
- Uklonite email filtre
- Uklonite email/telefone za oporavak
- Uklonite zlonamerne sinhronizovane pametne telefone
- Uklonite loše Android aplikacije
- Uklonite loše delegacije naloga

## References

- [https://www.youtube-nocookie.com/embed/6AsVUS79gLw](https://www.youtube-nocookie.com/embed/6AsVUS79gLw) - Matthew Bryant - Hacking G Suite: The Power of Dark Apps Script Magic
- [https://www.youtube.com/watch?v=KTVHLolz6cE](https://www.youtube.com/watch?v=KTVHLolz6cE) - Mike Felch i Beau Bullock - OK Google, Kako da Red Team GSuite?

{{#include ../../banners/hacktricks-training.md}}
