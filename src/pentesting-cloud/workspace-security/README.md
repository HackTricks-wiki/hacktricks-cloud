# GWS - Workspace Pentesting

{{#include ../../banners/hacktricks-training.md}}

## Entry Points

### Google Platforms and OAuth Apps Phishing

다양한 Google 플랫폼(예: Drive, Chat, Groups 등)을 사용하여 피해자에게 피싱 링크를 보내는 방법과 Google OAuth 피싱을 수행하는 방법을 확인하세요:

{{#ref}}
gws-google-platforms-phishing/
{{#endref}}

### Password Spraying

발견한 모든 이메일(또는 발견한 이메일 이름 패턴을 기반으로 생성한 이메일)로 비밀번호를 테스트하기 위해 [**https://github.com/ustayready/CredKing**](https://github.com/ustayready/CredKing)와 같은 도구를 사용할 수 있습니다(유지 관리되지 않는 것처럼 보이지만). 이 도구는 AWS 람다를 사용하여 IP 주소를 변경합니다.

## Post-Exploitation

자격 증명이나 사용자의 세션을 손상시킨 경우, 사용자의 잠재적인 민감한 정보에 접근하고 권한을 상승시키기 위해 여러 작업을 수행할 수 있습니다:

{{#ref}}
gws-post-exploitation.md
{{#endref}}

### GWS <-->GCP Pivoting

GWS와 GCP 간의 피벗 기술에 대해 더 읽어보세요:

{{#ref}}
../gcp-security/gcp-to-workspace-pivoting/
{{#endref}}

## GWS <--> GCPW | GCDS | Directory Sync (AD & EntraID)

- **GCPW (Google Credential Provider for Windows)**: 이는 Google Workspaces가 제공하는 단일 로그인으로, 사용자가 **자신의 Workspace 자격 증명**을 사용하여 Windows PC에 로그인할 수 있습니다. 또한, 이는 PC의 여러 위치에 Google Workspace에 접근하기 위한 토큰을 **저장합니다**.
- **GCDS (Google Cloud Directory Sync)**: 이는 **활성 디렉토리 사용자 및 그룹을 Workspace와 동기화**하는 데 사용할 수 있는 도구입니다. 이 도구는 **Workspace 슈퍼유저 및 권한이 있는 AD 사용자**의 자격 증명이 필요합니다. 따라서, 사용자 동기화를 위해 가끔씩 동기화하는 도메인 서버 내에서 이를 찾는 것이 가능할 수 있습니다.
- **Admin Directory Sync**: 이는 [https://admin.google.com/ac/sync/externaldirectories](https://admin.google.com/ac/sync/externaldirectories)에서 서버리스 프로세스를 통해 AD 및 EntraID의 사용자를 동기화할 수 있게 해줍니다.

{{#ref}}
gws-workspace-sync-attacks-gcpw-gcds-gps-directory-sync-with-ad-and-entraid/
{{#endref}}

## Persistence

자격 증명이나 사용자의 세션을 손상시킨 경우, 이를 지속적으로 유지하기 위한 옵션을 확인하세요:

{{#ref}}
gws-persistence.md
{{#endref}}

## Account Compromised Recovery

- 모든 세션에서 로그아웃
- 사용자 비밀번호 변경
- 새로운 2FA 백업 코드 생성
- 앱 비밀번호 제거
- OAuth 앱 제거
- 2FA 장치 제거
- 이메일 포워더 제거
- 이메일 필터 제거
- 복구 이메일/전화번호 제거
- 악성 동기화된 스마트폰 제거
- 나쁜 Android 앱 제거
- 나쁜 계정 위임 제거

## References

- [https://www.youtube-nocookie.com/embed/6AsVUS79gLw](https://www.youtube-nocookie.com/embed/6AsVUS79gLw) - Matthew Bryant - Hacking G Suite: The Power of Dark Apps Script Magic
- [https://www.youtube.com/watch?v=KTVHLolz6cE](https://www.youtube.com/watch?v=KTVHLolz6cE) - Mike Felch and Beau Bullock - OK Google, How do I Red Team GSuite?

{{#include ../../banners/hacktricks-training.md}}
