# GWS - Workspace Pentesting

{{#include ../../banners/hacktricks-training.md}}

## Entry Points

### Google Platforms and OAuth Apps Phishing

Ελέγξτε πώς μπορείτε να χρησιμοποιήσετε διάφορες πλατφόρμες της Google όπως το Drive, το Chat, τις Ομάδες... για να στείλετε στον θύμα έναν σύνδεσμο phishing και πώς να εκτελέσετε ένα Google OAuth Phishing στο:

{{#ref}}
gws-google-platforms-phishing/
{{#endref}}

### Password Spraying

Για να δοκιμάσετε κωδικούς πρόσβασης με όλα τα email που βρήκατε (ή έχετε δημιουργήσει με βάση ένα μοτίβο ονόματος email που μπορεί να έχετε ανακαλύψει) μπορείτε να χρησιμοποιήσετε ένα εργαλείο όπως το [**https://github.com/ustayready/CredKing**](https://github.com/ustayready/CredKing) (αν και φαίνεται ότι δεν συντηρείται) το οποίο θα χρησιμοποιήσει AWS lambdas για να αλλάξει διεύθυνση IP.

## Post-Exploitation

Εάν έχετε παραβιάσει κάποια διαπιστευτήρια ή τη συνεδρία του χρήστη, μπορείτε να εκτελέσετε πολλές ενέργειες για να αποκτήσετε πρόσβαση σε πιθανές ευαίσθητες πληροφορίες του χρήστη και να προσπαθήσετε να κλιμακώσετε τα προνόμια:

{{#ref}}
gws-post-exploitation.md
{{#endref}}

### GWS <-->GCP Pivoting

Διαβάστε περισσότερα για τις διάφορες τεχνικές για pivoting μεταξύ GWS και GCP στο:

{{#ref}}
../gcp-security/gcp-to-workspace-pivoting/
{{#endref}}

## GWS <--> GCPW | GCDS | Directory Sync (AD & EntraID)

- **GCPW (Google Credential Provider for Windows)**: Αυτό είναι το single sign-on που παρέχει το Google Workspaces ώστε οι χρήστες να μπορούν να συνδεθούν στους υπολογιστές Windows τους χρησιμοποιώντας **τα διαπιστευτήρια του Workspace τους**. Επιπλέον, αυτό θα **αποθηκεύει tokens για πρόσβαση στο Google Workspace** σε ορισμένα μέρη του υπολογιστή.
- **GCDS (Google CLoud DIrectory Sync)**: Αυτό είναι ένα εργαλείο που μπορεί να χρησιμοποιηθεί για να **συγχρονίσετε τους χρήστες και τις ομάδες του ενεργού καταλόγου σας με το Workspace σας**. Το εργαλείο απαιτεί **τα διαπιστευτήρια ενός superuser του Workspace και ενός προνομιούχου χρήστη AD**. Έτσι, μπορεί να είναι δυνατό να το βρείτε μέσα σε έναν διακομιστή τομέα που θα συγχρονίζει χρήστες από καιρό σε καιρό.
- **Admin Directory Sync**: Επιτρέπει να συγχρονίσετε χρήστες από AD και EntraID σε μια διαδικασία χωρίς διακομιστή από [https://admin.google.com/ac/sync/externaldirectories](https://admin.google.com/ac/sync/externaldirectories).

{{#ref}}
gws-workspace-sync-attacks-gcpw-gcds-gps-directory-sync-with-ad-and-entraid/
{{#endref}}

## Persistence

Εάν έχετε παραβιάσει κάποια διαπιστευτήρια ή τη συνεδρία του χρήστη, ελέγξτε αυτές τις επιλογές για να διατηρήσετε την επιμονή σε αυτό:

{{#ref}}
gws-persistence.md
{{#endref}}

## Account Compromised Recovery

- Αποσυνδεθείτε από όλες τις συνεδρίες
- Αλλάξτε τον κωδικό πρόσβασης του χρήστη
- Δημιουργήστε νέους κωδικούς εφεδρείας 2FA
- Αφαιρέστε τους κωδικούς πρόσβασης εφαρμογών
- Αφαιρέστε τις εφαρμογές OAuth
- Αφαιρέστε τις συσκευές 2FA
- Αφαιρέστε τους προωθητές email
- Αφαιρέστε τα φίλτρα email
- Αφαιρέστε το email/τηλέφωνα ανάκτησης
- Αφαιρέστε τα κακόβουλα συγχρονισμένα smartphones
- Αφαιρέστε τις κακές εφαρμογές Android
- Αφαιρέστε τις κακές εξουσιοδοτήσεις λογαριασμού

## References

- [https://www.youtube-nocookie.com/embed/6AsVUS79gLw](https://www.youtube-nocookie.com/embed/6AsVUS79gLw) - Matthew Bryant - Hacking G Suite: The Power of Dark Apps Script Magic
- [https://www.youtube.com/watch?v=KTVHLolz6cE](https://www.youtube.com/watch?v=KTVHLolz6cE) - Mike Felch and Beau Bullock - OK Google, How do I Red Team GSuite?

{{#include ../../banners/hacktricks-training.md}}
