# Temel Github Bilgileri

{{#include ../../banners/hacktricks-training.md}}

## Temel Yapı

Büyük bir **şirket**in temel github ortam yapısı, bir **enterprise**'a sahip olmaktır; bu enterprise birkaç **organization**'a sahiptir ve her biri **birden fazla repository** ve **birden fazla team** içerebilir. Daha küçük şirketler sadece **tek bir organization sahibi olup enterprise'a sahip olmayabilir**.

Kullanıcı açısından bir **user**, **farklı enterprise'ların ve organization'ların** bir üyesi olabilir. Bu yapıların içinde kullanıcı farklı **enterprise, organization ve repository rolleri** taşıyabilir.

Ayrıca bir kullanıcı farklı **takımların (teams)** üyesi olabilir ve bu takımlarda farklı enterprise, organization veya repository rolleri olabilir.

Ve son olarak **repository'ler özel koruma mekanizmalarına sahip olabilir.**

## Ayrıcalıklar

### Enterprise Rolleri

- **Enterprise owner**: Bu role sahip kişiler **yöneticileri yönetebilir, enterprise içindeki organization'ları yönetebilir, enterprise ayarlarını yönetebilir, organization'lar arasında politika uygulayabilir**. Ancak, bir organization sahibi yapılmadıkları veya organization'a ait bir repository'e doğrudan erişim verilmediği sürece **organization ayarlarına veya içeriğine erişemezler**.
- **Enterprise members**: Enterprise'ınız tarafından sahip olunan organization'ların üyeleri **otomatik olarak enterprise üyeleri** olur.

### Organization Rolleri

Bir organization içinde kullanıcılar farklı rollere sahip olabilir:

- **Organization owners**: Organization sahipleri **organization üzerinde tam idari erişime** sahiptir. Bu rol sınırlı tutulmalı, ancak organization içinde en az iki kişiden daha az olmamalıdır.
- **Organization members**: Organization içindeki kişilerin varsayılan, idari olmayan rolü organization member'dır. Varsayılan olarak organization üyeleri **bir dizi izne** sahiptir.
- **Billing managers**: Billing manager'lar organization için **fatura ayarlarını yönetebilen** kullanıcılardır (ör. ödeme bilgileri).
- **Security Managers**: Organization sahiplerinin herhangi bir team'e atayabileceği bir roldür. Uygulandığında, takımın her üyesine **organizasyon genelindeki security alert'leri ve ayarlarını yönetme izni ile tüm repository'leri okuma izni** verir.
- Eğer organization'ın bir security takımı varsa, security manager rolünü takım üyelerine organizasyona erişmek için gereken en az izinleri vermek amacıyla kullanabilirsiniz.
- **Github App managers**: Organization tarafından sahip olunan GitHub App'leri yönetmek için ek kullanıcılara izin vermek amacıyla owner onlara GitHub App manager izinleri verebilir.
- **Outside collaborators**: Outside collaborator, organization üyesi olarak açıkça yer almayan ancak **bir veya daha fazla organization repository'sine erişimi olan** kişidir.

Bu rollerin izinlerini şu tabloda **karşılaştırabilirsiniz**: [https://docs.github.com/en/organizations/managing-peoples-access-to-your-organization-with-roles/roles-in-an-organization#permissions-for-organization-roles](https://docs.github.com/en/organizations/managing-peoples-access-to-your-organization-with-roles/roles-in-an-organization#permissions-for-organization-roles)

### Üye Ayrıcalıkları

_https://github.com/organizations/\<org_name>/settings/member_privileges_ adresinde, **organizasyonun bir parçası olmanın kullanıcılara vereceği izinleri** görebilirsiniz.

Burada yapılandırılan ayarlar organizasyon üyelerinin aşağıdaki izinlerini belirler:

- Tüm organization repository'leri üzerinde admin, writer, reader veya hiç izin olmama.
- Üyelerin private, internal veya public repository oluşturup oluşturamayacağı.
- Repository'lerin fork edilip edilemeyeceği.
- Outside collaborator davet etmenin mümkün olup olmadığı.
- Public veya private sitelerin yayınlanıp yayınlanamayacağı.
- Admin'lerin repository'ler üzerindeki izinleri.
- Üyelerin yeni team oluşturup oluşturamayacağı.

### Repository Rolleri

Varsayılan olarak repository rolleri oluşturulur:

- **Read**: Projeyi görüntülemek veya tartışmak isteyen **kod dışı katkıcılar** için önerilir.
- **Triage**: Yazma erişimi olmadan **issue ve pull request'leri proaktif olarak yönetmesi gereken katkıcılar** için önerilir.
- **Write**: Projeye aktif olarak push yapan katkıcılar için önerilir.
- **Maintain**: Hassas veya yok edici eylemlere erişimi olmadan **repository'yi yönetmesi gereken proje yöneticileri** için önerilir.
- **Admin**: Güvenlik yönetimi veya repository silme gibi hassas ve yok edici eylemler dahil olmak üzere **projeye tam erişim** needs eden kişiler için önerilir.

Her rolün izinlerini şu tabloda **karşılaştırabilirsiniz**: [https://docs.github.com/en/organizations/managing-access-to-your-organizations-repositories/repository-roles-for-an-organization#permissions-for-each-role](https://docs.github.com/en/organizations/managing-access-to-your-organizations-repositories/repository-roles-for-an-organization#permissions-for-each-role)

Ayrıca kendi rollerinizi _https://github.com/organizations/\<org_name>/settings/roles_ adresinde **oluşturabilirsiniz**.

### Teams

Organization'da oluşturulan takımları _https://github.com/orgs/\<org_name>/teams_ adresinde **listeleyebilirsiniz**. Diğer takımların alt takımlarını görmek için her parent team'e erişmeniz gerektiğini unutmayın.

### Users

Organization kullanıcıları _https://github.com/orgs/\<org_name>/people_ adresinde **listelenebilir**.

Her kullanıcının bilgisi içinde kullanıcının **üye olduğu takımlar** ve kullanıcının **erişimi olan repo'lar** görülebilir.

## Github Kimlik Doğrulama

Github hesabınıza kimlik doğrulamak ve sizin adınıza işlem yapmak için farklı yollar sunar.

### Web Erişimi

**github.com**'a erişerek **username ve password** (ve muhtemelen **2FA**) ile giriş yapabilirsiniz.

### **SSH Keys**

Hesabınızı, ilgili **private key**in sizin adınıza işlem yapmasına izin veren bir veya birden fazla public key ile yapılandırabilirsiniz. [https://github.com/settings/keys](https://github.com/settings/keys)

#### **GPG Keys**

Bu anahtarlarla kullanıcıyı **taklit edemezsiniz**, ancak eğer kullanmazsanız **imzasız commit gönderirken keşfedilebilirsiniz**. [vigilant mode hakkında daha fazla bilgi için buraya bakın](https://docs.github.com/en/authentication/managing-commit-signature-verification/displaying-verification-statuses-for-all-of-your-commits#about-vigilant-mode).

### **Personal Access Tokens**

Bir uygulamaya hesabınıza erişim vermek için personal access token oluşturabilirsiniz. Bir personal access token oluştururken **kullanıcının** token'ın sahip olacağı **izinleri belirtmesi gerekir**. [https://github.com/settings/tokens](https://github.com/settings/tokens)

### Oauth Applications

Oauth uygulamaları sizden **github bilgilerinizin bir bölümüne erişim veya sizi taklit etme** izni isteyebilir. Bu işlevselliğin yaygın bir örneği bazı platformlarda bulabileceğiniz **login with github butonu**dur.

- Kendi **Oauth applications**'ınızı [https://github.com/settings/developers](https://github.com/settings/developers) adresinde **oluşturabilirsiniz**.
- Hesabınıza erişimi olan tüm **Oauth applications**'ı [https://github.com/settings/applications](https://github.com/settings/applications) adresinde görebilirsiniz.
- Oauth App'lerin isteyebileceği **scopes**'u şu adreste görebilirsiniz: [https://docs.github.com/en/developers/apps/building-oauth-apps/scopes-for-oauth-apps](https://docs.github.com/en/developers/apps/building-oauth-apps/scopes-for-oauth-apps)
- Bir **organization** içindeki uygulamaların üçüncü taraf erişimini _https://github.com/organizations/\<org_name>/settings/oauth_application_policy_ adresinde görebilirsiniz.

Bazı **güvenlik önerileri**:

- Bir **OAuth App**, belirtilen scope'larla **tüm GitHub genelinde kimlik doğrulanmış kullanıcı gibi davranmamalıdır** (ör. kullanıcı bildirimleri sağlama gibi) ve yalnızca belirtilen scope'lara erişmelidir.
- OAuth App, "Login with GitHub" etkinleştirerek kimlik sağlayıcı olarak kullanılabilir.
- **repo** OAuth scope'u ile OAuth App'ler **kimlik doğrulanmış kullanıcının tüm repository'leri üzerinde** işlem yapabilir; bu nedenle **sadece tek bir repository** için uygulama geliştirmek istiyorsanız OAuth App kullanmayın.
- Bir şirket veya takım için OAuth App oluşturmayın; OAuth App'ler **tek bir kullanıcı** olarak kimlik doğrular. Bir kişi şirket için OAuth App oluşturup sonra ayrılırsa, başka kimse ona erişemeyebilir.
- Daha fazlası için [buraya bakın](https://docs.github.com/en/developers/apps/getting-started-with-apps/about-apps#about-oauth-apps).

### Github Applications

Github uygulamaları, belirli kaynaklar üzerinde belirli eylemleri gerçekleştirmek için **github bilgilerinize erişim veya sizi taklit etme** izinleri isteyebilir. Github Apps içinde uygulamanın erişeceği repository'leri belirtmeniz gerekir.

- Bir GitHub App'i yüklemek için organization owner olmanız veya bir repository'de admin iznine sahip olmanız gerekir.
- GitHub App bir **kişisel hesaba veya bir organizasyona** bağlanmalıdır.
- Kendi Github uygulamanızı [https://github.com/settings/apps](https://github.com/settings/apps) adresinde oluşturabilirsiniz.
- Hesabınıza erişimi olan tüm **Github applications**'ı [https://github.com/settings/apps/authorizations](https://github.com/settings/apps/authorizations) adresinde görebilirsiniz.
- Bunlar Github Applications için **API Endpoints**'tir: [https://docs.github.com/en/rest/overview/endpoints-available-for-github-app](https://docs.github.com/en/rest/overview/endpoints-available-for-github-apps). Uygulamanın izinlerine bağlı olarak bazılarına erişebilecektir.
- Bir organization'da yüklü uygulamaları _https://github.com/organizations/\<org_name>/settings/installations_ adresinde görebilirsiniz.

Bazı güvenlik önerileri:

- Bir GitHub App, (uygulama bir [user-to-server](https://docs.github.com/en/apps/building-github-apps/identifying-and-authorizing-users-for-github-apps#user-to-server-requests) token kullanmıyorsa) **kullanıcıdan bağımsız eylemler gerçekleştirmelidir**. User-to-server erişim token'larını daha güvenli tutmak için 8 saat sonra süresi dolacak erişim token'ları ve yeni erişim token'ı almak için değiş tokuş edilebilen refresh token kullanabilirsiniz. Daha fazla bilgi için "[Refreshing user-to-server access tokens](https://docs.github.com/en/apps/building-github-apps/refreshing-user-to-server-access-tokens)." bölümüne bakın.
- GitHub App'in belirli repository'lerle entegre olduğundan emin olun.
- GitHub App bir **kişisel hesaba veya organizasyona** bağlanmalıdır.
- GitHub App'ten bir kullanıcının bildiği ve yapabildiği her şeyi beklemeyin.
- Sadece "Login with GitHub" servisine ihtiyacınız varsa GitHub App kullanmayın. Ancak bir GitHub App, kullanıcıları oturum açtırmak ve diğer işleri yapmak için bir [user identification flow](https://docs.github.com/en/apps/building-github-apps/identifying-and-authorizing-users-for-github-apps) kullanabilir.
- Sadece bir GitHub kullanıcısı gibi davranıp o kullanıcının yapabildiği her şeyi yapmak istiyorsanız GitHub App geliştirmeyin.
- App'i GitHub Actions ile kullanıyor ve workflow dosyalarını değiştirmek istiyorsanız, kullanıcı adına kimlik doğrulaması yapmak için `workflow` scope'u içeren bir OAuth token kullanmanız gerekir. Kullanıcının workflow dosyasını içeren repository'de admin veya write izni olmalıdır. Daha fazla bilgi için "[Understanding scopes for OAuth apps](https://docs.github.com/en/apps/building-oauth-apps/understanding-scopes-for-oauth-apps/#available-scopes)." bölümüne bakın.
- Daha fazlası için [buraya bakın](https://docs.github.com/en/developers/apps/getting-started-with-apps/about-apps#about-github-apps).

### Github Actions

Bu **github'da kimlik doğrulama yolu değildir**, ancak kötü amaçlı bir Github Action **izin verilmeyen erişim** elde edebilir ve Action'a verilen **ayrıca ayrıcalıklara** bağlı olarak çeşitli **saldırılar** gerçekleştirilebilir. Detaylar aşağıdadır.

## Git Actions

Git actions, bir olay gerçekleştiğinde kodun **otomatik olarak çalıştırılmasını sağlar**. Genellikle çalıştırılan kod repository'nin koduyla ilgili olur (ör. bir docker container build etmek veya PR'de gizli anahtar olup olmadığını kontrol etmek).

### Yapılandırma

_https://github.com/organizations/\<org_name>/settings/actions_ adresinde organization için **github actions yapılandırmasını** kontrol edebilirsiniz.

Github Actions kullanımını tamamen yasaklamak, **tüm github actions'lara izin vermek** veya sadece belirli actions'lara izin vermek mümkündür.

Ayrıca **hangi kullanıcıların bir Github Action'ı çalıştırmak için onaya ihtiyaç duyacağını** ve bir Github Action çalıştırıldığında **GITHUB_TOKEN'ın izinlerini** yapılandırmak da mümkündür.

### Git Secrets

Github Action'lar genellikle github veya üçüncü parti uygulamalarla etkileşim için bazı secret'lara ihtiyaç duyar. Bunları repo içinde düz metin olarak koymamak için github bunları **Secrets** olarak koymaya izin verir.

Bu secret'lar **repo için veya organizasyon genelinde** yapılandırılabilir. Daha sonra Action'ın secret'a erişebilmesi için onu şu şekilde deklar etmeniz gerekir:
```yaml
steps:
- name: Hello world action
with: # Set the secret as an input
super_secret:${{ secrets.SuperSecret }}
env: # Or as an environment variable
super_secret:${{ secrets.SuperSecret }}
```
#### Bash kullanarak örnek <a href="#example-using-bash" id="example-using-bash"></a>
```yaml
steps:
- shell: bash
env: SUPER_SECRET:${{ secrets.SuperSecret }}
run: |
example-command "$SUPER_SECRET"
```
> [!WARNING]
> Secrets **yalnızca onları beyan eden Github Actions'tan erişilebilir**.

> Repo veya organization içinde yapılandırıldıktan sonra **github kullanıcıları bunlara tekrar erişemeyecek**, sadece **değiştirebilecekler**.

Bu nedenle, **github secrets'i çalmanın tek yolu, Github Action'ı çalıştıran makineye erişebilmek**tir (bu senaryoda yalnızca Action için tanımlanmış secrets'a erişebileceksiniz).

### Git Environments

Github, **environments** oluşturmanıza ve **secrets** saklamanıza izin verir. Ardından, environment içindeki secrets'a github action'a şu şekilde erişim verebilirsiniz:
```yaml
jobs:
deployment:
runs-on: ubuntu-latest
environment: env_name
```
You can configure an environment to be **accessed** by **all branches** (default), **only protected** branches or **specify** which branches can access it.\
Additionally, environment protections include:
- **Required reviewers**: gate jobs targeting the environment until approved. Enable **Prevent self-review** to enforce a proper four‑eyes principle on the approval itself.
- **Deployment branches and tags**: restrict which branches/tags may deploy to the environment. Prefer selecting specific branches/tags and ensure those branches are protected. Note: the "Protected branches only" option applies to classic branch protections and may not behave as expected if using rulesets.
- **Wait timer**: delay deployments for a configurable period.

Ayrıca bir environment kullanılarak bir **action** çalıştırılmadan önce **gerekli inceleme sayısını** belirleyebilir veya dağıtımların devam etmesine izin vermeden önce belli bir **süre bekletebilirsiniz**.
### Git Action Runner

A Github Action can be **executed inside the github environment** or can be executed in a **third party infrastructure** configured by the user.

Bazı organizasyonlar, Github Actions'ı kullanıcı tarafından yapılandırılan bir **third party infrastructure** içinde çalıştırmaya izin verir; bunun sebebi genellikle daha **ucuz** olmasıdır.

Bir organizasyonun **self-hosted runners** listesini şu adreste görebilirsiniz: _https://github.com/organizations/\<org_name>/settings/actions/runners_

Hangi **Github Actions'ın non-github infrastructure** içinde çalıştırıldığını bulmanın yolu, Github Action konfigürasyon yaml'ında `runs-on: self-hosted` aramaktır.

It's **not possible to run a Github Action of an organization inside a self hosted box** of a different organization because **a unique token is generated for the Runner** when configuring it to know where the runner belongs.

Eğer özelleştirilmiş **Github Runner** örneğin bir makinede AWS veya GCP içinde yapılandırıldıysa, Action **metadata endpoint'e erişim** sağlayabilir ve makinenin çalıştığı servis hesabının token'ını **çalabilir**.

### Git Action Compromise

If all actions (or a malicious action) are allowed a user could use a **Github action** that is **malicious** and will **compromise** the **container** where it's being executed.

> [!CAUTION]
> A **malicious Github Action** run could be **abused** by the attacker to:
>
> - **Steal all the secrets** the Action has access to
> - **Move laterally** if the Action is executed inside a **third party infrastructure** where the SA token used to run the machine can be accessed (probably via the metadata service)
> - **Abuse the token** used by the **workflow** to **steal the code of the repo** where the Action is executed or **even modify it**.

## Branch Protections

Branch protections are designed to **not give complete control of a repository** to the users. The goal is to **put several protection methods before being able to write code inside some branch**.

Bir repository'nin **branch protections** ayarlarına şu adresten ulaşılabilir: _https://github.com/\<orgname>/\<reponame>/settings/branches_

> [!NOTE]
> It's **not possible to set a branch protection at organization level**. So all of them must be declared on each repo.

Farklı korumalar bir branche (ör. master) uygulanabilir:

- You can **require a PR before merging** (so you cannot directly merge code over the branch). If this is select different other protections can be in place:
- **Require a number of approvals**. It's very common to require 1 or 2 more people to approve your PR so a single user isn't capable of merge code directly.
- **Dismiss approvals when new commits are pushed**. If not, a user may approve legit code and then the user could add malicious code and merge it.
- **Require approval of the most recent reviewable push**. Ensures that any new commits after an approval (including pushes by other collaborators) re-trigger review so an attacker cannot push post-approval changes and merge.
- **Require reviews from Code Owners**. At least 1 code owner of the repo needs to approve the PR (so "random" users cannot approve it)
- **Restrict who can dismiss pull request reviews.** You can specify people or teams allowed to dismiss pull request reviews.
- **Allow specified actors to bypass pull request requirements**. These users will be able to bypass previous restrictions.
- **Require status checks to pass before merging.** Some checks need to pass before being able to merge the commit (like a GitHub App reporting SAST results). Tip: bind required checks to a specific GitHub App; otherwise any app could spoof the check via the Checks API, and many bots accept skip directives (e.g., "@bot-name skip").
- **Require conversation resolution before merging**. All comments on the code needs to be resolved before the PR can be merged.
- **Require signed commits**. The commits need to be signed.
- **Require linear history.** Prevent merge commits from being pushed to matching branches.
- **Include administrators**. If this isn't set, admins can bypass the restrictions.
- **Restrict who can push to matching branches**. Restrict who can send a PR.

> [!NOTE]
> As you can see, even if you managed to obtain some credentials of a user, **repos might be protected avoiding you to pushing code to master** for example to compromise the CI/CD pipeline.

## Tag Protections

Tags (like latest, stable) are mutable by default. To enforce a four‑eyes flow on tag updates, protect tags and chain protections through environments and branches:

1) On the tag protection rule, enable **Require deployments to succeed** and require a successful deployment to a protected environment (e.g., prod).
2) In the target environment, restrict **Deployment branches and tags** to the release branch (e.g., main) and optionally configure **Required reviewers** with **Prevent self-review**.
3) On the release branch, configure branch protections to **Require a pull request**, set approvals ≥ 1, and enable both **Dismiss approvals when new commits are pushed** and **Require approval of the most recent reviewable push**.

Bu zincir, tek bir işbirlikçinin workflow YAML'ı düzenleyerek retag veya force-publish ile sürümleri değiştirmesini engeller; çünkü deployment gate'leri workflow dışından uygulanır.

## References

- [https://docs.github.com/en/organizations/managing-access-to-your-organizations-repositories/repository-roles-for-an-organization](https://docs.github.com/en/organizations/managing-access-to-your-organizations-repositories/repository-roles-for-an-organization)
- [https://docs.github.com/en/enterprise-server@3.3/admin/user-management/managing-users-in-your-enterprise/roles-in-an-enterprise](https://docs.github.com/en/enterprise-server@3.3/admin/user-management/managing-users-in-your-enterprise/roles-in-an-enterprise)[https://docs.github.com/en/enterprise-server](https://docs.github.com/en/enterprise-server@3.3/admin/user-management/managing-users-in-your-enterprise/roles-in-an-enterprise)
- [https://docs.github.com/en/get-started/learning-about-github/access-permissions-on-github](https://docs.github.com/en/get-started/learning-about-github/access-permissions-on-github)
- [https://docs.github.com/en/account-and-profile/setting-up-and-managing-your-github-user-account/managing-user-account-settings/permission-levels-for-user-owned-project-boards](https://docs.github.com/en/account-and-profile/setting-up-and-managing-your-github-user-account/managing-user-account-settings/permission-levels-for-user-owned-project-boards)
- [https://docs.github.com/en/actions/security-guides/encrypted-secrets](https://docs.github.com/en/actions/security-guides/encrypted-secrets)
- [https://docs.github.com/en/actions/writing-workflows/workflow-syntax-for-github-actions](https://docs.github.com/en/actions/writing-workflows/workflow-syntax-for-github-actions)
- [https://securitylab.github.com/resources/github-actions-untrusted-input/](https://securitylab.github.com/resources/github-actions-untrusted-input/)
- [https://docs.github.com/en/rest/checks/runs](https://docs.github.com/en/rest/checks/runs)
- [https://docs.github.com/en/apps](https://docs.github.com/en/apps)
- [GitHub Actions: A Cloudy Day for Security - Part 1](https://binarysecurity.no/posts/2025/08/securing-gh-actions-part1)

{{#include ../../banners/hacktricks-training.md}}
