# Vercel

{{#include ../banners/hacktricks-training.md}}

## Basic Information

Vercel에서 **팀**은 클라이언트에 속한 전체 **환경**이며, **프로젝트**는 **애플리케이션**입니다.

**Vercel**의 보안 강화를 검토하려면 **Viewer 역할 권한**이 있는 사용자에게 요청하거나, 프로젝트를 확인하기 위해 최소한 **프로젝트 뷰어 권한**을 요청해야 합니다(팀 구성도 확인할 필요가 없는 경우).

## Project Settings

### General

**목적:** 프로젝트 이름, 프레임워크 및 빌드 구성과 같은 기본 프로젝트 설정을 관리합니다.

#### Security Configurations:

- **Transfer**
- **Misconfiguration:** 프로젝트를 다른 팀으로 전송할 수 있습니다.
- **Risk:** 공격자가 프로젝트를 훔칠 수 있습니다.
- **Delete Project**
- **Misconfiguration:** 프로젝트를 삭제할 수 있습니다.
- **Risk:** 프로젝트가 삭제됩니다.

---

### Domains

**목적:** 사용자 정의 도메인, DNS 설정 및 SSL 구성을 관리합니다.

#### Security Configurations:

- **DNS Configuration Errors**
- **Misconfiguration:** 악성 서버를 가리키는 잘못된 DNS 레코드(A, CNAME).
- **Risk:** 도메인 탈취, 트래픽 가로채기 및 피싱 공격.
- **SSL/TLS Certificate Management**
- **Misconfiguration:** 약하거나 만료된 SSL/TLS 인증서를 사용합니다.
- **Risk:** 중간자(MITM) 공격에 취약해져 데이터 무결성과 기밀성이 손상됩니다.
- **DNSSEC Implementation**
- **Misconfiguration:** DNSSEC를 활성화하지 않거나 잘못된 DNSSEC 설정.
- **Risk:** DNS 스푸핑 및 캐시 오염 공격에 대한 취약성이 증가합니다.
- **Environment used per domain**
- **Misconfiguration:** 프로덕션에서 도메인에 사용되는 환경을 변경합니다.
- **Risk:** 프로덕션에서 사용해서는 안 되는 잠재적인 비밀이나 기능이 노출됩니다.

---

### Environments

**목적:** 특정 설정 및 변수를 가진 다양한 환경(개발, 미리보기, 프로덕션)을 정의합니다.

#### Security Configurations:

- **Environment Isolation**
- **Misconfiguration:** 환경 간에 환경 변수를 공유합니다.
- **Risk:** 프로덕션 비밀이 개발 또는 미리보기 환경으로 유출되어 노출이 증가합니다.
- **Access to Sensitive Environments**
- **Misconfiguration:** 프로덕션 환경에 대한 광범위한 접근을 허용합니다.
- **Risk:** 무단 변경 또는 라이브 애플리케이션에 대한 접근으로 인해 잠재적인 다운타임이나 데이터 유출이 발생할 수 있습니다.

---

### Environment Variables

**목적:** 애플리케이션에서 사용하는 환경별 변수 및 비밀을 관리합니다.

#### Security Configurations:

- **Exposing Sensitive Variables**
- **Misconfiguration:** 민감한 변수를 `NEXT_PUBLIC_`로 접두어를 붙여 클라이언트 측에서 접근할 수 있게 합니다.
- **Risk:** API 키, 데이터베이스 자격 증명 또는 기타 민감한 데이터가 공개되어 데이터 유출이 발생할 수 있습니다.
- **Sensitive disabled**
- **Misconfiguration:** 비활성화된 경우(기본값) 생성된 비밀의 값을 읽을 수 있습니다.
- **Risk:** 민감한 정보의 우발적 노출 또는 무단 접근 가능성이 증가합니다.

---

### Git

**목적:** Git 리포지토리 통합, 브랜치 보호 및 배포 트리거를 구성합니다.

#### Security Configurations:

- **Ignored Build Step (TODO)**
- **Misconfiguration:** 이 옵션은 새로운 커밋이 GitHub에 푸시될 때 실행될 bash 스크립트/명령을 구성할 수 있는 것처럼 보이며, 이는 RCE를 허용할 수 있습니다.
- **Risk:** TBD

---

### Integrations

**목적:** 프로젝트 기능을 향상시키기 위해 타사 서비스 및 도구를 연결합니다.

#### Security Configurations:

- **Insecure Third-Party Integrations**
- **Misconfiguration:** 신뢰할 수 없거나 안전하지 않은 타사 서비스와 통합합니다.
- **Risk:** 취약점, 데이터 유출 또는 손상된 통합을 통한 백도어의 도입.
- **Over-Permissioned Integrations**
- **Misconfiguration:** 통합된 서비스에 과도한 권한을 부여합니다.
- **Risk:** 프로젝트 리소스에 대한 무단 접근, 데이터 조작 또는 서비스 중단.
- **Lack of Integration Monitoring**
- **Misconfiguration:** 타사 통합을 모니터링하고 감사하지 않습니다.
- **Risk:** 손상된 통합의 지연된 탐지로 인해 보안 위반의 잠재적 영향이 증가합니다.

---

### Deployment Protection

**목적:** 다양한 보호 메커니즘을 통해 배포를 안전하게 하고, 누가 환경에 접근하고 배포할 수 있는지를 제어합니다.

#### Security Configurations:

**Vercel Authentication**

- **Misconfiguration:** 인증을 비활성화하거나 팀원 확인을 시행하지 않습니다.
- **Risk:** 무단 사용자가 배포에 접근할 수 있어 데이터 유출 또는 애플리케이션 오용이 발생할 수 있습니다.

**Protection Bypass for Automation**

- **Misconfiguration:** 우회 비밀을 공개적으로 노출하거나 약한 비밀을 사용합니다.
- **Risk:** 공격자가 배포 보호를 우회하여 보호된 배포에 접근하고 조작할 수 있습니다.

**Shareable Links**

- **Misconfiguration:** 링크를 무차별적으로 공유하거나 오래된 링크를 철회하지 않습니다.
- **Risk:** 보호된 배포에 대한 무단 접근, 인증 및 IP 제한을 우회합니다.

**OPTIONS Allowlist**

- **Misconfiguration:** 지나치게 광범위한 경로 또는 민감한 엔드포인트를 허용합니다.
- **Risk:** 공격자가 보호되지 않은 경로를 악용하여 무단 작업을 수행하거나 보안 검사를 우회할 수 있습니다.

**Password Protection**

- **Misconfiguration:** 약한 비밀번호를 사용하거나 안전하지 않게 공유합니다.
- **Risk:** 비밀번호가 추측되거나 유출될 경우 배포에 대한 무단 접근이 발생할 수 있습니다.
- **Note:** **Pro** 플랜에서 **Advanced Deployment Protection**의 일환으로 추가 $150/월에 제공됩니다.

**Deployment Protection Exceptions**

- **Misconfiguration:** 실수로 프로덕션 또는 민감한 도메인을 예외 목록에 추가합니다.
- **Risk:** 중요한 배포가 공개되어 데이터 유출 또는 무단 접근이 발생할 수 있습니다.
- **Note:** **Pro** 플랜에서 **Advanced Deployment Protection**의 일환으로 추가 $150/월에 제공됩니다.

**Trusted IPs**

- **Misconfiguration:** IP 주소 또는 CIDR 범위를 잘못 지정합니다.
- **Risk:** 정당한 사용자가 차단되거나 무단 IP가 접근할 수 있습니다.
- **Note:** **Enterprise** 플랜에서 제공됩니다.

---

### Functions

**목적:** 런타임 설정, 메모리 할당 및 보안 정책을 포함한 서버리스 기능을 구성합니다.

#### Security Configurations:

- **Nothing**

---

### Data Cache

**목적:** 성능을 최적화하고 데이터 저장을 제어하기 위해 캐싱 전략 및 설정을 관리합니다.

#### Security Configurations:

- **Purge Cache**
- **Misconfiguration:** 모든 캐시를 삭제할 수 있습니다.
- **Risk:** 무단 사용자가 캐시를 삭제하여 잠재적인 DoS를 초래할 수 있습니다.

---

### Cron Jobs

**목적:** 지정된 간격으로 자동화된 작업 및 스크립트를 예약합니다.

#### Security Configurations:

- **Disable Cron Job**
- **Misconfiguration:** 코드 내에서 선언된 크론 작업을 비활성화할 수 있습니다.
- **Risk:** 서비스 중단의 잠재적 위험(크론 작업의 목적에 따라 다름).

---

### Log Drains

**목적:** 모니터링 및 감사를 위해 애플리케이션 로그를 캡처하고 저장하기 위해 외부 로깅 서비스를 구성합니다.

#### Security Configurations:

- Nothing (팀 설정에서 관리됨)

---

### Security

**목적:** 프로젝트 접근, 소스 보호 등 다양한 보안 관련 설정을 위한 중앙 허브입니다.

#### Security Configurations:

**Build Logs and Source Protection**

- **Misconfiguration:** 보호를 비활성화하거나 `/logs` 및 `/src` 경로를 공개적으로 노출합니다.
- **Risk:** 빌드 로그 및 소스 코드에 대한 무단 접근으로 인해 정보 유출 및 잠재적 취약점 악용이 발생할 수 있습니다.

**Git Fork Protection**

- **Misconfiguration:** 적절한 검토 없이 무단 풀 요청을 허용합니다.
- **Risk:** 악의적인 코드가 코드베이스에 병합되어 취약점이나 백도어가 도입될 수 있습니다.

**Secure Backend Access with OIDC Federation**

- **Misconfiguration:** OIDC 매개변수를 잘못 설정하거나 안전하지 않은 발급자 URL을 사용합니다.
- **Risk:** 결함 있는 인증 흐름을 통해 백엔드 서비스에 대한 무단 접근이 발생할 수 있습니다.

**Deployment Retention Policy**

- **Misconfiguration:** 보존 기간을 너무 짧게 설정(배포 기록 손실)하거나 너무 길게 설정(불필요한 데이터 보존)합니다.
- **Risk:** 필요할 때 롤백을 수행할 수 없거나 이전 배포로부터 데이터 노출 위험이 증가합니다.

**Recently Deleted Deployments**

- **Misconfiguration:** 삭제된 배포를 모니터링하지 않거나 자동 삭제에만 의존합니다.
- **Risk:** 중요한 배포 기록 손실로 인해 감사 및 롤백이 방해받을 수 있습니다.

---

### Advanced

**목적:** 구성 조정 및 보안 강화를 위한 추가 프로젝트 설정에 접근합니다.

#### Security Configurations:

**Directory Listing**

- **Misconfiguration:** 디렉토리 목록을 활성화하면 사용자가 인덱스 파일 없이 디렉토리 내용을 볼 수 있습니다.
- **Risk:** 민감한 파일, 애플리케이션 구조 및 공격의 잠재적 진입점이 노출됩니다.

---

## Project Firewall

### Firewall

#### Security Configurations:

**Enable Attack Challenge Mode**

- **Misconfiguration:** 이를 활성화하면 DoS에 대한 웹 애플리케이션의 방어력이 향상되지만 사용성의 대가가 따릅니다.
- **Risk:** 잠재적인 사용자 경험 문제.

### Custom Rules & IP Blocking

- **Misconfiguration:** 트래픽을 차단/해제할 수 있습니다.
- **Risk:** 악성 트래픽을 허용하거나 정상 트래픽을 차단하여 잠재적인 DoS를 초래할 수 있습니다.

---

## Project Deployment

### Source

- **Misconfiguration:** 애플리케이션의 전체 소스 코드를 읽을 수 있는 접근을 허용합니다.
- **Risk:** 민감한 정보의 잠재적 노출.

### Skew Protection

- **Misconfiguration:** 이 보호는 클라이언트와 서버 애플리케이션이 항상 동일한 버전을 사용하도록 보장하여 클라이언트가 서버와 다른 버전을 사용하는 비동기화를 방지합니다.
- **Risk:** 이를 비활성화하면 향후 새로운 배포에서 DoS 문제가 발생할 수 있습니다.

---

## Team Settings

### General

#### Security Configurations:

- **Transfer**
- **Misconfiguration:** 모든 프로젝트를 다른 팀으로 전송할 수 있습니다.
- **Risk:** 공격자가 프로젝트를 훔칠 수 있습니다.
- **Delete Project**
- **Misconfiguration:** 모든 프로젝트와 함께 팀을 삭제할 수 있습니다.
- **Risk:** 프로젝트가 삭제됩니다.

---

### Billing

#### Security Configurations:

- **Speed Insights Cost Limit**
- **Misconfiguration:** 공격자가 이 숫자를 증가시킬 수 있습니다.
- **Risk:** 비용 증가.

---

### Members

#### Security Configurations:

- **Add members**
- **Misconfiguration:** 공격자가 자신이 제어하는 계정을 초대하여 지속성을 유지할 수 있습니다.
- **Risk:** 공격자의 지속성.
- **Roles**
- **Misconfiguration:** 필요하지 않은 사람에게 너무 많은 권한을 부여하면 Vercel 구성의 위험이 증가합니다. [https://vercel.com/docs/accounts/team-members-and-roles/access-roles](https://vercel.com/docs/accounts/team-members-and-roles/access-roles)에서 가능한 모든 역할을 확인하십시오.
- **Risk**: Vercel 팀의 노출 증가.

---

### Access Groups

Vercel의 **Access Group**은 미리 정의된 역할 할당이 있는 프로젝트 및 팀 구성원의 모음으로, 여러 프로젝트에 걸쳐 중앙 집중식 및 간소화된 접근 관리를 가능하게 합니다.

**잠재적인 잘못된 구성:**

- **Over-Permissioning Members:** 필요 이상으로 많은 권한을 가진 역할을 할당하여 무단 접근이나 행동을 초래합니다.
- **Improper Role Assignments:** 팀 구성원의 책임과 일치하지 않는 역할을 잘못 할당하여 권한 상승을 초래합니다.
- **Lack of Project Segregation:** 민감한 프로젝트를 분리하지 않아 의도보다 더 넓은 접근을 허용합니다.
- **Insufficient Group Management:** Access Groups를 정기적으로 검토하거나 업데이트하지 않아 구식 또는 부적절한 접근 권한이 발생합니다.
- **Inconsistent Role Definitions:** 서로 다른 Access Groups 간에 일관되지 않거나 불분명한 역할 정의를 사용하여 혼란과 보안 격차를 초래합니다.

---

### Log Drains

#### Security Configurations:

- **Log Drains to third parties:**
- **Misconfiguration:** 공격자가 로그를 훔치기 위해 Log Drain을 구성할 수 있습니다.
- **Risk:** 부분적인 지속성.

---

### Security & Privacy

#### Security Configurations:

- **Team Email Domain:** 구성 시 이 설정은 지정된 도메인(예: `mydomain.com`)으로 끝나는 이메일 주소를 가진 Vercel 개인 계정을 자동으로 초대하여 팀에 가입하도록 합니다.
- **Misconfiguration:**\
잘못된 이메일 도메인 또는 잘못 철자된 도메인을 팀 이메일 도메인 설정에 지정합니다.
- 일반 이메일 도메인(예: `gmail.com`, `hotmail.com`)을 회사 특정 도메인 대신 사용합니다.
- **Risks:**
- **Unauthorized Access:** 의도하지 않은 도메인의 이메일 주소를 가진 사용자가 팀에 가입하라는 초대를 받을 수 있습니다.
- **Data Exposure:** 민감한 프로젝트 정보가 무단 개인에게 노출될 수 있습니다.
- **Protected Git Scopes:** 보호된 범위에서 다른 Vercel 팀이 리포지토리를 배포하지 못하도록 팀에 최대 5개의 Git 범위를 추가할 수 있습니다. 여러 팀이 동일한 범위를 지정할 수 있어 두 팀 모두 접근할 수 있습니다.
- **Misconfiguration:** 보호된 목록에 중요한 Git 범위를 추가하지 않습니다.
- **Risks:**
- **Unauthorized Deployments:** 다른 팀이 귀하의 조직 Git 범위에서 무단으로 리포지토리를 배포할 수 있습니다.
- **Intellectual Property Exposure:** 독점 코드가 배포되어 팀 외부에서 접근될 수 있습니다.
- **Environment Variable Policies:** 팀의 환경 변수를 생성하고 편집하는 정책을 시행합니다. 특히 모든 환경 변수가 Vercel의 배포 시스템에 의해 복호화될 수 있는 **민감한 환경 변수**로 생성되도록 강제할 수 있습니다.
- **Misconfiguration:** 민감한 환경 변수의 시행을 비활성화합니다.
- **Risks:**
- **Exposure of Secrets:** 환경 변수가 무단 팀 구성원에 의해 조회되거나 편집될 수 있습니다.
- **Data Breach:** API 키 및 자격 증명과 같은 민감한 정보가 유출될 수 있습니다.
- **Audit Log:** 팀의 활동을 지난 90일 동안 내보낼 수 있습니다. 감사 로그는 팀 구성원이 수행한 작업을 모니터링하고 추적하는 데 도움이 됩니다.
- **Misconfiguration:**\
무단 팀 구성원에게 감사 로그에 대한 접근을 부여합니다.
- **Risks:**
- **Privacy Violations:** 민감한 사용자 활동 및 데이터의 노출.
- **Tampering with Logs:** 악의적인 행위자가 로그를 변경하거나 삭제하여 자신의 흔적을 감출 수 있습니다.
- **SAML Single Sign-On:** 팀을 위한 SAML 인증 및 디렉토리 동기화를 사용자 정의할 수 있으며, 중앙 집중식 인증 및 사용자 관리를 위해 Identity Provider(IdP)와 통합할 수 있습니다.
- **Misconfiguration:** 공격자가 SAML 매개변수(예: Entity ID, SSO URL 또는 인증서 지문)를 설정하여 팀을 백도어할 수 있습니다.
- **Risk:** 지속성 유지.
- **IP Address Visibility:** 특정 데이터 보호 법률에 따라 개인 정보로 간주될 수 있는 IP 주소가 모니터링 쿼리 및 로그 드레인에 표시되는지 여부를 제어합니다.
- **Misconfiguration:** 필요 없이 IP 주소 가시성을 활성화한 상태로 두는 것.
- **Risks:**
- **Privacy Violations:** GDPR과 같은 데이터 보호 규정 준수 실패.
- **Legal Repercussions:** 개인 데이터를 잘못 처리하여 발생할 수 있는 잠재적 벌금 및 처벌.
- **IP Blocking:** Vercel이 요청을 차단해야 하는 IP 주소 및 CIDR 범위를 구성할 수 있습니다. 차단된 요청은 청구에 기여하지 않습니다.
- **Misconfiguration:** 공격자가 악성 트래픽을 허용하거나 정상 트래픽을 차단하는 데 악용할 수 있습니다.
- **Risks:**
- **Service Denial to Legitimate Users:** 유효한 사용자 또는 파트너의 접근 차단.
- **Operational Disruptions:** 특정 지역 또는 클라이언트에 대한 서비스 가용성 손실.

---

### Secure Compute

**Vercel Secure Compute**는 Vercel Functions와 백엔드 환경(예: 데이터베이스) 간의 안전하고 비공식적인 연결을 가능하게 하여 전용 IP 주소가 있는 격리된 네트워크를 설정합니다. 이를 통해 백엔드 서비스를 공개적으로 노출할 필요가 없어 보안, 규정 준수 및 개인 정보 보호가 향상됩니다.

#### **잠재적인 잘못된 구성 및 위험**

1. **Incorrect AWS Region Selection**
- **Misconfiguration:** Secure Compute 네트워크에 대한 AWS 리전을 백엔드 서비스의 리전과 일치하지 않게 선택합니다.
- **Risk:** 지연 증가, 데이터 거주지 준수 문제 및 성능 저하.
2. **Overlapping CIDR Blocks**
- **Misconfiguration:** 기존 VPC 또는 다른 네트워크와 겹치는 CIDR 블록을 선택합니다.
- **Risk:** 네트워크 충돌로 인해 연결 실패, 무단 접근 또는 네트워크 간 데이터 유출이 발생할 수 있습니다.
3. **Improper VPC Peering Configuration**
- **Misconfiguration:** VPC 피어링을 잘못 설정합니다(예: 잘못된 VPC ID, 불완전한 라우트 테이블 업데이트).
- **Risk:** 백엔드 인프라에 대한 무단 접근, 안전한 연결 실패 및 잠재적 데이터 유출.
4. **Excessive Project Assignments**
- **Misconfiguration:** 적절한 격리 없이 여러 프로젝트를 단일 Secure Compute 네트워크에 할당합니다.
- **Risk:** 공유 IP 노출로 인해 공격 표면이 증가하여 손상된 프로젝트가 다른 프로젝트에 영향을 미칠 수 있습니다.
5. **Inadequate IP Address Management**
- **Misconfiguration:** 전용 IP 주소를 적절하게 관리하거나 회전하지 않습니다.
- **Risk:** IP 스푸핑, 추적 취약점 및 IP가 악의적인 활동과 연관될 경우 블랙리스트에 올라갈 수 있습니다.
6. **Including Build Containers Unnecessarily**
- **Misconfiguration:** 빌드 중 백엔드 접근이 필요하지 않을 때 빌드 컨테이너를 Secure Compute 네트워크에 추가합니다.
- **Risk:** 공격 표면이 확대되고 프로비저닝 지연이 증가하며 네트워크 자원의 불필요한 소비가 발생합니다.
7. **Failure to Securely Handle Bypass Secrets**
- **Misconfiguration:** 배포 보호를 우회하는 데 사용되는 비밀을 노출하거나 잘못 처리합니다.
- **Risk:** 보호된 배포에 대한 무단 접근이 발생하여 공격자가 악성 코드를 조작하거나 배포할 수 있습니다.
8. **Ignoring Region Failover Configurations**
- **Misconfiguration:** 수동 장애 조치 지역을 설정하지 않거나 장애 조치 설정을 잘못 구성합니다.
- **Risk:** 기본 지역 중단 시 서비스 중단이 발생하여 가용성이 감소하고 데이터 불일치가 발생할 수 있습니다.
9. **Exceeding VPC Peering Connection Limits**
- **Misconfiguration:** 허용된 한도(예: 50개 연결 초과)보다 더 많은 VPC 피어링 연결을 설정하려고 시도합니다.
- **Risk:** 필요한 백엔드 서비스에 안전하게 연결할 수 없어 배포 실패 및 운영 중단이 발생할 수 있습니다.
10. **Insecure Network Settings**
- **Misconfiguration:** 약한 방화벽 규칙, 암호화 부족 또는 Secure Compute 네트워크 내에서 잘못된 네트워크 분할.
- **Risk:** 데이터 가로채기, 백엔드 서비스에 대한 무단 접근 및 공격에 대한 취약성이 증가합니다.

---

### Environment Variables

**목적:** 모든 프로젝트에서 사용하는 환경별 변수 및 비밀을 관리합니다.

#### Security Configurations:

- **Exposing Sensitive Variables**
- **Misconfiguration:** 민감한 변수를 `NEXT_PUBLIC_`로 접두어를 붙여 클라이언트 측에서 접근할 수 있게 합니다.
- **Risk:** API 키, 데이터베이스 자격 증명 또는 기타 민감한 데이터가 공개되어 데이터 유출이 발생할 수 있습니다.
- **Sensitive disabled**
- **Misconfiguration:** 비활성화된 경우(기본값) 생성된 비밀의 값을 읽을 수 있습니다.
- **Risk:** 민감한 정보의 우발적 노출 또는 무단 접근 가능성이 증가합니다.

{{#include ../banners/hacktricks-training.md}}
