# Atlassian (Jira/Confluence/JSM) Security

{{#include ../../banners/hacktricks-training.md}}

## Overview

Atlassian Cloud hosts multiple products under a single tenant domain, typically at https://<tenant>.atlassian.net. Common product paths in the same tenant are:

- /jira or /browse → Jira
- /wiki → Confluence
- /admin → Admin UI

A single Atlassian identity is shared across products in the tenant. Jira Service Management (JSM) can be configured with email channels that auto-create “customer” users when they email a support address. Confluence access is controlled by global and space permissions; if configured to allow “all authenticated users,” any user account in the tenant (including externally created JSM customers) may gain access.

## Enumeration

After you obtain a valid Atlassian Cloud identity for a tenant (via invitation or existing account), enumerate co-hosted products and access scopes:

```text
https://<tenant>.atlassian.net/jira
https://<tenant>.atlassian.net/browse
https://<tenant>.atlassian.net/admin
https://<tenant>.atlassian.net/wiki
```

- A page stating “You don’t have access” is normal for products not granted to the account.
- If Confluence is reachable under /wiki, enumerate spaces and verify read and write by attempting to view, create, edit, and delete pages in test locations.

## Misconfiguration: JSM email auto-provisioning → Confluence “all authenticated users”

Attack preconditions:
- JSM email channel auto-provisions accounts into the main Atlassian tenant when someone emails support@<company>.
- Confluence global or space permissions include “all authenticated users,” or grant a default group that all new users join.

Exploit chain:
1) Send any email to the public JSM support mailbox.
2) Accept the Atlassian invitation and sign in to the tenant.
3) Enumerate product paths; navigate to /wiki.
4) Confirm effective permissions by reading spaces and attempting to create/edit/delete pages where allowed.

Observed impact:
- Read: internal docs, architecture diagrams, configs, project info.
- Write: create/edit/delete pages (tampering, misinformation, persistence via malicious content/links/macros).

Why it happens:
- External “customers” get provisioned into the same tenant and inherit tenant-level default groups.
- Confluence permissions over-broaden access using “all authenticated users” (or groups automatically granted to all new accounts), unintentionally including external JSM-created users.

## Reproduction checklist

```text
1) Send an email → await Atlassian invite
2) Accept invite → sign in to https://<tenant>.atlassian.net
3) Visit https://<tenant>.atlassian.net/wiki
4) Confirm read access → attempt to create/edit/delete a test page
```

## Detection and validation

- Identity events: Look for newly provisioned users originating from JSM email channel flows.
- Group membership: Confirm whether external users are added to default groups with Confluence access.
- Confluence effective permissions: Review global permissions and space permissions for “all authenticated users” or groups that capture all users.
- Access logs: Check Confluence audit logs for access from newly created external accounts; review page create/edit/delete activity.

## Hardening guidance

- JSM email channels:
  - Disable automatic user provisioning into the primary tenant, or scope email-created users to isolated customer directories/tenants.
  - Require manual approval for invitations originating from public email channels.
- Confluence permissions:
  - Remove “all authenticated users” from global/space permissions unless strictly necessary.
  - Restrict access to vetted internal groups; avoid default groups that include external customers.
  - Periodically audit global permissions and each space’s permissions; verify anonymous vs. authenticated vs. internal-only access settings.
- Tenant hygiene:
  - Separate customer-facing helpdesk and internal products into distinct tenants/directories.
  - Regularly review SaaS defaults and inheritance paths for cross-product identity leakage.

## Notes for testers

- This is a broken access control/misconfiguration chain, not a CVE.
- No special payloads or tools are required; path enumeration plus invite acceptance is sufficient.
- Focus on documenting evidence: invitation email, tenant login, /wiki access, and read/write actions performed in non-sensitive test areas.

## References

- [Confluence Takeover: How a Simple Support Email Gave Me Full Wiki Access](https://medium.com/@kalvik/confluence-takeover-how-a-simple-support-email-gave-me-full-wiki-access-a9ac7c27fa31)

{{#include ../../banners/hacktricks-training.md}}
