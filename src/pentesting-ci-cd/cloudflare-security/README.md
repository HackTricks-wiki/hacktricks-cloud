# Cloudflare सुरक्षा

{{#include ../../banners/hacktricks-training.md}}

Cloudflare खाते में कुछ **सामान्य सेटिंग्स और सेवाएँ** हैं जिन्हें कॉन्फ़िगर किया जा सकता है। इस पृष्ठ पर हम प्रत्येक अनुभाग की **सुरक्षा संबंधित सेटिंग्स का विश्लेषण करेंगे:**

<figure><img src="../../images/image (117).png" alt=""><figcaption></figcaption></figure>

## वेबसाइट्स

Review each with:

{{#ref}}
cloudflare-domains.md
{{#endref}}

### डोमेन पंजीकरण

- [ ] In **`Transfer Domains`** सुनिश्चित करें कि किसी भी डोमेन का ट्रांसफर करना संभव न हो।

Review each with:

{{#ref}}
cloudflare-domains.md
{{#endref}}

## एनालिटिक्स

_कॉन्फ़िगरेशन सुरक्षा समीक्षा के लिए जांचने योग्य कुछ नहीं मिला._

## Pages

प्रत्येक Cloudflare Page पर:

- [ ] **`Build log`** में **संवेदनशील जानकारी** के लिए जांच करें।
- [ ] Pages को असाइन किए गए **Github repository** में **संवेदनशील जानकारी** की जांच करें।
- [ ] संभावित Github repo compromise की जांच करें via **workflow command injection** या `pull_request_target` compromise. अधिक जानकारी के लिए [**Github Security page**](../github-security/index.html) देखें।
- [ ] `/fuctions` directory में **vulnerable functions** की जांच करें (यदि कोई), `_redirects` फ़ाइल में **redirects** की जांच करें (यदि कोई) और `_headers` फ़ाइल में **misconfigured headers** की जांच करें (यदि कोई)।
- [ ] यदि आप **code** तक पहुँच सकते हैं तो **blackbox** या **whitebox** के माध्यम से **web page** में **vulnerabilities** के लिए जांच करें।
- [ ] प्रत्येक पृष्ठ के विवरण में `/<page_id>/pages/view/blocklist/settings/functions` देखें। **`Environment variables`** में **संवेदनशील जानकारी** के लिए जांच करें।
- [ ] विवरण पृष्ठ में **build command** और **root directory** की भी जांच करें कि क्या पेज को compromise करने के लिए कोई **potential injections** हैं।

## **Workers**

प्रत्येक Cloudflare Worker पर जांच करें:

- [ ] ट्रिगर्स: Worker को क्या ट्रिगर करता है? क्या कोई user ऐसा डेटा भेज सकता है जिसे Worker उपयोग करेगा?
- [ ] **`Settings`** में **`Variables`** जो **संवेदनशील जानकारी** रखते हैं, उनकी जांच करें।
- [ ] Worker के **code** की जांच करें और **vulnerabilities** खोजें (विशेषकर उन जगहों पर जहाँ user इनपुट को नियंत्रित कर सकता है)।
- [ ] SSRFs की जांच करें जो उस निर्दिष्ट पेज को return करें जिसे आप नियंत्रित कर सकते हैं।
- [ ] XSSs की जांच करें जो svg image के अंदर JS execute करते हैं।
- [ ] यह संभव है कि Worker अन्य internal services के साथ interact करे। उदाहरण के लिए, एक Worker ऐसा R2 bucket के साथ interact कर सकता है जिसमें इनपुट से प्राप्त information store होती है। उस स्थिति में, यह जांचना आवश्यक होगा कि Worker के पास R2 bucket पर क्या capabilities हैं और इन्हें user input से कैसे abuse किया जा सकता है।

> [!WARNING]
> डिफ़ॉल्ट रूप से एक **Worker को एक URL दिया जाता है** जैसे `<worker-name>.<account>.workers.dev`। user इसे एक **subdomain** पर सेट कर सकता है, लेकिन यदि आप उस **original URL** को जानते हैं तो आप हमेशा उससे access कर सकते हैं।

For a practical abuse of Workers as pass-through proxies (IP rotation, FireProx-style), check:

{{#ref}}
cloudflare-workers-pass-through-proxy-ip-rotation.md
{{#endref}}

## R2

प्रत्येक R2 bucket पर जांचें:

- [ ] **CORS Policy** configure करें।

## Stream

TODO

## Images

TODO

## Security Center

- [ ] यदि संभव हो, तो **`Security Insights`** **scan** और **`Infrastructure`** **scan** चलाएँ, क्योंकि ये security संबंधी रोचक जानकारी को highlight करेंगे।
- [ ] बस इन जानकारियों को security misconfigurations और रोचक सूचनाओं के लिए जांचें।

## Turnstile

TODO

## **Zero Trust**

{{#ref}}
cloudflare-zero-trust-network.md
{{#endref}}

## Bulk Redirects

> [!NOTE]
> Unlike [Dynamic Redirects](https://developers.cloudflare.com/rules/url-forwarding/dynamic-redirects/), [**Bulk Redirects**](https://developers.cloudflare.com/rules/url-forwarding/bulk-redirects/) are essentially static — वे मूल रूप से static हैं — वे किसी भी string replacement ऑपरेशन या regular expressions का समर्थन नहीं करते। हालांकि, आप URL redirect parameters configure कर सकते हैं जो उनके URL matching व्यवहार और उनके runtime व्यवहार को प्रभावित करते हैं।

- [ ] जाँचें कि redirects के लिए दिए गए **expressions** और **requirements** समझदारी से बने हैं।
- [ ] यह भी जाँचें कि क्या कोई **sensitive hidden endpoints** हैं जिनमें रोचक जानकारी निहित हो।

## Notifications

- [ ] **notifications** की जाँच करें। सुरक्षा के लिए ये notifications सुझाए जाते हैं:
- `Usage Based Billing`
- `HTTP DDoS Attack Alert`
- `Layer 3/4 DDoS Attack Alert`
- `Advanced HTTP DDoS Attack Alert`
- `Advanced Layer 3/4 DDoS Attack Alert`
- `Flow-based Monitoring: Volumetric Attack`
- `Route Leak Detection Alert`
- `Access mTLS Certificate Expiration Alert`
- `SSL for SaaS Custom Hostnames Alert`
- `Universal SSL Alert`
- `Script Monitor New Code Change Detection Alert`
- `Script Monitor New Domain Alert`
- `Script Monitor New Malicious Domain Alert`
- `Script Monitor New Malicious Script Alert`
- `Script Monitor New Malicious URL Alert`
- `Script Monitor New Scripts Alert`
- `Script Monitor New Script Exceeds Max URL Length Alert`
- `Advanced Security Events Alert`
- `Security Events Alert`
- [ ] सभी **destinations** की जांच करें, क्योंकि webhook URLs में **संवेदनशील जानकारी** (basic http auth) हो सकती है। यह भी सुनिश्चित करें कि webhook URLs **HTTPS** का उपयोग करें।
- [ ] अतिरिक्त जाँच के रूप में, आप किसी तृतीय पक्ष को **Cloudflare notification impersonate** करने की कोशिश कर सकते हैं—शायद आप किसी तरह **inject कुछ खतरनाक** कर पाएं।

## खाता प्रबंधन

- [ ] आप **`Billing` -> `Payment info`** में क्रेडिट कार्ड के **last 4 digits**, **expiration** समय और **billing address** देख सकते हैं।
- [ ] आप खाते में उपयोग किए गए **plan type** को **`Billing` -> `Subscriptions`** में देख सकते हैं।
- [ ] **`Members`** में आप खाते के सभी सदस्य और उनकी **role** देख सकते हैं। ध्यान दें कि यदि plan type Enterprise नहीं है, तो केवल 2 roles होते हैं: Administrator और Super Administrator। लेकिन यदि उपयोग किए गए **plan is Enterprise** है, तो [**more roles**](https://developers.cloudflare.com/fundamentals/account-and-billing/account-setup/account-roles/) का उपयोग least privilege सिद्धांत का पालन करने के लिए किया जा सकता है।
- इसलिए, जहाँ संभव हो **Enterprise plan** का उपयोग करने की सिफ़ारिश की जाती है।
- [ ] Members में यह भी देखा जा सकता है कि किन **members** के पास **2FA enabled** है। **हर** user के पास यह सक्षम होना चाहिए।

> [!NOTE]
> ध्यान दें कि सौभाग्य से role **`Administrator`** को memberships प्रबंधित करने की अनुमति नहीं देती (**cannot escalate privs or invite** नए सदस्यों को)।

## DDoS Investigation

[Check this part](cloudflare-domains.md#cloudflare-ddos-protection).

{{#include ../../banners/hacktricks-training.md}}
