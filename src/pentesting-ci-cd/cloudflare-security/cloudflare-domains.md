# Cloudflare Domains

{{#include ../../banners/hacktricks-training.md}}

Cloudflare'da yapılandırılan her TLD'de bazı **genel ayarlar ve hizmetler** yapılandırılabilir. Bu sayfada her bölümün **güvenlikle ilgili ayarlarını analiz edeceğiz:**

<figure><img src="../../images/image (101).png" alt=""><figcaption></figcaption></figure>

### Overview

- [ ] Hesabın **hizmetlerinin ne kadar** **kullanıldığını** anlamak
- [ ] Ayrıca **zone ID** ve **account ID** bulmak

### Analytics

- [ ] **`Security`** bölümünde herhangi bir **Rate limiting** olup olmadığını kontrol et

### DNS

- [ ] DNS **kayıtlarında** **ilginç** (hassas?) verileri kontrol et
- [ ] **İsim** (örneğin admin173865324.domin.com) temelinde **hassas bilgi** içerebilecek **alt alan adlarını** kontrol et
- [ ] **Proxylenmemiş** web sayfalarını kontrol et
- [ ] CNAME veya IP adresi ile **doğrudan erişilebilen** **proxylenmiş web sayfalarını** kontrol et
- [ ] **DNSSEC**'in **etkin** olduğunu kontrol et
- [ ] **Tüm CNAME'lerde** **CNAME Flattening**'in **kullanıldığını** kontrol et
- Bu, **alt alan adı ele geçirme açıklarını gizlemek** ve yükleme sürelerini iyileştirmek için faydalı olabilir
- Alan adlarının [**sahtecilik için savunmasız olmadığını**](https://book.hacktricks.xyz/network-services-pentesting/pentesting-smtp#mail-spoofing) kontrol et

### **Email**

TODO

### Spectrum

TODO

### SSL/TLS

#### **Overview**

- **SSL/TLS şifrelemesi** **Full** veya **Full (Strict)** olmalıdır. Diğer herhangi bir seçenek, bir noktada **düz metin trafiği** gönderecektir.
- **SSL/TLS Recommender** etkin olmalıdır

#### Edge Certificates

- **Always Use HTTPS** **etkin** olmalıdır
- **HTTP Strict Transport Security (HSTS)** **etkin** olmalıdır
- **Minimum TLS Versiyonu 1.2** olmalıdır
- **TLS 1.3** **etkin** olmalıdır
- **Automatic HTTPS Rewrites** **etkin** olmalıdır
- **Certificate Transparency Monitoring** **etkin** olmalıdır

### **Security**

- **`WAF`** bölümünde, **Firewall** ve **rate limiting kurallarının kullanıldığını** kontrol etmek ilginçtir.
- **`Bypass`** eylemi, bir istekte **Cloudflare güvenlik** özelliklerini **devre dışı bırakır**. Kullanılmamalıdır.
- **`Page Shield`** bölümünde, herhangi bir sayfa kullanılıyorsa **etkin** olduğunu kontrol etmek önerilir
- **`API Shield`** bölümünde, Cloudflare'da herhangi bir API açığa çıkmışsa **etkin** olduğunu kontrol etmek önerilir
- **`DDoS`** bölümünde, **DDoS korumalarının** etkinleştirilmesi önerilir
- **`Settings`** bölümünde:
- **`Security Level`**'ın **orta** veya daha yüksek olduğunu kontrol et
- **`Challenge Passage`**'ın en fazla 1 saat olduğunu kontrol et
- **`Browser Integrity Check`**'in **etkin** olduğunu kontrol et
- **`Privacy Pass Support`**'ın **etkin** olduğunu kontrol et

#### **CloudFlare DDoS Protection**

- Eğer mümkünse, **Bot Fight Mode** veya **Super Bot Fight Mode**'u etkinleştir. Programatik olarak erişilen bazı API'leri koruyorsanız (örneğin bir JS ön yüz sayfasından). Bu erişimi bozmadan etkinleştiremeyebilirsiniz.
- **WAF**'da: **URL yolu** veya **doğrulanmış botlar** için **rate limit** oluşturabilirsiniz (Rate limiting kuralları), veya **IP, Cookie, referans** vb. temelinde **erişimi engelleyebilirsiniz**. Böylece bir web sayfasından gelmeyen veya bir çerezi olmayan istekleri engelleyebilirsiniz.
- Eğer saldırı bir **doğrulanmış bot** tarafından geliyorsa, en azından **botlar için bir rate limit** ekleyin.
- Eğer saldırı **belirli bir yola** ise, önleme mekanizması olarak bu yolda bir **rate limit** ekleyin.
- **WAF**'daki **Tools** bölümünden IP adreslerini, IP aralıklarını, ülkeleri veya ASN'leri **beyaz listeye alabilirsiniz**.
- **Managed rules**'ın da zafiyet istismarlarını önlemeye yardımcı olup olmadığını kontrol edin.
- **Tools** bölümünde belirli IP'lere ve **kullanıcı ajanlarına** **engelleme veya meydan okuma** yapabilirsiniz.
- DDoS'da bazı kuralları **daha kısıtlayıcı hale getirmek için geçersiz kılabilirsiniz**.
- **Settings**: **Security Level**'ı **Yüksek** ve **Under Attack** olarak ayarlayın eğer saldırı altındaysanız ve **Browser Integrity Check etkin** ise.
- Cloudflare Domains -> Analytics -> Security -> **rate limit**'in etkin olup olmadığını kontrol et
- Cloudflare Domains -> Security -> Events -> **tespit edilen kötü niyetli olaylar** için kontrol et

### Access

{{#ref}}
cloudflare-zero-trust-network.md
{{#endref}}

### Speed

_Güvenlikle ilgili herhangi bir seçenek bulamadım_

### Caching

- **`Configuration`** bölümünde **CSAM Scanning Tool**'un etkinleştirilmesini düşünün

### **Workers Routes**

_Daha önce_ [_cloudflare workers_](./#workers) _kontrol etmiş olmalısınız_

### Rules

TODO

### Network

- [ ] Eğer **`HTTP/2`** **etkinse**, **`HTTP/2 to Origin`** **etkin** olmalıdır
- [ ] **`HTTP/3 (with QUIC)`** **etkin** olmalıdır
- [ ] Eğer **kullanıcılarınızın** **gizliliği** önemliyse, **`Onion Routing`**'in **etkin** olduğundan emin olun

### **Traffic**

TODO

### Custom Pages

- Güvenlikle ilgili bir hata tetiklendiğinde (örneğin bir engelleme, rate limiting veya saldırı altındayım modu) özel sayfaları yapılandırmak isteğe bağlıdır

### Apps

TODO

### Scrape Shield

- **Email Address Obfuscation**'ın **etkin** olduğunu kontrol et
- **Server-side Excludes**'ın **etkin** olduğunu kontrol et

### **Zaraz**

TODO

### **Web3**

TODO

{{#include ../../banners/hacktricks-training.md}}
